<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>学习 &amp; 技术 on LRYP&#39;s Blog</title>
        <link>https://littlereuben.github.io/study/</link>
        <description>Recent content in 学习 &amp; 技术 on LRYP&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>LRYP</copyright>
        <lastBuildDate>Sun, 23 Feb 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://littlereuben.github.io/study/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>狭义相对论笔记</title>
        <link>https://littlereuben.github.io/study/special-relativity/</link>
        <pubDate>Sun, 23 Feb 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/special-relativity/</guid>
        <description>&lt;p&gt;$\gdef\b#1{\boldsymbol{#1}}\gdef\d{\mathrm{d}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;这篇笔记是学普物二时为了理解磁场和电场本质一致的关系时写的，侧重于理解狭相的推导过程。好像这学期普物一也会用，大家可以参考。&lt;/p&gt;
&lt;p&gt;这篇文章里没包含的内容：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;用闵氏空间语言讲相对论，包括时空间隔的几何意义、四维矢量，以及一些高级的上下标表示法。&lt;/li&gt;
&lt;li&gt;钟慢、尺缩、质量的三个实验详细推导。&lt;/li&gt;
&lt;li&gt;双生子佯谬。&lt;/li&gt;
&lt;li&gt;四维加速度的推导（其实应该算是四维力的前置，但是后续只有力变换用得着，我就没推）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;公理 1&lt;/strong&gt;：在任意惯性系内，所有物理规律都是相同的。&lt;/p&gt;
&lt;p&gt;这里“惯性系”根本没定义，我们可以理解成，是这几条公理定义了惯性系，或者说惯性系要满足这几条公理。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;公理 2&lt;/strong&gt;：在任意惯性系内，光速均 $=c$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;公理 *&lt;/strong&gt;：如果从惯性系 $A$ 来看，惯性系 $B$ 相对于 $A$ 以 $\b v$ 的速度运动，那么从惯性系 $B$ 来看，惯性系 $A$ 相对于 $B$ 以 $-\b v$ 的速度运动。&lt;/p&gt;
&lt;p&gt;这条公理本来是可以由前两条公理推导出来，但是太复杂了（详见&lt;a class=&#34;link&#34; href=&#34;https://physics.stackexchange.com/questions/219390/why-is-the-relative-speed-between-two-inertial-frames-the-same-for-observers-in&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;），所以就默认它也算公理了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;惯性系的描述&lt;/strong&gt;：一个惯性系中，事件可以用三维空间加一维时间 $(x,y,z,t)$ 描述。同一个惯性（参考）系可以有很多惯性坐标系，但这些坐标系直接只是平移（含时间）和旋转（不含时间）关系，所以这个不是重点。注意，对坐标进行拉伸或压缩后，得到的并不是合法的惯性坐标系。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;惯性系中的观测&lt;/strong&gt;：可以认为，当一个事件发生时，这个惯性系可以立即得到其坐标，而并非一个站在原点处的人通过眼睛观测这个事件。书中具体实现这个事情，是通过在三维空间的每一点放一个钟，然后对时。
$$
\boxed{\gamma=\frac{1}{\sqrt{1-\frac{v^2}{c^2}}}}
$$
&lt;strong&gt;钟慢效应&lt;/strong&gt;：当一个钟在运动时（不一定是惯性地），它本身有一个固有时 $\tau$。这个固有时与观测它的参考系无关。&lt;br&gt;
通过对车上法向测距的几何分析（自己看书）（注意需要假设与速度垂直方向空间不伸缩）可得 $\Delta t=\gamma\Delta\tau$。&lt;br&gt;
注意这个式子的含义&lt;em&gt;不是&lt;/em&gt;“在系 $A^\prime$ 中经过了 $\Delta\tau$ 时间，&lt;em&gt;对应&lt;/em&gt;在系 $A$ 中经过了 $\gamma\Delta\tau$ 时间”，这个&lt;em&gt;对应&lt;/em&gt;是非良定义的。它的严格表述是，“在 $A^\prime$ 中同一点处发生的间隔 $\Delta\tau$ 的事件，从 $A$ 中来看是间隔 $\gamma\Delta\tau$ 的事件”。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;尺缩效应&lt;/strong&gt;：类似地，如果两点相对于钟静止，那么两点之间的距离就是固有长度 $l_0$。&lt;br&gt;
通过对车上径向测距的几何分析（注意需要依赖钟慢效应的推导）可得（与速度方向相同的杆）$l=l_0/\gamma$。&lt;br&gt;
更一般的尺缩效应会在下面解释。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;同时相对性&lt;/strong&gt;：一个系对时的过程中出现两处同时收到光信号，从另一个系看来是不同时的。注意这是一个定性的规律，因为从另一个系来看的长度还需分析。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;洛伦兹变换推导&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;这里我们默认两个参考系的 $(0,0)$ 重合。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;一维洛伦兹变换的推导（依赖于钟慢、尺缩）：&lt;/p&gt;
&lt;p&gt;我们首先不加证明地说，变换存在，且是线性的。&lt;/p&gt;
&lt;p&gt;钟慢效应说，在参考系 $A^\prime$ 中发生的事 $(0,0)-(0,t)$，可以对应到 $A$ 中发生的事 $(0,0)-(v\gamma t,t)$；&lt;/p&gt;
&lt;p&gt;尺缩效应需要改一下才能用，书里说的是，长度的测量是通过“激光测距仪”实现的，这个不好搞。考虑这样：$A^\prime$ 中有一根 $-l\sim 0$ 的棍子，它的两端经过 $A$ 中的原点作为两个事件。$A^\prime$ 中是 $(0,0)-(-l,l/v)$，$A$ 中则由于两次测的点相同，故反用钟慢效应，是 $(0,0)-(0,l/\gamma v)$。&lt;/p&gt;
&lt;p&gt;于是我们有方程：
$$
\left\{\begin{align*}
\begin{bmatrix}0\\ t\end{bmatrix}&amp;amp;=\begin{bmatrix}a_{11}&amp;amp;a_{12}\\ a_{21}&amp;amp;a_{22}\end{bmatrix}\begin{bmatrix}v\gamma t\\ t\end{bmatrix}\\
\begin{bmatrix}-l\\ \frac lv\end{bmatrix}&amp;amp;=\begin{bmatrix}a_{11}&amp;amp;a_{12}\\ a_{21}&amp;amp;a_{22}\end{bmatrix}\begin{bmatrix}0\\ \frac{l}{\gamma v}\end{bmatrix}
\end{align*}\right.
$$
解得
$$
\Lambda=\begin{bmatrix}\gamma&amp;amp;-\gamma v\\ -\frac{\gamma v}{c^2}&amp;amp;\gamma\end{bmatrix}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一维洛伦兹变换的推导（依赖于时空间隔不变性）（《电动力学》（郭硕鸿））：&lt;/p&gt;
&lt;p&gt;光速不变的说法强于 $\sqrt{x^2+y^2+z^2}=ct\Leftrightarrow \sqrt{{x^\prime}^2+{y^\prime}^2+{z^\prime}^2}=ct^\prime$。我们可以说&lt;strong&gt;时空间隔&lt;/strong&gt;是不变量
$$
x^2+y^2+z^2-c^2t^2={x^\prime}^2+{y^\prime}^2+{z^\prime}^2-c^2{t^\prime}^2
$$
于是
$$
(a_{11}x+a_{12}t)^2-c^2(a_{21}x+a_{22}t)^2=x^2-c^2t^2
$$
给出了三个方程（比对 $x^2$、$xt$、$t^2$ 的系数）。另外，考虑到 $v$，我们知道 $A$ 中的 $(vt,t)$ 对应着 $A^\prime$ 中的 $(0,?)$。于是
$$
\left\{
\begin{align*}
a_{11}^2-a_{21}^2&amp;amp;=1\\
a_{11}a_{12}-c^2a_{21}a_{22}&amp;amp;=0\\
a_{12}^2-c^2a_{22}^2&amp;amp;=-c^2\\
a_{11}v+a_{12}&amp;amp;=0
\end{align*}
\right.
$$
其中 $a_{11},a_{22}&amp;gt;0$。解得同样的结果。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;注：为什么我们必须要么构造实际场景，要么用有额外公理之感的时空间隔不变性，才能证明洛伦兹比变换呢？因为公理 2 要是用严格的语言描述，必须引入闵氏空间，就很麻烦了。&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;p&gt;三维洛伦兹变换的推导（&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/266509750&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/266509750&lt;/a&gt;）：我们固然可以用基变换矩阵，但是另两维其实没必要分开。&lt;/p&gt;
&lt;p&gt;空间的拉伸，只需将 $\b x=(x,y,z)$ 分解为与速度方向共线与垂直的两部分即可（至于垂直为啥不变，我也不知道）。即：
$$
\left\{\begin{align*}
\b x_{\parallel}&amp;amp;=\frac{\b x\cdot\b v}{v^2}\b v\\
\b x_{\perp}&amp;amp;=\b x-\b x_{\parallel}\\
\begin{bmatrix}|\b x_{\parallel}^\prime|\\ \b x_{\perp}^\prime\\ t^\prime\end{bmatrix}&amp;amp;=\begin{bmatrix}\gamma&amp;amp;0&amp;amp;-\gamma v\\ 0&amp;amp;1&amp;amp;0\\ -\frac{\gamma v}{c^2}&amp;amp;0&amp;amp;\gamma\end{bmatrix}\begin{bmatrix}|\b x_{\parallel}|\\ \b x_{\perp}\\ t\end{bmatrix}
\end{align*}\right.
$$
于是
$$
\begin{align*}
&amp;amp;\b x^\prime=\b x_\parallel^\prime+\b x_\perp=\gamma\b x_\parallel-\gamma\b vt+\b x-\b x_\parallel\\
&amp;amp;t^\prime=-\frac{\gamma v}{c^2}|\b x_\parallel|+\gamma t=-\frac{\gamma}{c^2}|\b x\cdot\b v|+\gamma t
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;主要要展开的就是（这里 $v$ 再加粗就太阴间了……）
$$
\b x_\parallel=\frac{xv_x+yv_y+zv_z}{v^2}\begin{bmatrix}v_x\\ v_y\\ v_z\end{bmatrix}
$$
于是
$$
\b x^\prime=\begin{bmatrix}
\gamma tv_x+x+(\gamma-1)\frac{v_x^2}{v^2}x+(\gamma-1)\frac{v_xv_y}{v^2}y+(\gamma-1)\frac{v_xv_z}{v^2}z\\
\gamma tv_y+(\gamma-1)\frac{v_yv_x}{v^2}x+y+(\gamma-1)\frac{v_y^2}{v^2}y+(\gamma-1)\frac{v_yv_z}{v^2}z\\
\gamma tv_z+(\gamma-1)\frac{v_zv_x}{v^2}x+(\gamma-1)\frac{v_zv_y}{v^2}y+z+(\gamma-1)\frac{v_z^2}{v^2}z\\
\end{bmatrix}
$$
即
$$
\begin{bmatrix}x^\prime\\ y^\prime\\ z^\prime\\ t^\prime\end{bmatrix}=
\begin{bmatrix}
1+(\gamma-1)\frac{v_x^2}{v^2}&amp;amp;(\gamma-1)\frac{v_xv_y}{v^2}&amp;amp;(\gamma-1)\frac{v_xv_z}{v^2}&amp;amp;\gamma v_x\\
(\gamma-1)\frac{v_yv_x}{v^2}&amp;amp;1+(\gamma-1)\frac{v_y^2}{v^2}&amp;amp;(\gamma-1)\frac{v_yv_z}{v^2}&amp;amp;\gamma v_y\\
(\gamma-1)\frac{v_zv_x}{v^2}&amp;amp;(\gamma-1)\frac{v_zv_y}{v^2}&amp;amp;1+(\gamma-1)\frac{v_z^2}{v^2}&amp;amp;\gamma v_z\\
-\gamma\frac{v_x}{c^2}&amp;amp;-\gamma\frac{v_y}{c^2}&amp;amp;-\gamma\frac{v_z}{c^2}&amp;amp;\gamma
\end{bmatrix}
\begin{bmatrix}x\\ y\\ z\\ t\end{bmatrix}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;用洛伦兹变换解释尺缩效应&lt;/strong&gt;：值得注意的是，上面说的“尺缩效应”是一般情况的特例。简单分析是无法得到一般情况的。有洛伦兹变换之后就可以分析了。&lt;br&gt;
尺缩效应的表述&lt;em&gt;是&lt;/em&gt;“在系 $A^\prime$ 中沿运动方向的长为 $l_0$ 的&lt;em&gt;静止&lt;/em&gt;的杆，&lt;em&gt;对应&lt;/em&gt;在系 $A$ 中长为 $l_0/\gamma$”。必须定义的是，如何在一个参考系中测量一个运动的杆：如果在系 $A$ 中有两个事件 $(x_0,t)$ 和 $(x_1,t)$（这里简化就用一维空间了），第一个事件是该地该时观测到杆的一头在该地，第二个事件是（另一）该地（同一）该时观测到杆的另一头在该地，那么 $|x_1-x_0|$ 就是观测到的长度。&lt;br&gt;
那么严格的推导是 $l_0=x_1^\prime-x_0^\prime=\Lambda_{11}x_1+\Lambda_{12}t-\Lambda_{11}x_0-\Lambda_{12}t=\gamma(x_1-x_0)=\gamma l$。&lt;br&gt;
现在我们可以明确，所谓“$A^\prime$ 比 $A$ 慢/短，反过来 $A$ 又比 $A^\prime$ 慢/短”，只是没有搞清钟慢和尺缩的严格表述犯的错，这两个效应不能正反连续两次应用（不是“对合”的）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;速度变换&lt;/strong&gt;：速度显然可以定义为，如果质点在两处分别出现的事件为 $(x_0,t_0)$ 和 $(x_0+\d x,t_0+\d t)$，那么 $v=\frac{\d x}{\d t}$。如果系 $A$ 中有个质点以 $v$ 的速度移动，而系 $A$ 相对于 $A^\prime$ 以 $v_0$ 的速度移动，那么从 $A^\prime$ 看来，
$$
v^\prime=\frac{\d x^\prime}{\d t^\prime}=\frac{\Lambda_{11}\d x+\Lambda_{12}\d t}{\Lambda_{21}\d x+\Lambda_{22}\d t}=\frac{\gamma_0\d x+\gamma_0v_0\d t}{\frac{\gamma_0v_0}{c^2}\d x+\gamma_0\d t}=\frac{v+v_0}{\frac{v_0v}{c^2}+1}
$$
从这里开始，$\gamma_0$ 表示 $v_0$ 对应的洛伦兹因子，$\gamma$ 表示 $v$ 对应的。如果是垂直方向的速度，则
$$
v_y^\prime=\frac{\d y}{\d t^\prime}=\frac{\d y}{\frac{\gamma_0v_0}{c^2}\d x+\gamma_0\d t}=\frac{v_y}{\gamma_0\left(\frac{v_0v_x}{c^2}+1\right)}
$$
例：两个相对地球反向分别以 $0.5c$ 的速度运动的飞船，从一架飞船上看另一架，相对速度为
$$
\frac{0.5c+0.5c}{0.25+1}=0.8c
$$
&lt;strong&gt;动量定义&lt;/strong&gt;：对于一个参考系中一个运动的质点，其动量 $\b p$ 为一个与它运动方向同向的向量。不同系中动量由于速度不同可能不同，但必须只依赖于 $v$ 和质点本身的性质（而不依赖于参考系），必须满足动量守恒。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;质量定义&lt;/strong&gt;：对于 $\b v\ne 0$ 的质点，动质量 $m_v$ 定义为使得 $\b p=m_v\b v$ 的标量，特殊地定义静质量 $m_0$，经过后续推导可知 $m_v$ 在 $v=0$ 处右连续。质量必须满足质量守恒。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;质量变换&lt;/strong&gt;：考虑 $A$ 中静质量相同的两个质点，一动一静发生完全非弹性碰撞。考虑与碰撞后状态相对静止的另一个系 $A^\prime$。在两个系中分别列出动量守恒与质量守恒方程，可以解得
$$
m_v=\gamma m_0
$$
同理可以得出动量变换，它有个更优美的形式，所以我们放到能量之后讲。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;力的定义&lt;/strong&gt;：和速度类似，$\b F=\frac{\d\b p}{\d t}$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;功与能量&lt;/strong&gt;：功的定义和经典力学一样：
$$
\begin{align*}
\d W&amp;amp;=\b F\cdot\d\b x\\
&amp;amp;=\frac{\d\b p\cdot\d\b x}{\d t}\\
&amp;amp;=\b v\cdot\d\b p\\
&amp;amp;=\b v\cdot\d(\gamma m_0\b v)\\
&amp;amp;=m_0(v^2\d\gamma+\gamma\b v\cdot\d\b v)\\
&amp;amp;=m_0v(v\d\gamma+\gamma\d v)\\
&amp;amp;=m_0\gamma^3v\d v\\
&amp;amp;=m_0c^2\d\gamma
\end{align*}
$$
（最后两行就是在凑积分）也就是说，定义能量变化量为做功的话，
$$
\Delta E=W=\Delta\gamma m_0c^2=\Delta m_vc^2
$$
也是只跟初末状态有关。$m_0c^2$ 被称为&lt;strong&gt;静能&lt;/strong&gt;，$(\gamma-1)m_0c^2$ 被称为&lt;strong&gt;动能&lt;/strong&gt;，$m_vc^2=\gamma m_0c^2$ 被称为&lt;strong&gt;总能&lt;/strong&gt;。&lt;br&gt;
动质量、动量、总能都是守恒量，但参考系不同会不同；静质量不是守恒量，但与参考系无关。考虑一个质量转换成能量的例子：原来一个静止的物体爆炸，碎片向各处飞去。动质量守恒说明，原静质量等于现动质量之和，从而大于现静质量之和。少的质量充当动能。&lt;br&gt;
最后，我们可以推出能量与动量的关系：
$$
E^2=\gamma^2m_0^2c^4=\frac{1-\frac{v^2}{c^2}+\frac{v^2}{c^2}}{1-\frac{v^2}{c^2}}m_0^2c^4=m_0^2c^4+\gamma^2m_0^2v^2c^2=E_0^2+p^2c^2
$$
&lt;strong&gt;四维速度与四维动量&lt;/strong&gt;：我们希望用洛伦兹变换矩阵直接表示速度、动量变换。考虑速度，其一大问题在于，它在变换后是两个变换量之比 $\frac{\d\b x^\prime}{\d t^\prime}$，这个没法方便地写成线性变换的形式。很容易想到，我们希望让分母变成一个不需变换的东西。所以考虑定义一种初看起来有些不伦不类的速度：对于在系 $A$ 中运动的一个质点，它本身有一个固有时 $\tau$。若它在 $\d\tau$ 的时间内，从 $A$ 观测走了 $\d\b x$，定义 $\b u=\frac{\d\b x}{\d\tau}$。&lt;br&gt;
由于 $\tau$ 与选取的参考系无关，现在我们就有（可根据实际情况选取一维空间或三维空间的 $\Lambda$）
$$
\begin{bmatrix}\frac{\d\b x^\prime}{\d \tau}\\ \frac{\d t^\prime}{\d\tau}\end{bmatrix}=\Lambda\begin{bmatrix}\frac{\d\b x}{\d\tau}\\ \frac{\d t}{\d\tau}\end{bmatrix}
$$
而 $\frac{\d}{\d\tau}=\frac{\d}{\d t}\frac{\d t}{\d\tau}=\gamma\frac{\d}{\d t}$，从而
$$
\begin{bmatrix}\gamma^\prime\b v^\prime\\ \gamma^\prime\end{bmatrix}=\Lambda\begin{bmatrix}\gamma\b v\\ \gamma\end{bmatrix}
$$
同样可以在 $\Lambda$ 中代入 $-v_0$，求出 $v_x^\prime$ 与 $v_x$ 的关系，与上面那种推导校验。&lt;br&gt;
动量变换反而容易了！因为 $\b p=\gamma m_0\b v$，直接就有
$$
\begin{bmatrix}\b p^\prime\\ m_{v^\prime}\end{bmatrix}=\Lambda\begin{bmatrix}\b p\\ m_v\end{bmatrix}
$$
&lt;strong&gt;四维力&lt;/strong&gt;：动量非常自然地把 $\d\tau$ “吸收”进了 $\gamma$，于是我们又可以通过 $/\d\tau$ 定义一个怪怪的力了！（大雾）
$$
\begin{bmatrix}\frac{\d\b p^\prime}{\d\tau}\\ \frac{\d m_{v^\prime}}{\d\tau}\end{bmatrix}=\Lambda\begin{bmatrix}\frac{\d\b p}{\d\tau}\\ \frac{\d m_v}{\d\tau}\end{bmatrix}
$$
上面就是 $\gamma\b F$，但是下面这个呢？实际算问题的时候鬼知道 $\frac{\d m_v}{\d\tau}$ 是多少啊……
$$
\frac{\d m_v}{\d\tau}=m_0\frac{\d\gamma}{\d\tau}=\frac{\b F\cdot\d\b x}{c^2\d\tau}=\frac{\b F\cdot\b u}{c^2}=\gamma\frac{\b F\cdot\b v}{c^2}
$$
第二个等号参见&lt;strong&gt;功与能量&lt;/strong&gt;那边的推导。于是（网上有些文章是把 $/\d t$ 的速度记成 $\b u$，不要搞混了）
$$
\begin{bmatrix}\gamma^\prime\b F^\prime\\ \gamma^\prime\frac{\b F^\prime\cdot\b v^\prime}{c^2}\end{bmatrix}=\Lambda\begin{bmatrix}\gamma\b F\\ \gamma\frac{\b F\cdot\b v}{c^2}\end{bmatrix}
$$
于是我们发现，力的变换不仅与时空有关系，还与质点当前的速度有关系。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;四维加速度&lt;/strong&gt;见 &lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/114045707&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/114045707&lt;/a&gt;。另一个比较靠谱的推导 &lt;a class=&#34;link&#34; href=&#34;https://dsl.nju.edu.cn/litao/teach/Ch6.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://dsl.nju.edu.cn/litao/teach/Ch6.pdf&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;参考书：《从零学相对论》（梁灿彬、曹周键），《新概念物理学教程 力学》（赵凯华、罗蔚茵）。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>OIer 速通编入门</title>
        <link>https://littlereuben.github.io/study/course-cppstudio/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-cppstudio/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/course-cppstudio/cover.png" alt="Featured image of post OIer 速通编入门" /&gt;&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h3 id=&#34;c-动态内存&#34;&gt;C 动态内存
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;malloc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;字节数&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 返回 void* 类型，可以隐式与别的指针类型转换
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;calloc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;数量&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;单个元素字节数&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 全置 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;realloc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;指针&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;新的字节数&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 指针可以是先前申请的或 NULL，如果是申请的，相当于 free，malloc 并复制。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;free&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;指针&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 释放
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;糖：&lt;code&gt;int * p = calloc(10, sizeof * p);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;对了，关于 C++ 的 &lt;code&gt;new&lt;/code&gt; 有两点提一下，一个时 &lt;code&gt;new int [1]&lt;/code&gt; 必须用 &lt;code&gt;delete []&lt;/code&gt; 因为 &lt;code&gt;new&lt;/code&gt; 数组时会额外申请空间记录数组大小。另一个是 &lt;a class=&#34;link&#34; href=&#34;https://en.m.wikipedia.org/wiki/Placement_syntax&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;placement new&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&#34;多文件编译&#34;&gt;多文件编译
&lt;/h3&gt;&lt;h4 id=&#34;odr&#34;&gt;ODR
&lt;/h4&gt;&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;In any translation unit, a template, type, function, or object can have no more than one definition. Some of these can have any number of declarations. A definition provides an instance.&lt;/li&gt;
&lt;li&gt;In the entire program, an object or non-inline function cannot have more than one definition; if an object or function is used, it must have exactly one definition. You can declare an object or function that is never used, in which case you don&amp;rsquo;t have to provide a definition. In no event can there be more than one definition.&lt;/li&gt;
&lt;li&gt;Some things, like types, templates, and extern inline functions, can be defined in more than one translation unit. For a given entity, each definition must have the same sequence of tokens. Non-extern objects and functions in different translation units are different entities, even if their names and types are the same.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;头文件-ifndef&#34;&gt;头文件 ifndef
&lt;/h4&gt;&lt;p&gt;多文件编译的原理为：将 &lt;code&gt;.h&lt;/code&gt; 中的内容加到每个 &lt;code&gt;.cpp&lt;/code&gt; 中（preprocess），然后编译这些 &lt;code&gt;.cpp&lt;/code&gt;，然后把他们链接起来。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.h&lt;/code&gt; 里的 &lt;code&gt;#ifndef&lt;/code&gt; 那些东西是为了避免同一个 &lt;code&gt;.cpp&lt;/code&gt; &lt;code&gt;include&lt;/code&gt; 多次同一个 &lt;code&gt;.h&lt;/code&gt;。例如&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// a.cpp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;h1.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;h2.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// h1.h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;h.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// h2.h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;h.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// h.h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PI&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;3.14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;常量、类定义等内容不能在一个翻译单元中定义多次。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意，这个技巧不能避免多个文件之间的重复定义，例如在 &lt;code&gt;.h&lt;/code&gt; 里加了 &lt;code&gt;int a;&lt;/code&gt; 之类的照样会造成 redefinition。&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;链接性&#34;&gt;链接性
&lt;/h4&gt;&lt;p&gt;链接性分为外部、内部、无。外部链接性意味着作用域可以在多个 &lt;code&gt;.cpp&lt;/code&gt;，前提是在定义所在的文件以外的文件中，要写 &lt;code&gt;extern&lt;/code&gt;（并且不初始化）。内部链接性意味着作用域只在当前文件内，无链接性就是在代码块内。&lt;/p&gt;
&lt;p&gt;全局变量、函数都是默认外部的，这就意味着它们不能在多个文件里或头文件里定义（但是函数可以多次声明，甚至在同一个文件里连续写两次 &lt;code&gt;int f(int) ;&lt;/code&gt; 都没问题）。如果要变成内部就在开头加 &lt;code&gt;static&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;头文件里可以定义什么&#34;&gt;头文件里可以定义什么
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;#define&lt;/code&gt; 肯定没什么问题。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;const&lt;/code&gt; 比较特殊，它是内部链接的，所以可以写在头文件里。如果要强制它变成外部的，就加 &lt;code&gt;extern&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;struct&lt;/code&gt; 和 &lt;code&gt;class&lt;/code&gt; 可以，但是成员函数不能在头文件里放在外面。类不能重复定义，但是可以在链接是出现重复，但是两个重复的不能不同，否则会出一些奇怪的情况。例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// a.cpp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;h.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// b.cpp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;h.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// h.h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这样不会 CE，但是会出现一些诡异的问题，比如一个文件里得按另一个的名字来。&lt;/p&gt;
&lt;p&gt;类定义不能在外部链接，也就是说不能在另一个文件里写 &lt;code&gt;extern node x;&lt;/code&gt; 来定义一个 &lt;code&gt;node&lt;/code&gt;（在另一个文件里定义的类）的实例。&lt;/p&gt;
&lt;h3 id=&#34;cmake&#34;&gt;CMake
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;cmake 目录&lt;/code&gt; 指令会对目录中的文件（含 &lt;code&gt;CMakeLists.txt&lt;/code&gt;、源文件）生成 build system。这一步还没有编译，可以理解为生成了以 &lt;code&gt;Makefile&lt;/code&gt; 为代表的一系列文件。&lt;/p&gt;
&lt;p&gt;如果要进一步指定目录，&lt;code&gt;-B&lt;/code&gt; 可指定输出目录，&lt;code&gt;-S&lt;/code&gt; 可指定输入目录。如果没有这个目录，直接 &lt;code&gt;cmake 目录&lt;/code&gt; 会报错，但 &lt;code&gt;cmake -B 目录&lt;/code&gt; 则会自动创建一个。&lt;/p&gt;
&lt;p&gt;如果 &lt;code&gt;cmake&lt;/code&gt; 报错&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  Running
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &amp;#39;nmake&amp;#39; &amp;#39;-?&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  failed with:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   系统找不到指定的文件。
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;就在 &lt;code&gt;cmake&lt;/code&gt; 后面加 &lt;code&gt;-G &amp;quot;MinGW Makefiles&amp;quot;&lt;/code&gt;。或者直接改环境变量：&lt;code&gt;setx CMAKE_GENERATOR &amp;quot;MinGW Makefiles&amp;quot; /m&lt;/code&gt;（需要管理员模式运行 Powershell，或者直接图形界面改也行）。&lt;/p&gt;
&lt;p&gt;注意一旦 &lt;code&gt;cmake&lt;/code&gt; 失败一次，就需要删掉所有相关文件再重新 &lt;code&gt;cmake&lt;/code&gt;，不然会傻傻地仍然报错，或提示已经 build 过。&lt;/p&gt;
&lt;p&gt;然后正式编译，使用 &lt;code&gt;make [-C 目录]&lt;/code&gt;（不写 &lt;code&gt;-C&lt;/code&gt; 只能 &lt;code&gt;make&lt;/code&gt; 当前目录）或 &lt;code&gt;cmake --build [目录]&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;以后改代码，只需重新 &lt;code&gt;make&lt;/code&gt; 就行。&lt;/p&gt;
&lt;p&gt;一般习惯把 build system 的部分放到子文件夹里。汇总：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mkdir build 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; build
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cmake ..
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./对应名字
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://wshibin.github.io/misc/cmake/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wshibin.github.io/misc/cmake/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://cmake.org/cmake/help/latest/guide/tutorial/index.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://cmake.org/cmake/help/latest/guide/tutorial/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.bilibili.com/video/BV14h41187FZ/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.bilibili.com/video/BV14h41187FZ/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;vcpkg&#34;&gt;vcpkg
&lt;/h3&gt;&lt;p&gt;vs 或 wsl，请。&lt;/p&gt;
&lt;h3 id=&#34;类&#34;&gt;类
&lt;/h3&gt;&lt;p&gt;基本结构、重载运算符、后置 &lt;code&gt;const&lt;/code&gt;、构造析构略。&lt;/p&gt;
&lt;h4 id=&#34;c-struct&#34;&gt;C struct
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里 &lt;code&gt;_&lt;/code&gt; 可省，直接写成匿名结构体。&lt;/p&gt;
&lt;h4 id=&#34;静态成员变量和函数&#34;&gt;静态成员变量和函数
&lt;/h4&gt;&lt;p&gt;顾名思义，加 &lt;code&gt;static&lt;/code&gt;，就是与类关联而不是与某个对象关联。注意 C++11 之前，类里是不能 &lt;code&gt;const&lt;/code&gt; 的，只能 &lt;code&gt;static const&lt;/code&gt;，或者 &lt;code&gt;enum&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;成员函数&#34;&gt;成员函数
&lt;/h4&gt;&lt;p&gt;成员函数如果传同类参，可以访问对方的 &lt;code&gt;private&lt;/code&gt; 成员。&lt;/p&gt;
&lt;p&gt;类内定义的成员函数是自动内联的。&lt;/p&gt;
&lt;p&gt;成员函数可以类外定义，必须再类内先声明，定义时要加 &lt;code&gt;::&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;::&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;众所周知，在成员函数头后加 &lt;code&gt;const&lt;/code&gt; 可以保证成员不被改变。但是它还能用于重载，拓宽了可使用情景：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cerr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;non-const&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cerr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;const&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这段代码会输出 &lt;code&gt;non-const\nconst\n&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;友元&#34;&gt;友元
&lt;/h4&gt;&lt;p&gt;友元函数是一种非成员函数，其声明必须在类内，定义可以在类内或类外，但在类内时不能直接使用成员变量。其关键作用是能在类外访问私有成员。显然这种东西不可能是私有的。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;friend&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ostream&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;operator&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ostream&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ostream&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;operator&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ostream&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;out&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;out&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;endl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;out&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注意声明时参列里 &lt;code&gt;&amp;amp;&lt;/code&gt; 不能少。&lt;/p&gt;
&lt;p&gt;友元类是在类定义中写 &lt;code&gt;friend class 另一个类的名字&lt;/code&gt;，然后另一个类就可以访问这个类的私有成员了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;friend&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;sa&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sb&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果只希望 &lt;code&gt;B&lt;/code&gt; 的某个函数可以访问 &lt;code&gt;A&lt;/code&gt; 的私有成员（以限制 &lt;code&gt;B&lt;/code&gt; 不在别的地方瞎搞），可以用友元成员函数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 必须要有！
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;friend&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;::&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;::&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;sa&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sb&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;我们来仔细考虑一下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;A&lt;/code&gt; 定义 → &lt;code&gt;B&lt;/code&gt; 定义：&lt;code&gt;A&lt;/code&gt; 里根本写不了 &lt;code&gt;B&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;B&lt;/code&gt; 定义 → &lt;code&gt;A&lt;/code&gt; 定义：&lt;code&gt;B&lt;/code&gt; 里根本写不了 &lt;code&gt;A&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;A&lt;/code&gt; 声明 → &lt;code&gt;B&lt;/code&gt; 定义 → &lt;code&gt;A&lt;/code&gt; 定义：&lt;code&gt;B&lt;/code&gt; 定义里要用 &lt;code&gt;A&lt;/code&gt; 的成员，但 &lt;code&gt;A&lt;/code&gt; 没定义。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;B&lt;/code&gt; 声明 → &lt;code&gt;A&lt;/code&gt; 定义 → &lt;code&gt;B&lt;/code&gt; 定义：&lt;code&gt;A&lt;/code&gt; 要写 &lt;code&gt;friend void B :: ...&lt;/code&gt;，&lt;code&gt;B&lt;/code&gt; 是得定义完的。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;所以最后只能 &lt;code&gt;A&lt;/code&gt; → &lt;code&gt;B&lt;/code&gt; → &lt;code&gt;A&lt;/code&gt; → &lt;code&gt;B&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;唐。&lt;/p&gt;
&lt;h4 id=&#34;类继承&#34;&gt;类继承
&lt;/h4&gt;&lt;p&gt;思想：两个类有共同特征，不想重复写这部分。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;class 派生类名 : [public|protected|private] 基类名 { 定义派生类独有的内容 } ;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;如果要继承多个，就用 &lt;code&gt;,&lt;/code&gt; 分隔。注意 &lt;code&gt;class C : public A, B&lt;/code&gt; 相当于 &lt;code&gt;class C : public A, private B&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;基类中 &lt;code&gt;private&lt;/code&gt; 的无法在派生类中访问，如果想访问但不希望被外面访问，就用 &lt;code&gt;protected&lt;/code&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;继承方式\基类内权限&lt;/th&gt;
&lt;th&gt;&lt;code&gt;public&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;protected&lt;/code&gt;&lt;/th&gt;
&lt;th&gt;&lt;code&gt;private&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;public&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;public&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;protected&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;inaccessible&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;protected&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;protected&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;protected&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;inaccessible&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;private&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;private&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;private&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;inaccessible&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;构造函数：推荐在派生类初始化列表中调用基类的构造函数，而不是直接赋值基类的元素。如果不写，则调用基类的默认构造函数。注意，唯一不行的是在初始化列表中初始化基类的元素，因为构造函数是先调用基类的构造函数，如果这样写就重复了。&lt;/p&gt;
&lt;p&gt;如果不写构造函数，也可以用初始化列表的方式（C++ 17），注意列表对应顺序是先基类后派生类。&lt;/p&gt;
&lt;p&gt;派生类无法使用基类的重载运算符和友元函数。&lt;/p&gt;
&lt;h4 id=&#34;多态&#34;&gt;多态
&lt;/h4&gt;&lt;p&gt;派生类可以重载基类的变量和函数，如果要使用基类中的，就用 &lt;code&gt;::&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;多态可以展开讲的最大的点就是虚方法。考虑：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Value = &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;endl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;rec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Sum = &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;endl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prod&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;rec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prod&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Product = &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prod&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;endl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// do something to b1, b2, c1, c2.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 指针和引用可以从派生类隐式转换到基类
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;显然他会输出四行 &lt;code&gt;Value = ...&lt;/code&gt;，但是我们希望它能输出两行 &lt;code&gt;Sum&lt;/code&gt;，两行 &lt;code&gt;Product&lt;/code&gt;，又懒得一个个 &lt;code&gt;. print()&lt;/code&gt;。那怎么办呢？&lt;/p&gt;
&lt;p&gt;我们在基类的函数开头加一个 &lt;code&gt;virtual&lt;/code&gt;（必须），然后在派生类的函数大括号前加 &lt;code&gt;override&lt;/code&gt;（可选）。在多重继承时，会自动找到最深的重载。&lt;/p&gt;
&lt;p&gt;如果强制一个类的派生类不能重载，就加 &lt;code&gt;final&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;问题：如何使继承链中途不再虚？&lt;/p&gt;
&lt;p&gt;问题：如果真的基类对象调用纯虚函数会怎样？&lt;/p&gt;
&lt;p&gt;抽象基类是具有纯虚函数的类，纯虚函数是不给出定义的虚函数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;virtual&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这种情况下，不能建立该类的对象，且必须在（要有对象的）派生类中给出纯虚函数的定义。&lt;/p&gt;
&lt;p&gt;析构函数是一类在类继承中往往必须要是虚函数的函数。考虑以下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 析构函数必须是公有的或保护的，不然程序结束时都调用不了，直接 CE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;程序结束时会调用 &lt;code&gt;b&lt;/code&gt; 的析构函数，先执行 &lt;code&gt;~B()&lt;/code&gt;，再执行 &lt;code&gt;~A()&lt;/code&gt;，输出 &lt;code&gt;ba&lt;/code&gt;。这没啥问题。（注意：动态分配内存的对象在程序结束时不会调用析构函数）&lt;/p&gt;
&lt;p&gt;但是如果 &lt;code&gt;main&lt;/code&gt; 里有这样的代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;delete&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;那就会导致只有基类的析构函数被调用。这在派生类里没有单独的动态内存时是没问题的（有静态变量是没问题的，也会跟着删掉），但是如果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;delete&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;那就会造成内存泄露。所以如果存在基类指针指向派生类对象的情况，析构函数就必须要是虚的。&lt;/p&gt;
&lt;p&gt;虚函数的多态的原理，是动态联编，大概就是每个对象都记录了一个函数指针表，用于查找它应该调用哪一级的重载的函数。因为类指针指向的对象类型可能取决于输入之类的，所以不得不边运行边确定，导致很慢。&lt;/p&gt;
&lt;h4 id=&#34;虚继承&#34;&gt;虚继承
&lt;/h4&gt;&lt;p&gt;复杂的继承会出问题，比如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;D&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;一个 &lt;code&gt;D&lt;/code&gt; 对象，没法直接访问 &lt;code&gt;.a&lt;/code&gt;，必须指定是 &lt;code&gt;.B::a&lt;/code&gt; 还是 &lt;code&gt;.C::a&lt;/code&gt;，函数同理。&lt;/p&gt;
&lt;p&gt;如果希望合并两个 &lt;code&gt;a&lt;/code&gt;，需要把 &lt;code&gt;B&lt;/code&gt; 和 &lt;code&gt;C&lt;/code&gt; 的继承方式改成虚继承 &lt;code&gt;virtual public A&lt;/code&gt;，与此同时当 &lt;code&gt;D&lt;/code&gt; 的构造函数递归调用 &lt;code&gt;B&lt;/code&gt; 和 &lt;code&gt;C&lt;/code&gt; 的构造函数时，将会忽略对 &lt;code&gt;A&lt;/code&gt; 的构造函数的递归调用，需要单独调用 &lt;code&gt;A&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;但是重载的函数还是没法合并，所以最好 &lt;code&gt;D&lt;/code&gt; 自己写一个，当然可以直接调用 &lt;code&gt;B::&lt;/code&gt; 和 &lt;code&gt;C::&lt;/code&gt; 的，这个的重复就无法避免了。&lt;/p&gt;
&lt;h3 id=&#34;模板&#34;&gt;模板
&lt;/h3&gt;&lt;p&gt;最基础的略。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;double res = max(2.5, 3);&lt;/code&gt; 不行，&lt;code&gt;double res = max &amp;lt;double&amp;gt; (2.5, 3);&lt;/code&gt; 可以。&lt;/p&gt;
&lt;p&gt;显式实例化：&lt;code&gt;template 返回类型 函数名 &amp;lt;具体化类型&amp;gt; (参数列表) ;&lt;/code&gt; 表示生成一个对应的实例。&lt;/p&gt;
&lt;p&gt;显式具体化：&lt;code&gt;template &amp;lt;&amp;gt; 返回类型 函数名 (&amp;lt;具体化类型&amp;gt;) (参数列表) { ... }&lt;/code&gt; 其中第二个 &lt;code&gt;&amp;lt;&amp;gt;&lt;/code&gt; 是可选的。和实例化不同的是，它相当于一种“内容不同的重载”，必须有函数定义，且出现在第一次调用之前（否则与隐式实例化冲突）。例如&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;strcmp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;模板类：开头加一样的东西就行。类外定义函数： &lt;code&gt;template &amp;lt;typename T&amp;gt; 返回类型 类名 &amp;lt;T&amp;gt; :: 函数头 { ... }&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后我们考虑一个例子：希望写一个 &lt;code&gt;max&lt;/code&gt;，它能接受一个 &lt;code&gt;int&lt;/code&gt; 和一个 &lt;code&gt;double&lt;/code&gt;（之类的），并返回 &lt;code&gt;double&lt;/code&gt;（选择级别高的类型）。如果这样：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;typename&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;typename&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;U&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;U&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;U&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;3.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;3.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这个就会有问题。可以用 &lt;code&gt;C++14&lt;/code&gt; 的特性，自动推导返回类型：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;typename&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;typename&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;U&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;auto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;U&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;stl-查漏补缺&#34;&gt;STL 查漏补缺
&lt;/h3&gt;&lt;p&gt;遍历一些 STL 对象时，建议用 &lt;code&gt;const_iterator&lt;/code&gt;，对应 &lt;code&gt;. cbegin()&lt;/code&gt; 和 &lt;code&gt;. cend()&lt;/code&gt;。作用是无法修改内容。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;++ it&lt;/code&gt; 比 &lt;code&gt;it ++&lt;/code&gt; 快，考虑 &lt;code&gt;it ++&lt;/code&gt; 具体该怎么实现：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;iterator&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;operator&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;iterator&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;tmp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// do increment
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;STL 提供了一个一般的 &lt;code&gt;find&lt;/code&gt;，它是暴力，不要将它用于已经有自己的 &lt;code&gt;find&lt;/code&gt; 的类。&lt;/p&gt;
&lt;h3 id=&#34;移动语义和右值引用&#34;&gt;移动语义和右值引用
&lt;/h3&gt;&lt;p&gt;左值是有地址的，可以赋值的变量。&lt;/p&gt;
&lt;p&gt;右值的例子包括字面量、四则运算的结果、函数的非引用返回值等。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;能否引用&lt;/th&gt;
&lt;th&gt;非常量左值引用&lt;/th&gt;
&lt;th&gt;常量左值引用&lt;/th&gt;
&lt;th&gt;非常量右值引用&lt;/th&gt;
&lt;th&gt;常量右值引用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;非常量左值&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;常量左值&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;右值&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;目前不知道常量右值是什么，也不知道常量右值引用有啥用。&lt;/p&gt;
&lt;p&gt;右值引用实际上是开了空间的。因此可以这样：&lt;code&gt;int &amp;amp;&amp;amp; p = 1; p = 2;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;可以用 &lt;code&gt;move&lt;/code&gt;（C++ 11）将左值转成右值。&lt;/p&gt;
&lt;p&gt;目前看起来右值引用没啥用。在复杂的类的应用中，考虑提高这段代码的效率：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;memcpy&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;operator&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;delete&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;memcpy&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;delete&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;private&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注意必须重载复制构造函数和赋值，否则会导致多对一。&lt;/p&gt;
&lt;p&gt;如果将一个对象复制给另一个对象，且这个对象不再使用（例如，这个对象是函数的返回值），那么暴力赋值就可以优化——我们希望直接把赋值者的内容转移给被赋值者，但是为了避免多对一析构爆炸，得把赋值者清空（&lt;code&gt;delete nullptr&lt;/code&gt; 不会发生任何事）。这就必须要求我们能修改等号右边的东西，这就是右值引用在移动语义中的作用。我们可以新增一个“移动构造函数”：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;nullptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;移动赋值同理。如果要将 &lt;code&gt;a&lt;/code&gt; 赋值给 &lt;code&gt;b&lt;/code&gt; 且 &lt;code&gt;a&lt;/code&gt; 不再用了，写 &lt;code&gt;b = move(a)&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id=&#34;智能指针&#34;&gt;智能指针
&lt;/h3&gt;&lt;p&gt;我们现在希望偷懒不写 &lt;code&gt;delete&lt;/code&gt;，于是类似上面，我们会写个指针类来自动 &lt;code&gt;delete&lt;/code&gt;，但是与上面不同的是，指针类并不负责申请内存，也不负责复制内容，只负责自动释放空间。这就导致如果两个指针指向同一片内存就会爆。&lt;/p&gt;
&lt;p&gt;头文件 &lt;code&gt;memory&lt;/code&gt;。C++98 有 &lt;code&gt;auto_ptr&lt;/code&gt;，略。C++11 有 &lt;code&gt;unique_ptr&lt;/code&gt; 和 &lt;code&gt;shared_ptr&lt;/code&gt;。&lt;code&gt;unique_ptr&lt;/code&gt; 禁止复制（构造和赋值），只能 &lt;code&gt;move&lt;/code&gt; 之后再赋；&lt;code&gt;shared_ptr&lt;/code&gt; 会维护一个计数器，等最后一个相关智能指针对象析构时才 &lt;code&gt;delete&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;用法 1：&lt;code&gt;unique/shared_ptr &amp;lt;int&amp;gt; p (new int [100]);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;不推荐用法 2：&lt;code&gt;int * p = new int [100]; unique/shared_ptr &amp;lt;int&amp;gt; q (p);&lt;/code&gt; 会导致多对一。&lt;/p&gt;
&lt;p&gt;用法 3：&lt;code&gt;auto p (make_unique/shared &amp;lt;int&amp;gt; (100));&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;类型转换&#34;&gt;类型转换
&lt;/h3&gt;&lt;p&gt;C++ 的类型转换：&lt;code&gt;static_cast &amp;lt;转换成的类型&amp;gt; (原变量)&lt;/code&gt;。在编译时会检查转换是否合法。&lt;/p&gt;
&lt;p&gt;C 中，这样的代码是可以的（逆天）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;C++ 中，不能这样 &lt;code&gt;static_cast &amp;lt;int &amp;amp;&amp;gt;&lt;/code&gt; 但是可以 &lt;code&gt;const_cast &amp;lt;int &amp;amp;&amp;gt;&lt;/code&gt;。只有特殊情况需要修改时才用。&lt;/p&gt;
&lt;p&gt;C 中，这样的代码是可以的：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;C++ 中，不能这样 &lt;code&gt;static_cast &amp;lt;node *&amp;gt;&lt;/code&gt; 但是可以 &lt;code&gt;reinterpret_cast &amp;lt;node *&amp;gt;&lt;/code&gt;。总的来说，感觉就是避免你无意识地瞎转类型，但是你硬要转也是可以的，效果和 C 的一样，就是“棒转”，不做任何事情。&lt;/p&gt;
&lt;p&gt;有且只有 &lt;code&gt;dynamic_cast&lt;/code&gt; 只能用于指针和引用。&lt;code&gt;dynamic_cast&lt;/code&gt; 可以把基类转换到派生类（&lt;code&gt;static_cast&lt;/code&gt; 也可以做）。如果被转换者类型不对（包括把本身就指向基类对象的指针转成派生类），会返回 &lt;code&gt;nullptr&lt;/code&gt;。&lt;code&gt;dynamic_cast&lt;/code&gt; 转换的必须是多态类型，即至少声明或继承（可以在本身 &lt;code&gt;override&lt;/code&gt;）了一个虚函数的类。&lt;/p&gt;
&lt;h3 id=&#34;异常&#34;&gt;异常
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;抛出异常 &lt;code&gt;throw 信息&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;try&lt;/code&gt; 开始代码块，里面可以用 &lt;code&gt;throw&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;捕获异常 &lt;code&gt;catch (信息类型 [变量名字]) { ... }&lt;/code&gt; 接在 &lt;code&gt;try&lt;/code&gt; 的代码块后，可以接多个处理方式。&lt;code&gt;catch (...)&lt;/code&gt; 通用。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;可以跨函数处理（再抛出）。跨的函数有返回值的赋值也会跳过。&lt;/p&gt;
&lt;p&gt;为了区分不同（大类的）异常情况，可以建立各种异常类。值得注意的是，如果抛出的类型是派生类，而捕获的类型中既有基类又有派生类，且前者写在前面，那就会被前者捕获。&lt;/p&gt;
&lt;p&gt;STL 中的东西的异常都是 &lt;code&gt;std :: exception&lt;/code&gt; 的派生类，可以调用 &lt;code&gt;. what()&lt;/code&gt; 知道它是哪种。&lt;/p&gt;
&lt;h3 id=&#34;优化原理&#34;&gt;优化原理
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;分支预测&lt;/li&gt;
&lt;li&gt;循环展开&lt;/li&gt;
&lt;li&gt;并行处理、SIMD&lt;/li&gt;
&lt;li&gt;循环顺序&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;标准属性&#34;&gt;标准属性
&lt;/h3&gt;&lt;p&gt;发现有个 project 里有些 &lt;code&gt;[[...]]&lt;/code&gt; 这种东西，加在声明或定义的类型名前面。这是起到修改编译器对一些特殊情况的反应的。包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;[[nodiscard]]&lt;/code&gt; 加在函数声明前，如果该函数的返回值未被使用会报警告，可以通过 &lt;code&gt;[[nodiscard(&amp;quot;...&amp;quot;)]]&lt;/code&gt; 加警告信息。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[[deprecated]]&lt;/code&gt; 表示对应东西可能被弃用，不鼓励使用（使用会警告），同上。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[[noreturn]]&lt;/code&gt; 表示对应函数不会正常返回（&lt;code&gt;exit&lt;/code&gt; 或 &lt;code&gt;throw&lt;/code&gt; 之类），提示编译器优化。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[[likely]]&lt;/code&gt; 和 &lt;code&gt;[[unlikely]]&lt;/code&gt; 加在分支语句后，表示更可能进入哪个分支，提示编译器优化。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;可变参数&#34;&gt;可变参数
&lt;/h3&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/694317432&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/694317432&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;例题&#34;&gt;例题
&lt;/h3&gt;&lt;p&gt;有个题感觉还是很 educational 的。如何实现一个高维数组，每维的长度都是 $n$，但维数 $d$ 不定？可以用模板类：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;typename&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Array&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;但这里的问题是 $d=0$ 的时候爆了。可以用部分具体化：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;template&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;typename&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Array&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>带你慢通 天文学导论</title>
        <link>https://littlereuben.github.io/study/course-astronomy/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-astronomy/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/course-astronomy/cover.png" alt="Featured image of post 带你慢通 天文学导论" /&gt;&lt;p&gt;$\gdef\unit#1{\,\mathrm{#1}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;p&gt;如果您真的对天文学感兴趣的话，可以考虑报这门课，但同时要做好花费一定精力的准备。这门课所需要的学习时间可能比其他 $2/3$ 学分的课多。&lt;/p&gt;
&lt;p&gt;这门课是 $3$ 学分，$10\%$ 雨课堂随堂测验，$10\%$ 作业（需交五次），$10\%$ 观星报告（一学期有五六次观星活动），$10\%$ 微科幻写作（可以完全用 AI），$60\%$ 期末。&lt;/p&gt;
&lt;p&gt;上课主要是按照 ppt 讲，ppt 基于的教材是 21&lt;sup&gt;st&lt;/sup&gt; Century Astronomy (fifth edition)，现在最新的是第七版。ppt 一千多张，知识量很大，一晚上三节课下来脑袋嗡嗡的，尤其是后半学期赶进度讲得很快，而且经常拖课。个人感觉老师很会讲，很有水平、有幽默感，但是思路比较跳跃，作为初学者很容易感觉各个知识点之间没有逻辑联系，或者单个知识点颠来倒去讲有点乱。我的笔记可能稍微梳理得清楚些，但也没法避免因为一些细碎的知识点而显得不够成系统。还是需要时间自己课后消化理解。&lt;/p&gt;
&lt;p&gt;几个其他的任务都简单。关于观星活动有两个值得注意的点：一个是建议西操观星带个三脚架，一个是直接用自带相机拍木星和土星必然过曝，整个行星变成一个光斑。&lt;/p&gt;
&lt;p&gt;期末个人感觉难度适中，不会考得很偏，不复习肯定会出事。$50$ 道选择，$20$ 道填空，$10$ 道简单的计算，考点全部来自 ppt，建议背 ppt，ppt 里打 * 的不考。&lt;strong&gt;上课时务必留意老师说“这个考试要考的啊”之类的话并记下来&lt;/strong&gt;，甚至观星活动时都会说（例如冬季大三角），这些是真的可能会考的。&lt;/p&gt;
&lt;p&gt;推荐 zzh 的&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com/article/yj5vlmt8&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;带你速通 天文学导论&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com/article/43fli1jp&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;星空摄影入门&lt;/a&gt;、Alex_Wei 的&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/alex-wei/p/18628499/introduction_to_astronomy&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;笔记&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;以下的图片与数据来源于教材和 Wikipedia。&lt;/p&gt;
&lt;h2 id=&#34;第一节课&#34;&gt;第一节课
&lt;/h2&gt;&lt;p&gt;太阳系→银河系→本星系群→室女座超星系团→拉尼亚凯亚超星系团&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Kay7E_01_01.jpg&#34;
	width=&#34;2474&#34;
	height=&#34;829&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;298&#34;
		data-flex-basis=&#34;716px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;恒星、星系只占很小一部分，之间——宇宙尘埃、暗物质、暗能量。&lt;/p&gt;
&lt;p&gt;膨胀、加速膨胀。&lt;/p&gt;
&lt;p&gt;行星系在我们的宇宙中普遍存在。&lt;/p&gt;
&lt;p&gt;$1\unit{AU}=1.5\times 10^8\unit{km}$，$8.3$ 光分。太阳—海王星：$60\unit{AU}$。&lt;/p&gt;
&lt;p&gt;离太阳最近的恒星比邻星，$4.2\unit{ly}$。比邻星是红矮星，把周围的行星潮汐锁定。&lt;/p&gt;
&lt;p&gt;太阳系离银河系中心：$2.8\times 10^4\unit{AU}$&lt;/p&gt;
&lt;p&gt;银河系直径：$(1\sim 2)\times 10^5\unit{AU}$&lt;/p&gt;
&lt;p&gt;银河系离仙女星系（M31，最近大星系，本星系群中最大星系）：$2.5\times 10^6\unit{AU}$&lt;/p&gt;
&lt;p&gt;麦哲伦大小星云是银河系的伴星系。&lt;/p&gt;
&lt;h2 id=&#34;天文观测&#34;&gt;天文观测
&lt;/h2&gt;&lt;p&gt;如何定义一天（太阳日）？太阳连续两次经过从同一地点来看天空最高点（子午线）之间的时间，不等于地球自转周期。每天的时长是不一样的，这是因为地球的公转轨道不是正圆。取平均值得到平太阳日。&lt;/p&gt;
&lt;p&gt;恒星日就是自转周期。&lt;/p&gt;
&lt;p&gt;如何定义一年？古埃及：每年尼罗河洪水泛滥到孟菲斯城的时候，发现天狼星和太阳同时从地平线升起。这个间隔就是 $365$ 天。&lt;/p&gt;
&lt;h3 id=&#34;基本概念&#34;&gt;基本概念
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;黄道&lt;/strong&gt;是地球绕太阳公转的轨道平面。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;东西&lt;/strong&gt;的定义是，自转自西向东。东西是在地球表面特定点才说的。如果脱离特定点看整个地球，东西就是一个“旋转方向”，而不是一个矢量。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;南北极&lt;/strong&gt;的定义是，根据右手定则，得到自转的旋转向量从球心指向正北。南北相应定义，但可以脱离地球上的特定点说。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;纬度&lt;/strong&gt;是指当地地面法线对赤道面的夹角。&lt;strong&gt;经度&lt;/strong&gt;指当地所在球面大圆与 0 度经度（格林尼治天文台）对应球面大圆的夹角。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Latitude_and_longitude_graticule_on_a_sphere.svg&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;&lt;strong&gt;地轴&lt;/strong&gt;，就是地球的自转轴。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;赤道&lt;/strong&gt;是地球表面的点随地球自转产生的轨迹中周长最长的圆周线。赤道平面与南北极连线&lt;strong&gt;垂直&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;转轴倾角&lt;/strong&gt;是赤道平面与黄道平面的夹角，地球的转轴倾角约为 $23.44^\circ$。也可以定义为自转的旋转向量和公转的旋转向量的夹角，其取值可以是 $[0,\pi]$。&lt;/p&gt;
&lt;p&gt;地球&lt;strong&gt;公转&lt;/strong&gt;的方向与自转方向相同，这个“相同”的本质就是 $23.44^\circ&amp;lt;90^\circ$。&lt;/p&gt;
&lt;p&gt;不要再说自转是顺/逆时针了！那会取决于观察的方向。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/AxialTiltObliquity.png&#34;
	width=&#34;760&#34;
	height=&#34;590&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;128&#34;
		data-flex-basis=&#34;309px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;地磁南/北极，是地球磁场的北/南极。地磁北极，也就是地球磁场的南极，在地理北极附近，并且在持续移动。&lt;/p&gt;
&lt;h3 id=&#34;星座&#34;&gt;星座
&lt;/h3&gt;&lt;p&gt;古代的星座是往图案上靠，连起来的。现在是通过将全天划分为 $88$ 个天区，每个天区对应一个星座。&lt;/p&gt;
&lt;p&gt;星图上的信息：分区（直线为边界）、各个星座、亮度、黄道、天赤道、观测的日期时间。&lt;/p&gt;
&lt;p&gt;（较亮）恒星的命名方式：星座 + 希腊字母（一般而言越靠前越亮）。&lt;/p&gt;
&lt;p&gt;一般而言，一个星座的各星无物理联系，但，如果一个星位置放大了，里面有多个星，那就可能有关系了（双星系统等，例如天狼星可以算双星，它有一个伴星，是颗白矮星。很亮的星大都是多星系统），如果数量多的，就叫做星团。星团周围有光晕，是星际尘埃散射的结果。&lt;/p&gt;
&lt;p&gt;中国古代：星官，三垣、二十八宿。&lt;/p&gt;
&lt;p&gt;最亮的星：天狼星（大犬座 α）。&lt;/p&gt;
&lt;p&gt;夏季大三角：织女一（天琴座 α）、河鼓二（天鹰座 α，牛郎星）、天津四（天鹅座 α）。&lt;/p&gt;
&lt;p&gt;冬季大三角：天狼星、南河三（小犬座 α）、参宿四（猎户座 α）。&lt;/p&gt;
&lt;p&gt;离太阳系最近的恒星系统：半人马座 α，三星。&lt;/p&gt;
&lt;p&gt;典型造父变星：北极星（小熊座 α，三星）、造父一（仙王座 δ）。&lt;/p&gt;
&lt;h3 id=&#34;天体的周日视运动&#34;&gt;天体的周日视运动
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;天球&lt;/strong&gt;是从地球上看星空，将星空假想成一个球面，没有半径。&lt;/p&gt;
&lt;p&gt;星星在天球上视作&lt;strong&gt;固定不动&lt;/strong&gt;（随着天球动）。&lt;strong&gt;太阳系内的会乱动&lt;/strong&gt;，太阳在天球上一年绕一圈。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;天球赤道&lt;/strong&gt;，就是地球赤道平面与天球的交圆。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;天球的天极&lt;/strong&gt;，就是地轴与天球相交的两点。&lt;/p&gt;
&lt;p&gt;在地球上任何位置，都恰好能看见天球的&lt;strong&gt;一半&lt;/strong&gt;。可以认为天球作为一个“屏幕”，是&lt;strong&gt;自东向西&lt;/strong&gt;转动的，那么现在可以认为地球不自转。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;星轨&lt;/strong&gt;是天体随天球转动的轨迹。&lt;/p&gt;
&lt;p&gt;所有的星星的星轨对应平面都&lt;strong&gt;垂直&lt;/strong&gt;于地轴。可以结合在地球的位置，算出哪些星在当地可以永远看到（拱极星，星轨和地平面相切），哪些星永远看不到。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;天球.png&#34; style=&#34;zoom:30%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;上图中，小球表示地球，大球表示天球，天球从右往左转。顶部蓝点为北天极和地理北极。侧面蓝点为观察点。蓝色球面为天球可见部分。橙色实线这圈及以上为拱极星，橙色虚线这圈及以下为永远看不到的星。如果观测地纬度为 $\phi$，那么拱极星的纬度在 $\pi/2-\phi$ 以上。同时，赤道面（以及星轨面）和地平面的夹角也是 $\pi/2-\phi$。&lt;/p&gt;
&lt;p&gt;在该点处看北边天空，星是逆时针转；看南边天空，是顺时针；看东边天空，左下—右上升起；看西边天空，左上—右下降落。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;天顶&lt;/strong&gt;，就是当地的地平面法线与天球的交点。当地的正北—正南在地球球面上的弦，就是&lt;strong&gt;子午线&lt;/strong&gt;。当地—北天极（附近有北极星）与当地—地面正北的夹角，可用于推导所处的纬度。&lt;/p&gt;
&lt;p&gt;天球动，星星动，天顶不动，子午线不动。&lt;/p&gt;
&lt;p&gt;要描述一颗星的位置怎么办？用地平坐标系。但是星星的坐标会变……&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;地平坐标系&lt;/strong&gt;是以观测地为中心点的坐标系。描述天球上的一点，可以用&lt;strong&gt;高度角&lt;/strong&gt;和&lt;strong&gt;方位角&lt;/strong&gt;两个参数来表示。高度角是连线与地平面的夹角，方位角是水平方向的，从正北 $0$ 度开始向东（顺时针）增加。&lt;/p&gt;
&lt;p&gt;子午线可以对应到天球上（方位角 $=0^\circ/180^\circ$，高度角 $\in[0^\circ,90^\circ]$）。任何通过子午线的天体都处于其距观测者地平面的&lt;strong&gt;最高位置&lt;/strong&gt;，称为&lt;strong&gt;过中天&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;不同经度——看到星的时间不同，不同纬度——看到星的范围不同。只有在赤道上，才能一天看尽整个天球。&lt;/p&gt;
&lt;p&gt;我们的时间都是太阳时，只不过经度不同。正午：太阳经过子午线的时刻，不等于 12 点，因为国家有经度上的跨度。北京时间是【东经 120 度正午对应 12 时】的时间，北京本身也不是 120 度。&lt;/p&gt;
&lt;p&gt;正午的太阳高度角为 $90^∘−(观测地纬度−太阳直射点纬度)$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;恒星日&lt;/strong&gt;是地球上某（任意）点，某（任意）个星连续两次过中天的时间间隔。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;太阳日&lt;/strong&gt;是地球上某（任意）点，太阳连续两次过中天的时间间隔。&lt;/p&gt;
&lt;h3 id=&#34;天体的周年视运动&#34;&gt;天体的周年视运动
&lt;/h3&gt;&lt;p&gt;回顾一天长度不等于地球自转周期的原因（“硬币悖论”）：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Sidereal_day_(prograde).svg&#34; style=&#34;zoom:100%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;每天白天的同一时刻，太阳的位置是&lt;strong&gt;往东&lt;/strong&gt;移动的。并且太阳日的长度是不同的。与太阳的距离越小，角速度越大，太阳日的时间越长。太阳日的时间可能小于，也可能大于 $24\unit{h}$。平太阳日就是 $24\unit{h}$。一恒星日约比平太阳日短 $4\unit{min}$。&lt;/p&gt;
&lt;p&gt;每天夜里的同一时刻，星的位置是&lt;strong&gt;往西&lt;/strong&gt;移动的，或者说，每天都会&lt;strong&gt;提前&lt;/strong&gt;升起，提前通过子午线，提前落下。这个提前的时间就是 $4\unit{min}$。&lt;/p&gt;
&lt;p&gt;在黄道附近的星座，称为黄道星座。黄道星座被分为十二个，就是现在常说的星座。但现在十二个星座和十二宫已经不对应了，是岁差导致的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;恒星年&lt;/strong&gt;的定义：太阳相对背景星，从一处回到原处的间隔。也就是公转周期，但不是公历年，这是因为两次太阳相对天球在同一位置的时候，地球的自转相位可能是不同的。恒星年约为 $365.25636\unit{d}$（太阳日）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;回归年（太阳年）&lt;strong&gt;的定义：太阳两次通过春分点的间隔。由于自转轴进动的原因，约为 $365.2422\unit d$，略短于恒星年 $20.5\unit{min}$。这个差称为&lt;/strong&gt;岁差&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;总结：
$$
\left\{
\begin{align*}
恒星日&amp;amp;=\frac{2\pi}{\omega_自}\\
太阳日&amp;amp;=\frac{2\pi}{\omega_自-\omega_公}\\
恒星年&amp;amp;=\frac{2\pi}{\omega_公}\\
太阳日&amp;amp;=24\unit h=1440\unit{min}=86400\unit s\\
恒星年&amp;amp;\approx 365.25636\times 太阳日
\end{align*}
\right.
$$
可以认为，除了最后一条，其他都是定义。&lt;/p&gt;
&lt;p&gt;我们一般的直觉，恒星日和太阳日之差，经过一年后地球刚好多转一个 $360^\circ$，它的原理是：
$$
(太阳日-恒星日)\times\frac{恒星年}{太阳日}=\frac{2\pi\omega_公}{(\omega_自-\omega_公)\omega_自}\cdot\frac{\omega_自-\omega_公}{\omega_公}=\frac{2\pi}{\omega_自}=恒星日
$$&lt;/p&gt;
&lt;h3 id=&#34;赤道坐标系&#34;&gt;赤道坐标系
&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Kay7E_02_14ab.jpg&#34;
	width=&#34;2422&#34;
	height=&#34;1674&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;144&#34;
		data-flex-basis=&#34;347px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;春秋分点&lt;/strong&gt;：天球赤道与黄道的交点。春秋分是&lt;strong&gt;一个时刻&lt;/strong&gt;，不是一天。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Kay7E_02_16a.jpg&#34; style=&#34;zoom:35%;&#34; /&gt;&lt;img src=&#34;Kay7E_02_16b.jpg&#34; style=&#34;zoom:35%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;&lt;strong&gt;赤经（RA, α）和赤纬（Dec, δ）&lt;/strong&gt;，就是地球的经纬线在天球上的投影。特殊地，赤经的 $0$ 不是格林尼治天文台，而是春分点。赤经的单位是时间，从春分点向东转一圈为 $24\unit{h^\prime}$（一恒星日）。赤纬还是一样 $-90^\circ\sim+90^\circ$。&lt;/p&gt;
&lt;p&gt;赤纬相同时，赤经越&lt;strong&gt;小&lt;/strong&gt;，越&lt;strong&gt;早&lt;/strong&gt;升起。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;地方恒星时&lt;/strong&gt;的定义：某地子午线对应的赤经。&lt;strong&gt;地方恒星时是不断在变的&lt;/strong&gt;，变的速度略快于太阳时，每天增加约 $4\unit{min^\prime}$ 左右。&lt;/p&gt;
&lt;p&gt;实际上在某一天内，各个地方在同一个当地太阳时时的地方恒星时基本是一样的，其计算思路是：由于春分时，该地 $12$ 点时的地方恒星时接近为 $0\unit{h^\prime}$，因此该地 $x$ 日 $y$ 时的地方恒星时就是
$$
[(x-春分)\times 4\unit{min^\prime}+y-12\unit{h^\prime}]\bmod 24\unit{h^\prime}
$$&lt;/p&gt;
&lt;p&gt;但是当地的时间并非绝对标准的太阳时，而是国家标准时间，因此还要算一下。例如北京的经度如果算作 $116^\circ$ 的话，恒星时就要再减去 $4^\circ\times 24\unit{h^\prime}/360^\circ$。&lt;/p&gt;
&lt;p&gt;我们再详细说一下这个 $4\unit{min^\prime}$。每个恒星日，恒星时比太阳时多走
$$
\left(\frac{太阳日}{恒星日}-1\right)\times24\unit{h^\prime}=\frac{\omega_公}{\omega_自-\omega_公}\times24\unit{h^\prime}\approx\frac{24\unit{h^\prime}}{365.25636}\approx 3.94\unit{min^\prime}
$$
&lt;strong&gt;恒星时角&lt;/strong&gt; $\tau=$ 恒星时 $\theta-{}$恒星赤经 $\alpha$。$\tau&amp;gt;0$ 时，恒星在子午线以西。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;岁差&lt;/strong&gt;：太阳对地球引力的力矩，导致地球自转的同时进动。地轴会绕黄道平面法线（过地心）转。那么相应地，赤道平面也会转，春秋分点也会变（向西移动，提前到来，以 $\sim 25800\unit y$ 为周期），因此一年的时间略短于 $365.25\unit{d}$，需要通过百年不闰解决。同时，赤道坐标系也会变，即星的坐标往东移（赤经增加）。因此每隔几十年要修正。&lt;/p&gt;
&lt;p&gt;拓展：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;科氏力&lt;/li&gt;
&lt;li&gt;太阳的 8 字形轨迹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;物理基础&#34;&gt;物理基础
&lt;/h2&gt;&lt;h3 id=&#34;历史&#34;&gt;历史
&lt;/h3&gt;&lt;p&gt;古希腊：亚里士多德提出地心说，托勒密完善（均轮、本轮）。&lt;/p&gt;
&lt;p&gt;中世纪：哥白尼提出日心说（反驳了一部分地心说，当时仍然支持天球事实存在，且由于精度不足，日心说的预测并不比地心说准确），第谷观测仪器+数据（介于地心日心之间），开普勒观测数据 + 三定律（完备日心说），伽利略开启近代天文学、物理学，用望远镜观察天体（彻底否定地心说，金星的盈亏，越亮越小），牛顿发现万有引力定律，第一台反射式光学望远镜。&lt;/p&gt;
&lt;h3 id=&#34;万有引力&#34;&gt;万有引力
&lt;/h3&gt;&lt;p&gt;高中物理。略。&lt;/p&gt;
&lt;h3 id=&#34;潮汐力&#34;&gt;潮汐力
&lt;/h3&gt;&lt;p&gt;月球的公转轨道于黄道夹角为 $5^\circ$ 左右，与黄赤夹角方向相反。&lt;/p&gt;
&lt;p&gt;地球在运动的时候，整个视作刚体，每个点的加速度相同。而地球由于相对于月球不能完全视作质点，各点受到月球的引力不同，故这里以地球为参考系，地球上的水的相同的惯性力与受到月球的不同的引力，导致了潮汐（&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/31294983/answer/72019418&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/31294983/answer/72019418&lt;/a&gt;）。
$$
a_{潮汐}=\frac{2GMr}{R^3}
$$
如果月球不公转，那么基本上就是每天两个潮汐周期。但是公转就会导致略微变长（$\sim 25\unit h$）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/%E6%BD%AE%E6%B1%90.jpg&#34;
	width=&#34;563&#34;
	height=&#34;285&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;197&#34;
		data-flex-basis=&#34;474px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;月球对地球的潮汐力导致了潮汐隆起，但是地球自转比月球公转快，这就导致隆起和地月连线不共线，这就对地球产生了与自转方向相反的力矩导致自转速度变慢，以及对月球产生了切向力导致月球公转变快从而做离心运动（&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/299894978/answer/3632821076&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/299894978/answer/3632821076&lt;/a&gt;）。太阳对地球也有潮汐力（是月球的），与月球共同导致大潮和小潮。地球对月球的潮汐力导致了潮汐锁定。&lt;/p&gt;
&lt;p&gt;双星系统要考。可以证明（&lt;a class=&#34;link&#34; href=&#34;https://farside.ph.utexas.edu/teaching/336k/Newton/node50.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://farside.ph.utexas.edu/teaching/336k/Newton/node50.html&lt;/a&gt;），双星系统的两个星一定是绕着它们的公共质心做（成比例的）等价于单星的运动。&lt;/p&gt;
&lt;p&gt;两体近似：仅考虑太阳引力作用下的行星轨道的计算。其它质量对两体近似的偏离称为引力摄动。通过考虑太阳、木星土星之后仍然不对，根据引力摄动，可以预言别的行星的存在。&lt;/p&gt;
&lt;h3 id=&#34;相对论&#34;&gt;相对论
&lt;/h3&gt;&lt;p&gt;牛顿万有引力定律的问题：水星的椭圆轨道也会进动。但是如果只靠万有引力，只能解释一部分（火神星），需要相对论才能完整解释。万有引力只能解释弱引力的情况，而水星离太阳太近了。&lt;/p&gt;
&lt;p&gt;相对论细节就不写了，一个提纲：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;狭义相对论的内容，时空观。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;速度接近光速时，长度变短，时间变慢，质量变大。&lt;/li&gt;
&lt;li&gt;μ 子的例子&lt;/li&gt;
&lt;li&gt;计算：洛伦兹变换、质能方程。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;广义相对论的内容（主要多处理了非惯性等效引力相关）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;光线在大质量天体周围的弯曲（太阳在日食时看、引力透镜），反而会变亮！&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/%E5%BC%95%E5%8A%9B%E9%80%8F%E9%95%9C.jpg&#34;
	width=&#34;712&#34;
	height=&#34;462&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;154&#34;
		data-flex-basis=&#34;369px&#34;
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;靠近大质量天体时，长度变短（引力红移），时间变慢（相对论时间修正）。红移公式为（$\gamma$ 根据逃逸速度计算）$1+z=\gamma$。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;Kay7E_18_15a.jpg&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;img src=&#34;Kay7E_18_15b.jpg&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;辐射&#34;&gt;辐射
&lt;/h3&gt;&lt;center&gt;&lt;img src=&#34;Spectrum.svg&#34; /&gt;&lt;/center&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Color_temperature_black_body_800-12200K.svg&#34;
	
	
	
	loading=&#34;lazy&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;电磁辐射依然是了解宇宙的主要载体，有关宇宙信息的绝大多部分来源于天体发出或反射的电磁辐射。&lt;/p&gt;
&lt;p&gt;电磁波相关的知识：高中物理。&lt;/p&gt;
&lt;p&gt;黑体（普朗克）辐射谱：不同温度的黑体辐射的光谱。规律：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;温度上升，峰值波长减小，两者成反比。（从而能测星体的光谱得到其温度）&lt;/li&gt;
&lt;li&gt;温度上升，（单位面积单位时间辐射出的）能量增加，能量与温度的四次方成正比。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;流强&lt;/strong&gt; $F$：一个天体单位时间从其表面单位面积所辐射出的能量。注意这个定义和一般理解的光通量不同，它的国际单位是 $\unit{J\cdot s^{-1}\cdot m^{-2}}$。可以类比的概念应该是光出射度。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;光度&lt;/strong&gt; $L$：一个天体单位时间的总辐射能量。类比发光强度。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;亮度&lt;/strong&gt; $B$：观测仪器单位面积单位时间所接收到的天体的辐射能量。类比照度。&lt;/p&gt;
&lt;p&gt;除此之外，还有距离、半径、温度等量。&lt;/p&gt;
&lt;p&gt;通过观测，我们可以得到波长峰值和亮度。
$$
\left\{\begin{aligned}
T&amp;amp;=\frac{2.9\times 10^6\unit{nm\cdot K}}{\textcolor{green}{\lambda_{\text{peak}}}}\\
F&amp;amp;=\sigma T^4\\
L&amp;amp;=4\pi r^2F\\
\textcolor{green}B&amp;amp;=\frac{L}{4\pi d^2}
\end{aligned}\right.
$$
因此只靠分析光谱，只能得到 $r:d$。&lt;/p&gt;
&lt;p&gt;辐射相关的内容在 L9 还有。&lt;/p&gt;
&lt;p&gt;除了用 $\rm\mu m$ 等 $10^3$ 为一级的长度单位描述波长，还有一个单位 Å（埃斯特朗），是 $10^{-10}\unit m$。&lt;/p&gt;
&lt;p&gt;当然，天体不能完全看作黑体，因为它表面的大气会吸收或发射特定频率的光子，形成光谱中的吸收线或发射线。根据这些线，可以推得其大气的化学成分及丰度。&lt;/p&gt;
&lt;p&gt;具体关于原子能级的概念：高中物理，略。氢原子的光谱记一下。&lt;/p&gt;
&lt;p&gt;问题：为什么吸收和发射不会抵消？&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/659539814&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;回答&lt;/a&gt;，主要就是吸收再发射就是各个方向了，不是天体—观测者连线方向了。&lt;/p&gt;
&lt;p&gt;原子的电离：天文学里标记的方法是用罗马数字（例如 H II = H&lt;sup&gt;+&lt;/sup&gt;）。&lt;/p&gt;
&lt;p&gt;H II 区 : 所有氢被近邻的炽热恒星的强烈紫外辐射（至少 $13.6\unit{eV}$ 才能电离）所电离的区域，是大质量恒星正在形成的标志。气体云里面是等离子体。&lt;/p&gt;
&lt;p&gt;分子光谱：分子内的电子跃迁：可见光和紫外谱线；分子振动的变化：红外谱线；分子转动的变化：射电谱线。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多普勒效应&lt;/strong&gt;：靠近蓝移，远离红移。
$$
\frac{\Delta\lambda}{\lambda}=\frac{v}{c}
$$
其中 $v$ 是&lt;strong&gt;视向速度&lt;/strong&gt;（乘个 $\cos$）。&lt;strong&gt;注意只有低速情况下适用。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;推导：观测到的波长定义为相邻两个波峰之间的距离。假设恒星以 $v$ 的速度远离观测者，那么相邻波峰中后一个比前一个多走 $\frac\lambda cv$ 的路程，于是 $\Delta\lambda=\frac\lambda cv$。&lt;/p&gt;
&lt;p&gt;可以通过对比标准的谱线系列（例如氢的巴尔末谱系）来确定恒星是在远离还是靠近。&lt;/p&gt;
&lt;h2 id=&#34;天文望远镜&#34;&gt;天文望远镜
&lt;/h2&gt;&lt;p&gt;伽利略发明望远镜（1609）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;折射望远镜&lt;/strong&gt;：很简单，就是利用凸透镜成实像，和实际情况是中心对称的。没法造大，因为色散问题会愈发严重（波长越短，折射率越大，高中物理）。加长焦距可以减小色差，复合透镜可以补偿色差。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;反射望远镜&lt;/strong&gt;：利用凹面镜成实像，就没有色散问题了。但是成像位置很尴尬，所以一般再加个平面镜，在侧面（牛顿）或者底面（卡塞格林）开个小口观看。&lt;/p&gt;
&lt;p&gt;反射望远镜的&lt;strong&gt;球面像差&lt;/strong&gt;：根据高中数学，把反射镜做成抛物面的形状，才能使光汇聚到一点，结果哈勃望远镜做成了球面，就要有宇航员上去装“眼镜”，于是就有了新概念二里那篇 Trouble with the Hubble。&lt;/p&gt;
&lt;p&gt;望远镜的主要功能不是放大，而是聚光和提高分辨率。同样长的曝光时间，同样大的像，口径越大，接受的光越多，最后光强越大。口径越大，不是看得越远，而是能看到的越暗。&lt;/p&gt;
&lt;p&gt;口径越大，角分辨率越小。具体来说，当某处发出的光通过透镜被汇聚到光屏上一点的过程中，会发生衍射，形成艾里斑。中央亮斑的角半径为 $\sin\theta=1.22\lambda/D$，$D$ 为透镜直径，因此半径为 $f\tan\theta\approx 1.22f\lambda/D$。如果两个亮斑，一个的中心处于另一个的第一暗环以内，就认为分不清。从而定义&lt;strong&gt;角分辨率&lt;/strong&gt; $\theta=1.22\lambda/D$，单位为弧度。&lt;/p&gt;
&lt;p&gt;课本里的话，是忽略的这个 $1.22$ 倍，$\theta=\lambda/D\unit{rad}=2.06\times10^5\lambda/D\unit{arcsec}$。&lt;/p&gt;
&lt;p&gt;参考：&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/548289357&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/548289357&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://www.telescope-optics.net/diffraction.htm&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.telescope-optics.net/diffraction.htm&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://astronomy.stackexchange.com/questions/35894/how-does-diffraction-occur-in-a-reflecting-telescope&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://astronomy.stackexchange.com/questions/35894/how-does-diffraction-occur-in-a-reflecting-telescope&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;大气极限：视宁度。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Diffraction_spike&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;星芒的原因&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;胡克望远镜（1917），哈勃通过它发现宇宙膨胀，通过红移。&lt;/p&gt;
&lt;p&gt;还有 Hale、Keck、VLT、Gemini、ESO、LBT、Subaru 等。最新：E-ELT。&lt;/p&gt;
&lt;p&gt;为什么现在大型望远镜都是两个四个一组的？干涉仪（astronomical interferometer），分辨率可以达到相当于它们距离的大镜。&lt;/p&gt;
&lt;p&gt;光学望远镜：望远镜（镜筒+赤道仪）+ 终端设备。终端设备（光学探测器与仪器）：目镜、探测器（照相机，CCD/CMOS）、分光仪器（摄谱仪/分光仪）。&lt;/p&gt;
&lt;p&gt;受限于大气层（反射、吸收、扰动），在地面能看到的，只有可见光、射电、部分红外与毫米波。&lt;/p&gt;
&lt;p&gt;之所以射电望远镜口径都这么大（或者需要阵列），就是因为 $\theta\propto\lambda/D$。大的：Arecibo、FAST。&lt;/p&gt;
&lt;p&gt;空间望远镜就可以看各波段了，但是造价太高。大的：哈勃、JWST、GMT、TMT。&lt;/p&gt;
&lt;p&gt;THU：MUST。PKU：EAST。上交：JUST。国内最大的是 LAMOST。&lt;/p&gt;
&lt;h2 id=&#34;太阳系&#34;&gt;太阳系
&lt;/h2&gt;&lt;p&gt;行星可以认为是恒星形成的“副产品”。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;行星系&lt;/strong&gt;是环绕一颗恒星（也可以是死亡后的恒星）的天体集合，包括行星、矮行星、小天体（卫星、小行星、彗星、流星体等）。恒星系不考虑行星，只是若干恒星，比如南门二（含比邻星）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;行星&lt;/strong&gt;的定义：质量够大足以使自己成为球体，轨道清晰无杂物。目前有发现“流浪”行星（没有围绕恒星）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;矮行星&lt;/strong&gt;的定义：不具有能清除轨道上其他天体的能力，别的和行星一样。&lt;/p&gt;
&lt;p&gt;太阳系里的矮行星：谷神星是小行星带中唯一的，别的（冥王星、阋神星（直接触发了冥王星的降级）之类的）都在‌柯伊伯带。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;彗星&lt;/strong&gt;：来自柯伊伯带或奥尔特星云（更外围）。有彗星的轨道是扁椭圆（例如哈雷彗星），来自柯伊伯带，还有一些是双曲线（只能靠近太阳一次），来自奥尔特星云。&lt;/p&gt;
&lt;h3 id=&#34;太阳系的形成&#34;&gt;太阳系的形成
&lt;/h3&gt;&lt;p&gt;太阳系形成的&lt;strong&gt;星云假说&lt;/strong&gt;：康德 → 拉普拉斯（天体力学之父）&lt;/p&gt;
&lt;p&gt;太阳系的早期图景：原太阳（尚未开始燃烧氢）被一个自转着的，扁平的气体尘埃盘环绕。这个旋转的盘不仅为太阳的成长提供物质和能量（质量集中在盘中心，最后形成太阳），而这个盘中的少量剩余物质形成了太阳系的行星等其它天体。一个自转的星际云通过引力坍缩形成了太阳及太阳系。&lt;/p&gt;
&lt;p&gt;支持星云假说的证据：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;已观测到许多年轻恒星被气体尘埃盘（星周盘/原行星盘）环绕。这个盘本身是不可见的（发出的光不是可见光波段的），但是会散射恒星的光。另外还有喷流，垂直于盘面。我们目前看见的那些盘面的图片，都是比如毫米波段的望远镜的图像合成出来的。会发现盘是一个个圆环状，暗环就对应正在形成的行星。可以看 L1527 IRS。&lt;/li&gt;
&lt;li&gt;所有行星轨道基本位于同一平面内 → 早期太阳系必定是扁平的。所有行星公转和自转方向，与太阳自转方向相同（有反例：金星、天王星，解释：随机大碰撞） → 形成行星的物质必定沿相同方向围绕太阳转动。&lt;/li&gt;
&lt;li&gt;陨石是落到地球表面的年轻太阳系的遗留碎片。其结构清晰地表明，陨石（再大就发展成（小）行星）是由许多小块物质聚合而成的，被称为时间胶囊。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;原行星盘是怎么形成的？关键是角动量。虽然太阳系的质量几乎全在太阳上，但角动量主要在行星（木星）上。&lt;/p&gt;
&lt;p&gt;恒星系一开始是个星际云。一个星际云绕银河系中心公转，由于不断被恒星爆炸推挤，或与其它星际云碰撞，使得星际云有一定的轻微自转。星际云非常延展巨大，具有巨大的角动量。星际云在自引力（需要有足够的质量和密度）的作用下开始坍缩变小。由于角动量守恒，其自转随着坍缩变小而越来越快。而引力坍缩具有方向性——考虑一块物质，在垂直于自转轴的方向，它确实受到引力，但一部分用于充当向心力了，因此坍缩得慢；而平行于自转轴的方向没有向心力，因此就坍缩得快，于是就形成一个盘状。由于坍缩更快， 与外区分离的内区形成&lt;strong&gt;原恒星&lt;/strong&gt;与&lt;strong&gt;吸积盘&lt;/strong&gt;。外区物质首先下落到具有转动的吸积盘，然后沿近似椭圆轨道靠近原恒星。吸积盘相当于一个“中转站”，它的半径是恒星的约几千倍，同时有很大的角动量，但其大部分物质成为恒星的材料的同时，角动量大的部分，通过射流被抛回星际空间，或是等剩下到足够稀了之后，和外区一起（也是角动量很大，不然就掉进来了），就成为行星的材料。&lt;/p&gt;
&lt;p&gt;一个可能要考的公式：角动量为
$$
L=\frac{4\pi mR^2}{5T}
$$
星体的成长：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;微粒之间的吸附，气体将小颗粒吹入大颗粒，合并。&lt;/li&gt;
&lt;li&gt;大了（$100\unit m$）之后，猛烈的碰撞会导致再碎成小的；如果不猛烈，可以继续增大。&lt;/li&gt;
&lt;li&gt;再大（$1\unit{km}$）称为&lt;strong&gt;星子&lt;/strong&gt;，它的引力可以吸引周围的小物体，不断加快增长。最后变成原行星。这一过程中有大量的撞击，这在岩质行星上留下了陨石坑。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;原行星盘内热外冷（原恒星的热辐射、下落气体的引力势能、粘滞（摩擦））。这导致各种物质在不同行星上的状态不同，所以太阳星外围的行星都是气态行星（太阳系的行星排列：内区，星子由岩石和金属组成；外区，主要由岩石、金属、水冰和冰态的挥发性有机物组成）。系外行星系的行星排列并非都是如此，可能发生了行星迁移（气体导致行星角动量损失，内移，热木星；天海王星是因为木星和土星的&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Gravitational_scattering&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;引力散射&lt;/a&gt;）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Kay7E_07_12.jpg&#34;
	width=&#34;1213&#34;
	height=&#34;492&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;246&#34;
		data-flex-basis=&#34;591px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;巨行星的成长：固态行星（核）一旦形成，它将继续吸积原行星盘中的气体而成长。 质量巨大的固态行星对聚集和维系氢和氦等轻元素气体具有明显的优势。强大的引力使得大质量的年轻固态行星在其周围形成“微型吸积盘”，物质（气体）通过吸积盘旋入固态行星。很多小行星就是这样被木星、土星捕获的。&lt;/p&gt;
&lt;p&gt;还有个假说是盘不稳定性，说的是原行星盘会碎开，每个对应一个巨行星。&lt;/p&gt;
&lt;p&gt;行星形成时从原行星盘中所获得的气体称为原始大气。巨行星能维持一开始捕获的气体，小质量行星不能。所以像地球、金星的大气层，都是次生大气，源自火山从行星内部喷出来的二氧化碳等气体，或彗星撞击。&lt;/p&gt;
&lt;p&gt;小行星和彗星核是存活到今天的星子，几乎保持太阳系刚形成时的状态。火星和木星之间的小行星带，是因为受到木星强大引力的搅动没能凝聚为一个行星。&lt;/p&gt;
&lt;h3 id=&#34;系外行星&#34;&gt;系外行星
&lt;/h3&gt;&lt;p&gt;2017 年人类首次在太阳系内发现系外天体 Oumuamua。&lt;/p&gt;
&lt;p&gt;行星很常见，但由于小而暗弱，且靠近明亮的恒星，所以探测很困难。&lt;/p&gt;
&lt;p&gt;发现的&lt;strong&gt;第一颗&lt;/strong&gt;系外行星：1995 年，&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/51_Pegasi_b&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;飞马座 51 b&lt;/a&gt;，&lt;strong&gt;视向速度法&lt;/strong&gt;。目前已经确认的系外行星已有数千颗。&lt;/p&gt;
&lt;p&gt;系外行星是绕恒星公转的且质量小于 $13$ 倍木星质量的天体。&lt;strong&gt;褐矮星&lt;/strong&gt;是大于 $13$ 倍木星质量，小于 $0.08$ 倍太阳质量，性质类似于木星。恒星是大于 $0.08$ 倍太阳质量，这样才能氢核聚变。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;发现行星的方法&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;视向速度法：观察恒星光谱吸收线的周期性的频移。就是认为行星和恒星形成一个双星系统。&lt;/li&gt;
&lt;li&gt;凌星法：当行星运行到恒星前面时，会遮挡很小一部分恒星光，从而使得恒星周期性地变暗。可以用于计算行星大小。&lt;/li&gt;
&lt;li&gt;微引力透镜法：当一颗恒星及其行星从远处背景恒星前经过时，引力透镜效应增强背景恒星的亮度，从而能够显示恒星及其行星的存在。可估算行星的质量，还能发现流浪行星。注意，可以区分恒星本身亮度变化与引力透镜造成的变化：引力透镜对各波段的影响（亮度变化比例）是一样的，自身变化（比如温度变化）显然是不同的。&lt;/li&gt;
&lt;li&gt;直接成像法：在天文望远镜上加装星（日）冕仪，降低恒星亮度，直接拍摄行星。&lt;/li&gt;
&lt;li&gt;天体测量法：直接观测恒星位置受行星影响的周期性变化。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以下是目前已知的系外行星的分布：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Kay7E_07_24.jpg&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;关于凌星法，这里有一个问题，就是，为什么太阳看起来是圆盘上各处亮度相同的？这是因为太阳是&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Lambert%27s_cosine_law&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;朗伯辐射体&lt;/a&gt;，对于一个小面 $\mathrm{d}a$，如果观察角度（观察点与其连线，和面的法向量的夹角）为 $\theta$，则看到的发光强度就是 $I\cos\theta$。朗伯辐射体的特性是，“视亮度”（观察到的光通量与视大小之比）与观察角度无关，因为这个 $\mathrm{d}a$ 从 $\theta$ 角度来看，面积就只剩下 $\mathrm{d}a\cos\theta$ 了，除一下刚好抵消。因此我们可以严格地说，凌星法中，理论上，太阳亮度的减少量就正比于遮住的面积。实际上的话太阳的远离更复杂些，还有&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Limb_darkening&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;周边昏暗效应&lt;/a&gt;，所以拍出来的图片还是周围暗。&lt;/p&gt;
&lt;p&gt;历史：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1992 年：发现至少三颗围绕中子星转的系外行星。&lt;/li&gt;
&lt;li&gt;1995 年：发现围绕主序星（飞马座 51）旋转的系外行星。方法：视向速度法。&lt;/li&gt;
&lt;li&gt;2021 年：首颗被确定的河外行星，M51-ULS-1b。&lt;/li&gt;
&lt;li&gt;后续发现方法：开普勒望远镜，发现首批地球大小的系外行星（凌星法，确定大小）；进一步证认：地面大口径望远镜（视向速度法，确定质量）。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;科学家还是很关心类地行星。要有生命产生，需要有液态水的存在（在宜居带内），和地球大小差别不太大，围绕类似太阳的恒星转。也会考虑光谱与地球的类似。&lt;/p&gt;
&lt;p&gt;开普勒 452b：第一个地球 2.0（后来发现观测到的信号是假的？）&lt;/p&gt;
&lt;p&gt;比邻星：至少三颗行星，且都已被潮汐锁定，不太可能有生命。且红矮星耀斑爆发剧烈，容易杀死行星上的生命。&lt;/p&gt;
&lt;h3 id=&#34;太阳&#34;&gt;太阳
&lt;/h3&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Sun&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;相关数据自己看&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;太阳为什么是稳定的？太阳的结构是向外压力（气体产生）与向内引力平衡的结果。在向外辐射能量的同时，核心进行的核聚变补充能量，形成平衡。压力、密度与温度向太阳中心增加。&lt;/p&gt;
&lt;p&gt;太阳通过热核聚变把质量转化为能量。（氢）核聚变需要足够高的温度与密度，克服电斥力，使强相互作用力将两个质子结合在一起，产生新原子核与其它粒子，释放能量。链式反应（PP 链）。四个氢原子聚变成一个氦原子。&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/316189630/answer/3075491963&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;能量产生的根源&lt;/a&gt;。核聚变比化学燃烧的能量转换效率高很多。其他核聚变方式：碳氮氧循环。&lt;/p&gt;
&lt;p&gt;太阳的主序寿命约为 $10^{10}$ 年，目前已过了约一半。&lt;/p&gt;
&lt;p&gt;太阳中心产生的能量去向：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;中微子直接逃逸到宇宙空间&lt;/li&gt;
&lt;li&gt;加热太阳内部&lt;/li&gt;
&lt;li&gt;向外转移到太阳表面辐射出去&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;能量传输方式：主要是辐射与对流。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;层：核反应区 → 辐射区 → 对流区 → 太阳大气&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;核反应区是等离子态，核聚变只在核反应区发生。&lt;/p&gt;
&lt;p&gt;光子在辐射区的传播比较困难，需要与电子碰撞很多次才能到对流区，这部分的气体更密了，就会把光子吸收，变热，往外飘，辐射出能量，再往内沉。对流的强弱取决于温度梯度与不透明度。气体的对流运动在&lt;strong&gt;光球层&lt;/strong&gt;形成被称为&lt;strong&gt;日面米粒组织&lt;/strong&gt;的斑驳图像。&lt;del&gt;有点像味噌汤&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;到大气之后，光子又能自由运动了，再过约 $8.3\unit{min}$ 到地球。一个光子从产生到太阳表面，得经过数万年的时间，并且是由伽马射线变成了可见光左右（包括红外和紫外）波段的。&lt;/p&gt;
&lt;p&gt;可以通过观测中微子（不受太阳气体影响）来分析太阳内部核聚变的情况。中微子探测器都在地底下深处。建立的太阳物理模型，其他数据都与观测相符，但观测到的中微子数量（单位流量）只是预言的 $1/3$。解释是中微子有质量，存在中微子振荡，中微子在 $e$、$\mu$、$\tau$ 三类中转化，而观测只能观测到 $e$（电子中微子）。&lt;/p&gt;
&lt;p&gt;太阳表面不同的小区域同时发生很多不同频率的振荡。&lt;/p&gt;
&lt;p&gt;太阳大气从内到外分为&lt;strong&gt;光球层&lt;/strong&gt;、&lt;strong&gt;色球层&lt;/strong&gt;和&lt;strong&gt;日冕&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;太阳的密度和温度从内向外降低，但在色球层温度增高，在日冕温度突然增高，密度突然减小。&lt;/p&gt;
&lt;p&gt;我们看到的太阳是光球层。温度约 $5780\unit K\,(6600\unit K\to 4400\unit K)$，厚 $500\unit{km}$，相比别的层较薄（所以太阳边界清晰）。临边昏暗效应就是因为在边上只有浅的部分的光，量和温度都小。从光球层发出的光会被太阳大气吸收部分，可以通过分析太阳光谱得到太阳大气的成分。&lt;/p&gt;
&lt;p&gt;光球层之上的 $1500\unit{km}$ 厚的区域称为色球层，温度 $4500\unit K\to6000\unit K$。要观测必须把光球层的影响去掉，需要特殊的望远镜。它是深红色的，不是光滑的球状而是针状等离子喷泉。&lt;/p&gt;
&lt;p&gt;在色球层外部的约 $100\unit{km}$ 的区域（过渡区），气体温度急剧上升，在此区域之上是太阳大气的最外层日冕，密度低，温度极高（百万 $\unit K$），延伸至 ${\sim}10$ 倍太阳半径。&lt;/p&gt;
&lt;p&gt;太阳活动：&lt;strong&gt;太阳黑子&lt;/strong&gt;、&lt;strong&gt;日珥&lt;/strong&gt;、&lt;strong&gt;太阳耀斑&lt;/strong&gt;、&lt;strong&gt;拱形冕环&lt;/strong&gt;。和磁场有关。由于太阳是等离子体，故变化的电场产生磁场，导致复杂的太阳磁场结构。另外，太阳存在较差自转（不同纬度，不同深度转动角速度都不同），以及对流，因此磁场被扭曲，产生这些“不稳定”的现象。&lt;/p&gt;
&lt;p&gt;太阳黑子温度也没那么低（可以用 $F\propto T^4$ 算）。它的大小可以达到地球直径的数十倍。太阳光谱观测表明太阳黑子磁场很强（塞曼效应）。磁场垂直进出的地方出现黑子，这种地方和附近的等离子体无法对流，温度变低。太阳黑子经常成对出现，每对黑子皆有在太阳表面上方的拱形磁力线相连，体现为冕环。两个黑子磁场方向相反，南北半球黑子极性相反。黑子寿命 $&amp;lt;11$ 天。日珥也是磁场的体现。总之可以认为表面等离子体的纹理反映磁感线（&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;太阳黑子.jpg&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;太阳耀斑：&lt;strong&gt;最剧烈&lt;/strong&gt;的太阳活动形式，一次喷发的磁能与日珥相当（但是耀斑时间短，日珥时间长），喷出速度极快。&lt;/p&gt;
&lt;p&gt;日珥和耀斑由磁重联造成。&lt;/p&gt;
&lt;p&gt;日珥和耀斑的&lt;strong&gt;日冕物质抛射&lt;/strong&gt;到地球大气形成极光。日冕物质抛射一般都需要日珥和耀斑，但日珥和耀斑不一定有日冕物质抛射。喷射的东西包括磁能、高能射线、热等离子体。&lt;/p&gt;
&lt;p&gt;最有名：1859 年的卡林顿事件。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;太阳风&lt;/strong&gt;相对温和，持续，它是由磁场指向外部的冕洞（几乎无高能辐射）造成的。&lt;/p&gt;
&lt;p&gt;黑子反映太阳活动强度，$11$ 年周期，两侧黑子越靠近赤道，强度越弱。黑子数最多的年称为太阳峰年。蝴蝶图。太阳磁极每一周期翻转。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Kay7E_14_19ac.jpg&#34; style=&#34;zoom:40%;&#34; /&gt;&lt;/center&gt;
&lt;h3 id=&#34;太阳系中的各行星&#34;&gt;太阳系中的各行星
&lt;/h3&gt;&lt;p&gt;这部分是自学不考内容，主要就是讲各行星的地质特点，可以看 zzh 的博客。&lt;/p&gt;
&lt;h2 id=&#34;恒星&#34;&gt;恒星
&lt;/h2&gt;&lt;h3 id=&#34;一些定量分析的方法&#34;&gt;一些定量分析的方法
&lt;/h3&gt;&lt;p&gt;恒星是一个自引力束缚的气态球。氢的燃烧（核聚变）是恒星的主要阶段，称为&lt;strong&gt;主序&lt;/strong&gt;阶段。&lt;/p&gt;
&lt;p&gt;恒星的&lt;strong&gt;视差&lt;/strong&gt; $p$（小学就学过啦）：在相隔半年时间内，恒星视位置变化的角大小的一半，或者应该说是恒星在天球上最两侧的角差（因为有的半年可能不对，必须是地日连线垂直于日星连线），小到角秒级。&lt;/p&gt;
&lt;p&gt;$1\unit{arcsec}$ 对应的距离为 $1\unit{parsec}$（秒差距），就是 $1\unit{parsec}=d_{\text{地日}}\cdot\cot(1\unit{arcsec})\approx 3.26\unit{ly}$。&lt;/p&gt;
&lt;p&gt;因为 $\cot$ 算起来麻烦，所以考虑近似。$p$ 和 $d$ 在数值上的关系：
$$
d=d_{\text{地日}}\cdot\cot p=d_{\text{地日}}\cdot\cot(1\unit{arcsec})\cdot\frac{\cot p}{\cot(1\unit{arcsec})}\approx 1\unit{parsec}\cdot\frac{\mathrm{arcsec}}{p}
$$
什么？你不知道为什么能这样 $\approx$？
$$
\frac{\cot k\theta}{\cot\theta}=\frac{\tan\theta}{\tan k\theta}=\frac{\theta+\Omicron(\theta^3)}{k\theta+\Omicron(\theta^3)}=\frac{1+\Omicron(\theta^2)}{k+\Omicron(\theta^2)}\sim\frac1k
$$
简而言之，可以写成 $d=1/p$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;视星等：体现视亮度&lt;/strong&gt;。最初制定时分为 $1\sim 6$ 等，$1$ 等最亮，$6$ 等最暗，$1$ 是 $6$ 的 $100$ 倍，也就是一等 $\sqrt[5]{100}\approx 2.512$ 倍。恒星视亮度用视星等表示，即以恒星视亮度的对数来表示。同一颗星，不同波段的视星等不同。&lt;/p&gt;
&lt;p&gt;实际上星等都是小数，还能是负的。如果 $0$ 等星的视亮度为 $b_0$，那么 $m$ 等星的视亮度为
$$
b=b_0{100}^{-m/5}
$$
也可以反推视星等
$$
m=-5\log_{100}\frac{b}{b_0}=-2.5\log_{10}\frac{b}{b_0}
$$
例如从地球上看太阳，$m\approx-26.7$。&lt;/p&gt;
&lt;p&gt;不同观测仪器有不同的可观测最暗星等，比如眼睛是 $6$。&lt;/p&gt;
&lt;p&gt;低光度恒星数量比高光度恒星数量多得多，比太阳光度高的恒星只占总样本的 $20\%$ 这样（而且暗恒星只会发现得越来越多）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;绝对星等：体现光度&lt;/strong&gt;，放在标准距离处的亮度。距离模数 $=$ 视星等 $-$ 绝对星等 体现距离。&lt;/p&gt;
&lt;p&gt;将星放在 $10\unit{parsec}$ 处的视星等，就等于绝对星等。
$$
M=-2.5\log_{10}\frac{L}{4\pi(10\unit{parsec})^2b_0}
$$
&lt;strong&gt;距离模数&lt;/strong&gt;通过光度和视亮度给出距离：
$$
m-M=-2.5\log_{10}\frac{b\cdot4\pi(10\unit{parsec})^2}{L}=-2.5\log_{10}\frac{\frac{L}{4\pi d^2}4\pi(10\unit{parsec})^2}{L}=5\log_{10}\frac{d}{10\unit{parsec}}
$$
所以从数值上来说（$d$ 单位 $\mathrm{parsec}$）
$$
m-M=5\log_{10}d-5
$$
分析恒星的表面温度固然可以分析光谱，但更简单的方法是直接用两个窄波段滤光片，看这两个波段的亮度的比值得到温度。这两个波段的视（无所谓）星等之差，被称为&lt;strong&gt;色指数&lt;/strong&gt;。定性地看，表面温度越高，色指数越小。色指数与温度没有简单的比例关系，只能用 &lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Color_index&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Ballesteros&amp;rsquo; formula&lt;/a&gt; 近似。&lt;/p&gt;
&lt;p&gt;所以，要确定一颗星的半径，实操上可以用以下方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过周年视差 $p$ 确定距离 $d$。&lt;/li&gt;
&lt;li&gt;测得视亮度 $B$，求得光度 $L=4\pi d^2B$。&lt;/li&gt;
&lt;li&gt;测得色指数 $B\text{-}\!V$ 确定温度 $T$。&lt;/li&gt;
&lt;li&gt;$R^2=L/4\pi\sigma T^4$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;双星系统的推导等下学期普物一，这里就记两个公式：一个是，轨道半径（周长）与质量成反比，一个是开普勒第三定律
$$
T^2=\frac{4\pi^2A^3}{G(m_1+m_2)}
$$
实际应用时，
$$
\frac{m_1+m_2}{M_{\odot}}=\frac{A_{\rm AU}^3}{T_{\rm years}^2}
$$
根据发现的方法，&lt;strong&gt;双星分为四类&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;目视双星。离地球较近或两星距离较远，可以直接观测位置来分析。&lt;/li&gt;
&lt;li&gt;分光双星。虽然无法直接区分两星，通过分析光谱可以发现两组多普勒效应偏移相反的谱线，就可以确定是双星。通过得到的视向速度（多普勒速度）曲线，可以得到周期、轨道半径等。考试题应该都会假设地球在其轨道平面上。如果速度关于时间轴对称（$\max=-\min$），那么就是圆轨道（但是我感觉椭圆轨道也可能这样啊……）。这种曲线图要会读，可能会考。&lt;/li&gt;
&lt;li&gt;食双星。其关键是，当地球和两星共线时，视亮度会降低。降低程度取决于哪颗在前，因此有主食和次食。&lt;/li&gt;
&lt;li&gt;天体测量双星。如果一颗星似乎绕着空的位置在转，就意味着可能存在另一颗没观测到的星。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;光谱型&lt;/strong&gt;：从热到冷 $\rm OBAFGKM$，每个内部又有 $0\sim 9$ 级。一开始是按照氢的谱线分类的。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Kay7E_13_07.jpg&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;h3 id=&#34;赫茨普龙罗素图&#34;&gt;赫茨普龙—罗素图
&lt;/h3&gt;&lt;p&gt;赫—罗图：横坐标是温度，纵坐标是光度，都是对数坐标。由于
$$
\log R=\frac12\log L-2\log T+C
$$
因此在图上，等半径线是斜率为正的直线（$T$ 反过来了）&lt;/p&gt;
&lt;img src=&#34;Kay7E_13_15.jpg&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;有 $90\%$ 的恒星（主序星）位于主序带上，它们就是处于氢燃烧阶段。它们处于主序带的哪里，取决于它们的质量。太阳是 $\rm G2V$，$\rm V$ 表示主序。&lt;/p&gt;
&lt;p&gt;这张图一个有用的东西是，原来测一个主序星的半径，需要先测距离，但是太远的话视差就太小了。现在只需分析光谱得到温度，就可以直接推得光度和半径，还能反推距离。当然这个关系的参数需要一些已知的近邻恒星样本。这个叫第一类标准烛光法，或分光视差法。&lt;/p&gt;
&lt;p&gt;质量也可以推：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Kay7E_13_17.jpg&#34; style=&#34;zoom:35%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;质光关系 $L\propto M^{3.5}$，半径 $R\propto M^{0.8}$。&lt;/p&gt;
&lt;p&gt;主序恒星只需要温度就可以确定了，非主序恒星仍需要光度，光度不好测，还是只能分析光谱。比如巨星大气压力小，故谱线宽度宽。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;主序恒星揭示恒星的属性及运行机制。&lt;/li&gt;
&lt;li&gt;非主序恒星揭示恒星如何形成、演化及消亡。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实在太远的恒星，光太微弱了，观测得利用引力透镜。&lt;/p&gt;
&lt;h3 id=&#34;星际介质与恒星形成&#34;&gt;星际介质与恒星形成
&lt;/h3&gt;&lt;p&gt;恒星总是一批批形成，也就是星团。在星团里，$d$、化学成分基本都一样，所以研究时只需关心质量。&lt;/p&gt;
&lt;p&gt;星系内的恒星仅占据很小的空间。星系内的空间叫做&lt;strong&gt;星际空间&lt;/strong&gt;（星系间的就是星系际空间），充满了&lt;strong&gt;星际介质&lt;/strong&gt;，$\sim90\%$ 是氢，$\sim10\%$ 是氦，极少数是重元素，这些气体称为&lt;strong&gt;星际气体&lt;/strong&gt;。星际介质非常稀薄，但相对整个宇宙的平均水平又高些。星际介质中 $\sim1\%$ 质量的物质是称为&lt;strong&gt;星际尘埃&lt;/strong&gt;的固体颗粒，这些颗粒也很小，最多跟紫外线波长差不多。&lt;/p&gt;
&lt;p&gt;在致密、冷的环境中，尘埃会粘合在一起，还可吸附其它的原子和分子。&lt;/p&gt;
&lt;p&gt;星际尘埃会导致尘埃效果/&lt;strong&gt;星际消光&lt;/strong&gt;（散射 + 吸收），影响观测。在可见光波段附近，波长越长，消光效果越弱（船喻）。所以，看到的星光偏暗、偏红——星际红化。所以需要修正。&lt;/p&gt;
&lt;p&gt;既然星际尘埃也会吸收光，所以它也有黑体辐射，反正就是温度比较低，主要在红外波段。&lt;/p&gt;
&lt;p&gt;大约一半的星际介质集中在 $\sim2\%$ 的星际空间中，这些相对致密的区域称为&lt;strong&gt;星际云&lt;/strong&gt;，其余的被称作&lt;strong&gt;云际气体&lt;/strong&gt;。越热的星际气体越少。炽热的云际气体主要是被近邻的超新星爆炸加热产生。&lt;/p&gt;
&lt;p&gt;氢：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;H II。星际云，恒星形成。&lt;/li&gt;
&lt;li&gt;H-α。云际气体产生的最强的可见光谱线。&lt;/li&gt;
&lt;li&gt;中性氢，产生 $21$ 厘米辐射，不受尘埃影响，有利于研究银河系的结构。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;H II 区是被大质量、炽热、极亮的 $\rm O$ 型和 $\rm B$ 型恒星的强烈紫外辐射所电离的相对致密的星际云。在星际云最致密的核心区，分子可以存活。这些暗云被称为&lt;strong&gt;分子云&lt;/strong&gt;，是恒星形成的场所。这些地方温度反而是低的，才能使分子稳定。说密，它密度也超不过我们抽的真空中剩余的分子密度。分子发射线（射电、红外）是分子（云）的指纹。分子云仅占银河系星际空间的 $\sim0.1\%$。最大的分子云称为巨分子云。&lt;/p&gt;
&lt;p&gt;分子云里除了 H，还有 CO 和少量有机物。&lt;/p&gt;
&lt;p&gt;可见光波段的暗斑的轮廓体现了分子云的轮廓（全被致密的尘埃吸收了），从红外波段看就可以透过看。分子的射电辐射不受星际尘埃的影响，是研究最致密最不透明的分子云的核心的窗口。&lt;/p&gt;
&lt;p&gt;分子云的自引力比向外的压力小很多，但因为周围有更热的云际气体，所以就使它维持着不扩散。如果分子云质量足够大、足够致密、足够冷，其自引力就会相对于压力更显著，才会发生引力坍缩。一旦开始坍缩，就会越来越快。坍缩是不均匀的，所以分子云会裂变成多个&lt;strong&gt;分子云核&lt;/strong&gt;（因此会有很多星团，一堆在一起的恒星）。分子云核中心坍缩比外层坍缩快，中心与外层分离，然后后面就是和太阳类似的故事，原恒星，吸积盘……&lt;/p&gt;
&lt;p&gt;把原恒星和其最终形成的恒星比较。&lt;strong&gt;原恒星比恒星大很多、亮很多&lt;/strong&gt;，但表面温度低（辐射红外），还在为氢聚变积累温度。坍缩是缺乏能量的体现。这个时候中心其实是有聚变的（氘（产生于大爆炸，只消耗不产生）和氕聚变成氦 3，但温度还是小于氢聚变所需的温度 $\sim10^7\unit K$），中心核发生对流，暂时阻止气体下落。等氘耗尽后，继续加速下落。等到足够小，密度足够大，温度足够高时，氢聚变开始，不再坍缩，结构稳定后，进入主序阶段。&lt;/p&gt;
&lt;p&gt;褐矮星是质量过小使温度不足以使核聚变发生的情况，情况介于木星和太阳之间。就一直发射红外波段的光。温度从高到低分为 $\rm LTY$ 型（接在光谱型那个后面）。&lt;/p&gt;
&lt;p&gt;小质量原恒星收缩时，内部变热，但其表面温度基本维持不变（负氢离子理论），于是光度下降。我们可以在赫—罗图上画出原恒星变成恒星时物理量的变化，称为&lt;strong&gt;演化程&lt;/strong&gt;。&lt;/p&gt;
&lt;img src=&#34;Kay7E_15_22ab.jpg&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;&lt;strong&gt;林忠四郎线&lt;/strong&gt;特指原恒星到主序恒星的这一族演化程。&lt;/p&gt;
&lt;p&gt;原恒星的喷流（还有星风、外向流）驱散分子云核与吸积盘，终止物质流入原恒星。原恒星的喷流是最菜的。喷流撞击到星际介质，加热星际气体（弓形激波）产生发光的气体结，称为 HH 天体。创生之柱的红外波段照片中的柱子里的红色点点就是这个东西。&lt;/p&gt;
&lt;p&gt;太阳形成需时大约三千万年。&lt;/p&gt;
&lt;p&gt;在主序阶段缓慢燃烧的过程中，恒星在赫罗图上向左上移动，光度增加，表面温度降低（为什么我查到有些说温度也升高？），半径变大。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;质量越大，恒星的主序寿命越短&lt;/strong&gt;（原恒星的寿命也最短）。具体的定量关系没法给出。对于与太阳性质相似的恒星：
$$
\tau_{\text{MS}}=10^{10}\unit{y}\cdot\frac{M/M_\odot}{L/L_\odot}
$$
根据质光关系，
$$
\tau_{\text{MS}}\propto M^{-2.5}
$$
氦与氢的比，离中心越近越大，主序阶段燃烧越后越大。当核心的氢越来越少，核心压力就减小（氦目前可不会燃烧（聚变），它需要高得多的温度），开始坍缩，这会导致中心燃烧效率增加，压力增加，外部就膨胀了。核心的氢尚未耗尽时，这一过程是缓慢的（基本稳定），等到完全耗尽了变成红巨星的过程就快了。所以现在整个的情况就是，核心收缩，外部扩张。十亿年后，地球已不宜居。&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;postMS.png&#34; style=&#34;zoom:80%;&#34; /&gt;&lt;figcaption&gt;&lt;a href=&#34;https://www.researchgate.net/figure/Post-main-sequence-evolutionary-track-of-different-stellar-masses-Data-for-the-plot_fig3_309727000&#34;&gt;来源&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;
&lt;h3 id=&#34;主序阶段之后小质量恒星&#34;&gt;主序阶段之后——小质量恒星
&lt;/h3&gt;&lt;p&gt;当核反应区的中心一块很小的区域的氢彻底烧完后，这部分再坍缩也没法促进燃烧了。所以氦核会不断坍缩，坍缩至&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Degenerate_matter&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;电子简并状态&lt;/a&gt;（？？都说了是氦核，为啥会有电子？），会提供电子简并压力抵抗引力。所以现在分成三个区域——简并态的氦、氢壳层（也属于核反应区，还在燃烧）、氢包层。既然氦坍缩了，氢壳层就会缩小，引力增加，燃烧加快。所以还是接着，光度增加、温度降低、半径变大。氦核质量增加和氢壳层燃烧加快互相促进，是一个滚雪球的过程。&lt;/p&gt;
&lt;p&gt;恒星脱离主序后的第一个阶段称为&lt;strong&gt;亚巨星&lt;/strong&gt;，表面温度下降。当温度下降一些后，又由于负氢离子理论，温度又开始维持，但继续变大变亮，这个是&lt;strong&gt;红巨星&lt;/strong&gt;阶段。&lt;/p&gt;
&lt;p&gt;虽然表面温度变低再不变，但氦核区的温度是持续升高的。当温度到一亿 $\mathrm{K}$ 左右时，开始氦核聚变，也称为 3α 过程（He→Be→C）。简并物质是很好的热导体，一旦氦核的中心开始燃烧，整个氦核一下子就被“点燃”了。但是由于热压相比电子简并压力可以忽略不计，故氦核几乎不膨胀。于是温度升高与燃烧互相促进，所以说简并氦核的燃烧是失控的，称为&lt;strong&gt;氦闪&lt;/strong&gt;。当然最后热压会大到超过电子简并压力，起主导作用，导致氦核内爆，膨胀冷却，电子简并很快被解除。氦闪从外面是看不出的。氦闪这个过程时间很短，只有几小时。氦闪后，氦核和氢壳层的引力减弱，压力减小，导致核反应率明显降低，表面明显变暗，但是实际上温度升高（我也不知道为啥），称为&lt;strong&gt;水平支&lt;/strong&gt;恒星。&lt;/p&gt;
&lt;p&gt;这个状态又会稳定一段时间，同时进行氢和氦的燃烧，但相对主序阶段短很多。离开水平支阶段，也就是碳核开始坍缩至电子简并态，进入&lt;strong&gt;渐近巨星支&lt;/strong&gt;阶段，再次变大变亮但变暗，同样可能发生碳闪。太阳由于质量不够，无法达到碳核聚变的温度。&lt;/p&gt;
&lt;p&gt;随着恒星膨胀得越来越大，导致其外层的逃逸速度越来越小，外层物质越来越容易逃逸到星际空间。于是恒星就慢慢只剩下了碳核、氦燃烧壳层、氢燃烧壳层了，光度依然很高，温度开始越来越高，这个阶段称为&lt;strong&gt;后渐近巨星&lt;/strong&gt;。现在的温度足以辐射紫外波段的光，它会加热并电离被抛射出的气体，使气体电离发光，形成&lt;strong&gt;行星状星云&lt;/strong&gt;（和行星半毛钱关系都没有）。最后燃烧完了，碳核就变成&lt;strong&gt;白矮星&lt;/strong&gt;了，质量约为原来恒星的 $\sim70\%$。当然球表面还是有氦的，碳会和氦聚变形成氧，太阳未来会变成碳—氧白矮星，碳核收缩为大小在地球这样，压力与引力平衡，不再变小，只是还在往外辐射能量。最后没东西辐射了就变成&lt;strong&gt;黑矮星&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;如果太阳质量损失量比较大，地球的轨道就会外移，继续围绕那时的太阳公转；否则地球会因与气体的摩擦降低速度，坠入太阳中心，这会使太阳短暂地变大变亮。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Kay7E_16_14.jpg&#34;
	width=&#34;2448&#34;
	height=&#34;2003&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;122&#34;
		data-flex-basis=&#34;293px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;主序阶段之后大质量恒星&#34;&gt;主序阶段之后——大质量恒星
&lt;/h3&gt;&lt;p&gt;大质量恒星的主序阶段氢燃烧以碳氮氧循环为主。&lt;/p&gt;
&lt;p&gt;即便在主序阶段，高辐射压导致大质量恒星猛烈地抛射其外层物质，产生高速星风，显著影响恒星的演化。&lt;/p&gt;
&lt;p&gt;由于质量大，温度在氦、碳进入电子简并状态前就已经达到对应的核聚变温度了，因此不发生简并，核燃烧由一种元素平稳过渡到另一种元素。元素越重，燃烧的持续时间越短。大质量恒星在脱离主序带之后被称为&lt;strong&gt;红超巨星&lt;/strong&gt;。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Kay7E_17_04.jpg&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;许多红超巨星都是变星。恒星在赫罗图上形成&lt;strong&gt;不稳定带&lt;/strong&gt;，周期性交替膨胀与收缩，引起其光度和颜色（表面温度）相应改变，这样的变星称为&lt;strong&gt;脉动变星&lt;/strong&gt;。这种周期性变化的原因很复杂，主要是跟氦的电离与复合有关。详见 &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/61799031/answer/3481304995&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/61799031/answer/3481304995&lt;/a&gt;。在变动的过程中，是小热亮↔大冷暗。脉冲变星有很多类，代表性的有 I 型造父变星（黄超巨星）、II 型造父变星（小、水平支）、天琴 RR 型变星（小、水平支）。每一类都有一个周光关系（都是光度与周期正相关）。也就是说，只要观测出周期，就可以得到光度，从而这个变星可以作为标准烛光。&lt;/p&gt;
&lt;p&gt;铁核永远不会燃烧，这是因为铁原子的结合能最大。铁聚变要吸收能量，这是做不到的。铁核会坍缩，也会进入电子简并态。但电子简并压力也抗衡不了引力，还会继续坍缩。坍缩的能量会被消耗掉，加速坍缩。当铁核内部坍缩到原子核与原子核之间紧挨在一起时，坍缩终止，外部仍然在坍缩，就会撞击在内核上反弹。中微子会造成一个气泡，和反弹共同，形成向外的激波。这个激波就造成&lt;strong&gt;超新星爆炸&lt;/strong&gt;。爆炸产生膨胀的尘埃气体云，核以中子星（中子简并压维持）的形式遗留，如果质量再大，连中子简并压力都不足以对抗引力，就会变成黑洞。&lt;/p&gt;
&lt;p&gt;以这种原理产生的超新星爆炸根据恒星质量从小到大分为 &lt;strong&gt;II 型&lt;/strong&gt;、&lt;strong&gt;Ib 型&lt;/strong&gt;、&lt;strong&gt;Ic 型&lt;/strong&gt;，这个是根据观测到的光谱分的，而光谱取决于外层的氢和氦是否已经被剥离。II 型有 H，Ib 型有 He，Ic 型没 He。&lt;/p&gt;
&lt;h3 id=&#34;致密星&#34;&gt;致密星
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;白矮星&lt;/strong&gt;：由 $&amp;lt;8\sim 9M_\odot$ 的恒星演化而来（例如太阳最后会变成 $\sim 0.5M_\odot$ 的白矮星），半径跟地球差不多，因此密度很高，自转周期也很短。&lt;strong&gt;在同一温度下，白矮星的质量越小，半径越大，光度越高。&lt;strong&gt;具体来说，$R\propto M^{-1/3}$。同一白矮星半径&lt;/strong&gt;不会&lt;/strong&gt;显著变化。球状星团中的白矮星多。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;中子星&lt;/strong&gt;：超过钱德拉塞卡极限后，不断坍缩，电子速度会接近光速，质子和电子结合“逆衰变”为中子。原子核瓦解，整个星体变为中子海洋，中子简并压力抗衡引力。半径只有几十公里，密度比白矮星大很多，表面温度在刚形成时很高（但会很快耗散）。自转周期是毫秒级。根据广义相对论，中子星上的时间比地球慢（中子星表面已经有很明显的相对论效应了）。同样，中子星质量越大，半径越小，它的质量极限称为&lt;strong&gt;奥本海默极限&lt;/strong&gt;，不确定，$\sim 3M_\odot$。&lt;/p&gt;
&lt;p&gt;中子星的类别：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;脉冲星（注意与脉冲变星区分！）。一些中子星会在磁轴发射电磁波，而磁轴与自转轴不共线，所以如果从地球能观测到，那周期就是中子星的自转周期。脉冲周期很稳定。&lt;/li&gt;
&lt;li&gt;磁陀星。就是磁场很强的中子星。快速射电暴可能来源于它。&lt;/li&gt;
&lt;li&gt;一般的中子星。&lt;/li&gt;
&lt;li&gt;夸克星。质量较大的中子星，核心处夸克都变成自由的了。是一种假说的中子星。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;虽说中子星在形成时表面温度很高，但半径太小了，没法借助黑体辐射观测。发现中子星的方式是观察周期性变化的电磁波，也就是“脉冲”。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;黑洞&lt;/strong&gt;：由质量 $&amp;gt;\sim 20M_\odot$ 的恒星演化而来。任何力都不足以抵抗引力，另一个表述是，表面的逃逸速度超过光速，即 $\sqrt{2GM/R}&amp;gt;c$。这个式子如果以 $R$ 作为未知数，得到 $R=2GM/c^2$ 称为&lt;strong&gt;引力半径&lt;/strong&gt;或&lt;strong&gt;史瓦西半径&lt;/strong&gt;。黑洞只有质量、角动量和电荷三个量，这称为黑洞无（三）毛定理。黑洞的平均密度
$$
\rho=\frac{M}{\frac43\pi R^3}=\frac{M}{\frac43\pi\frac{8G^3M^3}{c^6}}=\frac{3c^6}{32\pi G^3M^2}
$$
这个结果和白矮星、中子星的“质量越大半径越小”是反的，因为黑洞没法再坍缩了。当然实际上黑洞的所有质量集中在奇点。&lt;/p&gt;
&lt;p&gt;黑洞分为史瓦西黑洞（不旋转，不带电）、R–N 黑洞（不旋转，带电）、克尔黑洞（旋转，不带电）、克尔—纽曼黑洞（旋转，带电）。&lt;/p&gt;
&lt;p&gt;黑洞附近的光会被弯曲。黑洞的视界是指光能否逃逸的分界。对于史瓦西黑洞，引力半径等于视界半径；克尔黑洞有外视界和静界两个界，两者之间是能层，在能层不能保持静止，但可以逃离黑洞。黑洞的视界是单向的，在内部的事件无法对外部产生影响，在内部的时间对外部来说是静止的，视界处引力红移无限大，在内部的东西无法到外部来（尽管逃逸速度是指中途不加速的最大初速度，但即使在视界内向外走有燃料也是走不出来的，具体原因要用广相解释，&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/37872558&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;科普文章&lt;/a&gt;）。黑洞的潮汐力会将进入它的物体撕碎。质量越大，视界处潮汐力越小。&lt;/p&gt;
&lt;p&gt;克尔黑洞看起来很有意思。&lt;/p&gt;
&lt;p&gt;如果太阳系的某个天体突然变成黑洞，它只会对附近的物质产生影响，质量不变，可以认为它是&lt;strong&gt;等效&lt;/strong&gt;于原来的天体的。&lt;/p&gt;
&lt;h3 id=&#34;致密星的演化&#34;&gt;致密星的演化
&lt;/h3&gt;&lt;p&gt;如果是单个孤立的致密星，白矮星和中子星会逐渐冷却（需要极长时间，$138$ 亿年内还不足以使白矮星或中子星冷却到较低温度，目前已知白矮星最低 $3000\unit{K}$ 不到，中子星最低 $42000\unit{K}$ 不到），白矮星最终变为黑矮星。它们的简并态都会维持。&lt;/p&gt;
&lt;p&gt;黑洞会有&lt;strong&gt;霍金辐射&lt;/strong&gt;，具体原理我也不知道。辐射与质量成反比：
$$
T=\frac{hc^3}{8\pi GkM}
$$
因此黑洞会慢慢蒸发，寿命与质量平方成正比。&lt;/p&gt;
&lt;p&gt;双星系统的情况就很不一样，最后都会并合。两个白矮星、中子星、黑洞并合的时候都会释放&lt;strong&gt;引力波&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;小质量双星的演化：&lt;strong&gt;洛希瓣&lt;/strong&gt;是一个恒星引力影响范围的边界。双星中质量较大的，先离开主序阶段，在膨胀超过洛希瓣后，其物质会被另一个星吸收，使另一颗星演化加快。前者最终变成白矮星，另一颗星随后膨胀，就反过来吸。这一吸的过程主要是氢下落到白矮星（仍有角动量）的吸积盘，同时引力势能转化为热能（数十万 $\text{K}$），发出以紫外波段为主的辐射，这个叫&lt;strong&gt;激变变星&lt;/strong&gt;。在吸积的过程中，氢一直在白矮星的表面堆积，实际上因为白矮星是简并态，所以它反而会收缩，所以温度越来越高。当温度足以使氢核聚变时，会突然爆发，造成&lt;strong&gt;新星&lt;/strong&gt;。多次新星称为&lt;strong&gt;再发新星&lt;/strong&gt;。新星现象不会摧毁白矮星，反而会使白矮星质量增加。当白矮星的质量接近 $1.4M_\odot$ 时才会摧毁，这个称为 &lt;strong&gt;Ia 型&lt;/strong&gt;超新星爆炸。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;钱德拉塞卡极限&lt;/strong&gt;：当白矮星质量增加时，电子简并压力增加（受相对论效应影响，$\propto M^{4/3}$）比引力增加（$\propto M^2$）慢。超过这个极限，无论怎样坍缩，电子简并压力都无法克服引力。&lt;/p&gt;
&lt;p&gt;关于 Ia 型超新星爆炸的细节：其本质是在接近钱德拉塞卡极限时，温度升高足以使碳核聚变，然后发生失控核聚变，整个炸掉。实际上这个质量会在 $1.38M_\odot$（不同类型的白矮星略有不同）。不可能出现达到钱德拉塞卡极限然后温和地坍缩成中子星。&lt;strong&gt;Ia 型超新星爆炸不会留下任何核心&lt;/strong&gt;，只剩下超新星遗迹。中子星和黑洞只能通过其他几种超新星爆炸产生。&lt;/p&gt;
&lt;p&gt;如果吸积不足以使这颗白矮星爆炸，就会剩下白矮星双星。它们互相公转会辐射（可观量的）引力波，角动量减小，最后会合并，同样产生 Ia 型爆炸（如果和小于 $1.4M_\odot$ 就合并成一颗白矮星）。&lt;/p&gt;
&lt;p&gt;由于 Ia 型爆炸的光度一般都比较固定，所以也能当标准烛光。&lt;/p&gt;
&lt;p&gt;宇宙中的铁主要来自 Ia 型爆炸。&lt;/p&gt;
&lt;p&gt;超新星的命名是 SN + 年份 + 字母编号（同 Excel 列）。&lt;/p&gt;
&lt;p&gt;超新星爆炸的主要能量释放途径是中微子。&lt;/p&gt;
&lt;p&gt;超新星爆发所抛出的大量物质在向外运动膨胀过程中与星际物质和磁场相互作用而形成的气体星云，形成&lt;strong&gt;超新星遗迹&lt;/strong&gt;（注意与行星状星云区分），是包括 X 射线在内的高能辐射源，这就是宇宙射线的起源。&lt;/p&gt;
&lt;p&gt;许多中子星也都不是孤立的。中子星双星通过脉冲周期的周期性变化发现，同样双星也会释放引力波，逐渐靠近，最后合并，一般都会成为黑洞。&lt;/p&gt;
&lt;p&gt;黑洞有两类，X 射线双星系统中的&lt;strong&gt;恒星级质量黑洞&lt;/strong&gt;和星系中心的&lt;strong&gt;超大质量黑洞&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;中子星和黑洞的转轴方向都有喷流，是由弯曲的&lt;strong&gt;磁场&lt;/strong&gt;导致的。这个喷流叫&lt;strong&gt;相对论喷流&lt;/strong&gt;，因为速度很快。不同级别的黑洞喷流的长度级别也不一样。&lt;/p&gt;
&lt;p&gt;寻找恒星级黑洞，一般是寻找 X 射线双星。X 射线是怎么产生的呢？伴星的物质被黑洞吸积时，引力势能转化为内能，可以达到百万 $\text{K}$，发出的黑体辐射是 X 射线波段的。辐射的功率为
$$
L=\frac{GM\dot M}{r}=\eta\dot Mc^2,\,\eta=\frac{GM}{rc^2}
$$
其实很简单，就是引力势能的表达式（从伴星吸积的那个 $1/R$ 忽略），$M$ 表示黑洞的质量，$\dot{M}$ 表示吸积的质量效率，$r$ 表示吸积盘到中心的距离。化成后面这个式子就是为了长得像质能方程。$\eta$ 称为能量转换效率。代入史瓦西半径，黑洞的 $\eta&amp;lt;50\%$。&lt;/p&gt;
&lt;p&gt;黑洞的发出的 X 射线是快速变化的（没仔细讲，我猜就是一下子吸了一堆？），因此如果观测到 X 射线峰，可以通过其时长推得黑洞的半径上限（近地球的一侧和垂直侧的距离（远地球一侧会被遮住），就是时长乘光速）。同时通过分析视向速度曲线可以得到质量。那么这样就可以确定是否是黑洞及其属性。典型例子：&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Cygnus_X-1&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;天鹅座 X-1&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;黑洞是宇宙中最亮的。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;伽马射线暴&lt;/strong&gt;：短时间观测到大量伽马射线。产生机制是大质量恒星坍缩为中子星或黑洞（长爆），或者中子星与中子星、中子星与黑洞合并（短爆）。&lt;strong&gt;双黑洞合并不产生&lt;/strong&gt;。喷流的物质与喷流的物质相撞产生的内部激波是伽马射线，而喷流的物质与星际物质相撞产生的外部激波，和超新星遗迹一样，产生的是 X 射线及以下的辐射。&lt;/p&gt;
&lt;p&gt;如果较近的伽马射线暴的喷流指向地球，会有&lt;strong&gt;相对论聚束效应&lt;/strong&gt;，对地球产生较大影响。&lt;/p&gt;
&lt;p&gt;伽马射线暴和引力波的同时被观测验证了合并现象。&lt;/p&gt;
&lt;h2 id=&#34;星团与星系&#34;&gt;星团与星系
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;疏散星团年轻，球状星团年老&lt;/strong&gt;，原因可以简单理解为，疏散星团引力不强，容易散开。如何得到一个星团的寿命？看这个星团的赫罗图上恰好进入或离开主序带的星，根据寿命与光度的关系推。&lt;/p&gt;
&lt;h3 id=&#34;银河系&#34;&gt;银河系
&lt;/h3&gt;&lt;h4 id=&#34;银河系的结构&#34;&gt;银河系的结构
&lt;/h4&gt;&lt;p&gt;因为太阳系处在银河系之中，所以银河系本身的结构难以以可见光观测得到（有星际消光）。漩涡结构是通过中性氢 21 厘米射电辐射观测到的，棒旋星系结构是通过红外波段观测。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;Milky_Way_side_view.png&#34; style=&#34;zoom:10%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;这是银河系的结构，主要有几个部分：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;银心 &amp;amp; 核球。银心有个超大质量黑洞，核球处恒星密度很高。&lt;/li&gt;
&lt;li&gt;银盘。俯视来看，银盘分为数条旋臂，最大的四条为英仙臂、人马臂、猎户臂、天鹅臂。平视来看，有薄盘和厚盘。薄盘的恒星密度更高。&lt;/li&gt;
&lt;li&gt;银晕。从内到外分为内晕、外晕和热气体云。&lt;/li&gt;
&lt;li&gt;星团。疏散星团主要分布在银盘内，球状星团主要分布在银晕内，数量较少。&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;银河系中还有大量&lt;strong&gt;暗物质&lt;/strong&gt;。通过观测中性氢的射电的多普勒效应，分析距离银河系中心不同距离处的公转速率（&lt;strong&gt;自转曲线&lt;/strong&gt;），可以得到质量分布。如果只考虑中心天体作为引力源，应该有 $v\propto r^{-1/2}$。但是银河系不太靠中心的部分速度并不随着距离增加而减小，而是速度曲线相对平直，这个称为“较差自转”（我们上面在太阳中物质的转动中也提到过这个概念），我们可以据此预测质量分布。但预测的质量分布与实际的亮物质的分布不符，所以科学家预言暗物质的存在。暗物质主要分布于太阳轨道以外的区域，&lt;strong&gt;主导&lt;/strong&gt;着银河系的总质量，其范围远超亮物质的范围。&lt;/li&gt;
&lt;li&gt;但是如果只考虑较差自转，按说旋臂会消失。解释旋臂图案稳定的理论是&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Density_wave_theory&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;密度波理论&lt;/a&gt;。旋臂并不是大量物质驻留的地方，而是物质密度高的地方（物质一直在移动，类比车流）。旋臂是&lt;strong&gt;少量&lt;/strong&gt;的年轻的大质量、高光度、炽热恒星聚集的表现。&lt;/li&gt;
&lt;li&gt;银河系中心有个大质量黑洞，且恒星聚集。通过高分辨率望远镜观测银心附近的恒星轨道，可以推算黑洞的质量。也偶有观测到中心的黑洞的 X 射线暴——&lt;strong&gt;潮汐瓦解&lt;/strong&gt;事件。偶有，说明黑洞不太活跃。发现的银河系&lt;strong&gt;伽马射线泡&lt;/strong&gt;说明以前黑洞是活跃的。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;银河系中的恒星&#34;&gt;银河系中的恒星
&lt;/h4&gt;&lt;p&gt;这里提一下星族的定义：I 是含金属丰富的恒星（如太阳），II 是金属很少的恒星（如第二代恒星），III 是不含金属的恒星（第一代恒星）。&lt;/p&gt;
&lt;p&gt;银河系中的恒星分为：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;盘族恒星（I），在银盘面中环绕银心转动，比如太阳。相对年轻。&lt;/li&gt;
&lt;li&gt;晕族恒星（II），轨道面方向任意。相对年老。一些晕族恒星的轨道穿越太阳附近的银盘。&lt;/li&gt;
&lt;li&gt;棒族恒星（II）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;上面我们提到了，大爆炸只产生了氢、氦、锂，而重元素是通过红巨星、红超巨星、超新星爆炸、中子星合并产生的。所以我们说，&lt;strong&gt;重元素丰度随星际介质和恒星间的循环而增加&lt;/strong&gt;，一颗恒星中重元素的丰度和其诞生时间是正相关的。于是可以通过分析恒星的光谱知道它的年龄。科学家希望找到含重元素很少很少（甚至没有）的恒星，就是宇宙早期形成的恒星。&lt;/p&gt;
&lt;p&gt;银河系的恒星的年龄分布：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;银晕和核球外层的恒星年老。银晕和核球外层气体含量较少，这些地方恒星形成早已停止。尽管年老，但仍有较少的重元素，并非第一代恒星。&lt;/li&gt;
&lt;li&gt;银盘和核球内层的恒星相对年轻。核球内层气体密度很高，性质与银盘类似，恒星还在一代代持续形成。从银盘内区到外区，气体密度逐渐降低，恒星形成率逐渐降低，重元素丰度逐渐降低。&lt;/li&gt;
&lt;li&gt;形成银盘及其恒星的气体，之前已经历显著的恒星形成。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;本星系群&#34;&gt;本星系群
&lt;/h4&gt;&lt;p&gt;本星系群中主要的星系有：&lt;strong&gt;仙女座&lt;/strong&gt;星系 M31（质量最大，旋涡）、银河系、&lt;strong&gt;三角座&lt;/strong&gt;星系 M33、&lt;strong&gt;大小麦哲伦&lt;/strong&gt;星云（矮星系，其中恒星正在形成）、还有一堆其他的&lt;strong&gt;矮星系&lt;/strong&gt;环绕着主要的星系（像卫星一样，也成为伴星系）。推测：一个巨大的暗物质团块中的气体坍缩成许多原星系。一些原星系并合成为银河系和仙女星系，其他就是矮星系。&lt;/p&gt;
&lt;p&gt;通过比较不同距离（不同年龄）星系的大小、形态、黑洞质量，可以推测星系的并合历史。通过年老恒星可以推测，在并合成银河系之前，已经有恒星形成了。&lt;/p&gt;
&lt;p&gt;银河系未来会与人马座矮星系发生&lt;strong&gt;次并合&lt;/strong&gt;（不影响银河系结构），在之后会和仙女星系&lt;strong&gt;主并合&lt;/strong&gt;（使得并合后变成巨椭圆星系）。&lt;/p&gt;
&lt;h3 id=&#34;星系&#34;&gt;星系
&lt;/h3&gt;&lt;p&gt;星系是由引力束缚的，尘埃、气体、大量恒星组成的集合体。伽利略发现银河由众多恒星组成。以前由于观测能力限制，星系、星团、星云被统一认为成是星云，后来才区分。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/List_of_Messier_objects&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;梅西叶天体列表&lt;/a&gt;（1784）是 110 个经典的天体，包括两类星团、三类星云、星系。其中的天体命名就是 M + 序号，几个经典的要记的有：M1 蟹状星云、M31、M33、M42 猎户座大星云、M45 昴星团（它是疏散星团）。说到这里要巩固一下三类星云的定义区分：弥漫星云就是正常的星际尘埃与气体，就是相对密些罢了，主要成分是氢，可能未来会形成或正在形成恒星，能观测到它们是因为被附近（或其中）的恒星照亮。恒星状星云和超新星遗迹上面有提。&lt;/p&gt;
&lt;p&gt;希望有一天也能自己拍这个列表。&lt;/p&gt;
&lt;p&gt;后面：星云和星团总表（CN，1786）→ 星云和星团总表（GC，1864）→ 星云和星团新总表（NGC，1888）。所以后来就用 NGC + 序号了。&lt;/p&gt;
&lt;h4 id=&#34;星系的哈勃分类&#34;&gt;星系的哈勃分类
&lt;/h4&gt;&lt;center&gt;&lt;img src=&#34;Hubble_Tuning_Fork_diagram.svg&#34; /&gt;&lt;/center&gt;
&lt;p&gt;按照星系在可见光波段的形态分，没有星系演化的意义。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;椭圆星系&lt;/strong&gt;。看起来就是个放射渐变的椭圆形。按照扁率分为 E0~E7 共八类。具体来说，
$$
E=10\left(1-\frac ab\right)
$$
其中 $a$ 是短轴长，$b$ 是长轴长，所以说越扁 $E$ 越大。椭球照理说有三个参数，但关于星系的转轴应该是旋转对称的，所以就只有两个。&lt;/p&gt;
&lt;p&gt;也有一种分类是分巨椭圆星系和矮椭圆星系。&lt;/p&gt;
&lt;p&gt;椭圆星系中的恒星多是年老的小质量恒星，且其不再产生恒星。颜色一般偏红。正常来说不会有尘埃带。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;旋涡星系&lt;/strong&gt;。中间一个核球，周围一个星系盘上有旋臂。分为 Sa、Sb、Sc 三类，按顺序核球变小，旋臂变松、展开。&lt;/p&gt;
&lt;p&gt;棒旋星系。中间恒星聚集成棒状结构，穿过中心，延伸到星系盘。分为 SBa、SBb、SBc 三类，类似。&lt;/p&gt;
&lt;p&gt;这两类星系有星系晕，主要包含年老的小质量恒星。星系盘上的恒星相对较年轻。星系盘上会有尘埃带（遮光）。核球和星系盘偏红，星系盘偏蓝。&lt;/p&gt;
&lt;p&gt;透镜状星系分为 S0 和 SB0，可以理解为没有旋臂的旋涡/棒旋星系。是介于这两者与椭圆星系之间的一类。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;不规则星系&lt;/strong&gt;。无核球，无旋臂，无对称性，记作 Irr（也可以细分 Irr I、Irr II、dIrr），其中多年轻恒星且正在形成恒星。形成原因是被附近星系的引力扭曲。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;几乎所有星系中心都有超大质量黑洞。&lt;/strong&gt;（部分矮星系没有，例如麦哲伦）&lt;/p&gt;
&lt;p&gt;恒星的运动决定星系形态，在椭圆星系以及旋涡/棒旋星系的核球中，恒星的运动方向随机，可能某个平面方向上速度较大些，整个看起来就是扁的。&lt;/p&gt;
&lt;p&gt;银河系是 SBb/SBc，M31 是 SBb，M33 是 Sc，大小麦哲伦是 Irr。&lt;/p&gt;
&lt;h4 id=&#34;星系中的暗物质&#34;&gt;星系中的暗物质
&lt;/h4&gt;&lt;p&gt;暗物质占星系总质量的 $\sim90\%$，范围也比亮物质大，称为暗物质晕。&lt;/p&gt;
&lt;p&gt;旋涡星系的自转速度曲线需要暗物质，椭圆星系的热气体的存在需要暗物质（椭圆星系没法用测量转速来分析，因为其中的恒星轨道不在同一平面上。椭圆星系外围弥散着 X 射线，说明有温度很高的气体，从而知道这些气体的速率很大（why？热运动和正常运动应该是分开的呀），从而推得转速曲线，说明有额外的引力，也就是由暗物质产生）。&lt;/p&gt;
&lt;p&gt;关于暗物质是什么，最主流的观点是 &lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Weakly_interacting_massive_particle&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;WIMPs&lt;/a&gt;。微引力透镜的观测否定了暗物质是 MACHOs 的说法。&lt;/p&gt;
&lt;h3 id=&#34;活动星系核&#34;&gt;活动星系核
&lt;/h3&gt;&lt;p&gt;二十世纪天文四大发现：类星体、脉冲星、宇宙微波背景辐射和星际有机分子。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;类星体&lt;/strong&gt;：非常远的（所以是在宇宙年轻时的），致密的亮射电源，从可见光波段来看，没法放到赫罗图上（因为光度太高了），而且光谱上都是发射线（一般的恒星射电辐射是很弱的，且恒星都是吸收线）通过哈勃红移可以得出（极远的）距离，得到光度极高。观测得到类星体有喷流。那么实际上类星体是星系的剧烈活动的核心——它是活动星系核的一种。&lt;/p&gt;
&lt;p&gt;具有剧烈活动现象的星系称为&lt;strong&gt;活动星系&lt;/strong&gt;，核心不活动的星系称为正常星系或宁静星系，比如银河系。活动星系的分类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;星爆星系&lt;/strong&gt;，剧烈恒星形成。通常是两个星系合并时出现。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;活动星系核&lt;/strong&gt;（AGN），就是中心的大质量黑洞在不断吸物质。活动星系核有高光度、光谱有发射线、快速光变、辐射波段广、高偏振等特点。具体来说，根据辐射在各波段的特征，它具体又分为：
&lt;ul&gt;
&lt;li&gt;类星体。细分为射电噪的和射电宁静的。类星体和其他情况的一个不同点是，它必须要距离很远，或者说红移很大。&lt;/li&gt;
&lt;li&gt;赛弗特星系。注意这个并不是某个特定星系的名称！这个是射电宁静的一类，处于旋涡星系或不规则星系的中心。&lt;/li&gt;
&lt;li&gt;射电星系。处于椭圆星系中。有明显的射电瓣。&lt;/li&gt;
&lt;li&gt;耀变体。能量很高，光度很大，射电噪的。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;更加精确地分析活动星系核，我们从光度和结构来说：&lt;/p&gt;
&lt;p&gt;AGN 的能量来自太阳系大小的区域。这里有个考点是根据光变时标算尺寸：假设黑洞吸积了一堆物质，吸积盘突然发光，那么如果地球在盘所在平面，那么从地球观测到的辐射峰的时长，就是吸积盘的宽度除以光速。当然这个算出的只是一个很松的上限。&lt;/p&gt;
&lt;p&gt;同时 AGN 有非常长直的相对论性喷流，可以达到数千万光年。&lt;/p&gt;
&lt;p&gt;在这么一个小区域内能产生千亿倍太阳光度的辐射，它的辐射压就很大，一定有很大的自引力，也就是很大的质量，才能维持它的稳定。爱丁顿光度 $L_{\text{edd}}\propto M$ 表示对应质量的恒星的最大光度（同时可以推出不存在质量大于约 $100$ 倍太阳质量的恒星）。那么根据测得的数据，可以确定黑洞的质量下限。&lt;/p&gt;
&lt;p&gt;对于不活跃的黑洞，它吸积的效率是很低的。根据光度和能量转换率可以算出，比如说 M87 中心黑洞一年大概吸积半个木星质量。&lt;/p&gt;
&lt;p&gt;从结构上来说，活动星系核可以分为几部分：&lt;strong&gt;黑洞、吸积盘、喷流、宽线区、窄线区、尘埃环&lt;/strong&gt;。宽窄线的意思就是观测到的光谱的发射线宽度不同，这个是因为产生发射线的被电离气体的速度范围不同，靠近中心而速度大的，因为多普勒效应就会使发射线展宽。&lt;/p&gt;
&lt;p&gt;目前公认的说法是，不同种类的 AGN 是与观测夹角不同的，但同样性质的活跃黑洞。因为 AGN 的结构这么复杂，从不同角度看，可能会因为尘埃、和喷流的夹角、相对论效应等，得到很不同的观测结果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Emmaalexander_unified_agn.png&#34;
	width=&#34;968&#34;
	height=&#34;834&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;116&#34;
		data-flex-basis=&#34;278px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;早期（遥远）星系中，AGN 比例要高很多。&lt;/p&gt;
&lt;p&gt;蟹状星云可以作为标准烛光。&lt;/p&gt;
&lt;p&gt;事件视界望远镜（EHT）拍到了 M87 中心的和&lt;b&gt;人马座 A（银河系中心）&lt;/b&gt;黑洞，当一个星系确认黑洞后，其代号后面就会加上星号。&lt;/p&gt;
&lt;p&gt;黑洞的质量测量方法就是观测中心附近的气体、恒星等的运动。&lt;/p&gt;
&lt;h2 id=&#34;宇宙&#34;&gt;宇宙
&lt;/h2&gt;&lt;h3 id=&#34;宇宙的膨胀&#34;&gt;宇宙的膨胀
&lt;/h3&gt;&lt;p&gt;历史：弗里德曼建立宇宙的数学模型，斯莱弗发现宇宙学红移，勒梅特提出大爆炸假说，哈勃发现退行速度与距离成正比。&lt;/p&gt;
&lt;p&gt;宇宙不存在边界，可以类比吹气球的过程。&lt;/p&gt;
&lt;p&gt;宇宙学原理：宇宙是处处一样的，物理定律处处使用。在大尺度上，宇宙是均匀的，各向同性的。宇宙任何地方的“观测者”都应看到相同的宇宙。这个可以通过观测验证——一方面是各个方向的恒星密度均匀，一个就是几乎所有星系都在远离我们。&lt;/p&gt;
&lt;p&gt;接下来我们说的都是不考虑相对论效应的情况，因此不能处理速度太大，距离太远的情况。&lt;/p&gt;
&lt;p&gt;那么既然宇宙是各向同性的，宇宙的膨胀也是各向同性的。这个性质用数学语言描述，就是相对于每个位置的观测者来说，都有
$$
\boldsymbol{v}=k(t)\boldsymbol{r}
$$
远离速度只与当前的时间与距离有关。&lt;/p&gt;
&lt;p&gt;现在我们引入第二个假设，就是等速膨胀——宇宙膨胀速度是不变的（实际早期是减速膨胀的）。这句话的意思是说，取宇宙中的两个点，它们随着膨胀互相远离，远离的速度时时刻刻是一样的。用数学语言来说，假设两点的距离是 $d(t)$，那么
$$
\left\{\begin{aligned}
d(t)&amp;amp;=\int_0^tv(t^\prime)\mathrm{d}t^\prime=\int_0^tk(t^\prime)d(t^\prime)\mathrm{d}t^\prime\\
k(t)d(t)&amp;amp;=C
\end{aligned}\right.
$$&lt;/p&gt;
&lt;p&gt;从而 $d(t)=Ct$，$k(t)=1/t$。也就是说两个点之间的距离关于时间是正比例函数。这就是哈勃定律
$$
v_r=H_0d_G
$$
$H_0$ 就是宇宙年龄的倒数。&lt;/p&gt;
&lt;p&gt;现在我们考虑实际的问题：在观测到一个天体时，我们既不知道它的退行速度，也不知道它的距离，我们只知道它的光谱，可以通过比对几个关键谱线推出宇宙学红移 $z=\Delta\lambda/\lambda$。那么怎么推出现在它的距离呢？上课讲的是，直接用
$$
z=\frac vc,\,d=\frac v{H_0}
$$
来算。但是我们面对的毕竟是空间膨胀而不是简单的远离啊，$z=v/c$ 这事真对吗？所以我想仔细算一遍。&lt;/p&gt;
&lt;p&gt;考虑它发射当前观测到的光时，距离地球 $d_0$，宇宙年龄 $t_0$。以它的发射点为数轴原点，在光以 $c$ 的速度正向移动的同时，空间在膨胀，设光所在位置为 $y$，单单膨胀带给它的速度为 $y/t$。两个速度叠加，得到 $y^\prime=c+y/t$。如果最终在 $t_1$ 时间到达地球，那么 $y|_{t=t_1}=d_0t_1/t_0$。&lt;/p&gt;
&lt;p&gt;先解这个微分方程。齐次解为 $y=Ct$，非齐次解为 $y=ct\ln t+Ct$，代入初始条件得 $y=ct\ln(t/t_0)$。结合另一个方程解得 $t_1=t_0\mathrm{e}^{d_0/ct_0}$。光线到达地球的时候，红移为 $z=t_1/t_0-1$，距离就是 $d_0t_1/t_0$。&lt;/p&gt;
&lt;p&gt;在假定距离不太大，也就是 $d_0/ct_0$ 不太大的情况下，可以用 $\mathrm{e}^x\approx 1+x$ 来估算：$t_1=t_0(1+d_0/ct_0)$，$z=d_0/ct_0$，$d_1=d_0t_1/t_0=zt_1=zct_1=zc/H_0$。嘿，它是对的。也就是说，我们可以通过观测以前发出的光来推断发光的天体现在的距离。&lt;/p&gt;
&lt;p&gt;$z$ 很大的情况，就算用的是不估计的表达式，也会因为相对论问题出错。比如说在一个模型下（Friedmann 方程）：
$$
t=\frac1{H_0}\int_0^{1/(1+z)}\frac{\mathrm{d}a}{a\sqrt{0.3a^{-3}+0.7}}
$$
但无论如何有个东西还是对的，就是 $z=t_1/t_0-1$，或者说在这光发出的时候，宇宙尺度因子（现在是 $1$）是 $R_{\rm U}=1/(1+z)$。&lt;/p&gt;
&lt;p&gt;那现在的问题就是测得哈勃常数 $H_0$。不能选太近的天体，不然&lt;strong&gt;本动速度&lt;/strong&gt;（除去随着膨胀，相对于地球的速度）就会严重影响结果。但太远的本身就不知道距离，怎么办呢？这里有一个距离阶梯的方法：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/Kay7E_19_12.jpg&#34;
	width=&#34;2100&#34;
	height=&#34;1111&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;189&#34;
		data-flex-basis=&#34;453px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;比如说，我们知道造父变星的光度，并发现有一个星系里既有造父变星，又有一个 Ia 超新星，那么就可以得到超新星的光度，从而往更远的推。哈勃当时用的标准烛光是造父变星，测得偏大了很多。&lt;/p&gt;
&lt;h3 id=&#34;宇宙微波背景辐射&#34;&gt;宇宙微波背景辐射
&lt;/h3&gt;&lt;p&gt;热大爆炸宇宙学模型：1948，伽莫夫，αβγ 论文。&lt;/p&gt;
&lt;p&gt;宇宙大爆炸只合成了最轻的元素：氢、氦、锂（宇宙中锂铍硼的丰度很低是因为它们不是核聚变的产物，而是被核聚变消耗）。铁及之前的元素是通过大质量恒星的核聚变出现，比铁重的原子是通过中子俘获 + β 衰变形成，在例如超新星爆炸、中子星并合等事件中。&lt;/p&gt;
&lt;p&gt;宇宙微波背景辐射（CMB）是宇宙大爆炸发生的重要证据。它是能看到的宇宙最早期的辐射。最早由上面的这篇论文预测，后来，1964、65 年由贝尔实验室的几位科学家偶然观测到（最早的好像是苏联的科学家）。&lt;/p&gt;
&lt;p&gt;$38$ 万年之前的信息没法从电磁波角度了解，因为那个时候之前因为原子都被电离了，光子没法自由移动，或者说宇宙对电磁波是不透明的。在那之后，宇宙复合（中性化），温度约三千 $\rm K$。随着宇宙膨胀，温度继续下降。CMB 也随着从伽马射线波段（冷却）到红外波段，再（红移）到微波波段，现在宇宙的平均温度只有个位数 $\rm K$，总体来说，宇宙膨胀了 $1100$ 倍，温度下降了 $1100$ 倍，CMB 波长峰值红移了 $1100$ 倍。&lt;/p&gt;
&lt;p&gt;CMB 的谱需要到太空中观测，COBE 观测得到，它极其完美地符合 $2.73\unit K$ 黑体辐射谱。&lt;/p&gt;
&lt;p&gt;CMB 高度各向同性，但是从地球来看有轻微的不同性，因为地球相对于宇宙空间有一个速度，这就是 CMB 的偶极不对称性。当扣除这部分，以及其他微波辐射源、尘埃消光的影响，发现 CMB 在高度各项同性的基础上有十万分之几的各向异性。（这种各向异性很重要，因为它这种不均匀是形成各种天体的种子）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-astronomy/CMB.jpg&#34;
	width=&#34;256&#34;
	height=&#34;384&#34;
	
	loading=&#34;lazy&#34;
	
		alt=&#34;直接观测结果；消去地球运动影响；消去其他天体影响；&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;66&#34;
		data-flex-basis=&#34;160px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;WMAP 探测器观察的角分辨率更高，把背景辐射的极差提高到了万分之二。后面还有 Planck。这些观测都进一步给出了更精确的哈勃常数以及宇宙中的物质分布比例。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;大爆炸核合成&lt;/strong&gt;的说法，解释了氦的观测得丰度高于恒星核合成的产量对应的预估。在大爆炸后的短时间内，质子碰撞合成轻原子核，这个叫大爆炸（原初）核合成。&lt;/p&gt;
&lt;p&gt;通过数学预测的各元素比例和实测的各元素比例，可以得到宇宙的亮物质（重子）密度。&lt;/p&gt;
&lt;h3 id=&#34;宇宙结构的起源&#34;&gt;宇宙结构的起源
&lt;/h3&gt;&lt;p&gt;我们希望找到宇宙最早的天体发出来的光。&lt;/p&gt;
&lt;p&gt;上面我们提到，星系的形成是因为引力，那么这个引力主要是暗物质。星系也会聚集起来形成&lt;strong&gt;星系群&lt;/strong&gt;或&lt;strong&gt;星系团&lt;/strong&gt;（星系群里星系少，星系团里星系多）。总体来说，矮星系数量远多于巨星系，旋涡星系常见。少部分星系团中，椭圆星系（主要由旋涡星系并合而成）主导。本星系群（银河系、M31、M33、大小麦哲伦）的周围有室女星系团（中心 M87）、后发星系团等，都是形如中心一个椭圆星系，周围一堆旋涡星系。本星系群和室女星系团都（不含后发）属于室女（本）超星系团，中心在室女星系团附近。&lt;/p&gt;
&lt;p&gt;绘制宇宙的大尺度结构，就用哈勃红移算距离。星系不是随机分布，而是组成复杂的网状结构。由星系组成的纤维和“墙”环绕着巨洞。像海绵或者说&lt;strong&gt;泡泡&lt;/strong&gt;的结构。&lt;/p&gt;
&lt;p&gt;暗物质也主导星系团、群的质量。测的方法跟星系内是一样的（看各星系速度、看炽热气体的 X 射线、引力透镜）。&lt;strong&gt;星系团的暗物质先于星系的暗物质被提出。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;宇宙一开始是非常均匀的，其极其微小的“微扰”不均匀性是形成现在复杂星系结构的原因，有个蝴蝶效应在里面。大爆炸后 $38$ 万年到数亿年期间，没有恒星（正在形成），这段时期称为&lt;strong&gt;黑暗时期&lt;/strong&gt;。这段时期的研究是靠观测&lt;strong&gt;中性氢&lt;/strong&gt;的 $21$ 厘米辐射。&lt;/p&gt;
&lt;p&gt;宇宙暴胀时期的量子涨落产生了密度涨落，为星系和星系组合提供了“团块（种子）”，引力不稳定性把宇宙的密度涨落转变为星系。&lt;strong&gt;CMB 各项异性是量子涨落的印记。&lt;strong&gt;目前的说法是，形成的过程是&lt;/strong&gt;自下而上&lt;/strong&gt;等级式成团：小结构先形成，再形成大结构。&lt;/p&gt;
&lt;p&gt;大爆炸宇宙学的标准模型是 ΛCDM 模型，可以通过计算机模拟来研究。它有四个参数：暗能量（Λ）、（冷）暗物质（CDM）、亮物质、哈勃常数。这些参数取不同的值，宇宙的演化情况是不同的，只有特定的参数组合才能导致现在宇宙的大尺度结构。但是无论如何，初始情况不能绝对均匀，得有形成结构的种子，这就靠 CMB 的观测数据得出。亮、暗物质开始于等同的密度涨落（也等同于 CMB），但 $38$ 万年后，亮物质受到辐射压的影响，模糊的程度强于暗物质（暗物质不与辐射互动）。暗物质分&lt;strong&gt;冷暗物质&lt;/strong&gt;（未知基本粒子，质量大、运动慢）和&lt;strong&gt;热暗物质&lt;/strong&gt;（粒子质量轻、运动极快）。热、冷暗物质共同形成最大尺度的结构，&lt;strong&gt;冷暗物质形成星系尺度的结构&lt;/strong&gt;。冷暗物质和亮物质一起坍缩，冷暗物质为亮物质提供引力。当坍缩到一定程度时，暗物质因为无法发出辐射，引力和辐射压就平衡了，无法坍缩，亮物质可以通过辐射失去热量，而逐渐变小。这就是为什么亮物质形成小而扁的星系，而暗物质弥漫在大得多的范围。&lt;/p&gt;
&lt;p&gt;黑暗时期过后（$5.5$ 亿年），第一代恒星开始在在暗物质微晕中形成，原初气体云在一小部分中性氢形成分子氢、冷却气体云后，因压力降低而引力坍缩。因为开始的时候，无重元素，无尘埃，无冷而致密的分子云，只有氢和氦，它们的能级少，不容易通过辐射散热，所以气体云必须足够大才能坍缩，所以就没法形成小质量的恒星。这些大质量的恒星，辐射紫外线，电离周围的气体。它们寿命短，经历超新星爆炸后，结局都是 X 射线双星，黑洞。甚至可能从气体云直接坍缩成黑洞。有说法说，并合的恒星质量黑洞成为星系中心超大质量黑洞的种子。&lt;/p&gt;
&lt;p&gt;第二代有了重元素（当然还是丰度很低），就跟现在差不多了。第二代恒星提供关于第一代恒星的性质与银河系早期的物理条件的线索。根据上面说的自下而上的形成顺序，第一代矮星系和第二代恒星同时形成，其中有些小质量恒星现在仍处于主序阶段，这些在第二轮中首次出现的小质量恒星称为第一代小质量恒星。本星系群里也有大量这个时候形成的超弱矮星系，光度很低，暗物质比例很高，极低金属丰度。在第二代恒星形成后，可能没有再形成恒星。是第一代星系的化石。还有球状星团，球状星团相比矮星系，其中的暗物质密度更低，大小也小。&lt;/p&gt;
&lt;p&gt;早期宇宙更小、星体数量更多、星体更靠近，所以并合更频繁。在大的旋涡星系附近，存在大量矮椭球星系与球状星团，它们可能是大星系由小星系并合而来的证据。越早期的星系，越暗弱、混乱、形状不规则。&lt;/p&gt;
&lt;p&gt;超大质量黑洞的质量与旋涡星系的核球和椭圆星系（整个椭圆星系就可以视为核球）的质量正相关。星系（黑洞）在并合时会触发恒星形成区。恒星形成率在宇宙 $20$ 到 $30$ 亿年时最高。&lt;/p&gt;
&lt;p&gt;两个星系团碰撞时，恒星和暗物质不改变，&lt;strong&gt;热气体会减速&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;韦布望远镜发现，早期星系中规则的星系数量远多于标准模型所预言的。&lt;/p&gt;
&lt;h3 id=&#34;宇宙的未来与极早期&#34;&gt;宇宙的未来与极早期
&lt;/h3&gt;&lt;p&gt;实际上宇宙不是等速膨胀的。&lt;/p&gt;
&lt;p&gt;在没有暗能量的概念时，科学家认为，因为宇宙有质量，就有引力，所以膨胀一定时减速的。那么具体的减速情况就取决于宇宙本身的“逃逸速度”。假设现在宇宙的平均密度为 $\rho$，有个距离地球 $d$ 的天体，它以 $H_0d$ 的速度远离。它所受的指向地球的引力，可以视作半径为 $d$ 的球里面的物质的引力，质量为 $\frac43\pi d^3\rho$。那么逃逸速度为
$$
\sqrt{\frac{2GM}d}=\sqrt{\frac{8\pi Gd^2\rho}3}
$$
能够逃逸的临界情况为
$$
H_0d=\sqrt{\frac{8\pi Gd^2\rho}3}\Longrightarrow\rho=\frac{3H_0^2}{8\pi G}
$$
与 $d$ 无关。也就是说，如果 $\rho$ 小于等于这个值，宇宙就能一直减速膨胀下去，否则最后就会宇宙大收缩。这个临界值称为宇宙的临界密度 $\rho_{\rm c}$。宇宙的物质密度参数定义为
$$
\Omega_{\rm mass}=\frac\rho{\rho_{\rm c}}
$$
其中 $\rho$ 为观测得到的密度。如果 $\Omega_{\rm mass}\le 1$ 就会一直膨胀。实际测得它约为 $0.32$。&lt;/p&gt;
&lt;p&gt;如果宇宙真的是减速膨胀的，那我们通过标准烛光法（实际）和哈勃定律（假定是匀速膨胀）得出来的某个遥远天体的距离会怎样不同呢？&lt;/p&gt;
&lt;p&gt;首先明确标准烛光法测得的是当前的距离而不是发光时的距离，设为 $d$。我们认为 $H_0$ 取的是真实测得的，当前宇宙的膨胀速度比例。设 $z$ 为测得的红移。那么发光时天体与地球的距离比当前的距离就是 $1/(1+z)$，这个前面提过。那就是说，从 $d/(1+z)$ 到 $d$，是通过一个减加速（上凸）的过程，光刚好能传到地球。如果我们用匀速的方法（即 $zc/H_0$）来测，那么就不可能是从 $d/(1+z)$ 到 $d$，因为在匀速的情况下，光因膨胀而“吃到”的减速没有那么多，所以在膨胀到 $d$ 之前就已经到达了地球，这就不对了。解决这个的方法就是增大 $d$。所以匀速模型下测得的结果，如果要自洽，就是距离偏大。&lt;/p&gt;
&lt;p&gt;这个东西老师上课没仔细讲，然后实际上你简单想想很容易觉得，它不应该是减速模型距离偏大吗？这个东西实际上还真没这么简单，你仔细分析，实际上考虑的是这么一个问题：对于微分方程
$$
y^\prime=c+\frac{a^\prime(t)}{a(t)}y
$$
（$a$ 就是尺度因子），其中 $a(0)=1/(1+z)$，$a(t_0)=1$，$y|_{t=0}=0$。考虑方程
$$
y=a(t)d_0
$$
的解 $t_1$，那么当 $a(t)$ 是一次函数时，这个解一定比 $a(t)$ 是上凸函数时的解小。可以得到解为
$$
y=a(t)\cdot c\int_0^t\frac{\mathrm{d}u}{a(u)}
$$
因此等式相当于
$$
\int_0^{t_1}\frac{\mathrm{d}u}{a(u)}=\frac{d_0}c
$$
肯定是一次函数累积得最快。&lt;/p&gt;
&lt;p&gt;如果你有更简单的解释请留言。&lt;/p&gt;
&lt;p&gt;哎呀反正考试的时候记得是减速偏小就行啦。&lt;/p&gt;
&lt;p&gt;那么实际结果观测结果恰恰相反。这说明宇宙中有一个斥力。爱因斯坦在用广义相对论预言宇宙发展时，为了符合他认为的宇宙稳定，加入了起长程斥力的宇宙学常数 $\Lambda$。现在这个量反而可以用来对应斥力了。这个斥力是由暗能量造成的。暗能量均匀分布，不聚集成团，仅在巨大时空尺度上起作用。同样有一个暗能量密度 $\Omega_\Lambda$。暗能量在宇宙早期不重要，在约一半宇宙年龄前宇宙膨胀是减速的。随着宇宙膨胀，引力越来越弱，暗能量（密度不变）占主导，使减速转为加速。但暗能量具体是什么还不知道。宇宙的膨胀模式是物质和暗能量（时间演化）共同作用的结果。&lt;/p&gt;
&lt;p&gt;如果宇宙膨胀减速，则宇宙年龄 $&amp;lt;1/H_0$；宇宙膨胀加速，则宇宙年龄 $&amp;gt;1/H_0$。&lt;/p&gt;
&lt;p&gt;宇宙的总密度参数 $\Omega_0=\Omega_{\rm mass}+\Omega_\Lambda$ 决定宇宙的形状，它是等于 $1$ 的，这意味着宇宙是平直的。&lt;/p&gt;
&lt;p&gt;关于早期宇宙，就几个知识点：&lt;/p&gt;
&lt;p&gt;粒子的创建需要很高的温度。产生：两个伽马射线光子碰撞，产生正反粒子对。湮灭：粒子与反粒子对湮灭， 质量转为能量。辐射场温度越高，所创建的粒子的质量越大。在阈值温度之上，粒子—反粒子对和辐射处于热平衡状态，即对产生和对湮灭平衡；在阈值温度之下，对湮灭之后粒子不能再被创建。宇宙年龄 $\sim 0.0001\unit s$ 后，质子不再创生。宇宙年龄 $\sim 100\unit s$ 后，电子不再创生。物质略微超过反物，每十亿个粒子—反粒子对，多出一个额外的粒子。随着宇宙膨胀冷却，对湮灭后对产生不再发生，这些幸存的没有配对的正粒子从辐射场中冻结出来，其数量一直恒定至今。&lt;/p&gt;
&lt;p&gt;后面是宇宙初期演化的八个时代，然后平直疑难问题、视界疑难问题、宇宙的结局。&lt;/p&gt;
&lt;p&gt;宇宙的未来有两个说法，大撕裂和热寂。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/421862639/answer/1553781857&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;如何证明人类在宇宙中存在过？&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;雨课堂测试的几个知识点&#34;&gt;雨课堂测试的几个知识点
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;金星的盈亏（越亮越小，伽利略发现）彻底否定了地心说。&lt;/li&gt;
&lt;li&gt;伽利略是通过造父变星测距而得到星云不属于银河系的，因为他没有区分 I 型和 II 型，所以测得 $H_0$ 误差大。&lt;/li&gt;
&lt;li&gt;空间望远镜的最大不利因素是昂贵。&lt;/li&gt;
&lt;li&gt;地球表面不能探测 X、γ 射线。&lt;/li&gt;
&lt;li&gt;目前最常用的发现系外行星的方法是凌星法。&lt;/li&gt;
&lt;li&gt;天狼星的白矮星伴星是通过天体测量法发现的。&lt;/li&gt;
&lt;li&gt;双黑洞的并合不产生 γ 射线暴，只有大质量恒星坍缩，或者合并中有至少一者为中子星才能。&lt;/li&gt;
&lt;li&gt;年轻恒星主要位于银河系的旋臂，而不能说银盘。&lt;/li&gt;
&lt;li&gt;哈勃确定（旋涡）星云是银河系外的星系的关键是，他（利用造父变星）测量出了其距离。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;考试的一些知识点&#34;&gt;考试的一些知识点
&lt;/h2&gt;&lt;p&gt;这边列出的是一些我不太清楚的或者觉得相对容易忽视的。您需要先保证复习完主要的知识点和雨课堂测试题。每届的题目肯定是不一样的。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;中国农民丰收节的时间是秋分。&lt;/li&gt;
&lt;li&gt;冬季大三角。&lt;/li&gt;
&lt;li&gt;狭义相对论效应能解释 μ 介子。&lt;/li&gt;
&lt;li&gt;变星的周光关系与多普勒效应无关，其他很多天体的发现都和多普勒有关。&lt;/li&gt;
&lt;li&gt;双射电脉冲星一定是两颗中子星。&lt;a class=&#34;link&#34; href=&#34;https://baijiahao.baidu.com/s?id=1630611326878654152&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;两颗中子星合并后不一定是黑洞&lt;/a&gt;。发现第一颗双射电脉冲星获诺贝尔奖。&lt;/li&gt;
&lt;li&gt;太阳表面的震荡可以体现内部结构。&lt;/li&gt;
&lt;li&gt;太阳具有 $22$ 年的磁周期。&lt;/li&gt;
&lt;li&gt;B-V 值的严格定义——峰值波长越短，B-V 越小。&lt;/li&gt;
&lt;li&gt;太阳是 G2V 型。&lt;/li&gt;
&lt;li&gt;黑暗时期靠中性氢研究。&lt;/li&gt;
&lt;li&gt;活动星系核不包含恒星。&lt;/li&gt;
&lt;li&gt;行星状星云是由气体被电离所致。&lt;/li&gt;
&lt;li&gt;球状星团中暗物质比例较小。&lt;/li&gt;
&lt;li&gt;原太阳与太阳比，光度、大小、颜色中，颜色差的相对来说最小。&lt;/li&gt;
&lt;li&gt;疏散星团几乎没有白矮星，球状星团里有很多。&lt;/li&gt;
&lt;li&gt;天琴 RR 主要在银河系内被观测到，造父变星则相反。&lt;/li&gt;
&lt;li&gt;白矮星 Ia 爆发有两种：经典是吸积到钱德拉塞卡极限，超亮是两颗白矮星并合。我不知道为啥试卷里是单选。&lt;/li&gt;
&lt;li&gt;通过两个星团中正在离开主序带的恒星的年龄等，比较星团的年龄。&lt;/li&gt;
&lt;li&gt;人马座 A* 黑洞就是银河系中心。&lt;/li&gt;
&lt;li&gt;大爆炸核合成预言了今天宇宙的轻元素丰度。&lt;/li&gt;
&lt;li&gt;两个星系高速碰撞时，亮物质热气体减速，暗物质不减速。&lt;/li&gt;
&lt;li&gt;暴胀期解释了视界问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;附录&#34;&gt;附录
&lt;/h2&gt;&lt;h3 id=&#34;课内公式&#34;&gt;课内公式
&lt;/h3&gt;&lt;p&gt;$r$ 和 $R$ 均表示半径，$m$ 和 $M$ 均表示质量。&lt;/p&gt;
&lt;p&gt;太阳日和恒星日的差：
$$
太阳日-恒星日=恒星日\times\frac{太阳日}{恒星年}\approx\frac{24\unit{h}}{365}
$$
某地 $x$ 日（从春分日起）$y$ 时的地方恒星时：
$$
\left(x\times 4\unit{min}+y-12\unit{h}+\frac{该地经度-该地时区中央子午线}{360^\circ}\cdot 24\unit{h}\right)\bmod 24\unit{h}
$$
向心加速度：
$$
a=\frac{v^2}{r}=v\omega=\omega^2r=\frac{4\pi^2r}{T^2}=4\pi^2f^2r
$$
万有引力：
$$
F=\frac{Gm_1m_2}{r^2}
$$&lt;/p&gt;
&lt;p&gt;黄金代换：
$$
GM=v^2r=gr^2
$$
宇宙速度：
$$
v_1=\sqrt{gR},\,v_2=\sqrt{2gR}
$$
开普勒第三定律：
$$
\frac{a^3}{T^2}=\frac{GM}{4\pi^2}
$$
双星系统：
$$
\frac{(r_1+r_2)^3}{T^2}=\frac{G(m_1+m_2)}{4\pi^2}
$$&lt;/p&gt;
&lt;p&gt;$$
r_1m_1=r_2m_2
$$&lt;/p&gt;
&lt;p&gt;潮汐加速度（$r$ 是受力星球的半径）：
$$
a=\frac{2GMr}{d^3}
$$
波：
$$
E=hf
$$&lt;/p&gt;
&lt;p&gt;$$
\lambda f=c
$$&lt;/p&gt;
&lt;p&gt;红移（$v$ 是视向靠近速度）：
$$
z=\frac{\Delta\lambda}{\lambda}=\frac vc
$$
黑体辐射定律（光谱辐射亮度）：
$$
B_\nu(\nu,T)=\frac{2h\nu^3}{c^2}\frac{1}{\mathrm{e}^{h\nu/k_BT}-1}
$$
峰值波长与温度的关系：
$$
T=\frac{2.9\times 10^6\unit{nm\cdot K}}{\lambda_{\text{peak}}}
$$
流强：
$$
F=\sigma T^4
$$
光度：
$$
L=4\pi R^2F
$$
亮度：
$$
B=\frac{L}{4\pi d^2}=\frac{r^2}{d^2}\sigma T^4
$$
凌星亮度下降率（假设恒星是朗伯辐射体）：
$$
p=\frac{R^2_{\text{planet}}}{R^2_{\text{star}}}
$$
聚光能力（$D$ 是光圈大小）：
$$
A=\frac{\pi D^2}{4}
$$
角分辨率：
$$
\theta=2.06\times10^5\frac\lambda D\unit{arcsec}
$$
角动量：
$$
L=\iiint(\boldsymbol{r}\times\boldsymbol{v})\mathrm{d}m
$$
均匀球体的角动量：
$$
L=\frac{4\pi mR^2}{5T}
$$
太阳核聚变的能量：
$$
\Delta E=\Delta mc^2
$$
距离与视差的关系：
$$
d=\frac1p
$$
视星等：
$$
m=-2.5\log_{10}\frac{b}{b_0}
$$
绝对星等：
$$
M=-2.5\log_{10}\frac{L}{4\pi(10\unit{parsec})^2b_0}
$$
距离模数：
$$
\mu=m-M=5\log_{10}d-5
$$
色指数：
$$
B\text{-}\!V=-2.5\log_{10}\frac{b_B}{b_V}
$$&lt;/p&gt;
&lt;p&gt;质寿关系（类日）：
$$
\tau_{\text{MS}}=10^{10}\unit{y}\cdot\frac{M/M_\odot}{L/L_\odot}
$$
史瓦西半径：
$$
r=\frac{2GM}{c^2}
$$
黑洞平均密度：
$$
\rho=\frac{3c^6}{32\pi G^3M^2}
$$
黑洞的能量转换效率：
$$
\eta=\frac{GM}{rc^2}
$$
哈勃定律：
$$
v_r=H_0d_G
$$
宇宙的临界密度：
$$
\rho=\frac{3H_0^2}{8\pi G}
$$&lt;/p&gt;
&lt;h3 id=&#34;常数表&#34;&gt;常数表
&lt;/h3&gt;&lt;p&gt;以下，秒分时日（$\rm s,min,h,d$）均靠铯原子钟定义，平太阳日和 $1\unit{d}$ 差别极小。&lt;/p&gt;
&lt;p&gt;部分数据取自 &lt;a class=&#34;link&#34; href=&#34;https://nssdc.gsfc.nasa.gov/planetary/factsheet/sunfact.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://nssdc.gsfc.nasa.gov/planetary/factsheet/sunfact.html&lt;/a&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;名称&lt;/th&gt;
&lt;th&gt;符号&lt;/th&gt;
&lt;th&gt;数值&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;光速&lt;/td&gt;
&lt;td&gt;$c$&lt;/td&gt;
&lt;td&gt;$2.9979\times 10^8\unit{m/s}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天文单位&lt;/td&gt;
&lt;td&gt;$1\unit{AU}$&lt;/td&gt;
&lt;td&gt;$1.4960\times 10^8\unit{km}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光年&lt;/td&gt;
&lt;td&gt;$1\unit{ly}$&lt;/td&gt;
&lt;td&gt;$9.4607\times 10^{15}\unit{m}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星日&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$23.934\unit{h}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;平太阳日&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$24\unit{h}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星年&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$365.256\unit{d}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳年&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$365.242\unit{d}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;月亮公转周期&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$27.32\unit{d}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;月相周期&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$29.53\unit{d}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;目前地球自转轴进动周期&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$25772\unit{y}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;万有引力常数&lt;/td&gt;
&lt;td&gt;$G$&lt;/td&gt;
&lt;td&gt;$6.6743\times 10^{-11}\unit{m^3/(kg\cdot s^2)}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳质量&lt;/td&gt;
&lt;td&gt;$M_\odot$&lt;/td&gt;
&lt;td&gt;$1.9884\times 10^{30}\unit{kg}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;地球质量&lt;/td&gt;
&lt;td&gt;$M_\oplus$&lt;/td&gt;
&lt;td&gt;$5.9722\times 10^{24}\unit{kg}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳半径&lt;/td&gt;
&lt;td&gt;$r_\odot$&lt;/td&gt;
&lt;td&gt;$6.957\times 10^5\unit{km}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;地球半径&lt;/td&gt;
&lt;td&gt;$r_\oplus$&lt;/td&gt;
&lt;td&gt;$6371\unit{km}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光球层温度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$5772\unit{K}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳光度&lt;/td&gt;
&lt;td&gt;$L_\odot$&lt;/td&gt;
&lt;td&gt;$3.828\times 10^{26}\unit{W}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳赤道自转周期&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$25.05\unit{d}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第一宇宙速度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$7.9\unit{km/s}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第二宇宙速度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$11.2\unit{km/s}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;普朗克常数&lt;/td&gt;
&lt;td&gt;$h$&lt;/td&gt;
&lt;td&gt;$6.6261\times 10^{-34}\unit{m^2\cdot kg/s}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;维恩位移定律的分子&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$2.8978\times 10^6\unit{\mu m\cdot K}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;斯忒藩—玻耳兹曼常数&lt;/td&gt;
&lt;td&gt;$\sigma$&lt;/td&gt;
&lt;td&gt;$5.6704\times 10^{-8}\unit{W/(m^2\cdot K^4)}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;可见光波长范围&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$380\sim 750\unit{nm}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;氢原子的电离能&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$13.598\unit{eV}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;角分辨率的常数（课内）&lt;/td&gt;
&lt;td&gt;$1\unit{rad}$&lt;/td&gt;
&lt;td&gt;$2.0626\times 10^5\unit{arcsec}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;角分辨率的常数（课外）&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$1.2197$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;质子—质子链的能量转换效率&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$0.7\%$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳寿命&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$\sim 10^{10}\unit{y}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;秒差距&lt;/td&gt;
&lt;td&gt;$1\unit{pc}$&lt;/td&gt;
&lt;td&gt;$3.2616\unit{ly}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;钱德拉塞卡极限&lt;/td&gt;
&lt;td&gt;$1.4M_\odot$&lt;/td&gt;
&lt;td&gt;$2.765\times 10^{30}\unit{kg}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;银盘直径&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$26.8\pm 1.1\unit{kpc}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳距银心&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$8.32\pm 0.14\unit{kpc}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;薄盘厚度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$220\sim 450\unit{pc}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;厚盘厚度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$2.6\pm 0.5\unit{kpc}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;哈勃常数&lt;/td&gt;
&lt;td&gt;$H_0$&lt;/td&gt;
&lt;td&gt;$70\unit{km/s/Mpc}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙年龄&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$1.38\times 10^{10}\unit{y}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙背景辐射温度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$2.72548\pm 0.00057\unit{k}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙物质密度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;$3\times 10^{-27}\unit{kg/m^3}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙临界密度&lt;/td&gt;
&lt;td&gt;$\rho_{\rm c}$&lt;/td&gt;
&lt;td&gt;$9.5\times 10^{27}\unit{kg/m^3}$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;中英对照表&#34;&gt;中英对照表
&lt;/h3&gt;&lt;p&gt;您甚至可以看术语来期末复习。&lt;/p&gt;
&lt;h4 id=&#34;术语&#34;&gt;术语
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;中文&lt;/th&gt;
&lt;th&gt;英文&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;天文单位&lt;/td&gt;
&lt;td&gt;astronomical unit&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光年&lt;/td&gt;
&lt;td&gt;light-year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星座&lt;/td&gt;
&lt;td&gt;constellation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;极&lt;/td&gt;
&lt;td&gt;pole&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赤道&lt;/td&gt;
&lt;td&gt;equator&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;北回归线&lt;/td&gt;
&lt;td&gt;the Tropic of Cancer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;南回归线&lt;/td&gt;
&lt;td&gt;the Tropic of Capricorn&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;纬度&lt;/td&gt;
&lt;td&gt;latitude&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;经度&lt;/td&gt;
&lt;td&gt;longitude&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;子午线&lt;/td&gt;
&lt;td&gt;meridian&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;本初子午线&lt;/td&gt;
&lt;td&gt;prime meridian&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天球&lt;/td&gt;
&lt;td&gt;celestial sphere&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天顶&lt;/td&gt;
&lt;td&gt;zenith&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;地底&lt;/td&gt;
&lt;td&gt;nadir&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赤纬&lt;/td&gt;
&lt;td&gt;declination&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赤经&lt;/td&gt;
&lt;td&gt;right ascension&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;黄道&lt;/td&gt;
&lt;td&gt;ecliptic&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;地平（线）&lt;/td&gt;
&lt;td&gt;horizon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;中天&lt;/td&gt;
&lt;td&gt;culmination&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;过中天&lt;/td&gt;
&lt;td&gt;meridian transits&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;高度角&lt;/td&gt;
&lt;td&gt;altitude&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;方位角&lt;/td&gt;
&lt;td&gt;azimuth&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拱极星&lt;/td&gt;
&lt;td&gt;circumpolar star&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星轨&lt;/td&gt;
&lt;td&gt;star trail&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳日&lt;/td&gt;
&lt;td&gt;solar day&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星日&lt;/td&gt;
&lt;td&gt;sidereal day&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;黄道带&lt;/td&gt;
&lt;td&gt;the zodiac&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;自转&lt;/td&gt;
&lt;td&gt;rotate&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;公转&lt;/td&gt;
&lt;td&gt;revolve&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;春/秋分&lt;/td&gt;
&lt;td&gt;the spring(vernal)/autumn(autumnal) equinox&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;夏/冬至&lt;/td&gt;
&lt;td&gt;the summer/winter solstice&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;进动&lt;/td&gt;
&lt;td&gt;precession&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;岁差&lt;/td&gt;
&lt;td&gt;precession of the equinoxes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;章动&lt;/td&gt;
&lt;td&gt;nutation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;月相&lt;/td&gt;
&lt;td&gt;phase of the moon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;新月&lt;/td&gt;
&lt;td&gt;new moon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;娥眉月&lt;/td&gt;
&lt;td&gt;waxing crescent&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;上弦月&lt;/td&gt;
&lt;td&gt;first quarter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;上凸月&lt;/td&gt;
&lt;td&gt;waxing gibbous&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;满月&lt;/td&gt;
&lt;td&gt;full moon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;下凸月&lt;/td&gt;
&lt;td&gt;waning gibbous&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;下弦月&lt;/td&gt;
&lt;td&gt;last quarter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;残月&lt;/td&gt;
&lt;td&gt;waning crescent&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星年&lt;/td&gt;
&lt;td&gt;sidereal year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;回归年&lt;/td&gt;
&lt;td&gt;tropical year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星周期&lt;/td&gt;
&lt;td&gt;sidereal period&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;会合周期&lt;/td&gt;
&lt;td&gt;synodic period&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;潮汐锁定&lt;/td&gt;
&lt;td&gt;tidal locking&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;同步自转&lt;/td&gt;
&lt;td&gt;synchronous rotation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日食&lt;/td&gt;
&lt;td&gt;solar eclipse&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日全食&lt;/td&gt;
&lt;td&gt;total solar eclipse&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日环食&lt;/td&gt;
&lt;td&gt;annular solar eclipse&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日偏食&lt;/td&gt;
&lt;td&gt;partial solar eclipse&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;本影&lt;/td&gt;
&lt;td&gt;umbra&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;半影&lt;/td&gt;
&lt;td&gt;penumbra&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;地心&lt;/td&gt;
&lt;td&gt;geocentric&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;本轮&lt;/td&gt;
&lt;td&gt;epicycle&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;均轮&lt;/td&gt;
&lt;td&gt;deferent&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日心&lt;/td&gt;
&lt;td&gt;heliocentric&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;顺行&lt;/td&gt;
&lt;td&gt;prograde motion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;逆行&lt;/td&gt;
&lt;td&gt;retrograde motion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;近日点&lt;/td&gt;
&lt;td&gt;perihelion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;远日点&lt;/td&gt;
&lt;td&gt;aphelion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;椭圆&lt;/td&gt;
&lt;td&gt;ellipse&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;万有引力定律&lt;/td&gt;
&lt;td&gt;universal law of gravitation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;逃逸速度&lt;/td&gt;
&lt;td&gt;escape velocity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;潮汐隆起&lt;/td&gt;
&lt;td&gt;tidal bulge&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;辐射&lt;/td&gt;
&lt;td&gt;radiation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光谱&lt;/td&gt;
&lt;td&gt;spectrum&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;紫外线&lt;/td&gt;
&lt;td&gt;ultraviolet radiation, UV&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;红外线&lt;/td&gt;
&lt;td&gt;infrared radiation, IR&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光子&lt;/td&gt;
&lt;td&gt;photon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;质子&lt;/td&gt;
&lt;td&gt;proton&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;中子&lt;/td&gt;
&lt;td&gt;neutron&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;电子&lt;/td&gt;
&lt;td&gt;electron&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;中微子&lt;/td&gt;
&lt;td&gt;neutrino&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;发射线&lt;/td&gt;
&lt;td&gt;emission line&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;吸收线&lt;/td&gt;
&lt;td&gt;absorption line&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;红移&lt;/td&gt;
&lt;td&gt;redshift&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;蓝移&lt;/td&gt;
&lt;td&gt;blueshift&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;热辐射&lt;/td&gt;
&lt;td&gt;thermal radiation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;辐射强度&lt;/td&gt;
&lt;td&gt;radiant intensity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;流强&lt;/td&gt;
&lt;td&gt;flux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光度&lt;/td&gt;
&lt;td&gt;luminosity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;亮度&lt;/td&gt;
&lt;td&gt;brightness&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光学望远镜&lt;/td&gt;
&lt;td&gt;optical telescope&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;折射式望远镜&lt;/td&gt;
&lt;td&gt;refracting telescope&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;反射式望远镜&lt;/td&gt;
&lt;td&gt;reflecting telescope&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;物镜&lt;/td&gt;
&lt;td&gt;objective lens&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;目镜&lt;/td&gt;
&lt;td&gt;eyepiece&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;色差&lt;/td&gt;
&lt;td&gt;chromatic aberration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;色散&lt;/td&gt;
&lt;td&gt;dispersion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;立体角&lt;/td&gt;
&lt;td&gt;solid angle&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;角分辨率&lt;/td&gt;
&lt;td&gt;angular resolution&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;衍射极限&lt;/td&gt;
&lt;td&gt;diffraction limit&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视宁度&lt;/td&gt;
&lt;td&gt;seeing&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光谱仪&lt;/td&gt;
&lt;td&gt;spectrograph&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星&lt;/td&gt;
&lt;td&gt;star&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;行星系&lt;/td&gt;
&lt;td&gt;planetary system&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;卫星&lt;/td&gt;
&lt;td&gt;moon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星云&lt;/td&gt;
&lt;td&gt;nebula&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;流星&lt;/td&gt;
&lt;td&gt;meteor&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;陨石&lt;/td&gt;
&lt;td&gt;meteorite&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;原恒星&lt;/td&gt;
&lt;td&gt;protostar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;原行星盘&lt;/td&gt;
&lt;td&gt;protoplanetary disk&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;角动量&lt;/td&gt;
&lt;td&gt;angular momentum&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;吸积盘&lt;/td&gt;
&lt;td&gt;accretion disk&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;双极流&lt;/td&gt;
&lt;td&gt;bipolar outflow&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;喷流&lt;/td&gt;
&lt;td&gt;jet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星子&lt;/td&gt;
&lt;td&gt;planetesimal&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;行星迁移&lt;/td&gt;
&lt;td&gt;planet migration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;原始大气&lt;/td&gt;
&lt;td&gt;primary atmosphere&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;次生大气&lt;/td&gt;
&lt;td&gt;secondary atmosphere&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;彗星&lt;/td&gt;
&lt;td&gt;comet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;彗核&lt;/td&gt;
&lt;td&gt;comet nucleus&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;类地行星&lt;/td&gt;
&lt;td&gt;terrestrial planet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;巨行星&lt;/td&gt;
&lt;td&gt;giant planet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;系外行星&lt;/td&gt;
&lt;td&gt;extrasolar planet/exoplanet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;矮行星&lt;/td&gt;
&lt;td&gt;dwarf planet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;褐矮星&lt;/td&gt;
&lt;td&gt;brown dwarf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视向速度法&lt;/td&gt;
&lt;td&gt;radial-velocity method&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;凌星法&lt;/td&gt;
&lt;td&gt;transit method&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;微引力透镜法&lt;/td&gt;
&lt;td&gt;gravitational microlensing&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天体测量法&lt;/td&gt;
&lt;td&gt;astrometric method&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;直接成像法&lt;/td&gt;
&lt;td&gt;direct imaging&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;核合成&lt;/td&gt;
&lt;td&gt;nucleosynthesis&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;核聚变&lt;/td&gt;
&lt;td&gt;nuclear fusion&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;氢燃烧（氢核聚变）&lt;/td&gt;
&lt;td&gt;hydrogen burning&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;（热）传导&lt;/td&gt;
&lt;td&gt;conduction&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;对流&lt;/td&gt;
&lt;td&gt;convection&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;不透明度&lt;/td&gt;
&lt;td&gt;opacity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日面米粒组织&lt;/td&gt;
&lt;td&gt;granulation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日震&lt;/td&gt;
&lt;td&gt;helioseismology&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光球层&lt;/td&gt;
&lt;td&gt;photosphere&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;色球层&lt;/td&gt;
&lt;td&gt;chromosphere&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日冕&lt;/td&gt;
&lt;td&gt;corona&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;临边昏暗&lt;/td&gt;
&lt;td&gt;limb darkening&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳黑子&lt;/td&gt;
&lt;td&gt;sunspot&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳黑子周期&lt;/td&gt;
&lt;td&gt;sunspot cycle&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳耀斑&lt;/td&gt;
&lt;td&gt;solar flare&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;冕环&lt;/td&gt;
&lt;td&gt;coronal loop&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日珥&lt;/td&gt;
&lt;td&gt;solar prominence&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日冕物质抛射&lt;/td&gt;
&lt;td&gt;coronal mass ejection&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;冕洞&lt;/td&gt;
&lt;td&gt;coronal hole&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;太阳风&lt;/td&gt;
&lt;td&gt;solar wind&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;极光&lt;/td&gt;
&lt;td&gt;aurora&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视差角&lt;/td&gt;
&lt;td&gt;parallactic angle&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视差&lt;/td&gt;
&lt;td&gt;parallax&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视星等&lt;/td&gt;
&lt;td&gt;apparent magnitude&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;绝对星等&lt;/td&gt;
&lt;td&gt;absolute magnitude&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;距离模数&lt;/td&gt;
&lt;td&gt;distance modulus&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;色指数&lt;/td&gt;
&lt;td&gt;color index&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;滤光片&lt;/td&gt;
&lt;td&gt;optical filter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;双星&lt;/td&gt;
&lt;td&gt;binary star&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;质心&lt;/td&gt;
&lt;td&gt;center of mass&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视双星&lt;/td&gt;
&lt;td&gt;visual binary&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;食双星&lt;/td&gt;
&lt;td&gt;eclipsing binary&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;分光双星&lt;/td&gt;
&lt;td&gt;spectroscopic binary&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天体测量双星&lt;/td&gt;
&lt;td&gt;astrometric binary&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;光谱型&lt;/td&gt;
&lt;td&gt;spectral type&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;主序&lt;/td&gt;
&lt;td&gt;main sequence, MS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;巨星&lt;/td&gt;
&lt;td&gt;giant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星际介质&lt;/td&gt;
&lt;td&gt;interstellar medium&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星际尘埃&lt;/td&gt;
&lt;td&gt;interstellar dust&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星际消光&lt;/td&gt;
&lt;td&gt;interstellar extinction&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;红化&lt;/td&gt;
&lt;td&gt;reddening&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星际云&lt;/td&gt;
&lt;td&gt;interstellar cloud&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;云际气体&lt;/td&gt;
&lt;td&gt;intercloud gas&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星云&lt;/td&gt;
&lt;td&gt;nebula&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;电离&lt;/td&gt;
&lt;td&gt;ionize&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;分子云&lt;/td&gt;
&lt;td&gt;molecular cloud&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;巨分子云&lt;/td&gt;
&lt;td&gt;giant molecular cloud&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;演化程&lt;/td&gt;
&lt;td&gt;evolutionary track&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星团&lt;/td&gt;
&lt;td&gt;star cluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;球状星团&lt;/td&gt;
&lt;td&gt;globular cluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;疏散星团&lt;/td&gt;
&lt;td&gt;open cluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;褐矮星&lt;/td&gt;
&lt;td&gt;brown dwarf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;寿命&lt;/td&gt;
&lt;td&gt;lifetime&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;质光关系&lt;/td&gt;
&lt;td&gt;mass-luminosity relation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;亚巨星（支）&lt;/td&gt;
&lt;td&gt;subgiant (branch), SB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;红巨星（支）&lt;/td&gt;
&lt;td&gt;red giant (branch), RGB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;简并&lt;/td&gt;
&lt;td&gt;degenerate&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;氦闪&lt;/td&gt;
&lt;td&gt;helium flash&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;水平支&lt;/td&gt;
&lt;td&gt;horizontal branch, HB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;渐近巨星支&lt;/td&gt;
&lt;td&gt;asymptotic giant branch, AGB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;后渐近巨星支&lt;/td&gt;
&lt;td&gt;post asymptotic giant branch, post-AGB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;行星状星云&lt;/td&gt;
&lt;td&gt;planetary nebula&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;白矮星&lt;/td&gt;
&lt;td&gt;white dwarf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;黑矮星&lt;/td&gt;
&lt;td&gt;black dwarf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;不稳定带&lt;/td&gt;
&lt;td&gt;instability strip&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;脉动变星&lt;/td&gt;
&lt;td&gt;pulsating variable stars&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;造父变星&lt;/td&gt;
&lt;td&gt;Cepheid variable&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天琴座 RR 型变星&lt;/td&gt;
&lt;td&gt;RR Lyrae variable&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;超新星&lt;/td&gt;
&lt;td&gt;supernova&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;超新星遗迹&lt;/td&gt;
&lt;td&gt;supernova remnant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;中子星&lt;/td&gt;
&lt;td&gt;neutron star&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;脉冲星&lt;/td&gt;
&lt;td&gt;pulsar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;黑洞&lt;/td&gt;
&lt;td&gt;black hole&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;激变变星&lt;/td&gt;
&lt;td&gt;cataclysmic variable stars&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;新星&lt;/td&gt;
&lt;td&gt;nova&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;再发新星&lt;/td&gt;
&lt;td&gt;recurrent nova&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;X 射线双星&lt;/td&gt;
&lt;td&gt;X-ray binary&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;主序转折点&lt;/td&gt;
&lt;td&gt;main-sequence turnoff&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;磁星&lt;/td&gt;
&lt;td&gt;magnetar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;夸克（奇异）星&lt;/td&gt;
&lt;td&gt;quark star&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;快速射电暴&lt;/td&gt;
&lt;td&gt;fast radio burst, FRB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;视界&lt;/td&gt;
&lt;td&gt;event horizon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;奇点&lt;/td&gt;
&lt;td&gt;singularity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;能层&lt;/td&gt;
&lt;td&gt;ergosphere&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;相对论性喷流&lt;/td&gt;
&lt;td&gt;astrophysical(relativistic) jet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;恒星级质量黑洞&lt;/td&gt;
&lt;td&gt;stellar black hole&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;超大质量黑洞&lt;/td&gt;
&lt;td&gt;supermassive black hole&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;伽马射线暴&lt;/td&gt;
&lt;td&gt;gamma-ray burst, GRB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;引力波&lt;/td&gt;
&lt;td&gt;gravitational wave&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;旋臂&lt;/td&gt;
&lt;td&gt;spiral arm&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;核球&lt;/td&gt;
&lt;td&gt;bulge&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星系盘&lt;/td&gt;
&lt;td&gt;galactic disk&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星系晕&lt;/td&gt;
&lt;td&gt;galactic halo&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;尘埃带&lt;/td&gt;
&lt;td&gt;dust lane&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙射线&lt;/td&gt;
&lt;td&gt;cosmic ray&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;密度波&lt;/td&gt;
&lt;td&gt;density wave&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;潮汐瓦解&lt;/td&gt;
&lt;td&gt;tidal disruption&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;椭圆星系&lt;/td&gt;
&lt;td&gt;elliptical galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;旋涡星系&lt;/td&gt;
&lt;td&gt;spiral galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;棒旋星系&lt;/td&gt;
&lt;td&gt;barred spiral galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;不规则星系&lt;/td&gt;
&lt;td&gt;irregular galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;矮星系&lt;/td&gt;
&lt;td&gt;dwarf galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;河外星系&lt;/td&gt;
&lt;td&gt;extragalactic system&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;暗物质&lt;/td&gt;
&lt;td&gt;dark matter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;标准烛光&lt;/td&gt;
&lt;td&gt;standard candle&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;距离阶梯&lt;/td&gt;
&lt;td&gt;distance ladder&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;类星体&lt;/td&gt;
&lt;td&gt;quasar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;引力红移&lt;/td&gt;
&lt;td&gt;gravitational redshift&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙学红移&lt;/td&gt;
&lt;td&gt;cosmological redshift&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;活动星系核&lt;/td&gt;
&lt;td&gt;active galactic nucleus, AGN&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;射电噪的&lt;/td&gt;
&lt;td&gt;radio-loud&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;射电宁静的&lt;/td&gt;
&lt;td&gt;radio-quiet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;射电星系&lt;/td&gt;
&lt;td&gt;radio galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;耀变体&lt;/td&gt;
&lt;td&gt;blazar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;辐射压&lt;/td&gt;
&lt;td&gt;radiation pressure&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;尘埃环&lt;/td&gt;
&lt;td&gt;obscuring torus&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙学原理&lt;/td&gt;
&lt;td&gt;cosmological principle&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;（宇宙是）均匀的&lt;/td&gt;
&lt;td&gt;homogeneous&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;（宇宙是）各向同性的&lt;/td&gt;
&lt;td&gt;isotropic&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;退行速度&lt;/td&gt;
&lt;td&gt;recessional velocity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;本动速度&lt;/td&gt;
&lt;td&gt;peculiar velocity&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;回溯时间&lt;/td&gt;
&lt;td&gt;look-back time&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙大爆炸&lt;/td&gt;
&lt;td&gt;the Big Bang&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙尺度因子&lt;/td&gt;
&lt;td&gt;scale factor&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙微波背景辐射&lt;/td&gt;
&lt;td&gt;cosmic microwave background radiation, CMB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;复合（光子退耦）&lt;/td&gt;
&lt;td&gt;recombination&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星系群&lt;/td&gt;
&lt;td&gt;galaxy group&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;星系团&lt;/td&gt;
&lt;td&gt;galaxy cluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;超星系团&lt;/td&gt;
&lt;td&gt;supercluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;巨洞&lt;/td&gt;
&lt;td&gt;void&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;大尺度结构&lt;/td&gt;
&lt;td&gt;large-scale structure&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;等级式成团&lt;/td&gt;
&lt;td&gt;hierarchical clustering&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;黑暗时代&lt;/td&gt;
&lt;td&gt;the Dark Ages&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;再电离&lt;/td&gt;
&lt;td&gt;reionization&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;量子涨落&lt;/td&gt;
&lt;td&gt;quantum fluctuation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;临界密度&lt;/td&gt;
&lt;td&gt;critical density&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;宇宙学常数&lt;/td&gt;
&lt;td&gt;the cosmological constant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;暗能量&lt;/td&gt;
&lt;td&gt;dark energy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;大挤压&lt;/td&gt;
&lt;td&gt;the Big Crunch&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;大撕裂&lt;/td&gt;
&lt;td&gt;the Big Rip&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;平直宇宙&lt;/td&gt;
&lt;td&gt;flat universe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;暴涨&lt;/td&gt;
&lt;td&gt;inflation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;多重宇宙&lt;/td&gt;
&lt;td&gt;multiverse&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;天体&#34;&gt;天体
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;中文&lt;/th&gt;
&lt;th&gt;英文&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;太阳系&lt;/td&gt;
&lt;td&gt;the Solar System&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;银河系&lt;/td&gt;
&lt;td&gt;the Milky Way&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;本星系群&lt;/td&gt;
&lt;td&gt;the Local Group of Galaxies&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;本（室女座）超星系群&lt;/td&gt;
&lt;td&gt;the Local(Virgo) Supercluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拉尼亚凯亚超星系团&lt;/td&gt;
&lt;td&gt;the Laniakea Supercluster&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;仙女座星系&lt;/td&gt;
&lt;td&gt;the Andromeda Galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;三角座星系&lt;/td&gt;
&lt;td&gt;the Triangulum Galaxy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;大/小麦哲伦星云&lt;/td&gt;
&lt;td&gt;the Large/Small Magellanic Cloud&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;北极星&lt;/td&gt;
&lt;td&gt;Polaris&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天狼星&lt;/td&gt;
&lt;td&gt;Sirius&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;比邻星&lt;/td&gt;
&lt;td&gt;Proxima Centauri&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;昴星团&lt;/td&gt;
&lt;td&gt;the Pleiades&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;蟹状星云&lt;/td&gt;
&lt;td&gt;the Crab Nebula&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;人名&#34;&gt;人名
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;中文&lt;/th&gt;
&lt;th&gt;英文&lt;/th&gt;
&lt;th&gt;贡献&lt;/th&gt;
&lt;th&gt;诺贝尔奖&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;托勒密&lt;/td&gt;
&lt;td&gt;Ptolemy&lt;/td&gt;
&lt;td&gt;地心说（150 年《天文学大成》）&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;哥白尼&lt;/td&gt;
&lt;td&gt;Copernicus&lt;/td&gt;
&lt;td&gt;日心说（1543 年《天体运行论》）&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;第谷&lt;/td&gt;
&lt;td&gt;Tycho&lt;/td&gt;
&lt;td&gt;望远镜之前最好的天文仪器和观测&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;开普勒&lt;/td&gt;
&lt;td&gt;Kepler&lt;/td&gt;
&lt;td&gt;观测、开普勒三定律（1619 年《世界的和谐》）&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;伽利略&lt;/td&gt;
&lt;td&gt;Galileo&lt;/td&gt;
&lt;td&gt;第一位使用望远镜，彻底否定地心说，发现银河由众多恒星组成&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;牛顿&lt;/td&gt;
&lt;td&gt;Newton&lt;/td&gt;
&lt;td&gt;第一台反射式望远镜、物理（1687 年《自然哲学的数学原理》）&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;爱因斯坦&lt;/td&gt;
&lt;td&gt;Einstein&lt;/td&gt;
&lt;td&gt;相对论等&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;根策尔、盖兹&lt;/td&gt;
&lt;td&gt;Genzel, Ghez&lt;/td&gt;
&lt;td&gt;发现银河系中心的黑洞&lt;/td&gt;
&lt;td&gt;2020&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;韦斯、巴里什、索恩&lt;/td&gt;
&lt;td&gt;Weiss, Barish, Thorne&lt;/td&gt;
&lt;td&gt;LIGO 探测装置（探测引力波）&lt;/td&gt;
&lt;td&gt;2017&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;麦克斯韦&lt;/td&gt;
&lt;td&gt;Maxwell&lt;/td&gt;
&lt;td&gt;电磁场理论（1873 年《论电和磁》）&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;普朗克&lt;/td&gt;
&lt;td&gt;Planck&lt;/td&gt;
&lt;td&gt;黑体辐射谱、量子力学创始人之一&lt;/td&gt;
&lt;td&gt;1918&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;韦恩&lt;/td&gt;
&lt;td&gt;Wien&lt;/td&gt;
&lt;td&gt;位移定律&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;斯特藩、玻尔兹曼&lt;/td&gt;
&lt;td&gt;Stefan, Boltzmann&lt;/td&gt;
&lt;td&gt;斯特藩—玻尔兹曼定律&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;玻尔&lt;/td&gt;
&lt;td&gt;Bohr&lt;/td&gt;
&lt;td&gt;原子模型&lt;/td&gt;
&lt;td&gt;1922&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;巴尔末&lt;/td&gt;
&lt;td&gt;Balmer&lt;/td&gt;
&lt;td&gt;巴尔末线系&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;莱曼&lt;/td&gt;
&lt;td&gt;Lyman&lt;/td&gt;
&lt;td&gt;莱曼线系&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;多普勒&lt;/td&gt;
&lt;td&gt;Doppler&lt;/td&gt;
&lt;td&gt;多普勒效应&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;卡塞格林&lt;/td&gt;
&lt;td&gt;Cassegrain&lt;/td&gt;
&lt;td&gt;反射式望远镜&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;艾里&lt;/td&gt;
&lt;td&gt;Airy&lt;/td&gt;
&lt;td&gt;艾里斑&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;瑞利&lt;/td&gt;
&lt;td&gt;Rayleigh&lt;/td&gt;
&lt;td&gt;瑞利散射、判据&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;康德&lt;/td&gt;
&lt;td&gt;Kant&lt;/td&gt;
&lt;td&gt;首先提出太阳系形成的星云假说、认为旋涡星云是“岛宇宙”&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拉普拉斯&lt;/td&gt;
&lt;td&gt;Laplace&lt;/td&gt;
&lt;td&gt;提供星云假说的定量化版本&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;马约尔、奎洛兹&lt;/td&gt;
&lt;td&gt;Mayor, Queloz&lt;/td&gt;
&lt;td&gt;发现第一颗系外行星&lt;/td&gt;
&lt;td&gt;2019&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;贝特&lt;/td&gt;
&lt;td&gt;Bethe&lt;/td&gt;
&lt;td&gt;恒星能源及核反应&lt;/td&gt;
&lt;td&gt;1967&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;戴维斯、小柴昌俊&lt;/td&gt;
&lt;td&gt;Davis, Koshiba&lt;/td&gt;
&lt;td&gt;对天体物理学，特别是对探测宇宙中微子的开拓性贡献&lt;/td&gt;
&lt;td&gt;2022&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;麦克唐纳、梶田隆章&lt;/td&gt;
&lt;td&gt;McDonald, Kajita&lt;/td&gt;
&lt;td&gt;发现了中微子振荡，证实了中微子有质量&lt;/td&gt;
&lt;td&gt;2015&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赫茨普龙&lt;/td&gt;
&lt;td&gt;Hertzsprung&lt;/td&gt;
&lt;td&gt;赫—罗图&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;罗素&lt;/td&gt;
&lt;td&gt;Russell&lt;/td&gt;
&lt;td&gt;赫—罗图&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;林忠四郎&lt;/td&gt;
&lt;td&gt;Hayashi&lt;/td&gt;
&lt;td&gt;恒星形成模型和前主序列演化模型&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赫比格、阿罗&lt;/td&gt;
&lt;td&gt;Herbig, Haro&lt;/td&gt;
&lt;td&gt;HH 天体&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;洛希&lt;/td&gt;
&lt;td&gt;Roche&lt;/td&gt;
&lt;td&gt;洛希极限、洛希瓣&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;钱德拉塞卡&lt;/td&gt;
&lt;td&gt;Chandrasekhar&lt;/td&gt;
&lt;td&gt;钱德拉塞卡极限&lt;/td&gt;
&lt;td&gt;1983&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;休伊什&lt;/td&gt;
&lt;td&gt;Hewish&lt;/td&gt;
&lt;td&gt;发现第一颗脉冲星&lt;/td&gt;
&lt;td&gt;1974&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;泰勒、赫尔斯&lt;/td&gt;
&lt;td&gt;Taylor, Hulse&lt;/td&gt;
&lt;td&gt;发现第一颗双星射电脉冲星&lt;/td&gt;
&lt;td&gt;1993&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;洛里默&lt;/td&gt;
&lt;td&gt;Lorimer&lt;/td&gt;
&lt;td&gt;发现首例快速射电暴&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;史瓦西&lt;/td&gt;
&lt;td&gt;Schwarzschild&lt;/td&gt;
&lt;td&gt;史瓦西度规与史瓦西半径&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;霍金&lt;/td&gt;
&lt;td&gt;Hawking&lt;/td&gt;
&lt;td&gt;黑洞辐射&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;林家翘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;密度波理论&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;梅西耶&lt;/td&gt;
&lt;td&gt;Messier&lt;/td&gt;
&lt;td&gt;梅西耶星表&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赫歇尔&lt;/td&gt;
&lt;td&gt;Herschel&lt;/td&gt;
&lt;td&gt;银河系结构、NGC、发现天王星，并发现天王星的轨道预言和实际观测不一致&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;沙普利&lt;/td&gt;
&lt;td&gt;Shapley&lt;/td&gt;
&lt;td&gt;发现球状星团三维分布、太阳系不是银河系的中心&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;哈勃&lt;/td&gt;
&lt;td&gt;Hubble&lt;/td&gt;
&lt;td&gt;哈勃分类、哈勃定律&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;施密特&lt;/td&gt;
&lt;td&gt;Schmidt&lt;/td&gt;
&lt;td&gt;首次发现类星体&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;塞弗特&lt;/td&gt;
&lt;td&gt;Seyfert&lt;/td&gt;
&lt;td&gt;赛弗特星系&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;爱丁顿&lt;/td&gt;
&lt;td&gt;Eddington&lt;/td&gt;
&lt;td&gt;爱丁顿光度&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;弗里德曼&lt;/td&gt;
&lt;td&gt;Friedmann&lt;/td&gt;
&lt;td&gt;弗里德曼宇宙模型&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;勒梅特&lt;/td&gt;
&lt;td&gt;Lemaître&lt;/td&gt;
&lt;td&gt;宇宙膨胀模型&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;伽莫夫&lt;/td&gt;
&lt;td&gt;Gamow&lt;/td&gt;
&lt;td&gt;αβγ 论文&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;皮布尔斯&lt;/td&gt;
&lt;td&gt;Peebles&lt;/td&gt;
&lt;td&gt;对于物理宇宙学方面的理论发现&lt;/td&gt;
&lt;td&gt;2019&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;彭齐亚斯、威尔逊&lt;/td&gt;
&lt;td&gt;Penzias, Wilson&lt;/td&gt;
&lt;td&gt;发现宇宙微波背景辐射&lt;/td&gt;
&lt;td&gt;1978&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;马瑟、斯穆特&lt;/td&gt;
&lt;td&gt;Mather, Smoot&lt;/td&gt;
&lt;td&gt;发现了宇宙微波背景辐射的黑体谱形式和各项异性&lt;/td&gt;
&lt;td&gt;2006&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;兹威基&lt;/td&gt;
&lt;td&gt;Zwicky&lt;/td&gt;
&lt;td&gt;星系团的暗物质&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;鲁宾&lt;/td&gt;
&lt;td&gt;Rubin&lt;/td&gt;
&lt;td&gt;星系的暗物质&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;珀尔马特、施密特、里斯&lt;/td&gt;
&lt;td&gt;Perlmutter, Schmidt, Riess&lt;/td&gt;
&lt;td&gt;通过观测遥远的超新星发现宇宙正在加速膨胀&lt;/td&gt;
&lt;td&gt;2011&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;古斯&lt;/td&gt;
&lt;td&gt;Guth&lt;/td&gt;
&lt;td&gt;提出大爆炸后暴胀期&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;望远镜&#34;&gt;望远镜
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;中文&lt;/th&gt;
&lt;th&gt;缩写&lt;/th&gt;
&lt;th&gt;贡献&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;韦布太空望远镜&lt;/td&gt;
&lt;td&gt;JWST&lt;/td&gt;
&lt;td&gt;首张“全彩”红外照片、早期星系、“长城”、最遥远的黑洞合并、创世之柱（红外）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;胡克望远镜&lt;/td&gt;
&lt;td&gt;Hooker&lt;/td&gt;
&lt;td&gt;为哈勃定律、赫—罗图提供数据&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;哈勃太空望远镜&lt;/td&gt;
&lt;td&gt;HST&lt;/td&gt;
&lt;td&gt;深空、创世之柱（可见光）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;钱德拉 X 射线太空望远镜&lt;/td&gt;
&lt;td&gt;CXO&lt;/td&gt;
&lt;td&gt;蟹状星云 X 射线图像、一些黑洞的 X 射线图像&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;事件视界望远镜&lt;/td&gt;
&lt;td&gt;EHT&lt;/td&gt;
&lt;td&gt;M87* 黑洞、Sgr A* 黑洞&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
        </item>
        <item>
        <title>普通物理 (2) 笔记</title>
        <link>https://littlereuben.github.io/study/course-physics2/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-physics2/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/course-physics2/cover.jpg" alt="Featured image of post 普通物理 (2) 笔记" /&gt;&lt;p&gt;$\gdef\b#1{\boldsymbol{#1}}\gdef\d{\mathrm{d}}\gdef\p{\partial}\gdef\J{\mathbf{J}}\gdef\H{\mathbf{H}}\gdef\eps{\varepsilon}\gdef\i{\mathrm{i}}\gdef\unit#1{\,\mathrm{#1}}\gdef\re{\operatorname{Re}}\gdef\im{\operatorname{Im}}\gdef\e{\mathrm{e}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;p&gt;普通物理一点都不普通。&lt;/p&gt;
&lt;p&gt;本文适合非物竞但大概学过高中物理的同学看。&lt;/p&gt;
&lt;p&gt;这个课是点名 $10\%$，作业 $30\%$，期中 $25\%$，期末 $35\%$，这次好像是点了两次，都在下半学期。&lt;/p&gt;
&lt;p&gt;教材是费曼物理学讲义第二卷，会考的是 $1\sim8$、$10$、$13\sim18$、$20\sim24$。最后会用 Microwave Engineering (Pozar) 的第三章。作业很多都取自 Introduction to Electrodynamics (Griffiths)。&lt;/p&gt;
&lt;p&gt;前置知识就是微积分，但其实没什么难度，知道 $\nabla$ 相关和 Stokes 公式的原理就行，第一节课会过一遍。上半学期只讲静电学的内容，包括库仑定律、高斯定律、电多极子、含导体情况的解法、静电能、电介质。下半学期讲剩余的内容，包括安培定律、毕奥—萨伐尔定律、磁矢势、磁偶极子、静磁能、法拉第电磁感应定律、麦克斯韦方程组、电磁波、交流电路、谐振腔、波导。期末会考上半学期中的电介质。&lt;/p&gt;
&lt;p&gt;上课的 ppt 基本是照着教材写，讲也是照着讲。作为初学者，我经常会不明白为什么某个物理图景能用这个公式去刻画，或者没搞清楚讲的对象或（一些用于简化问题的）假设是什么，或者为什么突然要提这个例子。听过很多人说费曼物理学讲义其实不适合初学者，书里举的一些例子和内容的详略安排都是给完整学过一遍基础知识的人看的，视角比较高，为的是看到一些更本质的东西。&lt;/p&gt;
&lt;p&gt;我的笔记里会尽量讲清一些例子它严谨的推理过程是怎样的，另外有一些例子比如涉及玻尔玆曼分布之类的，不会考。&lt;/p&gt;
&lt;p&gt;建议从一开始就跟着进度看 Introduction to Electrodynamics。&lt;/p&gt;
&lt;p&gt;作业平均六道，可能会放一道比较难的。&lt;/p&gt;
&lt;p&gt;听说去年考试是期中巨难，今年是期中巨简单期末巨难，难到那种非物竞生容易不及格的那种。可以做好在若干节课和某次考试中心态爆炸的准备。当然过难肯定是会调分的。&lt;/p&gt;
&lt;p&gt;关于考试的一些 tips：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;复习基本公式的推导，与基本原理相关的一些例子，比如为什么导体表面越尖锐电荷密度越大。考试第一题是四个小简答题，会问这种。&lt;/li&gt;
&lt;li&gt;简单的考试会出作业题或作业题改编。&lt;/li&gt;
&lt;li&gt;需要练熟练度，强推。&lt;/li&gt;
&lt;li&gt;保证会做的做对。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;课上讲了但不考的知识点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一些需要用到普物一知识的例子&lt;/li&gt;
&lt;li&gt;推迟势&lt;/li&gt;
&lt;li&gt;圆柱形谐振腔&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;课上没讲的一些知识点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;张量&lt;/li&gt;
&lt;li&gt;狄拉克 $\delta$ 函数（记了）&lt;/li&gt;
&lt;li&gt;调和函数&lt;/li&gt;
&lt;li&gt;保角变换（记了）&lt;/li&gt;
&lt;li&gt;介质中的电像法（期末）&lt;/li&gt;
&lt;li&gt;磁标势&lt;/li&gt;
&lt;li&gt;磁多极子（记了）&lt;/li&gt;
&lt;li&gt;偶极子的受力&lt;/li&gt;
&lt;li&gt;磁介质&lt;/li&gt;
&lt;li&gt;含介质情况的麦克斯韦方程组&lt;/li&gt;
&lt;li&gt;含介质情况的能量&lt;/li&gt;
&lt;li&gt;平面波导、圆柱形波导&lt;/li&gt;
&lt;li&gt;谐振腔和波导的能量耗散（期末）&lt;/li&gt;
&lt;li&gt;能量密度（期末）&lt;/li&gt;
&lt;li&gt;坡印廷矢量&lt;/li&gt;
&lt;li&gt;电磁场的动量&lt;/li&gt;
&lt;li&gt;电磁场的相对论变换及麦克斯韦方程组的相对论形式&lt;/li&gt;
&lt;li&gt;真正解一般情况下的麦克斯韦方程组，例如一个匀速直线运动电荷引起的电磁场&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;有空多复习 ppt 和作业，多刷《大题典》，不要像我这样记太多笔记。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;cheatsheet.zip&#34; &gt;我的 cheat sheet&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;致谢&#34;&gt;致谢
&lt;/h2&gt;&lt;p&gt;Huge thanks to mjy, zzy, lhz, psy, qkx. 感谢你们解答了我这么多傻逼问题。&lt;/p&gt;
&lt;h2 id=&#34;第一节课&#34;&gt;第一节课
&lt;/h2&gt;&lt;h3 id=&#34;物理思想&#34;&gt;物理思想
&lt;/h3&gt;&lt;p&gt;数学和物理的差异：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-1.jpg&#34; style=&#34;zoom:15%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;牛顿力学和电磁学的视角的差异：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-2.jpg&#34; style=&#34;zoom:15%;&#34; /&gt;&lt;/center&gt;
&lt;h3 id=&#34;光的波粒二象性&#34;&gt;光的波粒二象性
&lt;/h3&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Wheeler%27s_delayed-choice_experiment&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;延迟选择实验&lt;/a&gt;。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-3.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;浅灰色的是半透镜，透 $50\%$ 反 $50\%$。如果右上没有半透镜，那么两个光屏上各 $50\%$，这体现出光的粒子性（左下处 $50\%$ 向右，$50\%$ 向上）。如果右上有，那么会发生干涉，导致两个光屏的亮度不同（尽管和为 $100\%$）。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;问题：第二个半透镜处的干涉是如何发生的？&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Beam_splitter#Phase_shift&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;答案&lt;/a&gt;。例如两束入射第二个半透镜的光线的振幅分别为 $\frac A{\sqrt{2}}\sin(\omega x+\varphi_1)$ 和 $\frac A{\sqrt{2}}\sin(\omega x+\varphi_2)$。那么两束出射光线就会是 $\frac A2[\sin(\omega x+\varphi_1)+\sin(\omega x+\varphi_2)]$ 和 $\frac A2[\sin(\omega x+\varphi_1+\pi)+\sin(\omega x+\varphi_2)]$，两者振幅分别为 $A\cos\frac{\varphi_1-\varphi_2}2$ 和 $A\sin\frac{\varphi_1-\varphi_2}2$，符合强度之和为 $A^2$ 的守恒性。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-4.gif&#34; /&gt;&lt;/center&gt;
&lt;p&gt;追问：两束相位差为 $\pi$ 的光干涉，不就违反能量守恒了吗？&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/525841505/answer/2424533220&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/525841505/answer/2424533220&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;场的数学描述&#34;&gt;场的数学描述
&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;老问题：为什么场线（本质是积分曲线）的密度可以体现场强？&lt;/p&gt;
&lt;p&gt;答：我们要明确的是，当我们说“场线越密场强越强”时，我们说的对象是“同一束场线”。&lt;br&gt;
假设场是连续的。对于同一束场线，考虑它们所处的两个“截”曲面（实际上这个截面是无数条场线形成的，形成方法是每个点处的场线都是截面在该处切面的法向量），密度越密，截面面积越小，而因为是同一束场线，故通量相等，故场强越大。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;练习：证明 $\nabla T(\b x_0)$ 与 $T(\b x_0)$ 所在的等高线（面）在 $\b x_0$ 处的切线（面）垂直。&lt;br&gt;
事实上，$n-1$ 维超平面的法向量就是用 $\nabla$ 定义的，所以是弱智。&lt;br&gt;
详细说一下，$T(\b x_0)$ 所在的等高线（面）$T(\b x)=T(\b x_0)$ 在 $\b x_0$ 处的切面，这个切面中的所有向量 $\Delta\b x$，它们都是形如“从 $\b x_0$ 出发往 $\b x_0$ 方向走，近似看来不会使 $T(\b x_0+\Delta x)$ 变化”，用数学语言说，就是 $\nabla T(\b x_0)\cdot\Delta\b x=0$。&lt;/p&gt;
&lt;h2 id=&#34;矢量分析&#34;&gt;矢量分析
&lt;/h2&gt;&lt;h3 id=&#34;基本定义&#34;&gt;基本定义
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;梯度（gradient）标量→矢量
$$
\nabla f=\left(\frac{\p f}{\p x},\frac{\p f}{\p y},\frac{\p f}{\p z}\right)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;散度（divergence）矢量→标量
$$
\nabla\cdot\b F=\frac{\p\b F_x}{\p x}+\frac{\p\b F_y}{\p y}+\frac{\p\b F_z}{\p z}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;旋度（curl）矢量→矢量
$$
\nabla\times\b F=\left(\frac{\p\b F_z}{\p y}-\frac{\p\b F_y}{\p z},\frac{\p\b F_x}{\p z}-\frac{\p\b F_z}{\p x},\frac{\p\b F_y}{\p x}-\frac{\p\b F_x}{\p y}\right)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;通量（flux）
$$
\Phi=\iint_S\b F\cdot\d\b s
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;环量（circulation）
$$
\Gamma=\oint_L\b F\cdot\d\b l
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当我们把 $\nabla$ 当作一个“向量算子”时，我们的依据是，点乘和叉乘在空间变换下形式不变，而与偏导相关的也是如此。&lt;/p&gt;
&lt;p&gt;接下来，我们要做的，就是借助通量和环量的几何直观，证明散度和旋度的几何直观。&lt;/p&gt;
&lt;h3 id=&#34;stokes-公式相关&#34;&gt;Stokes 公式相关
&lt;/h3&gt;&lt;h3 id=&#34;gauss-公式&#34;&gt;Gauss 公式
&lt;/h3&gt;&lt;p&gt;显然，一个大曲面的通量可以拆分成多个小曲面的通量之和。考虑一个极小立方体（左下角所处位置 $(x,y,z)$）。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-5.jpg&#34; style=&#34;zoom:30%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;两个 $yz$ 平面的通量为 $[\b F_x(x+\d x,y,z)-\b F_x(x,y,z)]\d y\d z$。&lt;/p&gt;
&lt;p&gt;注意，这里 $x+\d x$ 和 $x$ 要区分，而 $y$、$z$ 不需要区分。&lt;/p&gt;
&lt;p&gt;这个式子可以写成 $\frac{\p\b F_x}{\p x}\d x\d y\d z$。其余两个方向同理。&lt;/p&gt;
&lt;p&gt;于是
$$
\oiint_S\b F\cdot \d\b s=\iiint_{V}\left(\frac{\p\b F_x}{\p x}+\frac{\p\b F_y}{\p y}+\frac{\p\b F_z}{\p z}\right)\d v=\iiint_V(\nabla\cdot\b F)\d v
$$
那么在一个实际的矢量场中，我们认为场的分布是连续的，那么我们认为一个点 $(x,y,z)$ 附近的每个点和它的性质是相近的，所以我们认为 $\Phi=VQ$，这里 $Q$ 就是我们希望得到的“体积流率”。对上式两侧除以 $V$ 并 $V\to 0$，得 $Q=\nabla\times\b F$。这就是散度的物理意义——一个点出流的量。&lt;/p&gt;
&lt;h3 id=&#34;green-公式--stokes-公式&#34;&gt;Green 公式 &amp;amp; Stokes 公式
&lt;/h3&gt;&lt;p&gt;同样，闭曲线的环量也可以拆分。先看二维情况，考虑一个极小正方形。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-6.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;环量为 $(\b F_x(x,y)-\b F_x(x,y+\d y))\d x+(\b F_y(x+\d x,y)-\b F_y(x,y))\d y=\left(\frac{\p\b F_y}{\p x}-\frac{\p\b F_x}{\p y}\right)\d x\d y$。&lt;/p&gt;
&lt;p&gt;于是有
$$
\oint_L\b F\cdot\d\b l=\iint_S\left(\frac{\p\b F_y}{\p x}-\frac{\p\b F_x}{\p y}\right)\d s
$$
那么对于三维的情况，如果只考虑 $xy$ 平面，那么得到的是旋度的 $z$ 方向（根据旋转方式—转轴的右手定则）。因此考虑另两维，就得到的完整的公式。对于理解“拆分维度分量”有困难的情况，我们可以这样考虑：一般化面积微元，设小块是两边为 $\b d_1,\b d_2$ 的平行四边形。环量为
$$
\begin{align*}
&amp;amp;(\b F(\b x)-\b F(\b x+\b d_2))\cdot\b d_1+(\b F(\b x+\b d_1)-\b F(\b x))\cdot\b d_2\\
={}&amp;amp;-(\nabla\cdot\b F_x\cdot\b d_2,\nabla\cdot\b F_y\cdot\b d_2,\nabla\cdot\b F_z\cdot\b d_2)\cdot\b d_1+(\nabla\cdot\b F_x\cdot\b d_1,\nabla\cdot\b F_y\cdot\b d_1,\nabla\cdot\b F_z\cdot\b d_1)\cdot\b d_2\\
={}&amp;amp;-\b d_1\J_{\b F}\b d_2^\top+\b d_2\J_{\b F}\b d_1^\top\\
={}&amp;amp;\sum\frac{\p\b F_i}{\p x_j}({\b d_2}_i{\b d_1}_j-{\b d_1}_i{\b d_2}_j)\\
={}&amp;amp;\left(\frac{\p\b F_z}{\p y},\frac{\p\b F_x}{\p z},\frac{\p\b F_y}{\p x}\right)\cdot(\b d_1\times\b d_2)-\left(\frac{\p\b F_y}{\p z},\frac{\p\b F_z}{\p x},\frac{\p\b F_x}{\p y}\right)\cdot(\b d_1\times\b d_2)\\
={}&amp;amp;(\nabla\times\b F)\cdot(\b d_1\times\b d_2)
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;而这个 $\b d_1\times\b d_2$ 就是面积向量。因此我们得到
$$
\oint_L\b F\cdot\d\b l=\iint_S(\nabla\times\b F)\cdot\d\b s
$$
同样，考虑不断缩小面积 $S$，就可以得到旋度的物理意义：一个点周围单位面积旋转的强度（这个强度是相对于转轴而言的，由旋度点乘转轴方向得到的，可以类比梯度），其中最强的就是与旋度同向的转轴。&lt;/p&gt;
&lt;h3 id=&#34;无旋场&#34;&gt;无旋场
&lt;/h3&gt;&lt;p&gt;$$
\boxed{\nabla\times(\nabla f)=\b 0}
$$&lt;/p&gt;
&lt;p&gt;梯度的旋度等于 $0$，直觉，沿着某个方向增加的场不会侧向旋转。&lt;/p&gt;
&lt;p&gt;换句话说，梯度场一定是无旋场。&lt;/p&gt;
&lt;p&gt;接下来说明，无旋场一定是某个梯度场。&lt;/p&gt;
&lt;p&gt;对于无旋场 $\b F$，它是路径无关的，因为由格林公式，
$$
\oint_L\b F\cdot\d\b l=\iint_S(\nabla\times\b F)\cdot\d\b s=0
$$
那么，构造函数 $f$：
$$
f(\b x)=\int_{\b x_0}^{\b x}\b F\cdot\d\b l
$$
其中 $\b x_0$ 是任选的一个点。&lt;/p&gt;
&lt;p&gt;这里，能用上下限的形式来表示大于一维空间的积分，其&lt;strong&gt;良定义&lt;/strong&gt;性是由路径无关保证的。具体而言：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;定义
$$
\int_{\b x_1}^{\b x_2}\nabla f\cdot\d\b l=\int_{\b x_1}^{\b x_2}\d f=f(\b x_2)-f(\b x_1)
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;现在，显然有 $\nabla f=\b F$（&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Gradient_theorem#Converse_of_the_gradient_theorem&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;严格证明&lt;/a&gt;）。&lt;/p&gt;
&lt;p&gt;另外，保守场意味着，任意回路的环量都是 $0$。由于回路可以任取，故必须要求 $\nabla\times\b F$ 处处为 $\b 0$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;一句话概括：梯度场 $\Longleftrightarrow$ 无旋场 $\Longleftrightarrow$ 保守场。&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;例-1&#34;&gt;例 1
&lt;/h4&gt;&lt;p&gt;考虑静电场。这里，电场力就是上文的 $\b F$。&lt;/p&gt;
&lt;p&gt;证明对于单个点电荷，其形成的电场无旋：
$$
\b F=-\frac{kQ\b r}{|\b r|^3}\\
\frac{\p\b F_x}{\p y}=3kQ\frac{xy}{|\b r|^5}=\frac{\p\b F_y}{\p x}
$$
我们也可以从环路积分的角度验证它无旋。&lt;/p&gt;
&lt;p&gt;那现在，我们就可以定义电势，这里定义的积分是 $\int_{\b x}^{无穷远处}$。得到
$$
\varphi=-\frac{kQ}{|\b r|}
$$&lt;/p&gt;
&lt;h3 id=&#34;无散场&#34;&gt;无散场
&lt;/h3&gt;&lt;p&gt;$$
\boxed{\nabla\cdot(\nabla\times\b F)=0}
$$&lt;/p&gt;
&lt;p&gt;旋度的散度等于 0，直觉，旋转的场不会有起点和终点。可以从磁场的角度理解——磁感线一定是闭合的。&lt;/p&gt;
&lt;p&gt;无散场有性质
$$
\oiint_S\b F\cdot\d\b s=\iiint_V(\nabla\cdot\b F)\d v=0
$$
不是特别好用“保守”之类的说法描述。&lt;/p&gt;
&lt;p&gt;然后无散场一定是某个矢量场的旋度（这样的一个旋度被称为矢量势能）。证明如下：&lt;/p&gt;
&lt;p&gt;设 $\b F=\nabla\times\b f$。令 $\b f_z=0$。方程化为
$$
\left\{\begin{align*}
-\frac{\p\b f_y}{\p z}&amp;amp;=\b F_x\\
\frac{\p\b f_x}{\p z}&amp;amp;=\b F_y\\
\frac{\p\b f_y}{\p x}-\frac{\p\b f_x}{\p y}&amp;amp;=\b F_z
\end{align*}\right.
$$
所以可以取
$$
\left\{
\begin{align*}
\b f_x&amp;amp;=\int_{z_0}^z\b F_y\d t_z+C_x(x,y)\\
\b f_y&amp;amp;=-\int_{z_0}^z\b F_x\d t_z+C_y(x,y)
\end{align*}
\right.
$$
代入最后一式，得
$$
-\int_{z_0}^z\left(\frac{\p\b F_x}{\p x}+\frac{\p\b F_y}{\p y}\right)\d t_z+\frac{\p C_y}{\p x}-\frac{\p C_x}{\p y}=\b F_z
$$
取 $C_x\equiv 0$，那么
$$
\begin{align*}
\frac{\p C_y}{\p x}&amp;amp;=\b F_z+\int_{z_0}^z\left(\frac{\p\b F_x}{\p x}+\frac{\p\b F_y}{\p y}\right)\d t_z\\
&amp;amp;=\b F_z-\int_{z_0}^z\frac{\p\b F_z}{\p z}\d t_z\\
&amp;amp;=\left.\b F_z\right|_{z=z_0}
\end{align*}
$$
这保证了 $C_y$ 与 $z$ 维无关，否则就无解了。&lt;/p&gt;
&lt;p&gt;因此
$$
C_y(x,y)=\int_{x_0}^x\b F_z(t_x,y,z_0)\d t_x
$$
同时，任何 $f+\nabla C$ 都是解。&lt;/p&gt;
&lt;p&gt;最后我们给出 Helmholtz decomposition：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;任何一阶微分连续的向量场，都可以表示为一个无旋场和无散场的叠加。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;常用公式&#34;&gt;常用公式
&lt;/h3&gt;&lt;p&gt;见 cheat sheet。&lt;/p&gt;
&lt;h3 id=&#34;一些技巧&#34;&gt;一些技巧
&lt;/h3&gt;&lt;p&gt;$$
\nabla\cdot(\b g\times\b f)=\nabla_{\b g}\cdot(\b g\times\b f)+\nabla_{\b f}\cdot(\b g\times\b f)=\b f\cdot(\nabla\times\b g)-\b g\cdot(\nabla\times\b f)\\
\nabla\times(\b g\times\b f)=\nabla_{\b g}\times(\b g\times\b f)+\nabla_{\b f}\times(\b g\times\b f)=(\b f\cdot\nabla)\b g-(\nabla\cdot\b g)\b f+(\nabla\cdot\b f)\b g-(\b g\cdot\nabla)\b f
$$&lt;/p&gt;
&lt;p&gt;遇到 $\nabla\circ(\b f_1\circ\b f_2)$  形式，其展开式中，每个单项式都形如
$$
\frac{\p({\b f_1}_i{\b f_2}_j)}{\p x_k}
$$
因此它一定能拆成两个只对其中一个项求偏导之和的形式。因此上文中 $\nabla_{\b g}$、$\nabla_{\b f}$ 的意思就是说，“碰到 $\b g/\b f$ 才偏导，另一个直接数乘”。这个方便记忆，推导不是很正规。&lt;/p&gt;
&lt;p&gt;关于求电场和电势，各有三种方法：① 直接积分；② 高斯定律+对称性；③ $-\nabla\varphi$。① 直接积分；② $\nabla^2\varphi=-\rho/\eps_0$；③ $\int\b E$。&lt;/p&gt;
&lt;h3 id=&#34;曲线坐标系相关&#34;&gt;曲线坐标系相关
&lt;/h3&gt;&lt;p&gt;当时我在看这个的时候很困惑，其实只需要明确几点原则就行：曲线坐标系里的向量是有起点的，不是平移不变的。向量坐标直接运算是没有意义的，因此（除非起点为原点，这时向量就表示位置）向量的终点也没有意义，只是表示朝向和大小。曲线坐标系里分基向量和单位基向量。各处的基向量不同。这个课里只考虑各单位向量均互相垂直的坐标系，包括极坐标系、柱坐标系、球坐标系。&lt;/p&gt;
&lt;p&gt;接下来以球坐标系 $\rho\theta\phi$ 为例。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;1-7.svg&#34; /&gt;&lt;/center&gt;
&lt;p&gt;对于一个位置 $\b r$，定义各基向量为
$$
\b e_i=\frac{\p\b r}{\p x_i}
$$
其中 $x_i$ 表示某维。对于具体情况一般习惯写 $\b e_\rho$、$\b e_\theta$、$\b e_\phi$ 或 $\b\rho$、$\b\theta$、$\b\phi$。&lt;/p&gt;
&lt;p&gt;定义单位基向量为单位化的基向量。基向量的模长称为拉梅系数 $h_i$。单位基向量写作 $\b{\hat e}_\rho$ 等或 $\b{\hat\rho}$ 等。这篇笔记里我们统一把单位基向量写成后面这种，包括直角坐标系。&lt;/p&gt;
&lt;p&gt;在球坐标系中，$h_\rho=1$，$h_\theta=\rho$，$h_\phi=\rho\sin\theta$。“定义”全微分
$$
\d\b r=\b\rho\d\rho+\b\theta\d\theta+\b\phi\d\phi=\b{\hat\rho}h_\rho\d\rho+\b{\hat\theta}h_\theta\d\theta+\b{\hat\phi}h_\phi\d\phi
$$
求各种微分形式（这个词能这么用吗…）的球面坐标表示，可以把直角坐标系的表达式用坐标变换公式转过去，期间用多元函数的链式求导法则把 $/\p x$ 变成 $/\p\rho$ 等。一个更直接的方法就是，我们知道，比如说
$$
\nabla f\cdot\b{\hat\phi}=\frac{\nabla f\cdot\b\phi}{h_\phi}=\frac1{h_\phi}\frac{\p f}{\p\phi}
$$
第二个等号是因为梯度的定义。所以
$$
\nabla=\frac{\b{\hat\rho}}{h_\rho}\frac{\p}{\p\rho}+\frac{\b{\hat\theta}}{h_\theta}\frac{\p}{\p\theta}+\frac{\b{\hat\phi}}{h_\phi}\frac{\p}{\p\phi}
$$
其实基于各基向量垂直，这个是很直观的。&lt;/p&gt;
&lt;p&gt;求散度、旋度这些，一种思路是，还是像上面这样，但是注意到 $\p{\b{\hat x}_i}/\p x_j$ 这种东西的结果不是 $\b 0$。通过转直角坐标系求出它们之后就简单了。&lt;/p&gt;
&lt;p&gt;所以为什么三种 $\nabla$ 都可以用这个式子呢？或者应该问为什么 $\nabla$ 在不同坐标系下有某个不变性呢？&lt;/p&gt;
&lt;p&gt;看到过有同学用更简洁的方法推 $\nabla^2$，好像是用的一些更高端的方法。&lt;/p&gt;
&lt;h2 id=&#34;静电学的基本公式&#34;&gt;静电学的基本公式
&lt;/h2&gt;&lt;p&gt;电势的思想略，这边默认会高中的内容。&lt;/p&gt;
&lt;h3 id=&#34;高斯定律&#34;&gt;高斯定律
&lt;/h3&gt;&lt;p&gt;$$
\left\{\begin{align*}
\nabla\cdot\b E&amp;amp;=\frac{\rho}{\eps_0}\\
\nabla\times\b E&amp;amp;=-\frac{\p\b B}{\p t}\\
\nabla\cdot\b B&amp;amp;=0\\
\nabla\times\b B&amp;amp;=\mu_0\b j+\mu_0\eps_0\frac{\p\b E}{\p t}
\end{align*}\right.
$$&lt;/p&gt;
&lt;p&gt;当 $\b E$ 和 $\b B$ 都是恒定时，方程变为
$$
\left\{\begin{align*}
\nabla\cdot\b E&amp;amp;=\frac{\rho}{\eps_0}\\
\nabla\times\b E&amp;amp;=0\\
\nabla\cdot\b B&amp;amp;=0\\
\nabla\times\b B&amp;amp;=\mu_0\b j
\end{align*}\right.
$$
于是电磁场就分开了。&lt;/p&gt;
&lt;p&gt;$\rho$（电荷密度）确定了 $\Rightarrow$ 散度和旋度都确定了 $\Rightarrow$ 电场确定了（除了加常数，&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Helmholtz_decomposition#Fields_with_prescribed_divergence_and_curl&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;说明&lt;/a&gt;）&lt;/p&gt;
&lt;p&gt;电荷是量子化的——&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Oil_drop_experiment&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;油滴实验&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;电场是保守场，这个和 $\nabla\times\b E=\b 0$ 对应，这意味着，单个点电荷的电场一定是与 $\b r$ 共线的。虽然如此，具体的强度（平方反比）没有要求，因此还需要另一个方程。为什么说 $\nabla\cdot\b E=\rho/\eps_0$ 限制了平方反比呢？考虑圆心上有个点电荷的球面：
$$
\Phi=\oiint_S\b E\d\b s=4\pi r^2\cdot\frac{q}{4\pi\eps_0r^2}=\frac{q}{\eps_0}
$$
&lt;strong&gt;只有平方&lt;/strong&gt;，才能使电通量与球半径&lt;strong&gt;无关&lt;/strong&gt;。诶，可以类比光通量。&lt;/p&gt;
&lt;p&gt;库仑定律（$\b F=\frac{1}{4\pi\eps_0}\frac{q_1q_2}{|\b r|^3}\b r$）和叠加定律，和麦克斯韦方程组的前两个可以互推。&lt;/p&gt;
&lt;p&gt;这里 $\eps_0\approx 8.85\times 10^{-12}\unit{C^2/(N\cdot m^2)}$ 是真空的介电常数。注意量纲！&lt;/p&gt;
&lt;h3 id=&#34;推导&#34;&gt;推导
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;关键式子&lt;/strong&gt;：对于 $\b r\ne\b r_0$，
$$
\nabla\cdot\frac{\b r-\b r_0}{|\b r-\b r_0|^3}=\frac{\nabla\cdot(\b r-\b r_0)}{|\b r-\b r_0|^3}+(\nabla\frac{1}{|\b r-\b r_0|^3})\cdot(\b r-\b r_0)=\frac{3}{|\b r-\b r_0|^3}-\frac{3(\b r-\b r_0)\cdot(\b r-\b r_0)}{|\b r-\b r_0|^5}=0\\
\nabla\times\frac{\b r-\b r_0}{|\b r-\b r_0|^3}=\frac{\nabla\times(\b r-\b r_0)}{|\b r-\b r_0|^3}+(\nabla\frac{1}{|\b r-\b r_0|^3})\times(\b r-\b r_0)=\b 0+\frac{3(\b r-\b r_0)\times(\b r-\b r_0)}{|\b r-\b r_0|^5}=\b 0
$$&lt;/p&gt;
&lt;p&gt;（有些书里会管 $\b r-\b r^\prime$ 叫花体的 r）&lt;/p&gt;
&lt;p&gt;库仑定律 $+$ 叠加定律 $\Rightarrow$ 高斯定律积分形式：（$V^\prime\subseteq V$，$B_\eps(\cdot)$ 是球，$S_\eps(\cdot)$ 是球面）
$$
\begin{align*}
\Phi(V^\prime)&amp;amp;=\oiint_{\p V^\prime}\b E(\b r)\cdot\d\b s\\
&amp;amp;=\oiint_{\p V^\prime}\iiint_{V}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;=\oiint_{\p V^\prime}\iiint_{V^\prime}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;+\oiint_{\p V^\prime}\iiint_{V\setminus V^\prime}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;=\iiint_{V^\prime}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\oiint_{\p V^\prime}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;+\iiint_{V^\prime}\d v^\prime\boxed{\nabla\cdot\iiint_{V\setminus V^\prime}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}}_{=0}\\
&amp;amp;=\iiint_{V^\prime}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\left(\boxed{\oiint_{\p(V^\prime\setminus B_\delta(\b r^\prime))}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s}_{=0}+\oiint_{S_\delta(\b r^\prime)}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\right)\\
&amp;amp;=\iiint_{V^\prime}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\oiint_{S_\delta(\b r^\prime)}\frac{\d\b n}{\delta^2}\\
&amp;amp;=\iiint_{V^\prime}\frac{\rho(\b r^\prime)}{\eps_0}\d v
\end{align*}
$$
高斯定律积分形式 $\Rightarrow$ 高斯定律微分形式：
$$
\iiint_{V^\prime}\nabla\cdot\b E(\b r)\d v=\oiint_{\p V^\prime}\b E(\b r)\cdot\d\b s=\iiint_{V^\prime}\frac{\rho(\b r^\prime)}{\eps_0}\d v\\
\Downarrow\\
\nabla\cdot\b E=\frac{\rho}{\eps_0}
$$&lt;/p&gt;
&lt;p&gt;高斯定律 $\Rightarrow$ 库仑定律：太简单了。注意空间中不能弥漫着一个常数矢量的电场，否则就违反了球面对称性。&lt;/p&gt;
&lt;p&gt;库仑定律 $+$ 叠加定律 $\Rightarrow$ 无旋性质：这里我们就只推单点电荷的了。（以下，$S$ 是包含 $\b r_0$ 的任意曲面）
$$
\begin{align*}
&amp;amp;\oint_{\p S}\b E(\b r)\cdot\d\b l\\
={}&amp;amp;\boxed{\iint_{S\setminus B_\delta(\b r_0)}(\nabla\times\b E(\b r))\cdot\d\b s}_{=0}+\oint_{\p(S\cap B_\delta(\b r_0))}\b E(\b r)\cdot\d\b l\\
={}&amp;amp;\oint_{S\cap S_\delta(\b r_0)}\frac{q}{4\pi\eps_0}\frac{\boxed{(\b r-\b r_0)\cdot\d\b l}_{=0}}{|\b r-\b r_0|^3}\\
={}&amp;amp;0
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;这个利用的是球面上的切向量与径向量垂直。然后再比对：
$$
0=\oint_{\p S}\b E(\b r)\cdot\d\b l=\iint_S(\nabla\times\b E(\b r))\cdot\d\b s
$$
这看起来像废话，如果把单个电荷换成连续分布的电荷密度就显得不是废话了，&lt;del&gt;我只是懒得写了&lt;/del&gt;。&lt;/p&gt;
&lt;p&gt;最后提一句，&lt;strong&gt;高斯定律必须在有界区域上用&lt;/strong&gt;，不然你考虑一个点电荷的球邻域的补，它就爆了。&lt;/p&gt;
&lt;h3 id=&#34;狄拉克-δ-函数&#34;&gt;狄拉克 δ 函数
&lt;/h3&gt;&lt;p&gt;我们注意到，上面的推导核心思路是这样的：&lt;/p&gt;
&lt;p&gt;利用 Stokes 公式家庭在两个维数之间转化，充分利用关键式子，将与中心相离的部分扔掉，剩下中心的一个球形邻域，利用球的性质直接搞掉。最后再利用 Stokes 公式家庭，&lt;strong&gt;比对&lt;/strong&gt;两个积分式，得出微分形式的结果。&lt;/p&gt;
&lt;p&gt;这里我们逃不开比对，有什么好的方法吗？我们要引入狄拉克 $\delta$ 函数。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://wuli.wiki/online/Delta.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;定义&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这里最关键的两个事是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$$
\begin{align*}
&amp;amp;\forall a&amp;lt;b\in\R\cup\set{\pm\infty}\setminus\set{0},\lim_{n\to\infty}\int_a^b\delta_n(x)\d x=[0\in(a,b)]\\
\Longrightarrow{}&amp;amp;\forall f\in C(\R),\lim_{n\to\infty}\int_{-\infty}^{+\infty}\delta_n(x)f(x)=f(0)
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;当我们说一个玩意 $*$ 等于 $\delta(x)$ 之类的东西的时候，我们本质上在说的是存在一种通过狄拉克 $\delta$ 函数列逼近 $*$ 的方式。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以说回来，之所以
$$
\nabla\cdot\left(\frac{\b{\hat r}}{r^2}\right)=4\pi\delta^3(\b r)
$$
（这里 $\b{\hat r}$ 指被单位化过的 $\b r$）是因为我们存在一系列，例如说
$$
\left\{{\frac{4}{3}\pi\delta_i^3f_i(\b x)=\iiint_{B_{\delta_i}(\b x)}\nabla\cdot\left(\frac{\b{\hat r}}{r^2}\right)\d v=\oiint_{S_{\delta_i}(\b x)}\frac{\b{\hat r}}{r^2}\cdot\d\b s=\big([|\b x|&amp;lt;\delta_i]+[|\b x|\le\delta_i]\big)2\pi}\right\}
$$
（其中 $\set{\delta_i}$ 趋近于 $0$）这样的函数列 $\set{f_i(\b x)}$，它一方面趋近于 $\nabla\cdot(\b{\hat r}/r^2)$，一方面符合狄拉克 $\delta$ 函数列的定义的三次方 $4\pi$ 倍，于是就可以画上一个等号，意思是说 $\nabla\cdot(\b{\hat r}/r^2)$ 的行为和一般的狄拉克 $\delta$ 函数类似，能够替换。注意 $\delta^3(\b r)=\delta(x)\delta(y)\delta(z)$。&lt;/p&gt;
&lt;p&gt;这时，
$$
\begin{align*}
\nabla\cdot\b E(\b r)&amp;amp;=\iiint_V\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\left(\nabla\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\right)\\
&amp;amp;=\iiint_V\frac{\rho(\b r^\prime)\d v}{\eps_0}\delta^3(\b r-\b r^\prime)\\
&amp;amp;=\frac{\rho(\b r^\prime)}{\eps_0}
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;这个时候你会感觉，我好像说了很多，但好像又什么也没说。这里的问题在于，不平凡的推导部分本质上是 狄拉克 $\delta$ 函数的常规定义（其他地方（积分）趋近于 $0$，整个积分（趋近于）为 $1$）$\Longrightarrow$ 它的卷积“萃取”性质。但这个我不会证（悲）&lt;/p&gt;
&lt;p&gt;但是在这里具体的情况下还是可以证的：
$$
\nabla\cdot\b E(\b r)=\lim_{\delta\to 0^+}\left[\boxed{\iiint_{V\setminus B_\delta(\b r)}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\left(\nabla\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\right)}_{=0}+\nabla\cdot\iiint_{B_\delta(\b r)}\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\right]
$$
注意，这里 $\nabla$ 并非对 $B_\delta(\b r)$、$\rho(\b r)$、$(\b r-\b r^\prime)/|\b r-\b r^\prime|^3$ 这三者都求导，只是对最后一个求。如果要都求会导致 $\rho$ 提不出来。&lt;/p&gt;
&lt;p&gt;由于 $\rho$ 是连续函数，故在 $B_{\delta}(\b r)$ 上一致连续，把这个连续和左边 $\lim$ 的 $\eps-\delta$ 定义写开来搞一搞，可以得到
$$
\begin{align*}
\nabla\cdot\b E(\b r)&amp;amp;=\frac{\rho(\b r)}{4\pi\eps_0}\lim_{\delta\to 0^+}\left(\nabla\cdot\iiint_{B_\delta(\b r)}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\d v\right)\\
&amp;amp;=\frac{\rho(\b r)}{4\pi\eps_0}\lim_{\delta\to 0^+}\left(\iiint_{B_\delta(\b r)}\nabla_{\b r}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\d v\right)\\
&amp;amp;=-\frac{\rho(\b r)}{4\pi\eps_0}\lim_{\delta\to 0^+}\left(\iiint_{B_\delta(\b r)}\nabla_{\b r^\prime}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\d v\right)\\
&amp;amp;=-\frac{\rho(\b r)}{4\pi\eps_0}\lim_{\delta\to 0^+}\oiint_{S_\delta(\b r)}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;=-\frac{\rho(\b r)}{4\pi\eps_0}(-4\pi)=\frac{\rho(\b r)}{\eps_0}
\end{align*}
$$
写完上式后，我不禁开始问自己，在处理这种无穷的时候，我们本质上在做什么？就是在积分时把未定义点抠掉。这个抠掉并不会影响结果，但并不能因此就说，我们可以利用 $\nabla\cdot(\b{\hat r}/r^2)=0$ 把整个式子都化成零，因为 $\nabla$，求导，它是一个极限过程。尽管极限过程中不断有邻域外的部分贡献变为 $0$，但邻域内永远是有贡献的。那这里我们发现这个贡献恒为 $4\pi$。&lt;strong&gt;所以严谨地来说，这里的积分区域应当去掉 $\set{\b r}$，然后 $\nabla$ 不能直接换进积分里，只能在外面展开成 $\lim$&lt;/strong&gt;。狄拉克 $\delta$ 函数，其实就是在允许 $\nabla$ 换进积分的同时，保证极限过程不丢。于是其实可以这样严谨地写：
$$
\begin{align*}
\nabla\cdot\b E(\b r_0)&amp;amp;=\lim_{\delta\to 0^+}\frac{3}{4\pi\delta^3}\iiint_{B_\delta(\b r_0)}\nabla\cdot\b E(\b r)\d v\\
&amp;amp;=\lim_{\delta\to 0^+}\frac{3}{4\pi\delta^3}\oiint_{S_\delta(\b r_0)}\b E(\b r)\cdot\d\b s\\
&amp;amp;=\lim_{\delta\to 0^+}\frac{3}{4\pi\delta^3}\oiint_{S_\delta(\b r_0)}\iiint_V\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\cdot\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;=\lim_{\delta\to 0^+}\frac{3}{4\pi\delta^3}\iiint_V\frac{\rho(\b r^\prime)\d v}{4\pi\eps_0}\oiint_{S_\delta(\b r_0)}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}\cdot\d\b s\\
&amp;amp;=\lim_{\delta\to 0^+}\frac{3}{4\pi\delta^3}\iiint_{B(\b r_0,\delta)}\frac{\rho(\b r^\prime)\d v}{\eps_0}\\
&amp;amp;=\lim_{\delta\to 0^+}\frac{3\rho(\b r_0)}{4\pi\delta^3}\iiint_{B(\b r_0,\delta)}\frac{\d v}{\eps_0}\\
&amp;amp;=\frac{\rho(\b r_0)}{\eps_0}
\end{align*}
$$
所以说相比积分形式，微分形式就是多了个取极限，多了个利用连续性把 $\rho(\cdot)$ 提出来的操作。&lt;/p&gt;
&lt;p&gt;同样的，旋度也可以用极限的方式来考虑。但是旋度不一样的地方在于，它涉及两个形式对称的导数的差，所以就是严格的 $0$。&lt;/p&gt;
&lt;h3 id=&#34;题外话&#34;&gt;题外话
&lt;/h3&gt;&lt;p&gt;如何构造一个电场，使得一个正电荷在一处稳定平衡？&lt;/p&gt;
&lt;p&gt;这样一个电场直觉上，任何包含正电荷的封闭面，电通量都得是负的，这说明这个正电荷处本身得有个负电荷！&lt;/p&gt;
&lt;p&gt;但是交变电场是可以的，离子阱。&lt;/p&gt;
&lt;p&gt;如果我们在八个顶点 $(\pm1,\pm1,\pm1)$ 放等量电荷，那么电场为：
$$
\b E=\frac{q}{4\pi\eps_0}\sum_{\b x_0}\frac{\b x-\b x_0}{|\b x-\b x_0|^3}
$$&lt;/p&gt;
&lt;p&gt;$$
\frac{\p\b E_i}{\p x_i}=\frac{q}{4\pi\eps_0}\sum_{\b x_0}\left(\frac{1}{|\b x-\b x_0|^3}-\frac{3(\b x_i-{\b x_0}_i)^2}{|\b x-\b x_0|^5}\right)
$$&lt;/p&gt;
&lt;p&gt;$$
\frac{\p\b E_i}{\p x_j}=-\frac{q}{4\pi\eps_0}\sum_{\b x_0}\frac{3(\b x_i-{\b x_0}_i)(\b x_j-{\b x_0}_j)}{|\b x-\b x_0|^5}
$$&lt;/p&gt;
&lt;p&gt;显然 $\b E|_{\b x=\b 0}=\b 0$，但是
$$
\left.\frac{\p\b E_i}{\p x_i}\right|_{\b x=\b 0}=\left.\frac{\p\b E_i}{\p x_j}\right|_{\b x=\b 0}=0
$$
（额，怎么爆了啊）&lt;/p&gt;
&lt;p&gt;别急，我们有
$$
\left.\frac{\p^3\b E_i}{\p x_i^3}\right|_{\b x=\b 0}=\frac{224}{27\sqrt3}
$$
也就是说 $\varphi$ 在坐标轴方向的一、二、三阶偏导都是 $0$，而四阶 $&amp;lt;0$，所以它至少不是极小值点。所以这是不能稳定的。&lt;/p&gt;
&lt;p&gt;但是，如果我们将电荷限制在一个平面内，四个角摆上电荷，那么
$$
\left.\frac{\p\b E_i}{\p x_i}\right|_{\b x=\b 0}=-\frac{1}{\sqrt2},\;\left.\frac{\p\b E_i}{\p x_j}\right|_{\b x=\b 0}=0
$$
这就说明 $\H_\varphi(\b 0)&amp;gt;0$，而且 $\varphi_{xx}(\b 0)&amp;gt;0$，从而可以稳定。&lt;/p&gt;
&lt;p&gt;这个事情说明，二维和三维是有本质区别的，不能把电学问题放到二维去看。&lt;/p&gt;
&lt;h3 id=&#34;例-1-1&#34;&gt;例 1
&lt;/h3&gt;&lt;p&gt;高斯定律应用于一些常见的构形。可以记一下。&lt;/p&gt;
&lt;p&gt;无限长导线：显然 $\b E\parallel \b d$。做一个半径为 $d$，高为 $l$ 的圆柱。
$$
2\pi dl\cdot E=\frac{l\lambda}{\eps_0}\Rightarrow E=\frac{\lambda}{2\pi\eps_0d}
$$
无限大平面：显然 $\b E\parallel\b d$。做一个以带点平面为对称面的，高为 $2d$，底面积为 $S$ 的柱体。
$$
2S\cdot E=\frac{S\sigma}{\eps_0}\Rightarrow E=\frac{\sigma}{2\eps_0}
$$
半径为 $r$ 的球：显然 $\b E\parallel\b d$（这里 $\b d=\overrightarrow{OP}$）。
$$
4\pi d^2\cdot E=\frac{\rho\frac{4}{3}\pi\min(d,r)^3}{\eps_0}\Rightarrow E=\frac{\rho\min(d,r)^3}{3\eps_0d^2}=\left\{\begin{align*}&amp;amp;\frac{\rho d}{3\eps_0},&amp;amp;d\le r\\ &amp;amp;\frac{\rho r^3}{3\eps_0d^2},&amp;amp;d&amp;gt;r\end{align*}\right.
$$
半径为 $r$ 的球壳：
$$
E=\left\{\begin{align*}&amp;amp;0,&amp;amp;d&amp;lt;r\\ &amp;amp;\frac{\sigma r^2}{2\eps_0d^2}m,&amp;amp;d=r\\ &amp;amp;\frac{\sigma r^2}{\eps_0d^2},&amp;amp;d&amp;gt;r\end{align*}\right.
$$&lt;/p&gt;
&lt;p&gt;这里值得提的一点是，对于一个无限大平面，平面内的场强为 $\b 0$。我们最好避免高斯面和带电平面有测度非零的交，不然会出现奇怪的问题。可以参见后面导体情况的讨论。&lt;/p&gt;
&lt;p&gt;有多个平面的结构，会出现高斯定理给出的方程不够用的情况，这是要加个对称性的方程。&lt;/p&gt;
&lt;h2 id=&#34;电偶极子&#34;&gt;电偶极子
&lt;/h2&gt;&lt;h3 id=&#34;分析思路&#34;&gt;分析思路
&lt;/h3&gt;&lt;p&gt;考虑两个分别处于 $(0,0,\pm d/2)$ 的，带电量相反 $\pm Q$ 的点电荷，然后考虑较远处的电势。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;4-1.png&#34; style=&#34;zoom:15%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;&lt;strong&gt;法 1&lt;/strong&gt;：直接泰勒展开硬展。
$$
\begin{align*}
\varphi&amp;amp;=\frac{Q}{4\pi\eps_0}\left(\frac{1}{\sqrt{R^2+d^2/4-Rd\cos\theta}}-\frac{1}{\sqrt{R^2+d^2/4+Rd\cos\theta}}\right)\\
&amp;amp;=\frac{Q}{4\pi\eps_0R}\left(1+\frac{\cos\theta}{2}\frac{d}{R}-1+\frac{\cos\theta}{2}\frac{d}{R}+\omicron\left(\frac dR\right)\right)\\
&amp;amp;\approx\frac{Qd\cos\theta}{4\pi\eps_0R^2}
\end{align*}
$$
&lt;strong&gt;法 2&lt;/strong&gt;：我们可以把 $r_+$ 估成 $R-(d/2)\cos\theta$，把 $r_-$ 估成 $R+(d/2)\cos\theta$。据说可以通过几何方法证明这样只会和真正的值差高阶小量。然后
$$
\frac{1}{r_+}=\frac{1/R}{1-(d/2R)\cos\theta}=\frac1R\left(1+\frac{d}{2R}\cos\theta+\omicron\left(\frac{d}{2R}\right)\right)
$$
于是同样就得出上面那个式子。&lt;/p&gt;
&lt;p&gt;然后考虑 $\cos\theta$ 的几何意义——实际上就是（负电荷到正电荷的向量）和 $\overrightarrow{OP}$ 的夹角。如果我们把前者和 $Q$ 的积称为 $\b p$（&lt;strong&gt;偶极矩&lt;/strong&gt;）的话，就可以得到（这里开始 $R$ 相关的全部小写了）：
$$
\b p=Qd\b{\hat z}\\
\varphi=\frac{\b p\cdot\b r}{4\pi\eps_0r^3}\\
\b E=\frac{1}{4\pi\eps_0}\left(\frac{3(\b p\cdot\b r)\b r}{r^5}-\frac{\b p}{r^3}\right)
$$&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;法 3&lt;/strong&gt;：一开始正负电荷都在原点，对于正电荷来说，
$$
\varphi_0=\frac{1}{4\pi\eps_0r}
$$
考虑正电荷向上移动了 $\Delta z=d/2$。那么
$$
\Delta\varphi^+=\frac{\p\varphi_0}{\p z}(-\Delta z)
$$
同理
$$
\Delta\varphi^-=\frac{\p(-\varphi_0)}{\p z}\Delta z
$$
因此
$$
\Delta\varphi=-\frac{\p\varphi_0}{\p z}d=-\frac{\p}{\p z}\frac{Q}{4\pi\eps_0r}d=\frac{Qdz}{4\pi\eps_0r^3}=-\frac{1}{4\pi\eps_0}\b p\cdot\left(\nabla\frac{1}{r}\right)
$$
电四极子是电偶极子再求导。一种“离散”的电四极子的推导：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;4-2.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;假设中心是 $O$，然后这个在 $xy$ 平面上，边长为 $l$。先考虑单个沿 $y$ 轴的电偶极子
$$
\varphi^{(1)}(\b r)=\frac{ql}{4\pi\eps_0}\cdot\frac{y}{r^3}
$$
然后往两边“分裂”
$$
\Delta\varphi_+^{(1)}(\b r)=\Delta\varphi_-^{(1)}(\b r)=-\frac{\p\varphi(\b r)}{\p x}\left(\frac{l}{2}\right)=\frac{3ql^2xy}{8\pi\eps_0r^5}
$$
于是
$$
\varphi^{(2)}(\b r)=\frac{3ql^2xy}{4\pi\eps_0r^5}
$$&lt;/p&gt;
&lt;h3 id=&#34;电势的多级展开&#34;&gt;电势的多级展开
&lt;/h3&gt;&lt;p&gt;回顾多元函数的泰勒展开：
$$
f(\b x)=\sum_{i=0}^n\sum_{\sum c_j=i}\frac{1}{\prod c_j!}\cdot\frac{\p^i f}{\p x_j^{c_j}}(\b x_0)\cdot\prod(x_j-{x_0}_j)^{c_j}+\omicron(\lVert\b x-\b x_0\rVert^n)
$$
现在考虑在原点附近，一块小的有电荷的区域（不能视作点电荷），对较远处一点 $\b r$ 所造成的电势
$$
\varphi(\b r)=\frac{1}{4\pi\eps_0}\iiint_{V}\frac{\rho(\b r^\prime)\d v}{|\b r-\b r^\prime|}
$$
如果区域不在原点附近，考虑任取其中一点 $\b r_0$，然后 $1/|\b r-\b r^\prime|$ 变成 $1/|(\b r-\b r_0)-(\b r^\prime-\b r_0)|$ 之后也是一样的，后面不讨论。&lt;/p&gt;
&lt;p&gt;泰勒展开当然不能直接用于 $\b r$ 啊，那就考虑在 $\b r$ 处展开 $f(\b x)=1/|\b x|$ 吧：
$$
f(\b r-\b r^\prime)=\frac{1}{|\b r|}-\sum_{i=1}^3\frac{\p\frac{1}{|\b r|}}{\p x_i}\b r^\prime_{i}+\frac{1}{2}\sum_{i=1}^3\sum_{j=1}^3\frac{\p^2\frac{1}{|\b r|}}{\p x_i\p x_j}\b r^\prime_i\b r^\prime_j-\cdots
$$
将积分写进来，就得到
$$
\begin{align*}
4\pi\eps_0\varphi(\b r)&amp;amp;=\frac{1}{|\b r|}\iiint_V\rho(\b r^\prime)\d v-\sum_{i=1}^3\frac{\p\frac{1}{|\b r|}}{\p x_i}\iiint_{V}\b r^\prime_{i}\rho(\b r^\prime)\d v+\frac{1}{2}\sum_{i=1}^3\sum_{j=1}^3\frac{\p^2\frac{1}{|\b r|}}{\p x_i\p x_j}\iiint_V\b r^\prime_i\b r^\prime_j\rho(\b r^\prime)\d v-\cdots\\
&amp;amp;=\frac{Q}{|\b r|}-\left(\nabla\frac{1}{|\b r|}\right)\cdot\iiint_V\b r^\prime\rho(\b r^\prime)\d v+\frac{1}{2}\H_{1/|\b r|}:\iiint_V\b r^\prime\otimes\b r^\prime\rho(\b r^\prime)\d v-\cdots
\end{align*}
$$
这里我们管
$$
\b p=\iiint_V\b r^\prime\rho(\b r^\prime)\d v
$$
叫电偶极矩。可以这样理解：在计算第一项 $Q/|\b r|$ 后，我们考虑了净电荷，但是没考虑这些电荷的空间分布。那么第二项就是对于每个 $\b r^\prime$，把它对应的电荷量 $\rho(\b r^\prime)\d v$ 从原点减去，然后加到它本身来，那么单个这样的东西就是我们上面说的电偶极子，全部积分起来也可以认为是。当然这一步的估算仍然是有误差的，但是电四极矩在展开式中几何意义我就不太会解释了。&lt;/p&gt;
&lt;p&gt;当我们在说一个系统的电偶极矩时，就有两个点需要注意：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;它的净电荷不等于 $0$，也可以有电偶极矩，即把它的电荷强制加成零之后再算。&lt;/li&gt;
&lt;li&gt;电偶极矩的方向和大小取决于原点的选择，或者说零阶项部分视作点电荷的位置。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;二阶项中的那个积分对应电四极矩是个张量
$$
\b D_{ij}=\iiint_V(3\b r_i\b r_j-\delta_{ij}\b r^2)\rho(\b r)\d v
$$
也就是说展开式中这项一般会写成 $\frac{1}{6}\H:\b D$。&lt;/p&gt;
&lt;p&gt;至于为什么在上面添油加醋，我也不知道，但是似乎有个相关的东西说明这个形式比较好，就是说，如果电荷分布是球面对称的，那么二阶项为零。&lt;/p&gt;
&lt;p&gt;如果 $\rho(\b r)=\rho(r)$，那么 $i\ne j$ 的部分直接可以变成零，而 $i=j$ 的部分有
$$
\left\{
\begin{align*}
&amp;amp;\b D_{11}=\b D_{22}=\b D_{33}\\
&amp;amp;\b D_{11}+\b D_{22}+\b D_{33}=0
\end{align*}
\right.
$$
所以三者也各自等于 $0$。&lt;/p&gt;
&lt;p&gt;至于更后面的项，尽管知道它的表达式，但对更具体的东西（比如电八极矩该怎样添油加醋，或者 $\nabla^k(1/|\b r|)$ 该怎么算之类的），我就不太清楚了。&lt;/p&gt;
&lt;p&gt;最后给出
$$
\H_{1/r}=\frac{1}{r^5}\begin{bmatrix}3x^2-r^2&amp;amp;3xy&amp;amp;3xz\\ 3xy&amp;amp;3y^2-r^2&amp;amp;3yz\\ 3xz&amp;amp;3yz&amp;amp;3z^2-r^2\end{bmatrix}
$$
$\b D$ 会不会模仿的就是这个东西呢？&lt;/p&gt;
&lt;h2 id=&#34;含导体的情况&#34;&gt;含导体的情况
&lt;/h2&gt;&lt;p&gt;在静电平衡时，导体内部是有自由电荷的，只不过电势为零，电场强度为零，净电荷为零。只有表面有净电荷，且表面的电场强度垂直于表面。无论是内部场强非零，还是表面不垂直，都会导致自由电荷的移动。&lt;/p&gt;
&lt;p&gt;考虑导体时，内侧合场强为 $0$，根据高斯定理，外侧合场强为 $\sigma/\eps_0$，因此表面上的合场强为 $\sigma/2\eps_0$。如何理解呢？可以这样想：挖去当前点附近的一小块表面，这个时候，无论时内、上、外，只要足够近，它们的场强都是相等的。然后再拼上这一块，把这一块当作一个无限大带电 $\sigma$ 的平面即可。所以可以列出两个方程，解出导体表面的场强。&lt;/p&gt;
&lt;p&gt;如果导体是个空腔，那么：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;考虑取一个实心部分内的，绕空腔的高斯面，得到内表面净电荷为零。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如何得到内表面电荷处处为零呢？考虑如果不是的话，必能找到一条电场线，然后这么搞：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;3-1.png&#34; /&gt;&lt;/center&gt;
&lt;p&gt;与无旋矛盾。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;同样，空腔内电场处处为零，否则用 2 的方法也可以搞出矛盾。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://physics.stackexchange.com/questions/43068/why-is-electric-field-strong-at-sharp-edges&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;为什么表面尖的地方电荷密度大？&lt;/a&gt;简而言之，考虑一个简单情况：一大一小的导体球相离充分远但被导线连接。这个也可以用于解释导体球相碰时的电荷分配。&lt;/p&gt;
&lt;h3 id=&#34;电容&#34;&gt;电容
&lt;/h3&gt;&lt;p&gt;$C=Q/U$。&lt;/p&gt;
&lt;p&gt;平行板电容器，$U=Ed=\sigma d/\eps_0$ 故 $C=\sigma S/U=\eps_0S/d$。&lt;/p&gt;
&lt;p&gt;同轴柱形电容器，根据高斯定律，$E=\lambda/2\pi\eps_0r$（无所谓内层是实心还是空心），$U=\lambda/2\pi\eps_0\cdot\ln(r_2/r_1)$，$C=l\lambda/U=2\pi\eps_0l/\ln(r_2/r_1)$。&lt;/p&gt;
&lt;h3 id=&#34;唯一性定理&#34;&gt;唯一性定理
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;已知源电荷分布。&lt;/li&gt;
&lt;li&gt;导体表面等势。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;能否确定导体表面的电荷分布？&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;唯一性定理：对于区域 $V$，如果内部的电荷分布已知，且 ① $\p V$ 上的势能分布已知；或 ② $\p V$ 上的电场垂直分量已知；则 $V$ 内的电场唯一确定。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证：若有两种电势分布 $\varphi_1$、$\varphi_2$，令 $U=\varphi_1-\varphi_2$。第一，我们知道 $\nabla^2 U=\rho/\eps_0-\rho/\eps_0=0$；第二，上面两个条件可以翻译为 $U|_{\p V}=0$ 或 $(\p U/\p n)|_{\p V}=0$，我们可以把它写成
$$
U\frac{\p U}{\p n}=0
$$
积分
$$
0=\oiint_{\p V}U\frac{\p U}{\p n}\d s=\oiint_{\p V}U(\nabla U)\cdot\d\b s=\iiint_V\nabla\cdot(U\nabla U)\d v=\iiint_V(\nabla U)^2\d v+\iiint_VU(\nabla^2 U)\d v=\iiint_V(\nabla U)^2\d v
$$
于是 $\nabla U=0$。&lt;/p&gt;
&lt;p&gt;注意：这里这个区域可以是无界的，至于为什么有的必须有界有的可以无界，我也不知道。似乎是整个空间净电荷为零的时候才可以无界？&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;推论：对于区域 $V$，如果在上述唯一性定理的条件基础上，$V$ 中还被抠了一些洞，每个洞对应一个导体，我们既不知道这个导体表面的电势，又不知道导体表面的场强，但是知道导体的净电荷，那么 $V$ 内的电场也能唯一确定。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证：这些导体的电势是定值，于是
$$
\iiint_{\p V_i}U\frac{\p U}{\p n}\d s=U_i\iiint_{\p V_i}(\b E_1\cdot\d\b s-\b E_2\cdot\d\b s)=U_i\left(\frac{Q}{\eps_0}-\frac{Q}{\eps_0}\right)=0
$$
别的都是一样的。&lt;/p&gt;
&lt;p&gt;直觉上来说，除了垂直那个条件不是特别好理解外，别的都可以通过拉普拉斯方程的解不会在边界以外的地方取到最值，从而如果边界处都相等（$=0$）内部也都是，这样的方式来理解。&lt;/p&gt;
&lt;h3 id=&#34;电像法&#34;&gt;电像法
&lt;/h3&gt;&lt;p&gt;尽管我们知道了唯一性，但是还是不好搞。为了避免直面拉普拉斯/泊松方程，这里有个电像法：就是把导体表面的电荷分布等效于一个更简单的，导体内部的电荷分布，使得导体表面的势能分布不变（允许内部不对），这样由唯一性定理，外面的电场分布在等效后不变。&lt;/p&gt;
&lt;p&gt;算出电场分布之后，利用 $E=\sigma/\eps_0$ 可得出导体表面的电荷分布。根据高斯定律，净电荷和像电荷相等。&lt;/p&gt;
&lt;h4 id=&#34;例-1-2&#34;&gt;例 1
&lt;/h4&gt;&lt;center&gt;&lt;img src=&#34;4-3.svg&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;这个无限大导体板是接地的（不然这题会出 bug）。&lt;/p&gt;
&lt;p&gt;假设板是 $yz$ 方向且过 $O$ 的。板上一点的场强是垂直于板的，大小为
$$
E(\b r)=\frac{qd}{2\pi\eps_0(r^2+d^2)^{3/2}}
$$
因此
$$
\sigma(\b r)=-\frac{qd}{2\pi(r^2+d^2)^{3/2}}
$$
验证总电荷 $=-q$：
$$
\int_{0}^{+\infty}\sigma(r)2\pi r\d r=qd\left.\frac{1}{\sqrt{r^2+d^2}}\right|_{r=0}^{+\infty}=-q
$$
如果不接地，由于这题选取的区域不得不是无界的，就会爆，或者说没法同时保证净的像电荷 $=0$，以及板上等势。&lt;/p&gt;
&lt;p&gt;注意这种结构在上下是不同介值时，像电荷的电荷量不是 $-q$。&lt;/p&gt;
&lt;h4 id=&#34;例-2&#34;&gt;例 2
&lt;/h4&gt;&lt;center&gt;&lt;img src=&#34;4-4.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;我们知道（阿波罗尼斯圆），与两个点距离之比为定值 $\ne 1$ 的点集形成一个圆（球）。也就是说，在这里我们希望构造像电荷使得
$$
\frac{q}{r_1}+\frac{q^\prime}{r_2}=0
$$
刚好是这个导体球。&lt;/p&gt;
&lt;p&gt;首先 $Q^\prime$ 一定在 $OQ$ 上，设与圆心距离为 $d$。设 $OQ$ 与圆交于 $C$，连接 $OP$、$CP$。可以通过倍长中线可以得到 $CP$ 平分 $\angle QPQ^\prime$，于是 $\angle Q=\pi-\angle PCQ-\angle QPC=\angle PCO-\angle Q^\prime PC=\angle OPQ^\prime$，于是 $\triangle OPQ^\prime\sim\triangle OQP$，
$$
\frac{OQ^\prime}{OP}=\frac{OP}{OQ}=\frac{PQ^\prime}{PQ}
$$
即
$$
\frac{OQ^\prime}{a}=\frac{a}{b}=\frac{r_2}{r_1}=-\frac{q^\prime}{q}
$$
得
$$
OQ^\prime=\frac{a^2}{b},\,q^\prime=-\frac{a}{b}q
$$
所以说，如果接地的话，导体球的电荷就是 $-a/b\cdot q$，换句话说，球会“吸收”$a/b$ 的电场；如果不接地或者规定球的电荷或规定球表面的电势的话，就再在球心塞一个像电荷。&lt;/p&gt;
&lt;h3 id=&#34;静电场的复势&#34;&gt;静电场的复势
&lt;/h3&gt;&lt;p&gt;首先要明确的一点是，当无穷远处有电荷时，无穷远处的势能就不一定能是零了，甚至可能出现两个方向的无穷远处势能不同的情况。另外“地”等于无穷远处。&lt;/p&gt;
&lt;p&gt;现在我们考虑二维电场，这里二维的意思是，在 $z$ 轴方向电荷均匀分布。&lt;/p&gt;
&lt;p&gt;解析函数：在一个区域内处处可微。复变解析函数 $f(z)=U(x,y)+\i V(x,y)\,(z=x+\i y)$ 满足 Cauchy-Riemann 方程
$$
\left\{\begin{aligned}
\frac{\p U}{\p x}&amp;amp;=\frac{\p V}{\p y}\\
\frac{\p U}{\p y}&amp;amp;=-\frac{\p V}{\p x}
\end{aligned}\right.
\Longrightarrow
\left\{\begin{aligned}
\nabla^2 U&amp;amp;=0\\
\nabla^2 V&amp;amp;=0
\end{aligned}\right.
\Longrightarrow
\nabla U\cdot\nabla V=0
$$
证：可微要求各个方向导数相等，也就是
$$
\frac{\p U}{\p x}+\i\frac{\p V}{\p x}=\frac{\p f}{\p x}=\frac{\p f}{\p(\i y)}=\frac{\p V}{\p y}-\i\frac{\p U}{\p y}
$$
现在 $\nabla^2$ 等于 $0$，说明 $U$ 和 $V$ 能作为势能。点乘等于 $0$，意味着 $U$ 和 $V$ 的等势线的法向量互相垂直，也就是等势线互相垂直。于是我们可以把一个当作等势线，一个当作电场线，尽管意义看起来有些诡异。&lt;/p&gt;
&lt;p&gt;比如说，$E=-\nabla V$。现在我们可以说什么呢？如果把 $V=\varphi$ 代进 $f$ 里，然后根据 $U$ 和 $V$ 的关系解得 $U$，那么 $U$ 就可以表示电场线。目前看起来这是废话，后面会发现有一些魔法。根据积分，我们会发现，可以把 $U$ 视作“等通线”，或者说，两点之间 $U$ 的差就是两点间连线对应的电通量。这个也很好理解，如果有个路径完全跟电场线重合，那么点乘就都等于 $0$，所以通量为 $0$。&lt;/p&gt;
&lt;h4 id=&#34;例-1-3&#34;&gt;例 1
&lt;/h4&gt;&lt;p&gt;考虑沿 $z$ 轴的无限长均匀导线。
$$
\b E(\b r)=\frac{\lambda\b r}{2\pi\eps_0r^2}
$$
写成复数形式就是
$$
E(z)=\frac{\lambda z}{2\pi\eps_0|z|^2}=\frac{\lambda z}{2\pi\eps_0z\bar{z}}=\frac{\lambda}{2\pi\eps_0\bar z}
$$
代入 $E=-\nabla V$，这里从复数的角度来说，$\nabla g=\nabla g\cdot(1,\i)$。
$$
E=-\nabla V=-\frac{\p V}{\p x}-\i\frac{\p V}{\p y}=-\frac{\p V}{\p x}-\i\frac{\p U}{\p x}=-\i\bar{f^\prime}
$$
于是
$$
f^\prime=\overline{\i E}=-\i\overline{E}=-\i\frac{\lambda}{2\pi\eps_0z}
$$
这个很像一个势能的形式，所以我们管 $f$ 叫 $E$ 的复势。&lt;/p&gt;
&lt;p&gt;由于复变函数有着与一元函数类似的运算规律（可参见 &lt;a class=&#34;link&#34; href=&#34;https://www.math.utah.edu/~yplee/teaching/4200f18/Ch2_pages.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.math.utah.edu/~yplee/teaching/4200f18/Ch2_pages.pdf&lt;/a&gt;），
$$
f(z)=-\i\frac{\lambda}{2\pi\eps_0}\ln z=\frac{\lambda}{2\pi\eps_0}\left(\arg z-\i\ln|z|\right)
$$
于是
$$
U(\rho,\theta)=\frac{\lambda}{2\pi\eps_0}\theta,\,V(\rho,\theta)=-\frac{\lambda}{2\pi\eps_0}\ln\rho
$$
$U$ 的等高线就形成一堆从原点发出的射线，符合无限长导线（或点电荷）的电场线。&lt;/p&gt;
&lt;p&gt;但是这种运用还是太凑巧了，更常见的运用是这样：给定导体的构造以及其电势，求空间中电场的分布。那么我们考虑找到一个解析的复变函数，其实部或虚部等势线刚好和导体重合。这样，这个函数的实部或虚部就是电势。&lt;/p&gt;
&lt;h4 id=&#34;例-2-1&#34;&gt;例 2
&lt;/h4&gt;&lt;p&gt;$f(z)=z^2=(x^2-y^2)+2xy\i$：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;5-1.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;取 $\im f=0$ 的部分，也就是坐标轴十字的这部分。那么空间中的电势可以分布为 $\varphi(x,y)=2xy$，或者进一步说，可以是 $xy$ 的任意倍数。具体来说，这样的电场是如何达成的呢？我们只需要利用 $\sigma/\eps_0=\p\varphi/\p n$ 即可，得到 $x$ 轴上的是 $2x$，$y$ 轴上的是 $2y$。&lt;/p&gt;
&lt;p&gt;但是实际上算一下，你会发现根本不对！比如考虑 $(1,1)$ 点：
$$
\b E=\int_{-\infty}^{+\infty}\frac{2x\d x}{2\pi\eps_0}\frac{(1-x,1)}{(1-x)^2+1}+\int_{-\infty}^{+\infty}\frac{2y\d x}{2\pi\eps_0}\frac{(1,1-y)}{1+(1-y)^2}
$$
然后你发现它根本不收敛！&lt;/p&gt;
&lt;p&gt;所以我也不知道我们现在到底在干什么，可能只是 playing with math 吧……&lt;/p&gt;
&lt;p&gt;一个看起来比较靠谱的情况是，$x^2-y^2=1$ 的部分有 $+\varphi$ 的导体板，$y^2-x^2=1$ 的部分有 $-\varphi$ 的导体板，那么四个导体板之间（可以视作封闭区域）的电势就是 $\varphi(x^2-y^2)$。&lt;/p&gt;
&lt;p&gt;这个方法其实确实严谨性有很大的问题，我们会怀疑的，第一个是这样的电荷分布是否真能稳定，第二个是有无穷多的总电荷是怎么做到的，第三个是无穷远处被弄的一团糟，第四个是有界性和解的唯一性，第五个是能否只在等势线的一部分上放上导体板（似乎只需在关注的区域内的等势线上全部放就行？），第六个是为啥 tmd 求出来的电荷分布无法形成正常的电场啊！&lt;/p&gt;
&lt;p&gt;通过跟一些同学进一步讨论，我大概得出两个结论：一个是必须规定无穷远处的电势，一个是肯定是无穷远处有一些场源在操纵整个结构。不管怎么说，复势只能解决这样的问题：形如规定了某个（足够）封闭的边界条件（电势），求中间的电势。&lt;/p&gt;
&lt;h4 id=&#34;例-3&#34;&gt;例 3
&lt;/h4&gt;&lt;p&gt;又例如 $f(z)=z^{1/2}$（取 $\theta\in(-\pi,\pi]$），可以得到
$$
z^{1/2}=\left(\frac{\sqrt{x^2+y^2}+x}{2}\right)^{1/2}+\i\operatorname{sgn}(y)\left(\frac{\sqrt{x^2+y^2}-x}{2}\right)^{1/2}
$$&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;5-2.png&#34; style=&#34;zoom:35%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;考虑 $x$ 正半轴对应的导体板，它形成的电场是虚线部分。然后，
$$
\sigma=\frac{\p\im z}{\p y}=-\frac{1}{2x}
$$
还是积不对。&lt;/p&gt;
&lt;h4 id=&#34;特别注意&#34;&gt;特别注意
&lt;/h4&gt;&lt;p&gt;期中考试考了一道导线形成的电偶极子的复势（实部是势能），我答案写了个 $\varphi=\lambda d/2\pi\eps_0\bar{z}$ 爆了，因为！$1/{\bar z}$ 压根不是解析的！&lt;/p&gt;
&lt;p&gt;复势必须是解析的。解析函数有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$z^n$（$n&amp;lt;0$ 时除去 $z=0$）&lt;/li&gt;
&lt;li&gt;$\e^z$&lt;/li&gt;
&lt;li&gt;$\ln z$（除去原点与负半轴）&lt;/li&gt;
&lt;li&gt;$\sin z,\cos z,\sinh z,\cosh z$ 等&lt;/li&gt;
&lt;li&gt;以上函数的四则运算、复合&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;非解析函数有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$|z|,|z|^2$&lt;/li&gt;
&lt;li&gt;$\bar z,1/{\bar z}$&lt;/li&gt;
&lt;li&gt;$\re z,\im z$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;保角变换&#34;&gt;保角变换
&lt;/h3&gt;&lt;p&gt;推荐《数学物理方法》（梁昆淼）。&lt;/p&gt;
&lt;p&gt;考虑一个电场，势能 $\varphi(z)$（$\varphi:\mathbb{C}\to\R$）的一些边界条件给定。我们现在想一个问题：假设解得了 $\varphi$。现在换元 $z^\prime=w(z)$，或者说 $\varphi\circ w^{-1}$，这个函数是否也是一个合法的势能呢？反过来呢？&lt;/p&gt;
&lt;p&gt;如果 $w$ 是解析函数，答案是肯定的。这样的一个变换叫保角变换，保角变换的名字是这样解释的：考虑某点 $z$，它变化了 $\d z$，那么函数值变化了 $w(z+\d z)-w(z)=w^\prime(z)\d z$。这个差就是复变函数可视化下，一条斜线的局部变成了另一个样子的斜线。那么如果有另一条与 $z+t\d z$ 夹角为 $\theta$ 的斜线，它经过映射后，方向就成了 $w(z+\e^{\i\theta}\d z)-w(z)=w^\prime(z)\e^{\i\theta}\d z$。这就是说，如果 $w^\prime(z)\ne 0$，则两者的交角不变。那么如果 $w^\prime(z)=0$，导数给出的信息就不足，有可能交角不对。例如 $w(z)=z^n$ 在原点处将角放大 $n$ 倍。&lt;/p&gt;
&lt;p&gt;但是用于解决电场问题的保角变换和这里的保角性没有直接的联系。因为我们考虑的是，只要拉普拉斯方程或泊松方程被保持就行。&lt;/p&gt;
&lt;p&gt;设 $w(x+\i y)=\xi+\i\eta$。这里我们把保角变换看成一种“坐标表示变换”，而不是直接函数复合。假设有泊松方程，我们进行推导：
$$
\begin{align*}
\frac{\rho}{\eps_0}&amp;amp;=\frac{\p^2\varphi}{\p x^2}+\frac{\p^2\varphi}{\p y^2}\\
&amp;amp;=\frac{\p}{\p x}\left(\frac{\p\varphi}{\p\xi}\frac{\p\xi}{\p x}+\frac{\p\varphi}{\p\eta}\frac{\p\eta}{\p x}\right)+\frac{\p}{\p y}\left(\frac{\p\varphi}{\p\xi}\frac{\p\xi}{\p y}+\frac{\p\varphi}{\p\eta}\frac{\p\eta}{\p y}\right)\\
&amp;amp;=\left[\left(\frac{\p\xi}{\p x}\right)^2+\left(\frac{\p\xi}{\p y}\right)^2\right]\frac{\p^2\varphi}{\p\xi^2}+2\left(\frac{\p\xi}{\p x}\frac{\p\eta}{\p x}+\frac{\p\xi}{\p y}\frac{\p\eta}{\p y}\right)\frac{\p^2\varphi}{\p\xi\p\eta}+\left[\left(\frac{\p\eta}{\p x}\right)^2+\left(\frac{\p\eta}{\p y}\right)^2\right]\frac{\p^2\varphi}{\p\eta^2}\\ &amp;amp;+\left(\frac{\p^2\xi}{\p x^2}+\frac{\p^2\xi}{\p y^2}\right)\frac{\p\varphi}{\p\xi}+\left(\frac{\p^2\eta}{\p x^2}+\frac{\p^2\eta}{\p y^2}\right)\frac{\p\varphi}{\p\eta}\\
&amp;amp;=|w^\prime(z)|^2\left(\frac{\p^2\varphi}{\p\xi^2}+\frac{\p^2\varphi}{\p\eta^2}\right)
\end{align*}
$$
因此，我们可以得到一个方法：现在，$xy$ 平面上给出了一些边界条件和电荷分布，要求电场分布，比较难求。那么我们就考虑通过解析函数 $w$，将 $(x,y)\mapsto(\xi,\eta)$，将边界条件和电荷位置通过 $w$ 变换，将电荷值除以 $|w^\prime|^2$，这样之后，如果能解出电场关于 $\xi,\eta$ 的表达式，再通过 $w^{-1}$ 把它变换回来就行了。&lt;/p&gt;
&lt;p&gt;为了严谨起见，我们要求：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$w$ 形成原&lt;strong&gt;考虑&lt;/strong&gt;区域（比如 $z^n$，我们只考虑一个角内）和变换后考虑区域的一个双射，这样才能保证两种情况下解形成一个双射。或者区域有界也行。&lt;/li&gt;
&lt;li&gt;$w^\prime(z)\ne 0$。如果有等于 $0$ 且对应点无电荷，实际上是对 $\varphi(\xi,\eta)$ 要求更严了些，这个应该不会有什么问题？&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如果 $w$ 多值，要规定一下辐角范围，当心一下取值两端点重合处如果值不等就不能处于区域内（可以处于边界）。&lt;/p&gt;
&lt;p&gt;再补充一下，关于这种变换，初学最容易搞晕的就是变量之间的关系。最合适的理解方式就是认为 $\varphi$ 一直不变，变的只是坐标系。也就是说，我们最好不要用 $\varphi(z)$ 这种表示，或者说原模型的电势永远只能是 $\varphi(z)$，而不能是 $\varphi(w(z))$ 或者 $\varphi(w^{-1}(z))$ 之类的。$\varphi$ 是和 $z$ 相关的一个变量，在我们说 $\xi,\eta$ 和 $\varphi$ 的关系的时候，我们本质上是说 $\xi+\i\eta\to z\to \varphi$ 这样的决定关系。当我们说能容易求出 $\xi,\eta$ 下电场分布 $\phi(\xi+\i\eta)$ 时，我们实际上在说的是 $\varphi(z)=\phi(w(z))$。&lt;/p&gt;
&lt;h4 id=&#34;例-1-4&#34;&gt;例 1
&lt;/h4&gt;&lt;p&gt;考虑两极板形成角 $\alpha$，电势为 $\varphi_0$。&lt;/p&gt;
&lt;p&gt;那么边界条件为 $\varphi(t)=\varphi(t\e^{i\alpha})=\varphi_0\,(t\ge 0)$。&lt;/p&gt;
&lt;p&gt;设计变换 $w(z)=z^{\pi/\alpha}\,(\theta\in[0,2\pi))$。那么边界被变换为与 $x$ 轴重合的板。我们我们知道平的情况，$\phi(z)=\varphi_0+C\im z$。因此我们得到的是：
$$
\varphi(z)=\varphi_0+C\im(z^{\pi/\alpha})=\varphi_0+C|z|^{\pi/\alpha}\sin\left(\frac\pi\alpha\arg z\right)
$$
例如 $\alpha=\pi/3$ 时，
$$
\varphi(x,y)=\varphi_0+C(3x^2y-y^2)
$$
这个例子没有电荷，所以形式比较好，能直接写出复势，如果有电荷的话直接和解析函数的定义矛盾了。&lt;/p&gt;
&lt;p&gt;其实基本上都是变换成平的。&lt;/p&gt;
&lt;h4 id=&#34;例-2-2&#34;&gt;例 2
&lt;/h4&gt;&lt;p&gt;考虑一个这样的形状：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;5-3-1.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;$(x_0,y_0)$ 处有个导线，线密度为 $\lambda$。这题刚好可以直接用电像法做，就是关于 $x$ 轴对称一下，再用例 2 的套路作圆内的两个。&lt;/p&gt;
&lt;p&gt;一个神奇的变换（解释详见《数学物理方法》（梁昆淼））：
$$
w(z)=\left(\frac{z-1}{z+1}\right)^2
$$
可以把图形变成 $x$ 轴。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;5-3-2.png&#34; /&gt;&lt;/center&gt;
&lt;p&gt;这里半圆弧部分被映射到了负半轴，Mathematica 刚好画不出来。&lt;/p&gt;
&lt;p&gt;令 $z_0=x_0+\i y_0$。电荷被变换到 $w(z_0)$ 处，电荷密度除以 $|w^\prime(z_0)|^2=16\left\lvert\frac{z_0-1}{z_0+1}\right\rvert^2$。&lt;/p&gt;
&lt;p&gt;现在利用电像法就很简单了。最后我们求得
$$
\varphi(z)=\frac{\lambda}{32\pi\eps_0\left\lvert\frac{z_0-1}{z_0+1}\right\rvert^2}\left[\ln\left\lvert\left(\frac{z-1}{z+1}\right)^2-\left(\frac{z_0-1}{z_0+1}\right)^2\right\rvert-\ln\left\lvert\left(\frac{z-1}{z+1}\right)^2-\left(\frac{\overline{z_0}-1}{\overline{z_0}+1}\right)^2\right\rvert\right]
$$
例如 $(x_0,y_0)=(1,1)$ 时&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;5-3-3.png&#34; /&gt;&lt;/center&gt;
&lt;p&gt;这就是势能（过小的忽略，所以有个洞）、等势线和电场线。&lt;/p&gt;
&lt;h2 id=&#34;莫名其妙提到的一些例子&#34;&gt;莫名其妙提到的一些例子
&lt;/h2&gt;&lt;h3 id=&#34;等离子振荡&#34;&gt;等离子振荡
&lt;/h3&gt;&lt;p&gt;等离子态：能量足够高，电子脱离原子核束缚自由运动，可以导电。我们考虑一个 $yz$ 方向的有厚度的无限大等离子体平面，我们认为离子不懂，只有电子沿 $x$ 方向动，并且所有电子的位移相同。考虑电子偏移了平衡位置 $s$：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;5-4.png&#34; /&gt;&lt;/center&gt;
&lt;p&gt;这时，可以想象它形成了一正一负两个极板。那么中间的电场为（这里 $q_e$ 是负的，$n_0$ 是数密度）：
$$
-\frac{n_0q_es}{\eps_0}
$$
利用牛二
$$
-\frac{n_0q_es}{\eps_0}q_e=m_e\ddot s
$$
解得
$$
s=C_1\sin\left(\sqrt{\frac{n_0q_e^2}{\eps_0m_e}}t+C_2\right)
$$
其中关键为频率满足
$$
\omega^2=\frac{n_0q_e^2}{\eps_0m_e}
$$
这个就是等离子态物质的固有频率。&lt;/p&gt;
&lt;p&gt;问题：为什么不用考虑磁场？&lt;/p&gt;
&lt;p&gt;一个应用是短波通信。大气层中的电离层，会反射频率小于它固有频率的波，大于的可以穿透。&lt;/p&gt;
&lt;p&gt;代入实际情况
$$
\omega\approx9\times10^{-3}\sqrt{n_0\unit{cm^3}}\unit{MHz}
$$
代入 $n_0=10^6\unit{cm^{-3}}$，得
$$
\omega\approx9\unit{MHz}
$$
最常用的短波通信就大概是这个波段，可以反射。&lt;/p&gt;
&lt;p&gt;另一个应用是解释为什么金属的反射率高。因为金属里面电子也是自由的，也可以看作等离子体，而可见光的频率远小于固有频率，所以会反射。&lt;/p&gt;
&lt;h2 id=&#34;静电能&#34;&gt;静电能
&lt;/h2&gt;&lt;p&gt;一个系统的电场能定义：就是它的总势能——将所有电荷从互相距离无穷远（能量为 $0$），放到当前状态，所需要做的功。&lt;/p&gt;
&lt;p&gt;对于两个距离为 $r$ 的电荷，它们形成的电势能为
$$
U=\frac{q_1q_2}{4\pi\eps_0r}
$$
这个值既是 $q_1$ 自己的电势能，又是 $q_2$ 自己的电势能。因此
$$
U=\frac{q_1\varphi_1+q_2\varphi_2}{2}
$$
注意这个 $1/2$ 是很重要的，去掉就和能量守恒矛盾了。可以理解为这个势能是两个电荷共享的。&lt;/p&gt;
&lt;p&gt;对于复杂系统，
$$
U=\frac12\sum q_i\varphi_i
$$
用积分形式，
$$
U=\frac12\iiint\varphi\rho\d v
$$&lt;/p&gt;
&lt;h3 id=&#34;例-1-5&#34;&gt;例 1
&lt;/h3&gt;&lt;p&gt;例如一个实心的，半径为 $R$ 的，均匀带电 $Q$ 的球：
$$
\begin{align*}
U&amp;amp;=\frac12\int_{0}^R\left[\frac{Q}{4\pi\eps_0R}+\frac{Q}{8\pi\eps_0R^3}(R^2-r^2)\right]\frac{Q}{\frac43\pi R^3}4\pi r^2\d r\\
&amp;amp;=\frac{3Q^2}{16\pi\eps_0R^6}\int_{0}^R(3R^2-r^2)r^2\d r\\
&amp;amp;=\frac{3Q^2}{20\pi\eps_0R}
\end{align*}
$$
另外一种简单些的算法是，考虑
$$
U=\sum_{j&amp;lt;i}q_i\varphi_{j\to i}
$$
因此可以写成
$$
U=\int_0^R\frac{Qr^2}{4\pi\eps_0R^3}\frac{Q}{\frac43\pi R^3}4\pi r^2\d r
$$
实际意义就是一层层从无穷远处取材裹起来，其中每一层内部的相互作用产生的电势能是高阶无穷小量。&lt;/p&gt;
&lt;p&gt;导体球：
$$
\frac12\frac{Q}{4\pi\eps_0R}Q=\frac{Q^2}{8\pi\eps_0R}=\int_0^Q\frac{q\d q}{4\pi\eps_0R}
$$
平行板电容器：&lt;/p&gt;
&lt;p&gt;一种算法是直接考虑两个极板。
$$
U=\frac12Q\varphi_1-\frac12Q\varphi_2=\frac12QV=\frac{Q^2}{2C}
$$
另一种算法是考虑逐渐给电容充电。每次加 $\d q$ 的电荷，正的比负的需要多增加 $V$ 的电势。
$$
U=\int_0^QV\d q=\int_0^Q\frac{q}{C}\d q=\frac{Q^2}{2C}
$$&lt;/p&gt;
&lt;p&gt;所以说无论电阻是多少，给电容充电的过程中一定有一般的能量会转变成内能。&lt;/p&gt;
&lt;p&gt;现在我们推导 $U$ 的另一种表达式（这里 $V$ 是整个空间）
$$
\begin{align*}
U&amp;amp;=\frac12\iiint_V\varphi\rho\d v\\
&amp;amp;=\frac12\iiint_V\varphi(-\eps_0\nabla^2\varphi)\d v\\
&amp;amp;=-\frac{\eps_0}2\iiint_V[\nabla\cdot(\varphi\nabla\varphi)-\nabla\varphi\cdot\nabla\varphi]\d v\\
&amp;amp;=-\frac{\eps_0}2\left(\lim_{V^\prime\to V}\oiint_{\p V^\prime}\varphi\nabla\varphi\cdot \d\b s-\iiint_V\b E\cdot\b E\d v\right)
\end{align*}
$$
当 $V^\prime\to V$ 时，$\varphi\propto r^{-1}$，$|\b E|\propto r^{-2}$，$S\propto r^2$，故前一项 $\to 0$。因此
$$
U=\frac{\eps_0}{2}\iiint_V\b E^2\d v
$$
这个更加本质，因为电场能是和场有关，即使是取真空中没有电荷的一块，然后这块区域外有电荷，这块区域内也应当贡献电场能。&lt;/p&gt;
&lt;p&gt;拿这个去算单点电荷的电场能，会发现它是发散的，所以点电荷的假设不成立。代入 $U=m_ec^2$ 可以解得电子的经典半径。在实操中，由于点电荷在场景内和在无穷远处的“自势能”是不变的，而且一般要求求需要做的功（求差），因此可以直接忽略。&lt;/p&gt;
&lt;h3 id=&#34;例-2-3&#34;&gt;例 2
&lt;/h3&gt;&lt;p&gt;考虑两个分别在 $x=\pm d/2$ 的 $yz$ 方向无限大接地极板以及在原点的点电荷 $q$。像电荷的推导会出现“连锁反应”，为：$x=kd$ 处 $(-1)^kq$ 的像电荷。&lt;/p&gt;
&lt;p&gt;考虑计算原点电荷对的左极板的力，由牛三，它与左极板对原电荷的力，也就是左边这串像电荷对原电荷的力等大反向。这个东西是
$$
F=\frac{1}{4\pi\eps_0}\sum_{i\ge 1}\frac{(-1)^iq^2}{i^2d^2}=-\frac{q^2}{4\pi\eps_0d^2}\cdot\frac{\pi^2}{12}
$$
整个系统的电场能为板的电势能与点的电势能之和除以二，而板的部分是 $0$，点的部分是：
$$
E=\frac{1}{4\pi\eps_0}\sum_{i\ge 1}\frac{(-1)^i2q^2}{id}=-\frac{q^2}{2\pi\eps_0d}\ln2
$$
于是可以计算出把点电荷移到无穷远处所做的功。注意它是负的电场能。&lt;/p&gt;
&lt;h2 id=&#34;电介质&#34;&gt;电介质
&lt;/h2&gt;&lt;p&gt;考虑往平行板电容器中间塞个宽为 $b$ 的导体，于是 $V$ 从 $\sigma/\eps_0d$ 减小到 $\sigma/\eps_0(d-b)$，所以 $C=Q/V$ 增加了。如果中间塞的是绝缘体，那屏蔽效果会弱很多，但绝缘体内部的电场强度仍然会下降，从而 $V$ 也是偏小。&lt;/p&gt;
&lt;p&gt;那么绝缘体具体是怎么样的呢？考虑其中一个原子，电子无法自由运动，但是原子核会往电场方向偏移，电子云会往反向偏移，整体会有形变，于是核和电子的等效中心形成了一个电偶极子 $\b p=q\b\delta$，极化矢量就是单位体积的电偶极矩 $\b P=Nq\b\delta$。在一块厚厚的绝缘体，每个原子这样的变化叠加起来，中间的部分就抵消了，于是净电荷就是形如两个对面分别带上了正负电荷，我们认为每个原子的变化是一样的，于是正负电荷层的厚度也就是单个电荷的 $\delta$，则
$$
\sigma_{\text{pol}}=Nq\delta
$$
它刚好就等于 $P$。&lt;/p&gt;
&lt;p&gt;与此同时，实验说（其中 $\chi$ 称为极化率，注意这个是近似，因为不一定是线性关系）
$$
\b P=\chi\eps_0\b E
$$
这个很好理解。&lt;/p&gt;
&lt;p&gt;于是可以列方程
$$
\left\{\begin{align*}
E&amp;amp;=\frac{\sigma-P}{\eps_0}\\
P&amp;amp;=\chi\eps_0E
\end{align*}\right.
$$
解得
$$
E=\frac{1}{1+\chi}\frac{\sigma}{\eps_0}
$$
于是
$$
C=\frac{Q}{V}=\frac{\sigma S}{Ed}=(1+\chi)\frac{\eps_0S}{d}
$$
称
$$
\kappa=1+\chi
$$
（又叫做 $\eps_r$ 或 $\eps/\eps_0$）为相对介电常数。&lt;/p&gt;
&lt;p&gt;考虑介质内一个假想面上，有多少的电荷通过它。计算思路是，先考虑垂直的情况，它就是电荷密度，乘上位移，这个就是 $\sigma_{\text{pol}}=P$ 的原因。那么如果面是斜的，就乘上个 $\cos$。
$$
\sigma_{\text{pol}}=\b P\cdot\b n
$$
在内部如果 $\b P$ 均匀，那这个东西是 $0$，因为通过这个面的两个方向的电荷抵消了，但在表面就有净的了。&lt;/p&gt;
&lt;p&gt;这个玩意的用处是，例如，考虑一个均匀极化的介质球，它表面的电荷分布就是
$$
\sigma_{\text{pol}}=P\cos\theta
$$
其中 $x$ 轴取的与电场强度相同。&lt;/p&gt;
&lt;p&gt;如果介质的极化不均匀，那么就会产生极化电荷——介质内部一块区域呈现出”额外的净电荷“的现象。这是因为，考虑一个区域 $V$，由电荷守恒，
$$
Q_{\text{pol}}=-\oiint_{\p V}\b P\cdot\b n\d s
$$
最基本地，
$$
Q_{\text{pol}}=\iiint_V\rho_{\text{pol}}\d v
$$
由高斯公式，我们可以把两个式子联系起来：
$$
\rho_{\text{pol}}=-\nabla\cdot\b P
$$
现在，考虑有另外的”真正的净电荷“分布 $\rho_{\text{free}}$（这个 $\text{free}$ 指的不是能自由移动）的情况：
$$
\nabla\cdot\b E=\frac{\rho}{\eps_0}=\frac{\rho_{\text{free}}+\rho_{\text{pol}}}{\eps_0}=\frac{\rho_{\text{free}}-\nabla\cdot\b P}{\eps_0}
$$
于是
$$
\rho_{\text{free}}=\nabla\cdot(\eps_0\b E+\b P)=\kappa\eps_0\nabla\cdot\b E
$$
$\b D=\eps_0\b E+\b P$ 被称为电位移矢量。我们现在有关系：
$$
\begin{align*}
\nabla\cdot\b D&amp;amp;=\rho_{\text{free}}\\
\nabla\cdot\b E&amp;amp;=\frac{\rho_{\text{free}}}{\kappa\eps_0}\\
\b D&amp;amp;=\kappa\eps_0\b E
\end{align*}
$$
另外，仍有 $\nabla\times\b E=\b 0$，但在非均匀介质的情况下，$\nabla\times\b D$ 可能不是 $\b 0$；在非均匀极化的情况下，局部会产生”净极化电荷“$\rho_{\text{pol}}$。在&lt;strong&gt;均匀介质中，只有介质表面和 $\rho_{\text{free}}$ 附近（无限近处）才会有极化电荷。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在均匀介质中，我们就有，对于一个点电荷，
$$
\b E=\frac{q\b r}{4\pi\kappa\eps_0\b r^3}
$$
值得注意的是，当介质不均匀时，$\nabla\cdot\b D=\rho_{\text{free}}$ 成立，但
$$
\b D=\iiint_V\frac{\rho_{\text{free}}\d v}{4\pi}\frac{\b r-\b r^\prime}{|\b r-\b r^\prime|^3}
$$
不再成立。&lt;/p&gt;
&lt;p&gt;总的来说，非均匀电介质相关问题的求解思路是&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;分析对称性（并加以猜测）。&lt;/li&gt;
&lt;li&gt;通过偏导或 $\b D$ 的高斯定律求出 $\b D$。&lt;/li&gt;
&lt;li&gt;根据 $\b D$ 与 $\b E$、$\b P$ 的关系求出它们。&lt;/li&gt;
&lt;li&gt;根据 $\b D$ 与 $\rho_{\text{free}}$ 或 $\sigma_{\text{free}}$ 的关系求出它们。&lt;/li&gt;
&lt;li&gt;根据 $\b P$ 与 $\rho_{\text{pol}}$ 与 $\rho_{\text{free}}$ 的关系求出它们。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;例-1-6&#34;&gt;例 1
&lt;/h3&gt;&lt;p&gt;考虑一个 $\rho_{\text{free}}=\rho_0$ 的，厚度为 $d$ 的，相对介电常数为 $\eps_r$ 的 $yz$ 方向无限大介质板。
$$
\frac{\p D}{\p x}=\left\{\begin{aligned}&amp;amp;\rho_0,&amp;amp;|x|\le\frac d2\\ &amp;amp;0,&amp;amp;|x|&amp;gt;\frac d2\end{aligned}\right.\Longrightarrow D=\rho_0\max\Set{\min\Set{x,\frac d2},-\frac d2}
$$
导一下别的：
$$
\left\{\begin{align*}
E&amp;amp;=\frac{\rho_0}{\eps_0\eps_r}\max\Set{\min\Set{x,\frac d2},-\frac d2}\\
P&amp;amp;=\rho_0\left(1-\frac{1}{\eps_r}\right)\max\Set{\min\Set{x,\frac d2},-\frac d2}\\
\rho_{\text{pol}}&amp;amp;=-\rho_0\left(1-\frac{1}{\eps_r}\right)\left[|x|\le\frac d2\right]\\
\sigma_{\text{pol}}&amp;amp;=\rho_0\left(1-\frac{1}{\eps_r}\right)\frac{d}{2}\left[|x|=\frac d2\right]
\end{align*}\right.
$$&lt;/p&gt;
&lt;p&gt;发现极化面电荷刚好可以可以跟极化体电荷抵消，符合电荷守恒。值得注意的是，这两者是需要分开计算的，面电荷其实相当于是出现了“无限密”的情况，会导致电场突变。&lt;/p&gt;
&lt;h3 id=&#34;例-2-4&#34;&gt;例 2
&lt;/h3&gt;&lt;p&gt;考虑一个表面积为 $S$ 的平行板电容器，一半塞上了 $\eps_r$ 的介质，可以理解为两个不同的电容并联。&lt;/p&gt;
&lt;p&gt;两个极板仍然分别是等势体，由 $V=Ed$，电场仍然是垂直的，均匀的（为什么？）。&lt;/p&gt;
&lt;p&gt;真空的部分 $C_1=\eps_0S/2d$，有介质的部分 $C_2=\eps_0\eps_rS/2d$。新的总电容就是 $C^\prime=C_1+C_2=\frac{1+\eps_r}2C$。新的电压是 $V^\prime=Q/C^\prime=\frac2{1+\eps_r}V$，电场强度是 $E^\prime=V^\prime/d=\frac{2}{1+\eps_r}E$。于是，真空部分的极板的面电荷密度为 $\sigma_1=\frac2{1+\eps_r}\sigma_0$，有介质部分 $\sigma_2=\frac{2\eps_r}{1+\eps_r}\sigma_0$。所以说，真空部分的电荷密度减小，有介质部分的电荷密度增加。&lt;/p&gt;
&lt;h3 id=&#34;例-3-1&#34;&gt;例 3
&lt;/h3&gt;&lt;p&gt;对于复杂的介质分布，我们难以直接解出电场分布。这时考虑得到一组解，然后用唯一性定理。&lt;/p&gt;
&lt;p&gt;考虑一个 $\b E_0$ 的匀强电场，其中放了一个半径为 $R$，相对介电常数为 $\eps_r$ 的介质球，求它对电场的影响。&lt;/p&gt;
&lt;p&gt;为了分析这个问题，我们必须先回答这个问题：当一个球，它表面分布了密度为 $P\cos\theta$（或者叫 $\sigma_0\cos\theta$ 舒服些）的电荷，那它会形成的电场分布是怎样的？（下图理解为立体角为 $\theta$ 的圆锥面与球的交圆部分 $\sigma=\sigma_0\cos\theta$）&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;7-1.jpg&#34; style=&#34;zoom:15%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;考虑这样一个模型，设两个球心的距离为 $d$。我们可以想象是两个球相减。在内部的空腔中，右侧球对其电场为
$$
\b E=\frac{\frac43\pi\left|\b r-\frac d2\b{\hat x}\right|^3\rho_0}{4\pi\eps_0}\cdot\frac{\b r-\frac d2\b{\hat x}}{\left|\b r-\frac d2\b{\hat x}\right|^3}=\frac{\rho_0}{3\eps_0}\left(\b r-\frac d2\b{\hat x}\right)
$$
左侧同理，所以总的就是
$$
\b E=-\frac{\rho_0}{3\eps_0}d\b{\hat x}
$$
而在外面，两个球可以视作是电偶极子（实际上内部也可以），$\b p=4\pi R^3\rho_0 d\b{\hat x}/3$。
$$
\b E=\frac{1}{4\pi\eps_0}\left(\frac{3(\b p\cdot\b r)\b r}{r^5}-\frac{\b p}{r^3}\right)=\frac{R^3\rho_0d}{3\eps_0}\frac{3\b r_x\b r-r^2\b{\hat x}}{r^5}
$$
另外，$\b r$ 方向的电荷面密度（虚线截灰色部分乘电荷体密度）为 $\rho_0d\cos\theta$。&lt;/p&gt;
&lt;p&gt;固定 $\rho_0d$ 为常数 $\sigma_0$，让 $d\to 0$。最终就可以得到按要求分布的电荷导致的电场。球内外分别为
$$
-\frac{\sigma_0}{3\eps_0}\b{\hat x};\;\frac{R^3\sigma_0}{3\eps_0}\frac{3\b r_x\b r-r^2\b{\hat x}}{r^5}=\frac{R^3\sigma_0}{\eps_0r^3}\left(\cos\theta-\frac13,\cos\theta\sin\theta\right)
$$
极化强度和电场强度互相影响，有方程
$$
\left\{
\begin{align*}
E&amp;amp;=E_0-\frac{P}{3\eps_0}\\
P&amp;amp;=\eps_0(\eps_r-1)E
\end{align*}
\right.
$$
解得
$$
\left\{
\begin{align*}
E&amp;amp;=\frac{3\eps_0}{\eps_r+2}E_0\\
P&amp;amp;=\frac{\eps_r-1}{\eps_r+2}3\eps_0E_0
\end{align*}
\right.
$$
$\eps_r\to+\infty$ 时相当于导体，它长这样（可以与&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/716420031&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;对比验证）：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;7-2.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;这里有三个问题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;为什么是均匀极化？猜的，由唯一性定理这个导出的就是答案。&lt;/li&gt;
&lt;li&gt;为什么是 $E=E_0-P/3\eps_0$ 而不是 $E=E_0-P/3\eps_r\eps_0$？因为 ${}-P/3\eps_0$ 的这部分本身考虑的就是极化，在已经考虑极化的影响下，球内部由于是均匀极化，就相当于没东西。&lt;/li&gt;
&lt;li&gt;不是说这种电荷聚集在表面的，它的表面电场是内外电场的平均吗？为什么这里用的是内部？好问题，我也想知道。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;静磁学的基本公式&#34;&gt;静磁学的基本公式
&lt;/h2&gt;&lt;h3 id=&#34;电和磁的关系&#34;&gt;电和磁的关系
&lt;/h3&gt;&lt;p&gt;有一根电中性的直导线，其中自由电荷密度为 $\lambda$，移动速度为 $v$，从而电流为 $I$。一个距离导线 $r$ 的电荷 $q$ 与自由电荷一样以速度 $v$（与电流方向相反）移动。下面我们可以求得它所在处的磁场为 $\mu_0I/2\pi r$，因此它受力 $\mu_0Iqv/2\pi r$。&lt;/p&gt;
&lt;p&gt;称刚才考虑的参考系为 $A$，导线中的正电荷在 $A$ 中静止。考虑 $q$ 静止的参考系 $A^\prime$。$q$ 就不受力了吗？并不是。不同的参考系中电荷量不变，而长度变，所以导线中的正负电荷的密度不同了。对于正电荷，根据尺缩效应，它的密度变为了 $\lambda_+^\prime=\gamma\lambda$。负电荷需要反过来用，因为它在 $A^\prime$ 中也是静止的，所以 $\lambda_-^\prime=\lambda/\gamma$。从而 $q$ 受库仑力 $(\lambda_+^\prime-\lambda_-^\prime)q/2\pi\eps_0r=\gamma v^2\lambda q/2\pi\eps_0c^2r=\gamma\mu_0Iqv/2\pi r$。&lt;/p&gt;
&lt;p&gt;由于这个力是垂直于导线方向的，所以洛伦兹变换只需乘/除以 $\gamma$，求得的结果自洽。&lt;/p&gt;
&lt;p&gt;这个事情说明电场和磁场本质上是一个事情，或者说，“磁场是电场的相对论修正”（知乎上看到的一句句子）。这个事情告诉我们，有时候就算是低速情况，也要考虑相对论效应。下面给出电流、电荷密度的洛伦兹变换（通过 $\nabla\cdot\b j+\p\rho/\p t=0$ 推得）：
$$
\left\{\begin{aligned}
\b j_x^\prime&amp;amp;=\gamma\left(\b j_x-v\rho\right)\\
\b j_y^\prime&amp;amp;=\b j_y\\
\b j_z^\prime&amp;amp;=\b j_z\\
\rho^\prime&amp;amp;=\gamma\left(\rho-\frac v{c^2}\b j_x\right)
\end{aligned}\right.
$$&lt;/p&gt;
&lt;h3 id=&#34;公式及推导&#34;&gt;公式及推导
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;物理量/关系&lt;/th&gt;
&lt;th&gt;静电场&lt;/th&gt;
&lt;th&gt;静磁场&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;公理 1.1：点场源与场的关系&lt;/td&gt;
&lt;td&gt;库仑定律 $\b E=\frac{1}{4\pi\eps_0}\frac{Q\b{\hat r}}{r^2}$&lt;/td&gt;
&lt;td&gt;毕奥—萨伐尔定律 $\b B=\frac{\mu_0}{4\pi}\frac{Q\b v\times\b{\hat r}}{r^2}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;公理 1.2：场源与通/环量的关系，微分形式&lt;/td&gt;
&lt;td&gt;高斯定律 $\nabla\cdot\b E=\frac{\rho}{\eps_0}$&lt;/td&gt;
&lt;td&gt;安培定律 $\nabla\times\b B=\mu_0\b j$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;公理 1.2：场源与通/环量的关系，积分形式&lt;/td&gt;
&lt;td&gt;高斯定律 $\oiint\b E\cdot\d\b s=\frac{Q}{\eps_0}$&lt;/td&gt;
&lt;td&gt;安培定律 $\oint\b B\cdot\d\b l=\mu_0I$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;公理 1.3：场的无旋/源特征&lt;/td&gt;
&lt;td&gt;电场无旋 $\nabla\times\b E=\b 0$&lt;/td&gt;
&lt;td&gt;磁场无源 $\nabla\cdot\b B=0$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;公理 2：场与力的关系&lt;/td&gt;
&lt;td&gt;洛伦兹力 $\b F=q\b E$&lt;/td&gt;
&lt;td&gt;洛伦兹力 $\b F=q\b v\times\b B$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;点（总）场源&lt;/td&gt;
&lt;td&gt;电荷 $Q$&lt;/td&gt;
&lt;td&gt;“动”电荷 $Q\b v$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场源的体密度&lt;/td&gt;
&lt;td&gt;（体）电荷密度 $\rho$&lt;/td&gt;
&lt;td&gt;（体）电流密度 $\b j$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场源的面密度&lt;/td&gt;
&lt;td&gt;面电荷密度 $\sigma$&lt;/td&gt;
&lt;td&gt;面电流密度 $\b J$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场源的线密度&lt;/td&gt;
&lt;td&gt;线电荷密度 $\lambda$&lt;/td&gt;
&lt;td&gt;电流 $\b I$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场源的变化&lt;/td&gt;
&lt;td&gt;$-$&lt;/td&gt;
&lt;td&gt;$\nabla\cdot\b j=-\frac{\d\rho}{\d t}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;常数&lt;/td&gt;
&lt;td&gt;真空介电常数 $\eps_0$&lt;/td&gt;
&lt;td&gt;真空磁导率 $\mu_0$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场&lt;/td&gt;
&lt;td&gt;电场（强度）$\b E$&lt;/td&gt;
&lt;td&gt;磁场（强度）$\b B$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;一般场源与场的关系，叠加定律&lt;/td&gt;
&lt;td&gt;$\b E=\frac{1}{4\pi\eps_0}\iiint\frac{\rho\d v(\b r-\b r_0)}{|\b r-\b r_0|^3}$&lt;/td&gt;
&lt;td&gt;$\b B=\frac{\mu_0}{4\pi}\iiint\frac{\b j\d v\times(\b r-\b r_0)}{|\b r-\b r_0|^3}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;势&lt;/td&gt;
&lt;td&gt;电势 $\varphi$&lt;/td&gt;
&lt;td&gt;磁矢势 $\b A$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;势与场源的关系，微分形式&lt;/td&gt;
&lt;td&gt;$\nabla^2\varphi=-\frac{\rho}{\eps_0}$&lt;/td&gt;
&lt;td&gt;$\nabla^2\b A=-\mu_0\b j$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;势与场源的关系，积分形式&lt;/td&gt;
&lt;td&gt;$\varphi=\frac{1}{4\pi\eps_0}\iiint\frac{\rho\d v}{|\b r-\b r_0|}$&lt;/td&gt;
&lt;td&gt;$\b A=\frac{\mu_0}{4\pi}\iiint\frac{\b j\d v}{|\b r-\b r_0|}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场与势的关系&lt;/td&gt;
&lt;td&gt;$\b E=-\nabla\varphi$&lt;/td&gt;
&lt;td&gt;$\b B=\nabla\times\b A$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;势能&lt;/td&gt;
&lt;td&gt;电势能 $W=\varphi q$&lt;/td&gt;
&lt;td&gt;$-$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;势能与做功的关系&lt;/td&gt;
&lt;td&gt;路径无关 $\varphi=\int\b E\cdot\d\b l$&lt;/td&gt;
&lt;td&gt;磁场的洛伦兹力不做功&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;偶极子&lt;/td&gt;
&lt;td&gt;电偶极子 $\b p=Q\b d$&lt;/td&gt;
&lt;td&gt;磁偶极子 $\b\mu=I\b S$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;偶极子的势&lt;/td&gt;
&lt;td&gt;$\varphi=\frac{1}{4\pi\eps_0}\frac{\b p\cdot\b{\hat r}}{r^2}$&lt;/td&gt;
&lt;td&gt;$\b A=\frac{\mu_0}{4\pi}\frac{\b\mu\times\b{\hat r}}{r^2}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;偶极子的场&lt;/td&gt;
&lt;td&gt;$\b E=\frac{1}{4\pi\eps_0}\big(\frac{3(\b p\cdot\b r)\b r}{r^5}-\frac{\b p}{r^3}\big)$&lt;/td&gt;
&lt;td&gt;$\b B=\frac{\mu_0}{4\pi}\big(\frac{3(\b\mu\cdot\b r)\b r}{r^5}-\frac{\b\mu}{r^3}\big)$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;偶极子受力&lt;/td&gt;
&lt;td&gt;$\b F=\nabla(\b p\cdot\b E)$&lt;/td&gt;
&lt;td&gt;$\b F=\nabla(\b\mu\cdot\b B)$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场能 1&lt;/td&gt;
&lt;td&gt;静电能 $U=\frac12\iiint\varphi\rho\d v$&lt;/td&gt;
&lt;td&gt;静磁能 $U=\frac12\iiint\b A\cdot\b j\d v$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;场能 2&lt;/td&gt;
&lt;td&gt;$U=\frac{\eps_0}2\iiint\b E^2\d v$&lt;/td&gt;
&lt;td&gt;$U=\frac1{2\mu_0}\iiint\b B^2\d v$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;注：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;公理 1.1 和 1.2+1.3 可互推。&lt;/li&gt;
&lt;li&gt;疑似书里是把 $\b B$ 作为磁场强度而非磁感应强度来讲的，也就是说可以全部当作 $\b H$。我在网上看到磁感应强度（考虑介质之后）是比磁场强度更本质的量，不太能理解。这不是跟 $\b E-\b D$ 关系刚好反过来了吗？&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;静电场、静磁场的定义：电荷密度恒定（可以有电流），电流恒定。&lt;/p&gt;
&lt;p&gt;磁场是由运动的电荷产生的。我们可以对电场和磁场进行一个比对：&lt;/p&gt;
&lt;p&gt;电荷 $\xrightarrow{/r^2}$ 电场 $\xrightarrow{\cdot q}$ 电场力&lt;/p&gt;
&lt;p&gt;电荷 $\xrightarrow{/\d t}$ 电流 $\xrightarrow{/r^2}$ 磁场 $\xrightarrow{\times q\b v}$ 磁场力&lt;/p&gt;
&lt;p&gt;所以相较而言，现在需要额外考虑的恒定的电荷运动的描述。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Part 1.&lt;/strong&gt; 电流密度 $\b j$：单位时间，单位面积，电荷通过量。我们有：
$$
\begin{align*}
&amp;amp;\b j=\frac{\rho\d\b l}{\d t}=\rho\b v=Nq\b v\\
&amp;amp;\d Q=\b j\cdot\d\b s\d t=\rho\b v\cdot\d\b s\d t\\
&amp;amp;I=\iint_S\b j\cdot\d\b s
\end{align*}
$$
你可能会觉得，（体）电流密度和（体）电荷密度是对照的，但它是单位面积通过的电荷量，这个不好记忆。可以这样记：它是单位体积电荷在单位时间内走过的“总路程”，即电荷量乘路程。&lt;/p&gt;
&lt;p&gt;有时候，我们也会把电流当作矢量，即沿导线方向。&lt;/p&gt;
&lt;p&gt;电流密度变化与电荷密度变化的关系：由电荷守恒（这里电荷只能移动，不能由你再往里放或者从里拿），对于一个体 $V$，
$$
\oiint_{\p V}\b j\cdot\d\b s=-\frac{\d Q}{\d t}=-\frac{\d}{\d t}\iiint_V\rho\d v\Longrightarrow\nabla\cdot\b j=-\frac{\d\rho}{\d t}
$$
静磁场的等价刻画是 $\d\rho/\d t=0$ 或 $\d\b E/\d t=\b 0$。以下推导验证了两个条件的等价：
$$
0=\nabla\cdot(\nabla\times\b B)=\mu_0\nabla\cdot\b j=-\mu_0\frac{\d\rho}{\d t}=0
$$
所以说电流一定成环。无限长导线可以认为成头尾在无限远处相接。&lt;/p&gt;
&lt;p&gt;没有磁荷，这个是实验得出的。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Part 2.&lt;/strong&gt; 静磁场的麦克斯韦方程：
$$
\left\{\begin{align*}
\nabla\cdot\b B&amp;amp;=0\\
\nabla\times\b B&amp;amp;=\mu_0\b j
\end{align*}\right.
$$
$\mu_0$ 被称为真空磁导率，一个重要的关系是 $c^2\eps_0\mu_0=1$，$c$ 是光速。&lt;/p&gt;
&lt;p&gt;这个和毕奥—萨伐尔定律是可以互推的，课上根本没提后者，了解一下就行，推导和电场的那些基本是一样的。值得注意的一个点是，毕奥—萨伐尔定律加洛伦兹力会导致出现两段电流元之间的作用力违反牛三的情况。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Part 3.&lt;/strong&gt; 现在关注力的部分。洛伦兹力：
$$
F=q(\b E+\b v\times\b B)
$$&lt;/p&gt;
&lt;p&gt;从洛伦兹力到安培力：
$$
\b F=\iiint_VN\d v(q\b v\times\b B)=\iiint_V(\b j\times\b B)\d v=\iiint_V(\b j\d s\times\b B)\d l=\int_L(\b I\times\b B)\d l\Longrightarrow\frac{\d\b F}{\d l}=\b I\times\b B
$$&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Part 4.&lt;/strong&gt; 安培定律：
$$
\oint_L\b B\cdot\d\b l=\iint_S(\nabla\times\b B)\cdot\d\b s=\mu_0\iint_S\b j\cdot\d\b s=\mu_0I
$$
注意这里的 $I$ 指的是穿过 $S$ 的电流，而不是任意方向的！&lt;/p&gt;
&lt;p&gt;另外这个只适用于静磁场。变化的时候要用安培—麦克斯韦定律。&lt;/p&gt;
&lt;p&gt;两个电流同向的平行导线是互相吸引的。在电流的值通过 $1\unit{C/s}$ 定义之前，它就是通过平行导线的受力为某个值来定义的。&lt;/p&gt;
&lt;p&gt;安培定律 $\Rightarrow$ 毕奥—萨伐尔定律：
$$
\begin{align*}
\b B&amp;amp;=\nabla\times\b A\\
&amp;amp;=\frac{\mu_0}{4\pi}\nabla\times\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\\
&amp;amp;=\frac{\mu_0}{4\pi}\iiint_V\left(\nabla\frac{1}{|\b r-\b r^\prime|}\right)\times\b j\d v&amp;amp;(\nabla\times(f\b A)=f\nabla\times\b A+\nabla f\times\b A)\\
&amp;amp;=-\frac{\mu_0}{4\pi}\iiint_V\frac{(\b r-\b r^\prime)\times\b j\d v}{|\b r-\b r^\prime|^3}\\
&amp;amp;=\frac{\mu_0}{4\pi}\iiint_V\frac{\b j\d v\times(\b r-\b r^\prime)}{|\b r-\b r^\prime|^3}\\
&amp;amp;=\frac{\mu_0}{4\pi}\iiint_V\frac{I\d\b l\times(\b r-\b r^\prime)}{|\b r-\b r^\prime|^3}
\end{align*}
$$
反过来（需假设无穷远处无电流，或者至少除以 $r$ 一次方后趋近于零）：
$$
\begin{align*}
\b B&amp;amp;=\frac{\mu_0}{4\pi}\iiint_V\frac{\b j\d v\times(\b r-\b r^\prime)}{|\b r-\b r^\prime|^3}\\
&amp;amp;=\nabla\times\frac{\mu_0}{4\pi}\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\\
\nabla\times\b B&amp;amp;=\frac{\mu_0}{4\pi}\nabla\times\left(\nabla\times\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\right)\\
&amp;amp;=\frac{\mu_0}{4\pi}\left[\nabla\left(\nabla\cdot\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\right)-\nabla^2\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\right]\\
&amp;amp;=\frac{\mu_0}{4\pi}\left[\nabla\left(-\iiint_V\b j\d v\nabla^\prime\cdot\frac1{|\b r-\b r^\prime|}\right)-\nabla^2\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\right]\\
&amp;amp;=\frac{\mu_0}{4\pi}\left[\nabla\left(-\oiint_{\p V}\frac{\b j\cdot\d\b s}{|\b r-\b r^\prime|}-\iiint_V\frac{\nabla^\prime\cdot\b j\d v}{|\b r-\b r^\prime|}\right)-\nabla^2\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\right]\\
&amp;amp;=-\frac{\mu_0}{4\pi}\nabla^2\iiint_V\frac{\b j\d v}{|\b r-\b r^\prime|}\\
&amp;amp;=\mu_0\iiint_V\delta^3(\b r-\b r^\prime)\b j\d v\\
&amp;amp;=\mu_0\b j(\b r)
\end{align*}
$$&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Part 5.&lt;/strong&gt; 磁矢势：由于 $\nabla\cdot\b B=0$，故 $\b B=\nabla\times\b A$，这个 $\b A$ 称为磁矢势。由于 $\b A+\nabla(\forall\varphi)$ 都不影响 $\nabla\times\b A$，故 $\b A$ 有很大的不确定度。实际上加了一个库仑规范，要求 $\nabla\cdot\b A=0$。但是仍然不唯一……&lt;/p&gt;
&lt;p&gt;为什么要定这个库仑规范呢？考虑
$$
\mu_0\b j=\nabla\times\b B=\nabla\times(\nabla\times\b A)=\nabla(\nabla\cdot\b A)-\nabla^2\b A=-\nabla^2\b A
$$
这很好，因为它和电势的形式一模一样！
$$
\begin{align*}
&amp;amp;\nabla^2\varphi=-\frac{\rho}{\eps_0}\\
&amp;amp;\nabla^2\b A_i=-\mu_0\b j_i
\end{align*}
$$
于是
$$
\b A(\b r)=\frac{\mu_0}{4\pi}\iiint_V\frac{\b j(\b r^\prime)\d v}{|\b r-\b r^\prime|}
$$
注意在 $\b B=0$ 处 $\b A$ 可能变化。&lt;/p&gt;
&lt;p&gt;我们验证一下这个式子必定符合库仑规范：
$$
\begin{align*}
\nabla\cdot\b A(\b r)&amp;amp;=\frac{\mu_0}{4\pi}\iiint_V\b j(\b r^\prime)\d v\nabla_{\b r}\cdot\left(\frac1{|\b r-\b r^\prime|}\right)\\
&amp;amp;=-\frac{\mu_0}{4\pi}\iiint_V\b j(\b r^\prime)\d v\nabla_{\b r^\prime}\cdot\left(\frac1{|\b r-\b r^\prime|}\right)\\
&amp;amp;=-\frac{\mu_0}{4\pi}\iiint_{\p V}\frac{\b j(\b r^\prime)\cdot\d\b s}{|\b r-\b r^\prime|}+\frac{\mu_0}{4\pi}\iiint_V\frac{\nabla_{\b r^\prime}\cdot\b j(\b r^\prime)\d v}{|\b r-\b r^\prime|}\\
&amp;amp;=0
\end{align*}
$$
倒数第二个等号是分部积分，最后一个等号第一项为零是因为可以把边界取得足够远，第二项为零是因为是静的情况。&lt;/p&gt;
&lt;h4 id=&#34;例-1-7&#34;&gt;例 1
&lt;/h4&gt;&lt;p&gt;通电直导线的磁场。首先可以用安培定律，取一个圆环。通过圆面的电流量就是 $I$，于是
$$
\b B=\frac{\mu_0\b I\times\b{\hat r}}{2\pi r}
$$
也可以先求磁矢势，这个结构和 $\lambda=I$ 的直棒没什么两样，因此（这里 $r$ 是柱坐标系的）
$$
\b A_z=-\frac{\mu_0I}{2\pi}\ln r
$$
于是
$$
\b B=\nabla\times\left(0,0,-\frac{\mu_0I}{2\pi}\ln r\right)=\left(-\frac{\mu_0Iy}{2\pi(x^2+y^2)},\frac{\mu_0Ix}{2\pi(x^2+y^2)},0\right)=\frac{\mu_0I}{2\pi r}\b{\hat\phi}
$$
也可以用毕奥—萨伐尔定律：
$$
\begin{align*}
\b B&amp;amp;=\frac{\mu_0}{4\pi}\int_{-\infty}^{+\infty}\frac{I\d z(\b{\hat z}\times(\b r-z\b{\hat z}))}{|\b r-z\b{\hat z}|^3}\\
&amp;amp;=\frac{\mu_0I}{4\pi}\int_{-\infty}^{+\infty}\frac{(0,0,1)\times(x_0,y_0,z_0-z)}{\left[x_0^2+y_0^2+(z-z_0)^2\right]^{3/2}}\d z\\
&amp;amp;=\frac{\mu_0I}{4\pi}\int_{-\infty}^{+\infty}\frac{(-y_0,x_0,0)}{\left[x_0^2+y_0^2+(z_0-z)^2\right]^{3/2}}\d z\\
&amp;amp;=\frac{\mu_0I}{4\pi}(-y_0,x_0)\left.\frac{z_0-z}{\left(x_0^2+y_0^2\right)\sqrt{x_0^2+y_0^2+(z_0-z)^2}}\right|_{-\infty}^{+\infty}\\
&amp;amp;=\frac{\mu_0I(-y_0,x_0)}{2\pi\left(x_0^2+y_0^2\right)}
\end{align*}
$$&lt;/p&gt;
&lt;h4 id=&#34;例-2-5&#34;&gt;例 2
&lt;/h4&gt;&lt;p&gt;无限长通电螺线管的磁场：首先通过环绕螺线管的安培回路得出外部无磁场，其次通过一半在内的安培回路得出内部
$$
B=\mu_0nI
$$
其中 $n$ 是单位长度的导线股数。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;8-2.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;如果用磁矢势或毕奥—萨伐尔算，则是灾难。为了演示还是用磁矢势算一下：&lt;/p&gt;
&lt;p&gt;假设轴是沿 $z$ 轴方向的。令面电荷密度为 $J=nI$，写出方向就是 $\b J=(-J\sin\varphi,J\cos\varphi,0)$。为了算 $\b A_y$，考虑用之前遇到过的套路，就是两个轴分别偏移了 $d/2$ 的实心均匀带点柱，让 $d\to 0$。&lt;/p&gt;
&lt;p&gt;对于一个圆柱，我们让它表面 $\varphi=0$（虽然直接是两个圆柱时无法自洽，但取了 $\p$ 之后实际上我们只关心变化量，所以说就隐含改为无穷远处为 $0$ 了）。在内部距轴 $r$ 处的电势为
$$
\varphi=\frac{\lambda}{4\pi\eps_0}-\frac{\lambda r^2}{4\pi\eps_0R^2}
$$
两个位移取极限，我们希望
$$
\frac{\lambda}{\pi R^2}d=J
$$
所以最终的电势是
$$
\lim_{d\to 0}-\frac{\p\varphi}{\p x}\cdot d\cdot\frac{J}{\lambda d/\pi R^2}=\frac{Jx}{2\eps_0}
$$
在外部则是
$$
\varphi=-\frac{\lambda}{2\pi\eps_0}\ln r
$$
同样完整的电势是
$$
-\frac{\p\varphi}{\p x}\cdot\frac{J\pi R^2}{\lambda}=\frac{2\lambda x}{4\pi\eps_0r^2}\cdot\frac{J\pi R^2}{\lambda}=\frac{JxR^2}{2\eps_0r^2}
$$
$x$ 维类似。所以总的来说，（在柱坐标系下）
$$
\b A=\left\{\begin{aligned}&amp;amp;\frac{\mu_0Jr}{2}\b{\hat\phi},&amp;amp;r&amp;lt;R\\ &amp;amp;\frac{\mu_0JR^2}{2r}\b{\hat\phi},&amp;amp;r&amp;gt;R\end{aligned}\right.
$$
于是
$$
\b B=\left\{\begin{aligned}&amp;amp;\mu_0J\b{\hat z},&amp;amp;r&amp;lt;R\\ &amp;amp;\b 0,&amp;amp;r&amp;gt;R\end{aligned}\right.
$$
用毕奥—萨伐尔算，我在另一篇里写过了。&lt;/p&gt;
&lt;h2 id=&#34;磁偶极子&#34;&gt;磁偶极子
&lt;/h2&gt;&lt;p&gt;磁铁的原理：磁铁中的电子自旋方向一致，而一般金属的电子自旋都是乱的，所以不显磁性。一堆小的电流回路等效于一个大的回路，这个原理就是 Stokes 公式。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;8-3.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src=&#34;9-1.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;磁偶极子：考虑两根长度为 $a$，距离为 $b$ 的，平行的短超导线，电流为相反的 $I$。这个可以类比电偶极子。电偶极子是 $p=Qd$，这里，$Q$ 类比 $Ia$，$d$ 就是 $b$。所以 $p=Iab$。如果这两个导线是沿 $x$ 方向的，那么
$$
\b A_x=-\frac{\mu_0}{4\pi}\frac{Iaby}{r^3}
$$
当然孤立的两根导线是无法电荷守恒的，在 $y$ 方向再有一对导线，就可以形成一个回路。于是
$$
\b A_y=\frac{\mu_0}{4\pi}\frac{Iabx}{r^3}
$$
于是
$$
\b A=\frac{\mu_0}{4\pi}\frac{Iab\b{\hat z}\times\b{\hat r}}{r^2}
$$
所以我们可以定义磁偶极矩
$$
\b\mu=I\b S
$$
其中 $\b S$ 就是面积矢量。就有
$$
\b A=\frac{\mu_0}{4\pi}\frac{\b\mu\times\b{\hat r}}{r^2}
$$
容易发现，一处的势是和电流方向相同的。&lt;/p&gt;
&lt;p&gt;然后可以导出
$$
\b B=\frac{\mu_0}{4\pi}\left(\frac{3(\b\mu\cdot\b r)\b r}{r^5}-\frac{\b\mu}{r^3}\right)
$$
对比电偶极子的情况，我们可以发现，一个回路（磁偶极子），和连线与该回路面垂直的两个异种电荷（电偶极子）是可以类比的。&lt;/p&gt;
&lt;p&gt;对于一般的情况，推导几乎和电势的多级展开思路相同。
$$
\begin{align*}
\b A(\b r)&amp;amp;=\frac{\mu_0}{4\pi}\iiint_V\frac{\b j(\b r^\prime)\d v}{|\b r-\b r^\prime|}\\
&amp;amp;\approx\frac{\mu_0}{4\pi}\iiint_V\b j(\b r^\prime)\d v\left(\frac1r-\b r^\prime\cdot\nabla\frac1r\right)\\
&amp;amp;=\frac{\mu_0}{4\pi}\left[\frac1r\iiint_V\b j(\b r^\prime)\d v-\iiint_V\left(\nabla\frac1r\cdot\b r^\prime\right)\b j(\b r^\prime)\d v\right]\\
\end{align*}
$$
为了得到标准形式，我们需要规定 $\b j$ 在空间中的分布是有限的（要是无限的根本不适合做近似）。先证明一个引理：
$$
\iiint_V\b j\cdot\nabla f\d v=0
$$
这是因为
$$
\text{LHS}=\iiint_V\nabla\cdot(\b jf)\d v-\iiint_Vf\nabla\cdot\b j\d v=\oiint_{\p V}\b jf\cdot\d\b s=0
$$
第一项
$$
\iiint_V\b j_x\d v=\iiint_V\b j\cdot\b{\hat x}\d v=\iiint_V\b j\cdot\nabla x\d v=0
$$
第二项，首先我们知道，对任意两维坐标 $\b x_k,\b x_l$（这里 $\b x$ 相当于 $\b r$，写 $\b x$ 是为了避免和别的地方混淆），
$$
0=\iiint_V\b j\cdot\nabla(\b x_k\b x_l)\d v=\iiint_V\b j_k\b x_l\d v+\iiint_V\b j_l\b x_k\d v
$$
然后我们考虑使用 $\b a\times(\b b\times\b c)=(\b a\cdot\b c)\b b-(\b a\cdot\b b)\b c$ 凑叉乘，记 $\b d=\nabla(1/r)$。
$$
\begin{align*}
&amp;amp;\iiint_V\left(\b d\cdot\b r^\prime\right)\b j(\b r^\prime)\d v\\
={}&amp;amp;\iiint_V\left[\frac{(\b d\cdot\b r^\prime)\b j(\b r^\prime)-(\b d\cdot\b j(\b r^\prime))\b r^\prime}{2}+\frac{(\b d\cdot\b r^\prime)\b j(\b r^\prime)+(\b d\cdot\b j(\b r^\prime))\b r^\prime}{2}\right]\d v\\
={}&amp;amp;{-\frac12}\iiint_V\b d\times(\b r^\prime\times\b j(\b r^\prime))\d v+\sum_{k,l}\b e_l\iiint_V\b d_k\left(\b r^\prime_k\b j(\b r^\prime)_l+\b j(\b r^\prime)_k\b r^\prime_l\right)\d v\\
={}&amp;amp;{-\frac12}\b d\times\iiint_V\b r^\prime\times\b j(\b r^\prime)\d v
\end{align*}
$$
于是全部算起来就是
$$
\b A(\b r)\approx\frac{\mu_0}{4\pi}\b d\times\frac12\iiint_V\b r^\prime\times\b j(\b r^\prime)\d v
$$
其中后面这一项（含 $1/2$）就是一般意义下的磁偶极矩。这个推导可以作为磁单极子不存在的理论依据。&lt;/p&gt;
&lt;p&gt;对于一个不规则形状但共面的回路，
$$
\b\mu=\frac12\iiint_V\b r\times\b j(\b r)\d s\d l=\frac12\oint_L\b r\times I\d\b r=I\b n\oint_Lr^2\d\theta=I\b S
$$&lt;/p&gt;
&lt;p&gt;符合常理。&lt;/p&gt;
&lt;h2 id=&#34;静磁能&#34;&gt;静磁能
&lt;/h2&gt;&lt;p&gt;定义静磁能为，将整个体系从相距无穷远且各部分（含自由电荷）静止，控制得到当前状态所作的总功。以下的推导不是特别严谨，你可以假定不考虑相对论效应。同时我们只是举了个特例来说明，随便变一下电偶极子的形状、磁场的分布之类的，体系成员的数量之类的，整个就很难推了。反正我觉得我写得比书里稍微清楚一点点。&lt;/p&gt;
&lt;p&gt;考虑一个磁偶极子在匀强的 $z$ 方向磁场里，与 $x$ 轴有夹角，与 $y$ 轴平行。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;9-2.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;在 1 和 2 上的力虽然相等，但会出现一个力矩，倾向于将整个矩形转成与 $x$ 轴也平行。
$$
\b\tau=\b l\times\b F=a\sin\theta\cdot BIb\cdot(-\b{\hat y})=\b\mu\times\b B
$$
由于我们没学过普物一，所以这里推一下二维的情况：
$$
\d W=\sum\d\b r\cdot\b F=\sum r\d\theta F_\perp=\sum\d\theta(\b r\times\b F)=\tau\d\theta
$$
也就是说，如果我们基于这个匀强磁场造成的“回复力”定义势能，那么现在这个磁偶极子的势能就是
$$
\int\tau\d\theta^\prime=\int\mu B\sin\theta^\prime\d\theta^\prime=-\mu B\cos\theta+C
$$&lt;/p&gt;
&lt;p&gt;为了检验这么搞是否靠谱，现在，我们再考虑两个场景：一个是将 $\theta=0$ 的这个磁偶极子从无限远处移到原点，一个是将 $\theta=\pi/2$ 的移过来。&lt;/p&gt;
&lt;p&gt;由于磁场无法做到无限，我们就想它在某一处有个突变。对于 $\theta=0$，譬如说从 $x=+\infty$ 处移过来，然后在某个 $x\le t$ 开始突然有了磁场。那么在穿越这个边界时，3、4 段力抵消，1 段有力，2 段无力，磁场力做功就是 $Fl=BIb\cdot a=\mu B$。&lt;/p&gt;
&lt;p&gt;如果是 $\theta=\pi/2$，那么 3、4 段无力，1、2 段力抵消，就是不做功。于是 $E_{\pi/2}-E_0=\mu B$，这个和上面的是一致的。&lt;/p&gt;
&lt;p&gt;好，我们现在知道的事情是，将 $\theta=0$ 情况从无穷远移到原点，所做的功是 $-\mu B$（和磁场做的功相反）。我们再考察维持电流所需要的功。由于这个是动生电动势，所以我们还是可以用洛伦兹力解释的。当 1 段在内，2 段在外时，且以 $v_0$ 的速度移动时，1 段受到导线方向的力为 $F=Qv_0B$，$Q$ 为 1 段总自由电荷量，为维持电流，做的功率为 $P=Fv$，$v$ 是电流中的电荷速度。总的功就是
$$
W=Pt=Fv\cdot\frac{a}{v_0}=QvaB=b\lambda vaB=ISB=\mu B
$$
也就是说维持电流做的功与移进去做的功刚好抵消，这很合理，因为磁的洛伦兹力不做功。&lt;/p&gt;
&lt;p&gt;当然同时我们也要考虑产生这个均匀电场的某个神秘角色（比如一个通电螺线管），维持它的电流所用的功。由于力的作用是相互的，因此如果把这个螺线管看作一个整体，它受的力大小就等于电偶极子所受的力（这句话的前提实际上就是，造成电动势的这部分洛伦兹力整体上合力为零），于是再由洛伦兹力不做功，维持电流的功仍然是 $\mu B$，而这个螺线管是不动的，所以机械上不做功。总体来说做功为 $-\mu B+\mu B+\mu B=\mu B$。于是，我们可以得到总的静磁能为 $\mu B$ 加上两个回路各自固有的能量。同样如果有一定夹角，我们可以推出 $U=\b\mu\cdot\b B$。于是对于一个处于非均匀磁场种的一般回路而言，可以把它拆成小回路
$$
U=\iiint_V\b B\cdot\d\b\mu=I\iint_S\b B\cdot\d\b s=I\oint_{\p S}\b A\cdot\d\b l
$$
对于一般的情况，可以用无数回路模拟整个无规则的 $\b j$ 场。那么这个时候 $I\d\b l=\b j\d v$。加之我们刚刚考虑的是“螺线管对电偶极子”的能量，反过来还有一倍，所以要除以二，总的就是
$$
U=\frac12\iiint_V\b A\cdot\b j\d v
$$&lt;/p&gt;
&lt;p&gt;你可能会想一个问题：既然磁场力不做功，那么为什么磁场会有能量呢？这说明你是在稳恒电流的默认假设下考虑的。变化的情况下还有感生电场。&lt;/p&gt;
&lt;h2 id=&#34;法拉第电磁感应定律&#34;&gt;法拉第电磁感应定律
&lt;/h2&gt;&lt;p&gt;对于一个面 $S$，定义磁通量
$$
\Phi=\iint_S\b B\cdot\d\b s
$$
由于 $\nabla\cdot\b B=0$，故这个是良定义的。&lt;/p&gt;
&lt;p&gt;一般来说，之所以能定义电势，就是因为电场做功与路径无关，或者说电场无旋。但是这里我们要给出电动势的定义：将一个电荷 $q$，沿着回路移动一圈，所做的功，除以 $q$。一般符号写成 $\cal E$。&lt;/p&gt;
&lt;p&gt;那就很奇怪了，这不应该永远是 $0$ 吗？有两种主要情况它会有值。一种是洛伦兹力的分量（洛伦兹力减安培力）形成的动生电动势：当磁场是静的时候，
$$
\mathcal{E}=\oint_L\frac{\b F}q\cdot\d\b l=\oint_L(\b v\times\b B)\cdot\d\b l=-\oint_L(\b v\times\d\b l)\cdot\b B=-\iint_S\frac{\d\b s}{\d t}\cdot\b B=-\frac{\d\Phi}{\d t}
$$
（注：高中课内推导不出这个的原因主要是没学混合积公式，乐）&lt;/p&gt;
&lt;p&gt;这种情况并非“真正有旋”，而只是形式上区分了&amp;quot;mechanical&amp;quot;和&amp;quot;electrical&amp;quot;的力。但是感生电动势就不能这么解释了，我们需要引入法拉第定律：当磁场不是静的时候，
$$
\nabla\times\b E=-\frac{\p\b B}{\p t}
$$
则
$$
\mathcal{E}=\oint_L\b E\cdot\d\b l=\iint_S(\nabla\times\b E)\cdot\d\b s=-\iint_S\frac{\p\b B}{\p t}\cdot\d\b s=-\frac{\d\Phi}{\d t}
$$
所以两个式子可以联合在一起。可以推出高中特殊情况下的公式 $\mathcal{E}=Blv$，方向可以归纳为楞次定律。&lt;/p&gt;
&lt;h3 id=&#34;自感与互感&#34;&gt;自感与互感
&lt;/h3&gt;&lt;p&gt;自感与互感系数就是回路的电流变化产生的对回路的电动势的比例。例如说，对于一个长度为 $l$，总匝数为 $N$，截面积为 $S$ 的足够长螺线管，
$$
\mathcal{E}=-\frac{\d\Phi}{\d t}=-\frac{\d(\mu_0\frac{N}{l}I\cdot NS)}{\d t}=-\mu_0\frac{N^2S}{l}\dot I=-\mu_0n^2lS\dot I
$$&lt;/p&gt;
&lt;p&gt;所以说自感系数为 $L=\mu_0n^2lS=\mu_0n^2V$。在高中的时候我们会看到那种直接视作理想情况（$\mu_0nI$）推互感的方法，然后仔细一推会发现 $M_{12}\ne M_{21}$，这个东西的原因是两个螺线管之间存在着&lt;strong&gt;不可忽略且不可避免的漏磁&lt;/strong&gt;。如果要写严格的一般的公式，我们可以这样考虑。对于两个回路，记它们的面分别为 $S_1$、$S_2$。
$$
\begin{align*}
\Phi_{12}=\iint_{S_2}\b B_1\cdot\d\b s_2=\oint_{\p S_2}\b A_1\cdot\d\b l_2=\oint_{\p S_1}\oint_{\p S_2}\frac{\mu_0I_1\d\b l_1\cdot\d\b l_2}{4\pi r_{12}}
\end{align*}
$$
注意到 $1$ 和 $2$ 在式子中的地位相同，所以说互感系数
$$
M_{12}=M_{21}=\frac{\mu_0}{4\pi}\oint_{\p S_1}\oint_{\p S_2}\frac{\d\b l_1\cdot\d\b l_2}{r_{12}}
$$
明确一下，$M_{12}$ 是指 $1$ 的电流变化在 $2$ 中产生的电动势的比例。电动势的正方向与电流正方向相同，所以 $\mathcal{E}=-L\dot I$ 定义的 $L$ 一定是正的，而 $\mathcal{E}_2=-M_{12}\dot{I}_1$ 定义的 $M_{12}$ 可正可负。比如说如果是两个轴在同一条直线上，绕线方向相同的螺线管，它们之间的 $M$ 就是正的。另外可以根据 $L$ 和 $M$ 反推出磁通量的表达式
$$
\left\{\begin{aligned}
\Phi_1&amp;amp;=L_1I_1+M_{21}I_2\\
\mathcal{E}_1&amp;amp;=-L_1\dot I_1-M_{21}\dot I_2\\
\Phi_2&amp;amp;=M_{12}I_1+L_2I_2\\
\mathcal{E}_2&amp;amp;=-M_{12}\dot I_1-L_2\dot I_2\\
\end{aligned}\right.
$$
实际求的时候，这个二重环路积分的式子并不好用。比如一个半径为 $R$ 的大圆线圈，中间有个共面的，面积为 $S$ 的小线圈。那么显然我们更乐意直接用 $\Phi$ 去算（而且小对大的 $\Phi$ 也不好算，只有大对小的好算）。根据毕奥—萨伐尔，中心的磁场强度为
$$
B=\frac{\mu_0I}{2R}
$$
可以认为中心附近的磁场均匀，所以
$$
M=\frac{\mu_0S}{2R}
$$
关于自感系数与互感系数的关系，我感觉就没有一本书讲得是严谨的，这里也只能简单写一下。现在还是考虑两个螺线管，我们不认为它们是理想的。考虑第一个螺线管有电流 $I_1$ 后产生的磁场，设单个截面所能接收到的磁场为 $\phi_1$。那么
$$
L_1=\frac{N_1\phi_1}{I_1},\,M\le\frac{N_2\phi_1}{I_1}
$$
这里的 $\le$ 号就是因为可能漏磁。注意由于两个螺线管截面面积可能不同，磁场大小（磁感线密度）可能变化，但总的磁通量（磁感线股数）是不变的。&lt;/p&gt;
&lt;p&gt;同理如果是第二个螺线管通电的话，
$$
L_2=\frac{N_2\phi_2}{I_2},\;M\le\frac{N_1\phi_2}{I_2}
$$
于是我们有
$$
M^2\le\frac{N_1N_2\phi_1\phi_2}{I_1I_2}=L_1L_2
$$
当且仅当不漏磁时取等。$k=M/\sqrt{L_1L_2}$ 被称为耦合系数。这个不等式还可以用能量证（见后）。但是我在想的是，你不觉得
$$
\left(\oint_{L_1}\oint_{L_1}\frac{\d\b l_1\cdot \d\b l_1^\prime}{r}\right)\left(\oint_{L_2}\oint_{L_2}\frac{\d\b l_2\cdot \d\b l_2^\prime}{r}\right)\ge\left(\oint_{L_1}\oint_{L_2}\frac{\d\b l_1\cdot \d\b l_2}{r}\right)^2
$$
长得跟柯西不等式神似吗？能纯从代数上证吗？&lt;/p&gt;
&lt;p&gt;关于自感与互感的应用，最有代表性的电感、LC 震荡电路、变压器，都在高中讲过了，这里略。&lt;/p&gt;
&lt;p&gt;这里我们考虑静磁能。上面我们不得不用动生电动势，借助机械功，间接地求出磁能。现在，有了感生电动势的手段，我们就可以先把没有电流的线路全都摆好，再慢慢加电流。对于一个自感系数为 $L_1$ 的超导线圈，如果它目前电流为 $I$，自感电动势为 $\mathcal{E}$，那么我们现在考虑一段 $\d l$ 的线，其处的电场为 $E$，单位时间有 $I$ 的电荷通过，所以这部分的功率是 $EI\d l$。于是为了维持电流，总的功率就是
$$
\oint EI\d l=\mathcal{E}I
$$
要把电流升到 $I_1$，总的功就是（增大电流无需做功）
$$
\int_0^{I_1}\mathcal{E}I\d t=\int_0^{I_1}L_1I\d I=\frac12L_1I_1^2
$$
这个时候如果再将另一个线圈通电，类似地积一下可以得到互感部分的做功 $MI_1I_2$。所以可以写出总的能量：
$$
U=\frac12\sum_{i,j}L_{ij}I_iI_j
$$
而我们知道 $\mathcal{E}=-\d\Phi/\d t=-L\d I/\d t$，也就是说 $LI=\Phi$。于是
$$
\begin{align*}
U&amp;amp;=\frac12\sum_i\sum_j(I_jL_{ji})I_i\\
&amp;amp;=\frac12\sum_i\Phi_iI_i\\
&amp;amp;=\frac12\sum_iI_i\iint_{S_i}\b B\cdot\d\b s\\
&amp;amp;=\frac12\sum_i\oint_{\p S_i}\b A\cdot I_i\d\b l\\
&amp;amp;=\frac12\iiint\b A\cdot\b j\d v
\end{align*}
$$
最后一个等号需要考虑一下几何意义。顺便再推一下另一个表达式
$$
\begin{align*}
U&amp;amp;=\frac12\iiint\b A\cdot\b j\d v\\
&amp;amp;=\frac1{2\mu_0}\iiint\b A\cdot(\nabla\times\b B)\d v\\
&amp;amp;=\frac1{2\mu_0}\left[\iiint\b B\cdot(\nabla\times\b A)\d v-\iiint\nabla\cdot(\b A\times\b B)\d v\right]\\
&amp;amp;=\frac1{2\mu_0}\left[\iiint\b B^2\d v-\iiint_S(\b A\times\b B)\cdot\d\b s\right]
\end{align*}
$$
当 $S$ 扩大时，$|\b A|\propto r^{-1}$，$|\b B|\propto r^{-2}$，$S\propto r^2$，所以后一项就是 $0$。&lt;/p&gt;
&lt;p&gt;最后用能量说明一下互感系数与自感系数的关系。对于两个线圈（注意 $I$ 可以取负，表示电流与规定方向反），
$$
0\le U=\frac12L_1I_1^2+\frac12L_2I_2^2+MI_1I_2\xlongequal{x=I_1/I_2}I_1I_2\left(\frac{L_1}{2}x+\frac{L_2}{2}x^{-1}+M\right)
$$
当 $I_1$ 与 $I_2$ 异号时，我们要保证里面的这个对勾函数最大值 $\le-M$，即
$$
-2\sqrt{\frac{L_1L_2}{4}}\le-M\Longrightarrow M\le\sqrt{L_1L_2}
$$&lt;/p&gt;
&lt;h3 id=&#34;例-1-8&#34;&gt;例 1
&lt;/h3&gt;&lt;p&gt;电子感应加速器。&lt;/p&gt;
&lt;p&gt;在高中我们学过运动电荷在匀强电场中做圆周运动，以及两个半圆槽组成的电子加速器。现在的问题是：能否通过改变磁场使得圆周运动轨道保持但不断加快？&lt;/p&gt;
&lt;p&gt;考虑在两个不同半径范围内布置不同强度的匀强垂直磁场。设电子轨道半径为 $r$，轨道所在处的磁场强度为 $B_r$，内部平均电场强度为 $\bar{B}$。我们有：
$$
\left\{\begin{aligned}
evB_r&amp;amp;=m\frac{v^2}r\\
\frac{\pi r^2}{2\pi r}\frac{\d\bar B}{\d t}e&amp;amp;=m\frac{\d v}{\d t}
\end{aligned}\right.
$$
解得 $\d\bar B=2\d B_r$。&lt;/p&gt;
&lt;h3 id=&#34;例-2-6&#34;&gt;例 2
&lt;/h3&gt;&lt;p&gt;一个边长为 $a$ 正方形回路，中间靠右 $1/4$ 处有一个与左右边平行的竖棒。垂直向内的磁场以 $k$ 的速率增加。框架的各部分，单位长度电阻均为 $r$。求竖棒上的电流。&lt;/p&gt;
&lt;p&gt;错误解答：对于左侧 $3/4$ 面积的区域，磁通量的增加速率为 $3a^2k/4$，矩形框架部分电阻为 $7ar/2$，电流为 $3ak/14r$。右侧 $1/4$ 的区域，磁通量增加速率为 $a^2k/4$，电阻为 $5r/2$，电流为 $ak/10r$。电流可以叠加，所以中间这个的电流是 $4ak/35r$。懒得管方向了。&lt;/p&gt;
&lt;p&gt;正确解答：设左 $3/4$ 的外框架部分电动势为 $\mathcal{E}_1$，右 $1/4$ 是 $\mathcal{E}_2$，竖棒是 $\mathcal{E}$，方向都是从上到下。可列方程
$$
\left\{\begin{aligned}
\mathcal{E}_1-\mathcal{E}&amp;amp;=\frac{3a^2k}4\\
\mathcal{E}-\mathcal{E}_2&amp;amp;=\frac{a^2k}4\\
\frac{\mathcal{E}_1}{5ar/2}+\frac{\mathcal{E}_2}{3ar/2}&amp;amp;=-\frac{\mathcal{E}}{ar}
\end{aligned}\right.
$$
解得电流为 $2ak/31r$。&lt;/p&gt;
&lt;h3 id=&#34;例-3-2&#34;&gt;例 3
&lt;/h3&gt;&lt;p&gt;一根无限长导线电流为 $I$，一个圆环半径为 $a$，圆心在距离导线 $b$ 处（$b&amp;gt;a$），圆面与导线形成的磁场垂直。圆环以 $v$ 的速度向远离导线的方向移动，求圆环中的电动势。
$$
\begin{align*}
\Phi&amp;amp;=\frac{\mu_0I}{2\pi}\int_{b-a}^{b+a}\frac{2\sqrt{a^2-(b-x)^2}\d x}{x}\\
&amp;amp;\xlongequal{b-x=a\cos\theta}\frac{\mu_0Ia}\pi\int_0^\pi\frac{\sqrt{a^2-a^2\cos^2\theta}\sin\theta\d\theta}{b-a\cos\theta}\\
&amp;amp;=\frac{\mu_0Ia}\pi\int_0^\pi\frac{\sin^2\theta\d\theta}{b/a-\cos\theta}\\
&amp;amp;=\frac{\mu_0Ia}\pi\int_0^\pi\left(\cos\theta+\frac ba+\frac{1-b^2/a^2}{b/a-\cos\theta}\right)\d\theta\\
&amp;amp;=\frac{\mu_0Ia}\pi\left(\frac ba\pi+\left(1-\frac{b^2}{a^2}\right)\int_0^\pi\frac{\d\theta}{b/a-\cos\theta}\right)
\end{align*}
$$
Calculus challenge:
$$
\begin{align*}
\int\frac{\d x}{a-\cos x}\xlongequal{\cos x=\frac{1-t^2}{1+t^2}}2\int\frac{\d t}{(a-1)+(a+1)t^2}=2\frac{\arctan\left(\sqrt{\frac{a+1}{a-1}}\tan\frac x2\right)}{\sqrt{a^2-1}}
\end{align*}
$$
所以原式是
$$
\frac{\mu_0Ia}\pi\left(\frac ba\pi+\left(1-\frac{b^2}{a^2}\right)\frac\pi{\sqrt{b^2/a^2-1}}\right)=\mu_0I\left(b-\sqrt{b^2-a^2}\right)
$$&lt;/p&gt;
&lt;p&gt;$$
\mathcal{E}=-\frac{\p\Phi}{\p b}v=\mu_0Iv\left(\frac b{\sqrt{b^2-a^2}}-1\right)
$$&lt;/p&gt;
&lt;h3 id=&#34;例-4&#34;&gt;例 4
&lt;/h3&gt;&lt;p&gt;有一个半径为 $a$，截面半径为 $b$，电阻率为 $\rho$，密度为 $\rho_m$ 的金属圆环沿着垂直于匀强磁场 $B$ 的轴以初始为 $\omega_0$ 的角速度转动（形成一个交流发电机的结构），求速度降低到 $\omega_0/\e$ 需要多久，假设 $b\ll a$，一圈内角速度不会降低太多。&lt;/p&gt;
&lt;p&gt;解 1：作为一个不懂物理思想的人，我就直接硬解。设转的角度为 $\phi$。为了求出导致速度降低的力矩，需要求出电流：
$$
I=\frac{\mathcal{E}}{R}=\frac{-\d\Phi/\d t}{\rho l/S}=\frac{\pi a^2B\omega\sin\phi}{\rho 2\pi a/\pi b^2}=\frac{\pi ab^2B\omega\sin\phi}{2\rho}
$$
对于一段 $\d\theta$，其受力平行于转轴方向的分力为 $BIa\d\theta\cdot\sin\theta$，力臂为 $a\sin\theta\sin\phi$。所以
$$
\tau=-Ia^2B\sin\phi\int_0^{2\pi}\sin^2\theta\d\theta=-\pi Ia^2B\sin\phi
$$
而这种结构的转动惯量为
$$
I_r=\frac{a^2m}2=\pi^2a^3b^2\rho_m
$$
因此
$$
\frac{\d\omega}{\d t}=\frac\tau{I_r}=-\frac{IB\sin\phi}{\pi ab^2\rho_m}=-\frac{B^2\omega\sin^2\phi}{2\rho\rho_m}\Longrightarrow\frac{\d\omega}{\d\phi}=\frac{\dot\omega}\omega=-\frac{B^2}{2\rho\rho_m}\sin^2\phi
$$
直接两边积分就可以了，代入初始条件得
$$
\omega=\frac{B^2}{8\rho\rho_m}\left(\sin2\phi-2\phi\right)+\omega_0
$$
这里 $\omega(t)$ 和 $\phi(t)$ 是写不出来的，我就干了一个看起来很诱人的近似：把 $\sin2\phi$ 扔了。这样就可以解了：
$$
\dot\phi=-\frac{B^2}{4\rho\rho_m}\phi+\omega_0\Longrightarrow\phi=\frac{4\omega_0\rho\rho_m}{B^2}\left(1-\e^{-B^2t/4\rho\rho_m}\right)
$$
$\omega=\omega_0/\e$ 时 $\phi=\frac{4\omega_0\rho\rho_m}{B^2}(1-\e^{-1})$，因此 $t=4\rho\rho_m/B^2$。&lt;/p&gt;
&lt;p&gt;解 2：从能量角度考虑。这个结构的动能为
$$
E_k=\frac12I_r\omega^2=\frac{\pi^2a^3b^2\rho_m}2\omega^2
$$
认为一圈内速度不变的情况下，根据焦耳定律，转化为内能的平均功率为
$$
-\frac{\d E_k}{\d t}=P=\frac1{2\pi}\int_0^{2\pi}I^2R\d\phi=\frac1{2\pi}\int_0^{2\pi}\frac{\pi^2a^3b^2B^2\omega^2\sin^2\phi}{2\rho}\d\phi=\frac{\pi^2a^3b^2B^2\omega^2}{4\rho}
$$
结合以上两式，
$$
\pi^2a^3b^2\rho_m\omega\dot\omega=-\frac{\pi^2a^3b^2B^2\omega^2}{4\rho}\Longrightarrow\dot\omega=-\frac{B^2\omega}{4\rho\rho_m}
$$
从而
$$
t=\int_{\omega_0}^{\omega_0/\e}\frac{\d\omega}{\dot\omega}=\frac{4\rho\rho_m}{B^2}\int_{\omega_0/\e}^{\omega_0}\frac{\d\omega}{\omega}=\frac{4\rho\rho_m}{B^2}
$$&lt;/p&gt;
&lt;h2 id=&#34;位移电流&#34;&gt;位移电流
&lt;/h2&gt;&lt;p&gt;最后我们需要加上这一项
$$
\nabla\times\b B=\mu_0\b j+\boxed{\mu_0\eps_0\frac{\p\b E}{\p t}}
$$
这一项的来源可以简单地用电荷守恒说明。我们知道旋度的散度为 $0$，如果没有这一项，那么
$$
0=\mu_0\nabla\cdot\b j=-\mu_0\frac{\p\rho}{\p t}
$$
也就是说只有在电流稳恒的情况下才自洽。加上的一项恰好满足
$$
\nabla\cdot\mu_0\eps_0\frac{\p\b E}{\p t}=\mu_0\eps_0\frac{\p}{\p t}\nabla\cdot\b E=\mu_0\frac{\p\rho}{\p t}
$$&lt;/p&gt;
&lt;p&gt;定义位移电流（体密度）为
$$
\b j_d=\eps_0\frac{\p\b E}{\p t}
$$&lt;/p&gt;
&lt;p&gt;现在麦克斯韦方程组就蕴含了电荷守恒。我们不需要把 $\nabla\cdot\b j=-\p\rho/\p t$ 单独写出来。&lt;/p&gt;
&lt;h3 id=&#34;例-1-9&#34;&gt;例 1
&lt;/h3&gt;&lt;p&gt;考虑一个向外（球面）均匀发出电流的点电荷 $Q$。既然是球面对称，那么如果一个点处的电场或磁场有切向的分量，那么以它和球心为轴旋转，就产生了矛盾。因此场的方向一定是法向的。我们先考虑电场，这个时候，
$$
\nabla\times\b E=-\frac{\p\b B}{\p t}
$$
已经没用了。因为当 $\b E$ 可以写成 $f(r)\b r$ 的时候，容易验证旋度必为 $\b 0$。所以现在我们能简单地说 $\b E=\frac{Q\b{\hat r}}{4\pi\eps_0r^2}$。&lt;/p&gt;
&lt;p&gt;既然 $\b B$ 也是法向的，$\nabla\times\b B$ 就也应该为 $\b 0$，进一步地，由于 $\nabla\cdot\b B=0$，就应该没磁场。但是如果没有那一项，就会导致
$$
\mu_0\b j=\mu_0\frac{\b{\hat r}}{4\pi r^2}\left(-\frac{\p Q}{\p t}\right)\ne 0
$$
加上那一项就对了。&lt;/p&gt;
&lt;h3 id=&#34;例-2-7&#34;&gt;例 2
&lt;/h3&gt;&lt;center&gt;&lt;img src=&#34;10-1.png&#34; style=&#34;zoom:30%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;考虑一个正在充电的电容，在其上方去一个圆形安培回路。如果截面只过导线，那么磁场环量
$$
\Gamma=\mu_0I
$$
但是我们知道由于磁场无源，故计算环量应当与选择的面无关。如果选择的面是穿过两个极板之间的 $S_1^\prime$，那么就没有 $\b j$ 了。这个时候就需要位移电流项了。我们认为极板足够大，所以如果极板的面积为 $S$，$S_1^\prime$ 的电通量就是
$$
2\cdot\frac{\sigma}{2\eps_0}\cdot S=\frac{Q}{\eps_0}
$$
从而
$$
\Gamma=\mu_0\eps_0\frac{\p}{\p t}\frac{Q}{\eps_0}=\mu_0I
$$
自洽了。&lt;/p&gt;
&lt;h2 id=&#34;麦克斯韦方程组&#34;&gt;麦克斯韦方程组
&lt;/h2&gt;&lt;p&gt;现在我们就得正式面对完整的麦克斯韦方程组了。
$$
\left\{\begin{align*}
\nabla\cdot\b E&amp;amp;=\frac{\rho}{\eps_0}\\
\nabla\times\b E&amp;amp;=-\frac{\p\b B}{\p t}\\
\nabla\cdot\b B&amp;amp;=0\\
\nabla\times\b B&amp;amp;=\mu_0\b j+\mu_0\eps_0\frac{\p\b E}{\p t}
\end{align*}\right.
$$&lt;/p&gt;
&lt;p&gt;但等一下，在考虑电磁波的传播时我们考虑的是无源的空间。所以 $\rho$ 和 $\b j$ 的项就没了。&lt;/p&gt;
&lt;p&gt;我们沿着书里讲解电磁波的思路——首先给一个需要一定假设的，简单直观的方法，然后再推波动方程。&lt;/p&gt;
&lt;h3 id=&#34;平面波的初步分析&#34;&gt;平面波的初步分析
&lt;/h3&gt;&lt;p&gt;我们考虑平面波，一切在 $y$、$z$ 方向都是均匀的。在坐标系的 $yz$ 平面上瞬间（可以认为是一个很短的时间内，这个无所谓）通了向 $+z$ 方向的平面电流 $\b J$，现在我们考虑电磁场在 $x&amp;gt;0$ 部分的传播。&lt;/p&gt;
&lt;p&gt;当然现在我们依照常识知道电磁场不可能瞬间布满整个空间，这也是合理的：通过麦克斯韦方程组，取安培回路，是没法得到极远处瞬间出现磁场的，因为 $\p\b E/\p t\ne\b 0$。唯一一种可能瞬间造成场的方式是通过 $\nabla\cdot\b E=\rho/\eps_0$，而由于电荷守恒，$\rho$ 是不可能突变的。&lt;/p&gt;
&lt;p&gt;现在我们需要的假设是，电场和磁场都是先占据 $x$ 小的部分（且占据了就一直存在），再占据 $x$ 大的部分，然后它们的传播速度是相等的。假设某个时刻，它们的波面在 $x_0$。&lt;/p&gt;
&lt;p&gt;由于电磁场均只与 $x$ 有关，故我们发现，$\b E_z$ 只与 $\b B_y$ 有关，$\b E_y$ 只与 $\b B_z$ 有关。~~没发现也没事，~~我们先分析 $\b B_y$。取一个 $xy$ 方向的，穿过波面（不穿过 $y$ 轴）的矩形安培回路（$y$ 方向长为 $l$）。$x$ 方向由于平移对称性贡献是 $0$，$y$ 方向，靠内的是 $-l\b B_y$，靠外的没有磁场。而电通量的变化率是 $lv\b E_z$。所以 $\b B_y=-\mu_0\eps_0v\b E_z$；取一个 $xz$ 方向的，穿过波面的矩形高斯（？）回路，$z$ 方向是 $l\b E_z$，而磁通量的变化率是 $lv\b B_y$，所以 $\b E_z=-v\b B_y$。我们把这两个方程结合起来，就得到 $\mu_0\eps_0v^2=1$，也就是说，电磁波传播的速度是 $1/\sqrt{\mu_0\eps_0}$，也就是光速。&lt;/p&gt;
&lt;p&gt;至于 $\b B_z$ 和 $\b E_y$，如果假设通电前没有任何电磁场，你会发现它根本没有理由会 $\ne 0$。$\b j$ 只会使 $\b B_y$ 产生变化。&lt;/p&gt;
&lt;p&gt;当然这个推导有很多不严谨的地方，比如你怎么说明 $\b B_y$ 和 $\b E_z$ 是均匀的？我的理解是，它本来就只是毛估估看一下，然后可以猜出一个解：
$$
\left\{\begin{aligned}
\b B_y(x,t)&amp;amp;=\frac{\mu_0J}{2}\theta(ct-x)\\
\b E_z(x,t)&amp;amp;=-\frac{\mu_0cJ}{2}\delta(ct-x)
\end{aligned}\right.
$$
然后用类唯一性定理（之类的东西？）。这里 $\theta$ 是作用类似于 $\delta$ 的分段函数，满足 $\theta^\prime=\delta$，你可以理解为 $\max\{\operatorname{sgn},0\}$，或者比如说 $\lim_{k\to+\infty}\e^{kx}/(\e^{kx}+1)$。&lt;/p&gt;
&lt;h3 id=&#34;解麦克斯韦方程组&#34;&gt;解麦克斯韦方程组
&lt;/h3&gt;&lt;p&gt;怎么严谨地分析上面这玩意呢？说来也简单。一方面，
$$
\nabla\times(\nabla\times\b B)=\nabla(\nabla\cdot\b B)-\nabla^2\b B=-\nabla^2\b B
$$
另一方面（$\b j=0$），
$$
\nabla\times(\nabla\times\b B)=\mu_0\nabla\times\b j+\mu_0\eps_0\nabla\times\frac{\p\b E}{\p t}=-\mu_0\eps_0\frac{\p^2\b B}{\p t^2}
$$
所以
$$
\nabla^2\b B=\mu_0\eps_0\frac{\p^2\b B}{\p t^2}
$$
$\b E$ 同理。这是波动方程（后面会讨论）。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;对于一般的情况，完整地过一下推导思路。&lt;/p&gt;
&lt;p&gt;首先，$\varphi$ 会出一个问题：电场不再保守。但是磁场仍然是无源的，所以我们可以保留 $\b A$。现在看第二个方程：
$$
\nabla\times\b E=-\frac{\p\b B}{\p t}\Longleftrightarrow\nabla\times\left(\b E+\frac{\p\b A}{\p t}\right)=0
$$
所以我们可以让 $\nabla\varphi=-\b E-\p\b A/\p t$，或者说，还是让 $\varphi$ 表示只考虑电荷导致的势能。这时就有
$$
\b E=-\nabla\varphi-\frac{\p\b A}{\p t}
$$
所以现在就剩下两&lt;ruby&gt;个&lt;rt&gt;tuó&lt;/rt&gt;&lt;/ruby&gt;方程
$$
\left\{\begin{aligned}
\nabla\cdot\left(\nabla\varphi+\frac{\p\b A}{\p t}\right)&amp;amp;=-\frac{\rho}{\eps_0}\\
\nabla\times(\nabla\times\b A)&amp;amp;=\mu_0\b j-\mu_0\eps_0\frac{\p}{\p t}\nabla\varphi-\mu_0\eps_0\frac{\p^2\b A}{\p t^2}
\end{aligned}\right.
$$
应用库仑规范，发现无法使方程充分简化。&lt;/p&gt;
&lt;p&gt;简化它们的思路是：希望把第二个式子搞成（含源的，数学上叫非齐次）波动方程的样子。其中需要扔掉的两项应当满足
$$
\nabla(\nabla\cdot\b A)=-\mu_0\eps_0\frac{\p}{\p t}\nabla\varphi
$$
也就是要求
$$
\nabla\cdot\b A=-\mu_0\eps_0\frac{\p\varphi}{\p t}
$$
把它代回第一个方程，我们就得到（接下来我们就写 $1/c^2$ 不写 $\mu_0\eps_0$ 了）
$$
\left\{\begin{aligned}
\nabla^2\varphi-\frac1{c^2}\frac{\p^2\varphi}{\p t^2}&amp;amp;=-\frac{\rho}{\eps_0}\\
\nabla^2\b A-\frac1{c^2}\frac{\p^2\b A}{\p t^2}&amp;amp;=-\mu_0\b j
\end{aligned}\right.
$$
这里对 $\b A$ 与 $\varphi$ 关系的要求被称为洛伦兹规范。细心的你可能开始怀疑：真能做到这个规范吗？我们假定存在一组任意的解 $(\varphi,\b A)$。它可以自由变化的点在于，麦克斯韦方程组只对 $\b B=\nabla\times\b A$ 有要求，所以如果 $\b A$ 加上一个任意的无旋场 $\nabla\phi$，是不影响的。但是由于有了个额外的方程 $\b E=-\nabla\varphi-\p\b A/\p t$，所以与此同时 $\varphi$ 要减去 $\p\phi/\p t$。也就是说，如果要把这个任意的解变得符合洛伦兹规范，$\phi$ 得满足：
$$
\nabla\cdot(\b A+\nabla\phi)=-\frac1{c^2}\left(\frac{\p\varphi}{\p t}-\frac{\p^2\phi}{\p t^2}\right)
$$
即
$$
\nabla^2\phi-\frac1{c^2}\frac{\p^2\phi}{\p t^2}=-\nabla\cdot\b A-\frac1{c^2}\frac{\p\varphi}{\p t}
$$
我们就假定非齐次波动方程一定有解吧，乐。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;这里，我们将关于 $\b E$ 和 $\b B$ 的偏微分方程（一共八条）转变为了关于 $\varphi$ 和 $\b A$ 的波动方程（四条），方程变得好解许多。实际上 $\b E$ 和 $\b B$ 也满足波动方程。容易验证
$$
\left\{\begin{aligned}
\nabla^2\b E-\frac1{c^2}\frac{\p^2\b E}{\p t^2}&amp;amp;=\frac1{\eps_0}\nabla\rho+\mu_0\frac{\p\b j}{\p t}\\
\nabla^2\b B-\frac1{c^2}\frac{\p^2\b B}{\p t^2}&amp;amp;=-\mu_0\nabla\times\b j
\end{aligned}\right.
$$&lt;/p&gt;
&lt;p&gt;遗憾的是，似乎由于课时不够，后面没讲实际运用 $\varphi$ 和 $\b A$ 解方程组的例子，而是直接莫名其妙转向了波导。&lt;/p&gt;
&lt;h3 id=&#34;解波动方程&#34;&gt;解波动方程
&lt;/h3&gt;&lt;p&gt;这里我们波动方程其实就是四维矢量的拉普拉斯方程。&lt;/p&gt;
&lt;h4 id=&#34;平面波&#34;&gt;平面波
&lt;/h4&gt;&lt;p&gt;回到上面的例子，在无场源的空间中，如果 $y$、$z$ 方向是均匀的，那么考虑 $\b E$ 和 $\b B$。如果展开麦克斯韦方程组，那么得到
$$
\left\{\begin{aligned}
\frac{\p\b E_x}{\p x}&amp;amp;=0\\
0&amp;amp;=\frac{\p\b B_x}{\p t}\\
\frac{\p\b E_z}{\p x}&amp;amp;=\frac{\p\b B_y}{\p t}\\
\frac{\p\b E_y}{\p x}&amp;amp;=-\frac{\p\b B_z}{\p t}\\
\frac{\p\b B_x}{\p x}&amp;amp;=0\\
0&amp;amp;=\frac{\p\b E_x}{\p t}\\
\frac{\p\b B_z}{\p x}&amp;amp;=-\frac1{c^2}\frac{\p\b E_y}{\p t}\\
\frac{\p\b B_y}{\p x}&amp;amp;=\frac1{c^2}\frac{\p\b E_z}{\p t}\\
\end{aligned}\right.
$$
如果展开刚推得的波动方程，可以得到
$$
\left\{\begin{aligned}
\frac{\p^2\b E_y}{\p x^2}-\frac1{c^2}\frac{\p^2\b E_y}{\p t^2}&amp;amp;=0\\
\frac{\p^2\b E_z}{\p x^2}-\frac1{c^2}\frac{\p^2\b E_z}{\p t^2}&amp;amp;=0\\
\frac{\p^2\b B_y}{\p x^2}-\frac1{c^2}\frac{\p^2\b B_y}{\p t^2}&amp;amp;=0\\
\frac{\p^2\b B_z}{\p x^2}-\frac1{c^2}\frac{\p^2\b B_z}{\p t^2}&amp;amp;=0
\end{aligned}\right.
$$
可以验证一下，容易从上面那个推得下面这个。为了解
$$
\frac{\p^2\psi}{\p x^2}-\frac1{c^2}\frac{\p^2\psi}{\p t^2}=0
$$
形式的一维波动方程。根据学微积分时候的经验，对于大于一阶的微分方程，可以考虑“因式分解”（因为微分也是一种线性变换）：
$$
\left(\frac{\p}{\p x}+\frac1c\frac{\p}{\p t}\right)\left(\frac{\p}{\p x}-\frac1c\frac{\p}{\p t}\right)\psi=0
$$
令
$$
u=\frac{\p\psi}{\p x}-\frac1c\frac{\p\psi}{\p t}
$$
则方程化为
$$
\frac{\p u}{\p x}+\frac1c\frac{\p u}{\p t}=0
$$
当然你可以集中注意力，注意到这个式子相当于 $u$ 在 $x+ct=b$（每个 $b$）的直线上不变，从而 $u=f(b)$。But why not learn some PDE?&lt;/p&gt;
&lt;p&gt;解这个玩意的思路是，把 $x$ 视作关于 $t$ 的函数，把方程化作 $u$ 关于 $t$ 的常微分方程。这样，我们就得到了 $tx$ 平面上一条线上的解。然后将这条线平移（之类的），铺满整个平面。这个线叫特征线。当然不是随便选一个 $x=x(t)$ 都可以把方程化过去的。考虑到
$$
\frac{\d u}{\d t}=\frac{\p u}{\p t}+\frac{\p u}{\p x}\cdot\frac{\d x}{\d t}
$$
所以取 $\d x/\d t=c$，即 $x=ct+b$，$b$ 就是可变化的平移量。在这条线上，$\d u/\d t=0$，所以解是 $u=C$。当然，这个 $C$ 是与 $b$ 相关的，所以完整的二维的解可以写成（$C$ 太难看了，还是管它叫 $f$）$u=f(b)=f(x-ct)$。&lt;/p&gt;
&lt;p&gt;现在解原来的方程（这边函数写得不是很规范，能懂就行）
$$
\frac{\p\psi}{\p x}-\frac1c\frac{\p\psi}{\p t}=u=f(x-ct)
$$
考虑 $x=-ct+b$ 上的解，方程为
$$
\frac{\d\psi}{\d t}=f(-2ct+b)
$$
令 $F(s)$ 为 $-f(s)/2c$ 的反函数，则
$$
\psi(t)=C+\int_0^tf(-2ct^\prime+b)\d t^\prime=C+\int_b^{-2ct+b}-\frac{f(s)}{2c}\d s=C+F(-2ct+b)-F(b)=C+F(x-ct)-F(b)
$$
还是一样，$C$ 是与 $b$ 相关的，另外 $F(b)$ 也可以并到 $C$ 里来，所以最后的解就是
$$
\psi=F(x-ct)+G(x+ct)
$$
其中 $F$、$G$ 是任意函数，甚至可以不是连续的（用 $\delta$ 函数模拟）。&lt;/p&gt;
&lt;p&gt;从物理意义上来说，$F$ 是沿 $x$ 轴正方向传播的波，$G$ 是反方向传播的波。如果只取正方向的波，比如我们代回最上面的方程组的 $\b E_y$，那么 $\b E_y=F_1(x-ct)$，设 $\b B_z=F_{*}(x-ct)$，代入其与 $\b E_y$ 的关系：
$$
F_{*}^\prime\cdot\frac{\p(x-ct)}{\p x}=-\frac1{c^2}F_1^\prime\cdot\frac{\p(x-ct)}{\p t}=\frac1c\b E_y^\prime
$$
所以 $\b B_z=F_1(x-ct)/c$（没有加常数是因为假定无穷远处为 $0$）。同理可以得到，$\b E_z=F_2(x-ct)$ 的话 $\b B_y=-F_2(x-ct)/c$。加上 $x$ 分量是常数即 $0$，这样一来我们就有 $\b E\cdot\b B=0$。所以说在这种特殊情况下，我们说 $\b k$、$\b E$、$\b B$ 两两垂直，其中 $\b k$ 是传播方向。一般情况下 $\b E\perp\b B$ 是不成立的。&lt;/p&gt;
&lt;h4 id=&#34;球面波&#34;&gt;球面波
&lt;/h4&gt;&lt;p&gt;由球面对称性，球面波只有 $\b{\hat r}$ 方向分量。由 $\Delta$ 的球面坐标系表示，波动方程可以写成
$$
\begin{align*}
\frac{\p^2\psi}{\p r^2}+\frac2r\frac{\p\psi}{\p r}-\frac1{c^2}\frac{\p^2\psi}{\p t^2}&amp;amp;=0\\
\Longleftrightarrow\frac{\p^2(r\psi)}{\p r^2}-\frac1{c^2}\frac{\p^2(r\psi)}{\p t^2}&amp;amp;=0
\end{align*}
$$
这个凑换元看起来很牛。这里由于反方向的波不符合实际，所以解就是
$$
\psi=\frac{f(r-ct)}{r}\b{\hat r}
$$&lt;/p&gt;
&lt;h4 id=&#34;柱面波&#34;&gt;柱面波
&lt;/h4&gt;&lt;p&gt;它的方程长这样：
$$
\frac{\p^2\psi}{\p r^2}+\frac1r\frac{\p\psi}{\p r}-\frac1{c^2}\frac{\p^2\psi}{\p t^2}=0
$$
不会。&lt;/p&gt;
&lt;h4 id=&#34;一般情况&#34;&gt;一般情况
&lt;/h4&gt;&lt;p&gt;非常不严谨的推导：考虑在原点附近的一堆分布，用点电荷模拟。在远处由于没有电荷，故齐次波动方程仍适用。在近处可以忽略 $c^{-2}\p^2\psi/\p t^2$ 这一项（因为前一项很大），所以近处是，例如说 $\varphi$，就是和之前静态的公式一样。这样反过来可以推远处的式子：
$$
\varphi(\b r,t)=\frac{1}{4\pi\eps_0}\iiint\frac{\rho(\b r^\prime,t-|\b r-\b r^\prime|/c)\d v}{|\b r-\b r^\prime|}
$$
$\b A$ 同理。这个玩意叫推迟势。虽然推导的时候用了近似，但代入检验（这里就不写了）一下就会发现这个在一般情况下也是对的。另外 $\b E$ 和 $\b B$ 的表达式更加复杂，推导可以看 Griffiths（就是些求导）。这里写一下结论：
$$
\left\{\begin{aligned}
\varphi(\b r,t)&amp;amp;=\frac{1}{4\pi\eps_0}\iiint\frac{\rho(\b r^\prime,t-\mathfrak{\b r}/c)\d v}{\mathfrak{r}}\\
\b A(\b r,t)&amp;amp;=\frac{\mu_0}{4\pi}\iiint\frac{\b j(\b r^\prime,t-\mathfrak{\b r}/c)\d v}{\mathfrak{r}}\\
\b E(\b r,t)&amp;amp;=\frac{1}{4\pi\eps_0}\iiint\left(\frac{\rho(\b r^\prime,t-\mathfrak{\b r}/c)}{\mathfrak{r}^2}\mathfrak{\b{\hat r}}+\frac{\dot\rho(\b r^\prime,t-\mathfrak{\b r}/c)}{c\mathfrak{r}}\mathfrak{\b{\hat r}}-\frac{\dot{\b j}(\b r^\prime,t-\mathfrak{\b r}/c)}{c^2\mathfrak{r}}\right)\d v\\
\b B(\b r,t)&amp;amp;=\frac{\mu_0}{4\pi}\iiint\left(\frac{\b j(\b r^\prime,t-\mathfrak{\b r}/c)}{\mathfrak{r}^2}+\frac{\dot{\b j}(\b r^\prime,t-\mathfrak{\b r}/c)}{c\mathfrak{r}}\right)\times\mathfrak{\b{\hat r}}\d v
\end{aligned}\right.
$$
其中 $\mathfrak{\b r}=\b r-\b r^\prime$（我打不出那个玩意！），以及 $\dot\rho$ 和 $\dot{\b j}$（wtf is this）是关于第二维求偏导。&lt;/p&gt;
&lt;p&gt;解一般的波方程一般考虑复波函数。&lt;/p&gt;
&lt;h2 id=&#34;交流电路&#34;&gt;交流电路
&lt;/h2&gt;&lt;p&gt;不知道为什么突然就开始讲电路了。&lt;/p&gt;
&lt;p&gt;交流电路里到处是三角函数，为了方便运算，我们可以用复数去分析。把电压写成复数 $V=V_0\e^{\i\omega t}$，电流同理。&lt;/p&gt;
&lt;p&gt;注意在交流电路中，要抛弃简单直流电路中“电压产生电流”的因果思维，电压与电流的大小是互相影响的，它们形成平衡就行。&lt;/p&gt;
&lt;p&gt;在交流电路中，电容和电感不再是等效于断路和短路了，它们具有类似电阻的性质。对于电容，如果它两侧的电压为 $U$，那么 $Q=CU$。又 $I=\d Q/\d t$，所以 $I$ 和 $U$ 的关系是 $I=C\d U/\d t=\i\omega CU$，运用欧姆定律，可以“定义”“电阻”（这里管它叫容抗）$z_C=1/\i\omega C$。对于电感，我们知道 $\mathcal{E}=-L\d I/\d t$，也就是说如果它是理想（超导）的话，为了平衡，两边需要加上 $-\cal{E}$ 的电压。所以 $I$ 和 $U$ 的关系是 $U=L\d I/\d t=\i\omega LI$，感抗 $z_L=\i\omega L$。电阻就是 $z_R=R$。所以这里的复数是啥意思呢？就是说它们会使电压和电流之间的相对相位发生变化。这些 $z$ 统称阻抗。&lt;/p&gt;
&lt;p&gt;在交流电路中求解复杂电路中的量，方法（基尔霍夫定律）跟直流是一样的，就是把实数换成复数。具体就不讲了。&lt;/p&gt;
&lt;p&gt;上课也提了一下等效电路相关。任何由线性元件组成的二段电路可以视作一个黑盒，只需要两个参数 $k$、$b$ 刻画：$U=kI+b$。$b=0$ 的称作无源元件，否则是有源元件。$\arg k$ 就是电压与电流的相位差。无源元件的相位差一定处于 $[-\pi/2,\pi/2]$ 内（怎么证？没法归纳（电桥不是串并联））。&lt;/p&gt;
&lt;p&gt;关于有源电路，有两种等效方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;（戴维南定理）任何二段有源电路，可以等效为一个理想电压源与一个电阻的串联。电压源的电动势为两端断路时的电压，电阻的大小为电源置为零（电压源短路，电流源断路）后的等效电阻。&lt;/li&gt;
&lt;li&gt;（诺顿定理）任何二段有源电路，可以等效为一个。理想电流源与一个电阻的并联。电流源的电流为两端短路时的电压，电阻的大小为电源置为零后的等效电阻。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这里注意，电流源（可以产生任意电压）实际上没法用 $U=kI+b$ 描述，或者其实得用 $I=lU+c$ 这种反过来的，反正就是条直线。&lt;/p&gt;
&lt;p&gt;证明就不写了，看&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/458289837&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;电路的能量考虑起来是容易的，就是说如果一段元件两端差了 $U$ 的电压，那么单位时间的电流，你甭管它里面发生了什么，只需要考虑它等效于将这段时间进入的总电荷直接移到出口（电荷守恒），所以功率就是 $UI$。焦耳热 $I^2R$ 是通过能量守恒推导的。&lt;/p&gt;
&lt;p&gt;那么在交流电路里，功率显然不能是虚数。设整个电路等效于电压源 $\cal E$ 与阻抗 $z=R+\i X$（$R$ 称为电阻，$X$ 称为电抗）的串联，那么
$$
\begin{align*}
P&amp;amp;=\frac{\omega}{2\pi}\int_0^{2\pi/\omega}\re\mathcal{E}\re I\d t\\
&amp;amp;=\frac{\omega}{2\pi}I_0^2\int_0^{2\pi/\omega}\left(R\cos\omega t-X\sin\omega t\right)\cos\omega t\d t\\
&amp;amp;=\frac12I_0^2R
\end{align*}
$$
这个和直流电路还是不一样的。另外，这说明电抗不对能量产生贡献。&lt;/p&gt;
&lt;h3 id=&#34;滤波器&#34;&gt;滤波器
&lt;/h3&gt;&lt;center&gt;&lt;img src=&#34;12-1.png&#34; style=&#34;zoom:40%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;考虑这样的一个结构，设其等效阻抗为 $z_0$，则
$$
z_0=z_1+\frac{z_0z_2}{z_0+z_2}
$$
解得
$$
z_0=\frac{z_1}2\pm\sqrt{\frac{z_1^2}4+z_1z_2}
$$
如果取 $z_1=\i\omega L$，$z_2=1/\i\omega C$，那么（舍掉 $-$ 是因为辐角取值）
$$
z_0=\frac{\i\omega L}2+\sqrt{\frac LC-\frac{\omega^2L^2}{4}}
$$
当 $\omega&amp;lt;2/\sqrt{LC}$，实数部分非零，所以这个电路会消耗能量，否则是纯电抗。那么现在问题就来了：为什么电容和电抗两个东西都是纯虚的，但是串并联起来就有电阻了呢？原因是，当你接上电源时，电流会往无穷远处传播，那么从无电流到有电流，这个无论是电阻、电容还是电抗都是要做功的，所以它就一直要做功。那反过来，我们就可以推断，当 $\omega\ge 2/\sqrt{LC}$ 时，电流一定不会往无穷远处传播，或者至少有一个收敛的衰减（当然这个是不严谨的，$\omega=2/\sqrt{LC}$ 时是不对的）。&lt;/p&gt;
&lt;p&gt;为了从数学角度验证这个说法，考虑 $a-b$ 和 $c-d$ 的电压差的比。根据分压定律，
$$
\frac{V_{cd}}{V_{ab}}=\frac{v_0-v_1}{v_0}=\frac{\sqrt{4L/C-\omega^2L^2}-\i\omega L}{\sqrt{4L/C-\omega^2L^2}+\i\omega L}
$$
如果 $\Delta\ge 0$，那么比值的模长就 $=1$，否则就 $&amp;lt;1$。因此超过截止频率的信号会指数衰减。&lt;/p&gt;
&lt;p&gt;所以这个结构可以作为一个滤波器。实际情况下，构造足够长的这个结构，$ab$ 头是天线，另一头就只会接受频率 $\le 2/\sqrt{LC}$ 的信号。如果再加上一个下面的结构，就可以滤出一个区间内的频率。&lt;/p&gt;
&lt;p&gt;当 $z_1=1/\i\omega C$，$z_2=\i\omega L$ 时，
$$
z_0=\frac{1}{2\i\omega C}+\sqrt{\frac LC-\frac1{4\omega^2C^2}}
$$
同理可以得到，它是反过来接受 $\omega\ge 2/\sqrt{LC}$ 的信号。&lt;/p&gt;
&lt;p&gt;作业里有些 RC、RL、LC、RLC 电路以及 bandwidth 和 quality factor 相关的东西，如果有时间可以把结论记到 cheat sheet 里。&lt;/p&gt;
&lt;h3 id=&#34;传输线&#34;&gt;传输线
&lt;/h3&gt;&lt;p&gt;最后考虑一个和下面内容有点联系的东西。我们考虑连续情况下的类比——传输线。费曼那里讲得过于简化了，这里直接按照另一本来。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;12-2.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;考虑两根同轴圆柱空心导体，也就是上面“两个导线”以一平行线为轴旋转一圈。当然我们这里考虑一个截面，反正它是旋转对称的。我们认为上面一条是内层，通了电，下面是接地的。那么导体本身有电阻和自感（什么？为啥没有互感？我不到啊），两个之间可以塞介电质，所以电阻不认为是无穷大，同时还能作为正常的电容看待。现在我们取一小段 $\Delta z$，设每单位的电阻、自感、电导（电阻 $\propto$ 面积，所以这里是倒数）、电容分别为 $R$、$L$、$G$、$C$。那么可以列方程
$$
\left\{\begin{aligned}
V(z,t)-V(z+\Delta z,t)&amp;amp;=I(z,t)(R\Delta z+\i\omega L\Delta z)\\
I(z,t)-I(z+\Delta z,t)&amp;amp;=V(z+\Delta z,t)(G\Delta z+\i\omega C\Delta z)
\end{aligned}\right.
$$
$\Delta z\to 0$：
$$
\left\{\begin{aligned}
\frac{\p V}{\p z}&amp;amp;=-(R+\i\omega L)I\\
\frac{\p I}{\p z}&amp;amp;=-(G+\i\omega C)V
\end{aligned}\right.
\Longrightarrow
\left\{\begin{aligned}
\frac{\p^2V}{\p z^2}&amp;amp;=(R+\i\omega L)(G+\i\omega C)V\\
\frac{\p^2I}{\p z^2}&amp;amp;=(R+\i\omega L)(G+\i\omega C)I
\end{aligned}\right.
$$
所以我们得到了一个“复波速”/复传播常数
$$
\gamma=\sqrt{(R+\i\omega L)(G+\i\omega C)}=\alpha+\i\beta
$$
其中 $\alpha$ 称为衰减常数，$\beta$ 称为传播常数。
$$
\left\{\begin{aligned}
V&amp;amp;=V_0^+\e^{-\gamma z}+V_0^-\e^{\gamma z}\\
I&amp;amp;=\sqrt{\frac{G+\i\omega C}{R+\i\omega L}}(V_0^+\e^{-\gamma z}-V_0^-\e^{\gamma z})
\end{aligned}\right.
$$
再乘回 $\e^{\i\omega t}$ 就得到
$$
V=V_0^+\e^{-\alpha z}\cos(\beta z-\omega t)+V_0^-\e^{\alpha z}\cos(\beta z+\omega t)
$$
波长 $\lambda=2\pi/\beta$，波速 $v=\omega/\beta$。这就是信号在传输线中的传播。显然只有 $\alpha=0$ 即 $R=G=0$ 时这东西才能真正有用，这时 $\beta=\omega\sqrt{LC}$，阻抗为 $Z=\sqrt{L/C}$。&lt;/p&gt;
&lt;p&gt;进一步计算可以得出里面的电磁场，我这边就不写了。它是个 $\rm TEM$ 波，也就是没有沿线方向的电、磁场。我们会在最后进一步讨论单个导体传输电磁场相关的问题。&lt;/p&gt;
&lt;h2 id=&#34;谐振腔&#34;&gt;谐振腔
&lt;/h2&gt;&lt;p&gt;其实建议先看波导再看这个，可能有些东西好理解一点。&lt;/p&gt;
&lt;p&gt;谐振腔说白了就是一个铁皮盒子，电磁场能在其中震荡。这个盒子所起的作用，在数学上，就是给出边界条件。所以我们先明确边界条件的分析方法。&lt;/p&gt;
&lt;p&gt;对于一个面电荷密度为 $\sigma$，面电流密度为 $\b J$ 的面，设它左右两边很近处的电磁场为 $\b E/\b B_{1/2}$。取穿过该面的，足够扁的高斯面（圆柱，比如），得到 ${\b E_1}_\perp-{\b E_2}_\perp=\sigma/\eps_0$；取足够扁的安培回路，得到 ${\b E_1}_\parallel-{\b E_2}_\parallel=\b 0$（因为中间的磁通量正比于长乘宽，除掉环量的长后，宽 $\to 0$）。同理可得到磁场的式子，最后我们有
$$
\left\{\begin{aligned}
\b n\cdot(\b E_1-\b E_2)&amp;amp;=\frac{\sigma}{\eps_0}\\
\b n\times(\b E_1-\b E_2)&amp;amp;=\b 0\\
\b n\cdot(\b B_1-\b B_2)&amp;amp;=\b 0\\
\b n\times(\b B_1-\b B_2)&amp;amp;=\mu_0\b J
\end{aligned}\right.
$$&lt;/p&gt;
&lt;h3 id=&#34;矩形谐振腔&#34;&gt;矩形谐振腔
&lt;/h3&gt;&lt;p&gt;处理谐振腔问题的思路和前面不太一样，我们是先考虑 free space 里的电磁场的解，然后再代入边界条件，而不是遵循电荷电流 → 电场磁场这个因果关系列麦克斯韦方程组，那样基本解不出来。&lt;/p&gt;
&lt;p&gt;现在考虑一个 $[0,a]\times[0,b]\times[0,d]$ 的长方体导体壳（我知道。$c$ 是光速）。设其中的电场为 $\b E(x,y,z,t)$。我们显然不会觉得把这东西的方程列出来之后能解。所以上课讲了一个粗暴的方法，我这里把它解读为，（我猜）任意（物理上合法的）多元函数都能拆成各个元各自的一元函数的积的无穷和，可以类比一元函数的傅里叶级数来理解，或者一个不严谨的证明就是直接泰勒展开。但是实际上这样理解还是有漏洞，就是说我们这里是要求每个解的边界条件都得满足，但是实际上他们线性组合完了之后满足边界条件就行了，所以我也说不清了。&lt;del&gt;评价为：这就是数理方程。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;考虑 $\b E_x$，然后通过猜测关于时间震荡（其实是处理波动方程时的常见套路），我们可以把它写成（各维 $\omega$ 相同）
$$
\b E_x(x,y,z,t)=E_x(x,y,z)\e^{\i\omega t}
$$
同样，实际情况我们就取实部。&lt;/p&gt;
&lt;p&gt;为了避免与磁场扯上关系，我们考虑列波动方程。在空腔内，
$$
\nabla^2\b E_x-\frac{1}{c^2}\frac{\p^2\b E_x}{\p t^2}=0\Longrightarrow\nabla^2E_x+\frac{\omega^2}{c^2}E_x=0
$$
右边这个叫亥姆霍兹方程。令 $k=\omega/c$。&lt;/p&gt;
&lt;p&gt;现在我们把 $E_x(x,y,z)$ 写成 $X(x)Y(y)Z(z)$（分量略 $x$ 下标）。那么方程就变成了
$$
\frac{\d^2X}{\d x^2}YZ+X\frac{\d^2Y}{\d y^2}Z+XY\frac{\d^2Z}{\d z^2}+k^2XYZ=0\Longrightarrow\frac{\d^2 X}{X\d x^2}+\frac{\d^2 Y}{Y\d y^2}+\frac{\d^2 Z}{Z\d z^2}=-k^2
$$&lt;/p&gt;
&lt;p&gt;对两边分别关于 $x$、$y$、$z$ 求导，就可以得到三个分量都是常数。以 $X$ 分量为例，
$$
\frac{\d^2X}{\d x^2}=CX
$$
如果 $C\ge 0$，会导致 $X$ 向至少一方向增加，无法符合边界条件，肯定不对。所以考虑设 $C=-k_x^2$，这时解得
$$
X=C_1\cos k_xx+C_2\sin k_xx
$$
同样写出另外两个部分：
$$
\left\{\begin{aligned}
X&amp;amp;=C_x\cos k_xx+D_x\sin k_xx\\
Y&amp;amp;=C_y\cos k_yy+D_y\sin k_yy\\
Z&amp;amp;=C_z\cos k_zz+D_z\sin k_zz\\
k^2&amp;amp;=k_x^2+k_y^2+k_z^2
\end{aligned}\right.
$$
现在代入边界条件。由于 $y=0/b$、$z=0/d$ 处只能有垂直边界方向的电场，从而无 $x$ 方向分量。故
$$
\begin{align*}
Y(0)=0&amp;amp;\Longrightarrow C_y=0\\
Y(b)=0&amp;amp;\Longrightarrow D_y=0\lor k_yb=n\pi\,(n\in\Z)\\
Z(0)=0&amp;amp;\Longrightarrow C_z=0\\
Z(d)=0&amp;amp;\Longrightarrow D_z=0\lor k_zd=p\pi\,(p\in\Z)
\end{align*}
$$
$D_y=0$ 和 $D_z=0$ 可以去掉（对应 $n=0$、$p=0$ 情况）。&lt;/p&gt;
&lt;p&gt;$X$ 部分怎么确定呢？别忘了我们还有一个 $\nabla\cdot\b E=0$（因为波动方程的形式前提是把 $\nabla(\nabla\cdot\b E)$ 去掉）。写开来会长成（这里不省略下标）：
$$
\frac{\d X_x}{\d x}Y_xZ_x+X_y\frac{\d Y_y}{\d y}Z_y+X_zY_z\frac{\d Z_z}{\d z}=0
$$
当 $x$ 接近 $0/a$ 时，根据类似的推导，$X_y=X_z=0$，从而只剩下
$$
\frac{\d X_x}{\d x}Y_xZ_x=0
$$
所以要么 $Y_x$ 或 $Z_x$ 恒为零，要么就是
$$
\begin{align*}
X^\prime(0)=0&amp;amp;\Longrightarrow D_x=0\\
X^\prime(a)=0&amp;amp;\Longrightarrow C_x=0\lor k_xa=m\pi\,(m\in\Z)
\end{align*}
$$
总的来说（$A_x=C_xD_yD_z$），
$$
E_x(x,y,z)=A_x\cos k_xx\sin k_yy\sin k_zz
$$
同理得到其他两维。但注意，我们没说其他两维的 $k_x$、$k_y$、$k_z$ 跟这里一样，所以最后还得依靠 $\nabla\cdot\b E=0$ 来得到额外的结果。最后我们得到的完整的式子与约束为（$\b B$ 由 $\nabla\times\b E=-\p\b B/\p t=-\i\omega\b B$ 得到）
$$
\left\{\begin{aligned}
\b E_x(x,y,z,t)&amp;amp;=A_x\e^{\i\omega t}\cos k_xx\sin k_yy\sin k_zz\\
\b E_y(x,y,z,t)&amp;amp;=A_y\e^{\i\omega t}\sin k_xx\cos k_yy\sin k_zz\\
\b E_z(x,y,z,t)&amp;amp;=A_z\e^{\i\omega t}\sin k_xx\sin k_yy\cos k_zz\\
\b B_x(x,y,z,t)&amp;amp;=(A_zk_y-A_yk_z)\frac{\i\e^{\i\omega t}}\omega\sin k_xx\cos k_yy\cos k_zz\\
\b B_y(x,y,z,t)&amp;amp;=(A_xk_z-A_zk_x)\frac{\i\e^{\i\omega t}}\omega\cos k_xx\sin k_yy\cos k_zz\\
\b B_z(x,y,z,t)&amp;amp;=(A_yk_x-A_xk_y)\frac{\i\e^{\i\omega t}}\omega\cos k_xx\cos k_yy\sin k_zz\\
\frac{\omega^2}{c^2}&amp;amp;=k_x^2+k_y^2+k_z^2\\
0&amp;amp;=A_xk_x+A_yk_y+A_zk_z\\
k_x&amp;amp;=\frac{m\pi}{a}\;(m\in\Z)\\
k_y&amp;amp;=\frac{n\pi}{b}\;(n\in\Z)\\
k_z&amp;amp;=\frac{p\pi}{d}\;(p\in\Z)
\end{aligned}\right.
$$
换句话说，要使得这个谐振腔能稳定地振动，初始给的信号必须要是 $\exists m,n,p\in\Z$，使
$$
\omega=c\pi\sqrt{\left(\frac ma\right)^2+\left(\frac nb\right)^2+\left(\frac pd\right)^2}
$$
并且对振幅也有限制。&lt;/p&gt;
&lt;p&gt;对于至少有一个分量为 $0$ 的情况，有一个命名方法——产生对应 $m$、$n$、$p$ 的震荡的信号生成器叫 $\mathrm{TE}_{mnp}$（如果 $\b E_z=0$）或 $\mathrm{TM}_{mnp}$（如果 $\b B_z=0$）。现在我们来分析一下至少有一个分量为 $0$，会导致哪些情况：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\b E_z=0$，通过 $k_x=0$ 达成。这时 $\b E_x$、$\b B_y$、$\b B_z$ 非零，且无所谓 $A_z$、$A_y$ 是否为零。&lt;/li&gt;
&lt;li&gt;$\b E_z=0$，通过 $A_z=0$ 达成。如果没有别的可变量非零，那么其他五个量均非零。&lt;/li&gt;
&lt;li&gt;$A_z=k_z=0$。这种不行，全部都变成零了。&lt;/li&gt;
&lt;li&gt;$\b B_z=0$，通过 $k_z=0$ 达成。这时 $\b E_z$、$\b B_x$、$\b B_y$ 非零。&lt;/li&gt;
&lt;li&gt;$\b B_z=0$，通过 $A_yk_x=A_xk_y$ 达成。这种看起来比较难分析，其实可以根据对称性，得到其他五个量也都非零。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其余情况都只是循环位移一下。总的来说，只有 $0$、$1$、$3$ 个分量为零这三种可能。所以说 $\rm TE$ 和 $\rm TM$ 只能表示其中部分情况，但是不会一种非全零的情况是 $\rm TEM$。另外加一个假设 $b&amp;lt;a&amp;lt;d$。&lt;/p&gt;
&lt;p&gt;&lt;del&gt;我知道你看见这些莫名其妙的说法已经受不了了，TE、TM、TEM 这些东西是波导来的，所以你可以认为这些是“惯例”的问题。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;对于 $\rm TE$，有 $\mathrm{TE}_{m0p}$、$\mathrm{TE}_{0np}$、$\mathrm{TE}_{mnp}$ 这三种，其中频率最低的是 $\mathrm{TE}_{101}$。这种情况的场是：
$$
\left\{\begin{aligned}
\b E_x&amp;amp;=0\\
\b E_y&amp;amp;=A\e^{\i\omega t}\sin\frac{\pi x}a\sin\frac{\pi z}d\\
\b E_z&amp;amp;=0\\
\b B_x&amp;amp;=-\frac{A\pi}d\frac{\i\e^{\i\omega t}}\omega\sin\frac{\pi x}a\cos\frac{\pi z}d\\
\b B_y&amp;amp;=0\\
\b B_z&amp;amp;=\frac{A\pi}a\frac{\i\e^{\i\omega t}}\omega\cos\frac{\pi x}a\sin\frac{\pi z}d\\
\omega&amp;amp;=c\pi\sqrt{\frac1{a^2}+\frac1{d^2}}
\end{aligned}\right.
$$
$\mathrm{TE}_{111}$ 的场是（注意这里我是把 $A_xk_x+A_yk_y=0$ 的等式解成了 $A_x=Ak_y$，$A_y=-Ak_x$，量纲一塌糊涂，反正能看就行）：
$$
\left\{\begin{aligned}
\b E_x&amp;amp;=\frac{A\pi}b\e^{\i\omega t}\cos\frac{\pi x}a\sin\frac{\pi y}b\sin\frac{\pi z}d\\
\b E_y&amp;amp;=-\frac{A\pi}a\e^{\i\omega t}\sin\frac{\pi x}a\cos\frac{\pi y}b\sin\frac{\pi z}d\\
\b E_z&amp;amp;=0\\
\b B_x&amp;amp;=\frac{A\pi^2}{ad}\frac{\i\e^{\i\omega t}}\omega\sin\frac{\pi x}a\cos\frac{\pi y}b\cos\frac{\pi z}d\\
\b B_y&amp;amp;=\frac{A\pi^2}{bd}\frac{\i\e^{\i\omega t}}\omega\cos\frac{\pi x}a\sin\frac{\pi y}b\cos\frac{\pi z}d\\
\b B_z&amp;amp;=-A\pi^2\left(\frac1{a^2}+\frac1{b^2}\right)\frac{\i\e^{\i\omega t}}\omega\cos\frac{\pi x}a\cos\frac{\pi y}b\sin\frac{\pi z}d\\
\omega&amp;amp;=c\pi\sqrt{\frac1{a^2}+\frac1{b^2}+\frac1{d^2}}
\end{aligned}\right.
$$
对于 $\rm TM$，只有 $\mathrm{TM}_{mn0}$、$\mathrm{TM}_{mnp}$ 这两种，其中频率最低的是 $\mathrm{TM}_{110}$。对应的场是：
$$
\left\{\begin{aligned}
\b E_x&amp;amp;=0\\
\b E_y&amp;amp;=0\\
\b E_z&amp;amp;=A\e^{\i\omega t}\sin\frac{\pi x}a\sin\frac{\pi y}b\\
\b B_x&amp;amp;=\frac{A\pi}b\frac{\i\e^{\i\omega t}}\omega\sin\frac{\pi x}a\cos\frac{\pi y}b\\
\b B_y&amp;amp;=-\frac{A\pi}a\frac{\i\e^{\i\omega t}}\omega\cos\frac{\pi x}a\sin\frac{\pi y}b\\
\b B_z&amp;amp;=0\\
\omega&amp;amp;=c\pi\sqrt{\frac1{a^2}+\frac1{b^2}}
\end{aligned}\right.
$$
我不想再写 $\mathrm{TM}_{111}$ 啦！&lt;/p&gt;
&lt;p&gt;模式是可以叠加的，另外我想知道，是否存在不能用这些模式线性组合得到的解。&lt;/p&gt;
&lt;h3 id=&#34;圆柱形谐振腔&#34;&gt;圆柱形谐振腔
&lt;/h3&gt;&lt;p&gt;书里有一种很牛的方法，对于接了交流电的平行板电容器，通过反复利用高斯定律和安培定律，可以得到其中电磁场的级数解。然后让边上恒为零，这个时候加上金属侧边（我不知道为啥其中的电流不会影响里面的电磁场），然后就解出来了。&lt;/p&gt;
&lt;p&gt;然后记得还有讲过电磁场在边界处指数衰减的，我也没记。&lt;/p&gt;
&lt;p&gt;将坐标系换为柱坐标系后，套路和上面类似。设
$$
\b E_z(\rho,\phi,z,t)=R(\rho)P(\phi)Z(z)\e^{\i\omega t}
$$
在 $\nabla^2\b E_z+k^2\b E_z=0$ 中代入
$$
\nabla^2=\frac{\p^2}{\p\rho^2}+\frac1\rho\frac{\p}{\p\rho}+\frac1{\rho^2}\frac{\p^2}{\p\phi^2}+\frac{\p^2}{\p z^2}
$$
得
$$
\frac{\d^2R}{\d\rho^2}PZ+\frac1\rho\frac{\d R}{\d\rho}PZ+\frac{R}{\rho^2}\frac{\d^2P}{\d\phi^2}Z+RP\frac{\d^2Z}{\d z^2}+k^2RPZ=0
$$
同除以 $RPZ$：
$$
\frac1R\frac{\d^2 R}{\d\rho^2}+\frac1{\rho R}\frac{\d R}{\d\rho}+\frac1{\rho^2P}\frac{\d^2P}{\d\phi^2}+\frac1Z\frac{\d^2Z}{\d z^2}+k^2=0
$$
整个等式被分成了与 $\rho$、$\phi$ 相关的和与 $z$ 相关的部分，所以可设
$$
\frac1Z\frac{\d^2Z}{\d z^2}=-\beta^2\Longrightarrow Z=C_1\cos\beta z+C_2\sin\beta z
$$
然后这里的话我们把它写成指数的形式，并且只保留 $\e^{-\i\beta z}$ 项。这样做的原因是为了把谐振腔看成波导的变形，然后只保留一个方向传播的波。这个后面会再提。总之
$$
\b E_z=R(\rho)P(\phi)\e^{\i(\omega t-\beta z)}
$$
这边提一下一个细节，我上课有个疑问：为啥是 $\e^{\i\beta z}$ 而不能是 $\e^{(\alpha+\i\beta)z}$？一方面如果是 $\e^{\alpha z}$，$\b E_\rho$、$\b E_\phi$ 和 $\b B_z$ 的边界条件就不可能满足，另一方面如果实部虚部都有，你会发现整个 $\re Z$ 根本没法满足 $Z^{\prime\prime}/Z$ 是个常数。&lt;/p&gt;
&lt;p&gt;再代一遍 $\Delta$，同除 $RP/\rho^2$：
$$
\frac{\d^2R}{\d\rho^2}P+\frac1\rho\frac{\d R}{\d\rho}P+\frac{R}{\rho^2}\frac{\d^2P}{\d\phi^2}+(k^2-\beta^2)RP=0\Longrightarrow\frac{\rho^2}{R}\frac{\d^2R}{\d\rho^2}+\frac{\rho}{R}\frac{\d R}{\d\rho}+(k^2-\beta^2)\rho^2=-\frac{1}{P}\frac{\d^2P}{\d\phi^2}
$$
我们又得到了一个等式，两侧分别只与 $\rho$、$\phi$ 相关。我们设它为 $n^2$，其中 $n\in\N$。只能这么设的原因其实很简单——为了保证 $P$ 以 $2\pi$ 为周期。右边的解是 $P=C_1\cos n\phi+C_2\sin n\phi$。左边的方程是
$$
\rho^2\frac{\d^2R}{\d\rho^2}+\rho\frac{\d R}{\d\rho}+\left[(k^2-\beta^2)\rho^2-n^2\right]R=0
$$
令 $k_c^2=k^2-\beta^2$，$t=k_c\rho$，则变为
$$
t^2\frac{\d^2R}{\d t^2}+t\frac{\d R}{\d t}+(t^2-n^2)R=0
$$
这个的解是贝塞尔函数（第一类贝塞尔函数 $J_n$ 和第二类贝塞尔函数 $Y_n$ 的线性组合，但 $Y_n$ 在 $0$ 处发散，舍）
$$
R=C_0J_n(t)=C_0J_n(k_c\rho)
$$&lt;/p&gt;
&lt;p&gt;如果 $k&amp;lt;\beta$ 即 $k_c$ 是虚数，我们会得到 $I_n(\i k_c\rho)$，$I$ 是第一类修正贝塞尔函数。这个东西零点只在 $x=0$，所以一定是没法满足边界条件的。所以我们要求 $k\ge\beta$。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;13-1.svg&#34; /&gt;&lt;/center&gt;
&lt;p&gt;$J_0$ 的前两个零点为 $x\approx 2.405$、$x\approx 5.520$。&lt;/p&gt;
&lt;p&gt;综上所述，我们的解长成这样
$$
\b E_z=C\cdot J_n(k_c\rho)\sin(n\phi+\phi_0)\e^{-\i\beta z}\e^{\i\omega t}
$$
那实际上 $\b E_\rho$ 和 $\b E_\phi$ 也肯定是有个 $\e^{\i\beta z}\e^{\i\omega t}$ 的因子在里面的，所以顶底给出了一对边界条件。如果圆柱高为 $d$，那么（实际情况大概会是强制把 $\sin$ 搞到实部或者改相位之类的）
$$
\beta=\frac{l\pi}d\;(l\in\Z)
$$
同时若圆柱半径为 $r$，那么 $J_n(k_cr)=0$。这就是两个边界条件。关于另两个分量和磁场的计算，我们放到下面。有个更简单的方法。&lt;/p&gt;
&lt;h2 id=&#34;波导&#34;&gt;波导
&lt;/h2&gt;&lt;p&gt;在研究完两种形状的谐振腔后，我们会想，有没有一般的方法？为什么 $\rm TEM$ 波不存在？之类的。波导可以理解为没有“底面”的无限长谐振腔，正常谐振腔里的电磁波可以理解为以两个底面为反射面，将波导里的电磁波“折叠起来”。同时，考虑波导可以得到一个更一般的计算方法。&lt;/p&gt;
&lt;p&gt;现在想一个任意形状回路沿 $z$ 轴移动得到的正柱面。设在其中的电磁场为
$$
\left\{\begin{aligned}
\b E&amp;amp;=(\b{\hat x}\b E_x(x,y)+\b{\hat y}\b E_y(x,y)+\b{\hat z}\b E_z(x,y))\e^{-\i\beta z}\e^{\i\omega t}\\
\b B&amp;amp;=(\b{\hat x}\b B_x(x,y)+\b{\hat y}\b B_y(x,y)+\b{\hat z}\b B_z(x,y))\e^{-\i\beta z}\e^{\i\omega t}
\end{aligned}\right.
$$
现在我们不直接套波动方程，而是代入无源麦克斯韦方程组：
$$
\left\{\begin{aligned}
\nabla\times\b E&amp;amp;=-\i\omega\b B\\
\nabla\times\b B&amp;amp;=\eps_0\mu_0\i\omega\b E
\end{aligned}\right.
$$
展开
$$
\left\{\begin{align*}
\frac{\p\b E_z}{\p y}+\i\beta\b E_y&amp;amp;=-\i\omega\b B_x&amp;amp;\tag{1}\\
-\i\beta\b E_x-\frac{\p\b E_z}{\p x}&amp;amp;=-\i\omega\b B_y\\
\frac{\p\b E_y}{\p x}-\frac{\p\b E_x}{\p y}&amp;amp;=-\i\omega\b B_z\\
\frac{\p\b B_z}{\p y}+\i\beta\b B_y&amp;amp;=\eps_0\mu_0\i\omega\b E_x&amp;amp;\tag{2}\\
-\i\beta\b B_x-\frac{\p\b B_z}{\p x}&amp;amp;=\eps_0\mu_0\i\omega\b E_y\\
\frac{\p\b B_y}{\p x}-\frac{\p\b B_x}{\p y}&amp;amp;=\eps_0\mu_0\i\omega\b E_z\\
\end{align*}\right.
$$
结合 $(1)$、$(2)$ 得
$$
(\eps_0\mu_0\omega^2-\beta^2)\b E_y=\i\left(-\beta\frac{\p\b E_z}{\p y}+\omega\frac{\p\b B_z}{\p x}\right)
$$
同理我们可以解得 $\b E_x$、$\b B_x$、$\b B_y$ 关于 $\b E_z$ 和 $\b B_z$ 的表达式，这意味着，我们后续只需要解出这两个量就行了。
$$
\left\{\begin{align*}
\b E_x&amp;amp;=\frac{-\i}{k_c^2}\left(\beta\frac{\p\b E_z}{\p x}+\omega\frac{\p\b B_z}{\p y}\right)\\
\b E_y&amp;amp;=\frac{\i}{k_c^2}\left(-\beta\frac{\p\b E_z}{\p y}+\omega\frac{\p\b B_z}{\p x}\right)\\
\b B_x&amp;amp;=\frac{\i}{k_c^2}\left(\eps_0\mu_0\omega\frac{\p\b E_z}{\p y}-\beta\frac{\p\b B_z}{\p x}\right)\\
\b B_y&amp;amp;=\frac{-\i}{k_c^2}\left(\eps_0\mu_0\omega\frac{\p\b E_z}{\p x}+\beta\frac{\p\b B_z}{\p y}\right)
\end{align*}\right.
$$&lt;/p&gt;
&lt;p&gt;别忘了 $k_c^2=k^2-\beta^2$。&lt;/p&gt;
&lt;h3 id=&#34;tem-波&#34;&gt;TEM 波
&lt;/h3&gt;&lt;p&gt;考虑 $\b E_z=\b B_z=0$ 的情况。只有在 $k_c=0$ 即 $k=\beta$ 时，其他的分量才有可能不是零，这时
$$
\left\{\begin{align*}
\beta\b E_y&amp;amp;=-\omega\b B_x\\
\beta\b E_x&amp;amp;=\omega\b B_y\\
\frac{\p\b E_y}{\p x}&amp;amp;=\frac{\p\b E_x}{\p y}\\
\beta\b B_y&amp;amp;=\eps_0\mu_0\omega\b E_x\\
-\beta\b B_x&amp;amp;=\eps_0\mu_0\omega\b E_y\\
\frac{\p\b B_y}{\p x}&amp;amp;=\frac{\p\b B_x}{\p y}\\
\end{align*}\right.
$$
这种情况下这堆东西其实没啥用，无非就是还能导出个二维的拉普拉斯方程
$$
\frac{\p^2\b E_x}{\p x^2}+\frac{\p^2\b E_y}{\p y^2}=\frac{\p^2\b B_x}{\p x^2}+\frac{\p^2\b B_y}{\p y^2}=0
$$
所以告诉了你真正要解的时候怎么解。但在只有一个导体的情况下，你会发现因为 $\nabla\cdot\b E=0$，所以其实就是一个静电屏蔽的场景，中间无电磁场，因为 $\nabla^2\varphi=0$ 且边界等势。所以 $\rm TEM$ 波其实没什么好说的。&lt;/p&gt;
&lt;p&gt;还有个东西叫波阻抗，其定义为
$$
Z=\frac{\b E_x}{\b H_y}=-\frac{\b E_y}{\b H_x}
$$
其中 $\b H=\b B/\mu_0$。在这里，
$$
Z_{\rm TEM}=\frac{\mu_0\omega}\beta=\frac{\mu_0\omega}k=\mu_0c=\sqrt{\frac{\mu_0}{\eps_0}}
$$
$\eta_0=\sqrt{\mu_0/\eps_0}$ 又被称为真空的固有阻抗。这个跟正常的阻抗肯定是不同的，真空的阻抗显然是 $\infty$。&lt;/p&gt;
&lt;p&gt;什么？你想知道它的物理意义？我也不知道，但我知道它的计算可能会考。你可以这样记忆：$R=U/I$，$U$ 与电场有关，$I$ 与磁场有关。&lt;/p&gt;
&lt;h3 id=&#34;te-波&#34;&gt;TE 波
&lt;/h3&gt;&lt;p&gt;$\b E_z=0$ 而 $\b B_z\ne 0$ 时，再考虑 $k=\beta$ 就没什么意义了（会导致 $\b B_z$ 是常数）。所以
$$
\left\{\begin{align*}
\b E_x&amp;amp;=\frac{-\i\omega}{k_c^2}\frac{\p\b B_z}{\p y}\\
\b E_y&amp;amp;=\frac{\i\omega}{k_c^2}\frac{\p\b B_z}{\p x}\\
\b B_x&amp;amp;=\frac{-\i\beta}{k_c^2}\frac{\p\b B_z}{\p x}\\
\b B_y&amp;amp;=\frac{-\i\beta}{k_c^2}\frac{\p\b B_z}{\p y}
\end{align*}\right.
$$
只需要解磁场的亥姆霍兹方程
$$
\frac{\p^2\b B_z}{\p x^2}+\frac{\p^2\b B_z}{\p y^2}+k_c^2\b B_z=0
$$
即可。这种情况的波阻抗为
$$
Z_{\rm TE}=\frac{\mu_0\omega}\beta=\frac{k\eta_0}\beta
$$&lt;/p&gt;
&lt;h3 id=&#34;tm-波&#34;&gt;TM 波
&lt;/h3&gt;&lt;p&gt;$$
\left\{\begin{align*}
\b E_x&amp;amp;=\frac{-\i\beta}{k_c^2}\frac{\p\b E_z}{\p x}\\
\b E_y&amp;amp;=\frac{-\i\beta}{k_c^2}\frac{\p\b E_z}{\p y}\\
\b B_x&amp;amp;=\frac{\i\eps_0\mu_0\omega}{k_c^2}\frac{\p\b E_z}{\p y}\\
\b B_y&amp;amp;=\frac{-\i\eps_0\mu_0\omega}{k_c^2}\frac{\p\b E_z}{\p x}\\
Z_{\rm TM}&amp;amp;=\frac{\beta}{\eps_0\omega}=\frac{\beta\eta_0}k
\end{align*}\right.
$$&lt;/p&gt;
&lt;h3 id=&#34;矩形波导&#34;&gt;矩形波导
&lt;/h3&gt;&lt;h4 id=&#34;te-波-1&#34;&gt;TE 波
&lt;/h4&gt;&lt;p&gt;$$
\left(\frac{\p^2}{\p x^2}+\frac{\p^2}{\p y^2}+k_c^2\right)\b B_z=0
$$&lt;/p&gt;
&lt;p&gt;设
$$
\b B_z=X(x)Y(y)
$$
则
$$
\frac{X^{\prime\prime}}{X}+\frac{Y^{\prime\prime}}{Y}+k_c^2=0\Longrightarrow
\left\{\begin{aligned}
X&amp;amp;=C_x\cos k_xx+D_x\sin k_xx\\
Y&amp;amp;=C_y\cos k_yy+D_y\sin k_yy\\
k_c^2&amp;amp;=k_x^2+k_y^2
\end{aligned}\right.
$$
这里 $k_c$ 是实数是比较显然的。然后（$\b E_x$ 和 $\b E_y$ 的）边界 $\Rightarrow D_x=D_y=0$、$k_x=m\pi/a$、$k_y=n\pi/b$。从而（必须）有
$$
\beta=\sqrt{k^2-\left(\frac{m\pi}a\right)^2-\left(\frac{n\pi}b\right)^2}
$$
最后的解是
$$
\left\{\begin{align*}
\b E_x&amp;amp;=\frac{\i\omega n\pi}{k_c^2b}A\cos\frac{m\pi x}a\sin\frac{n\pi y}b\e^{-\i\beta z}\\
\b E_y&amp;amp;=\frac{-\i\omega m\pi}{k_c^2a}A\sin\frac{m\pi x}a\cos\frac{n\pi y}b\e^{-\i\beta z}\\
\b E_z&amp;amp;=0\\
\b B_x&amp;amp;=\frac{\i\beta m\pi}{k_c^2a}A\sin\frac{m\pi x}a\cos\frac{n\pi y}b\e^{-\i\beta z}\\
\b B_y&amp;amp;=\frac{\i\beta n\pi}{k_c^2b}A\cos\frac{m\pi x}a\sin\frac{n\pi y}b\e^{-\i\beta z}\\
\b B_z&amp;amp;=A\cos\frac{m\pi x}{a}\cos\frac{n\pi y}b\e^{-\i\beta z}
\end{align*}\right.
$$
这个叫做 $\mathrm{TE}_{mn}$ 模式。&lt;/p&gt;
&lt;p&gt;最后我们说一下 $k_c$。它称为“截止波数”。想一个波导，它的 $a$、$b$ 都是定的，模式也是定的，所以 $k_c$ 是定的。那么这个时候不定的只有 $\omega$。如果 $\omega$ 过小，$k$ 就会过小，$\beta=\sqrt{k^2-k_c^2}$ 就变成虚的，信号就无法传播了（会指数衰减）。所以有个对应的截止频率——$\beta=0$，$k=k_c$ 时
$$
f_{c_{mn}}=\frac{\omega_c}{2\pi}=\frac{ck}{2\pi}=\frac{ck_c}{2\pi}=\frac{1}{2\pi\sqrt{\eps_0\mu_0}}\sqrt{\left(\frac{m\pi}a\right)^2+\left(\frac{n\pi}b\right)^2}
$$
这里讲的这些波导都是高通的。&lt;/p&gt;
&lt;p&gt;同样，如果 $b&amp;lt;a$，最低的截止频率对应的就是 $\mathrm{TE}_{10}$。对应的 $f_{c_{10}}=1/2a\sqrt{\eps_0\mu_0}$。&lt;/p&gt;
&lt;p&gt;我们再关注有几何意义的几个量：一个是波导波长，即在同一时间，波导中两个波峰的距离。由于 $z$ 方向有个 $\beta$ 倍，所以这个的值为
$$
\lambda_g=\frac{2\pi}{\beta}&amp;gt;\frac{2\pi}{\omega}=\lambda
$$
比正常真空中的波长长。同时，一个波峰的速度为，考虑 $\e^{\i(\omega t-\beta z)}=C$，也就是 $\omega t-\beta z=C$。
$$
v_p=\frac{\p z}{\p t}=\frac\omega\beta=\frac k\beta c&amp;gt;c
$$
这个称为相速度。因为波既在正常传播，内部的相位又在变化，所以会造成超光速的错觉。&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Phase_velocity&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里的几张图&lt;/a&gt;有助于理解。波导里面的信号实际是以群速度传播的：
$$
v_g=\frac{\p\omega}{\p\beta}=\frac{\beta c^2}\omega=\frac\beta kc&amp;lt;c
$$
群速度的公式怎么来的就不讲了。&lt;/p&gt;
&lt;h4 id=&#34;tm-波-1&#34;&gt;TM 波
&lt;/h4&gt;&lt;p&gt;除了边界条件啥都一样。
$$
\left\{\begin{align*}
\b E_x&amp;amp;=\frac{-\i\beta m\pi}{k_c^2a}A\cos\frac{m\pi x}a\sin\frac{n\pi y}b\e^{-\i\beta z}\\
\b E_y&amp;amp;=\frac{-\i\beta n\pi}{k_c^2b}A\sin\frac{m\pi x}a\cos\frac{n\pi y}b\e^{-\i\beta z}\\
\b E_z&amp;amp;=A\sin\frac{m\pi x}a\sin\frac{n\pi y}b\e^{-\i\beta z}\\
\b B_x&amp;amp;=\frac{\i\eps_0\mu_0\omega n\pi}{k_c^2b}A\sin\frac{m\pi x}a\cos\frac{n\pi y}b\e^{-\i\beta z}\\
\b B_y&amp;amp;=\frac{-\i\eps_0\mu_0\omega m\pi}{k_c^2a}A\cos\frac{m\pi x}a\sin\frac{n\pi y}b\e^{-\i\beta z}\\
\b B_z&amp;amp;=0
\end{align*}\right.
$$
最低的截止频率对应的是 $\mathrm{TM}_{11}$。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>算设 Survey：一些经典问题的 log 因子优化算法</title>
        <link>https://littlereuben.github.io/study/course-algo-survey/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-algo-survey/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;embed src= &#34;main.pdf&#34; width= &#34;100%&#34; height= &#34;800px&#34; type=&#34;application/pdf&#34; &gt;
&lt;a href=&#34;main.pdf&#34; style=&#34;display:block;text-align:center;&#34;&gt;&lt;b&gt;[PDF file]&lt;/b&gt;&lt;/a&gt;
</description>
        </item>
        <item>
        <title>微积分 A(1) 复习及一些题</title>
        <link>https://littlereuben.github.io/study/course-calculus-1-2/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-calculus-1-2/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/course-calculus-1-2/cover.jpg" alt="Featured image of post 微积分 A(1) 复习及一些题" /&gt;&lt;p&gt;$\gdef\eps{\varepsilon}\gdef\e{\mathrm{e}}\gdef\d{\mathrm{d}}\gdef\i{\mathrm{i}}\gdef\F{\mathbb{F}}\gdef\arcsinh{\operatorname{arcsinh}}\gdef\arccosh{\operatorname{arccosh}}\gdef\arctanh{\operatorname{arctanh}}\gdef\arccoth{\operatorname{arccoth}}\gdef\arcsech{\operatorname{arcsech}}\gdef\arccsch{\operatorname{arccsch}}\gdef\sgn{\operatorname{sgn}}\gdef\sech{\operatorname{sech}}\gdef\csch{\operatorname{csch}}\gdef\arccot{\operatorname{arccot}}\gdef\arcsec{\operatorname{arcsec}}\gdef\arccsc{\operatorname{arccsc}}\gdef\b#1{\boldsymbol{#1}}\gdef\mat#1{\begin{bmatrix}#1\end{bmatrix}}\gdef\dat#1{\begin{vmatrix}#1\end{vmatrix}}\gdef\tr{\operatorname{tr}}\gdef\R{\mathbb{R}}\gdef\Q{\mathbb{Q}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;p&gt;上半学期没什么东西，就记了一下大纲，然后记了些杂题，一部分放在下面，另一部分可以看期中复习 slide。&lt;/p&gt;
&lt;p&gt;下半学期有比较详尽的内容。&lt;/p&gt;
&lt;p&gt;参照了 wxf 的 ppt 和课。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://littlereuben.github.io/study/course-calculus-0/&#34; &gt;理论基础&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://littlereuben.github.io/study/course-calculus-1-1/&#34; &gt;期中复习&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&#34;上半学期&#34;&gt;上半学期
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;实分析初步&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;基础定义和性质、实数理论（略）&lt;/li&gt;
&lt;li&gt;上下界、上下确界
&lt;ol&gt;
&lt;li&gt;确界的类 $\eps-\delta$ 语言&lt;/li&gt;
&lt;li&gt;确界原理&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;初等函数
&lt;ol&gt;
&lt;li&gt;指数、对数、幂函数的定义
&lt;ol&gt;
&lt;li&gt;注意只考虑底数 $&amp;gt;0$ 的情况。&lt;/li&gt;
&lt;li&gt;有理数指数（开根）、无理数指数都使用上确界定义。&lt;/li&gt;
&lt;li&gt;指数、对数、幂函数的单调性。&lt;/li&gt;
&lt;li&gt;对数函数在没有连续性理论的情况下，类似于开根，也使用上确界定义。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;三角函数、反三角函数的定义与性质&lt;/li&gt;
&lt;li&gt;初等函数的定义
&lt;ol&gt;
&lt;li&gt;注意是有限次的四则运算与复合；注意定义域。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;极限与连续性&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$\eps-\delta$ 语言&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;注意极限和连续性都可以定义在定义域为非区间的函数上，但是考试应该会避免这种事。定义极限时，$x_0$ 必须是定义域的聚点；定义连续性时，$x_0$ 必须在定义域内。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\eps-\delta$ 的证明策略&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;基础放缩方法&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;上取整&lt;/li&gt;
&lt;li&gt;反解不等式&lt;/li&gt;
&lt;li&gt;多个条件取最值；分类讨论转求和&lt;/li&gt;
&lt;li&gt;三角不等式&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;阿基米德性、有理数和无理数的稠密性&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;黎曼函数、狄利克雷函数&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;二项式展开 → 伯努利不等式&lt;/p&gt;
&lt;p&gt;条件：$x&amp;gt;-1$&lt;/p&gt;
&lt;p&gt;$a&amp;gt;1$：$(1+x)^a\ge 1+ax$，在 $x=0$ 处取等&lt;/p&gt;
&lt;p&gt;$a=1$：$(1+x)^a=1+ax$&lt;/p&gt;
&lt;p&gt;$0&amp;lt;a&amp;lt;1$：$(1+x)^a\le 1+ax$，在 $x=0$ 处取等&lt;/p&gt;
&lt;p&gt;$a=0$：$(1+x)^a=1+ax$&lt;/p&gt;
&lt;p&gt;$a&amp;lt;0$：$(1+x)^a\ge 1+ax$，在 $x=0$ 处取等&lt;/p&gt;
&lt;p&gt;应用：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$n^k/a^n$&lt;/li&gt;
&lt;li&gt;$\sqrt[n]a$&lt;/li&gt;
&lt;li&gt;$\sqrt[n]n$&lt;/li&gt;
&lt;li&gt;$(1+1/n)^n$&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\e$ 和 $\ln$ 相关的不等式&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\e^x\ge 1+x$，在 $x=0$ 处取等（求导证 $(1+x)^{1/x}$ 单降、凸性切线）&lt;/li&gt;
&lt;li&gt;$\e^x\le(1+x)^{1+x}$（$x&amp;gt;-1$），在 $x=0$ 处取等（$(1+x)^{1/x+1}$ 单增）&lt;/li&gt;
&lt;li&gt;$\ln(1+x)\le x\le(1+x)\ln(1+x)$（$x&amp;gt;-1$），在 $x=0$ 处取等&lt;/li&gt;
&lt;li&gt;$\e^x\le1/(1-x)$（$x&amp;lt;1$），1 中 $x$ 换成 $-x$&lt;/li&gt;
&lt;li&gt;$\e^x&amp;lt;(\e-1)x+1$（$0&amp;lt;x&amp;lt;1$），过 $\e^x$ 的 $(0,1)-(1,\e)$ 的割线，凸性&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;三角函数相关的不等式&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\sin x&amp;lt;x&amp;lt;\tan x$（$0&amp;lt;x&amp;lt;\pi/2$）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;极限的初步性质&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;唯一性、有界性&lt;/li&gt;
&lt;li&gt;保序性与夹逼定理
&lt;ol&gt;
&lt;li&gt;取极限后，不含等变含等；极限不等，原邻域也不等。&lt;/li&gt;
&lt;li&gt;夹逼定理本身蕴含着极限的存在性。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;（连续也有）四则运算
&lt;ol&gt;
&lt;li&gt;注意分母不能是 $0$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;（连续也有）复合
&lt;ol&gt;
&lt;li&gt;注意定义域。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;初等函数的连续性&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;数列极限的特有性质&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;子列与原列的极限的关系
&lt;ol&gt;
&lt;li&gt;存在一个下标列同时使两个有界数列收敛&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;复合函数&lt;/li&gt;
&lt;li&gt;单调有界原理&lt;/li&gt;
&lt;li&gt;列紧性&lt;/li&gt;
&lt;li&gt;柯西列&lt;/li&gt;
&lt;li&gt;有界变差数列&lt;/li&gt;
&lt;li&gt;闭区间套定理&lt;/li&gt;
&lt;li&gt;Stolz 定理
&lt;ol&gt;
&lt;li&gt;注意使用条件：分母必须单调。&lt;/li&gt;
&lt;li&gt;差分后极限存在 $\Rightarrow$ 原极限存在&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;数列极限与函数极限的关系&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;归结原理与柯西收敛定理&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;间断点&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;可去间断点、跳跃间断点是第一类间断点（左右极限均存在但有至少一个 $\ne f(x_0)$），其他都是第二类。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\e$&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;证明数列极限存在&lt;/li&gt;
&lt;li&gt;证明函数极限存在&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;证明数列极限存在的方法&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;单调有界定理
&lt;ol&gt;
&lt;li&gt;$\e$&lt;/li&gt;
&lt;li&gt;$H_n-\ln n$&lt;/li&gt;
&lt;li&gt;一些可以用 Banach 不动点定理证的东西&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;保序性、夹逼
&lt;ol&gt;
&lt;li&gt;阶乘倒数和 $=\e$&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Stolz
&lt;ol&gt;
&lt;li&gt;平均值的极限&lt;/li&gt;
&lt;li&gt;$n!/n^n$&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;求极限的方法&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;（数列）等式两侧求极限解方程 → 找不动点&lt;/li&gt;
&lt;li&gt;数列、函数互相归约&lt;/li&gt;
&lt;li&gt;代数变形后利用连续性&lt;/li&gt;
&lt;li&gt;换元、取对数
&lt;ol&gt;
&lt;li&gt;逆天三角换元&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;等价替换、渐进分析&lt;/li&gt;
&lt;li&gt;Stolz、洛&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;连续性相关定理&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;单调函数、反函数的性质&lt;/li&gt;
&lt;li&gt;介值定理&lt;/li&gt;
&lt;li&gt;有界定理、最值定理
&lt;ol&gt;
&lt;li&gt;注意必须是闭区间&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;压缩不动点定理&lt;/li&gt;
&lt;li&gt;一致连续性&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;渐近线&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;由定义求：写出曲线上点到直线距离公式，求极限。或者说 $k=\lim f(x)/x$，$b=\lim(f(x)-kx)$。&lt;/li&gt;
&lt;li&gt;由渐近展开求：通过保留 $x$ 因子，剩下改成 $1/x$，写成 $f(x)/x=1+b/x+\omicron(x)\,(x\to\infty)$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;无穷和阶&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;无穷大小量的表示的定义与初步性质
&lt;ol&gt;
&lt;li&gt;通过不等式避免除以 $0$。&lt;/li&gt;
&lt;li&gt;证明对称性和传递性。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;手动展开的方法
&lt;ol&gt;
&lt;li&gt;$1/(1-x)$：递归&lt;/li&gt;
&lt;li&gt;$\e^x,\ln(1+x)$ 前几项：直接求极限，利用 $f(2h)-f(h)$ 可以展更多，展到 $x^3$ 项&lt;/li&gt;
&lt;li&gt;$(1+x)^{m/n}$：$(1+y)^n=(1+x)^m$，利用 $f+\omicron(f)=G+\omicron(g)$ 定理&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;等价无穷小量替换
&lt;ol&gt;
&lt;li&gt;注意那个著名反例（$x^2\sin1/x$）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;导数&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;导数和微分的定义
&lt;ol&gt;
&lt;li&gt;注意闭区间上可微，要求端点单侧可导。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;导数的运算法则&lt;/li&gt;
&lt;li&gt;求导的技巧
&lt;ol&gt;
&lt;li&gt;对于一些复杂导数的定性分析问题，可以写出“导数一定形如关于某些东西的多项式”，而不求出具体的解析式系数。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;导数的应用&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;导数在几何与物理中的应用&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;切线。注意非正则光滑曲线的切线可能会爆。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;曲率。计算方法 1：求法线交点的极限。计算方法 2：$\frac{[\arctan(y/x)]^\prime}{\sqrt{{x^\prime}^2+{y^\prime}^2}}$
$$
\kappa=\left\lvert\frac1r\right\rvert=\frac{\left\lvert x^\prime(t)y^{\prime\prime}(t)-x^{\prime\prime}(t)y^\prime(t)\right\rvert}{\left[(x^\prime(t))^2+(y^\prime(t))^2\right]^{3/2}}
$$
曲率中心：
$$
\left(x(t)-y^\prime(t)\frac{(x^\prime(t))^2+(y^\prime(t))^2}{x^\prime(t)y^{\prime\prime}(t)-x^{\prime\prime}(t)y^\prime(t)},y(t)+x^\prime(t)\frac{(x^\prime(t))^2+(y^\prime(t))^2}{x^\prime(t)y^{\prime\prime}(t)-x^{\prime\prime}(t)y^\prime(t)}\right)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;微分中值定理&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;一般的罗尔定理、柯西中值定理、拉格朗日中值定理，注意要在闭区间上连续（左端点右连续，右端点左连续），在开区间上可导，$\xi\in$ 开区间。柯西中值定理要求 $g^\prime\not\equiv0$，也就是说 $g$ 严增或严减。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;广义柯西中值定理：$f$、$g$ 在 $(a,b)$ 上可导（$a,b$ 甚至可以是无穷），不要求 $g^\prime\ne 0$；$\exists\xi\in(a,b)$ 使得
$$
f^\prime(\xi)\left(\lim_{x\to b^-}g(x)-\lim_{x\to a^+}g(x)\right)=g^\prime(\xi)\left(\lim_{x\to b^-}f(x)-\lim_{x\to a^+}f(x)\right)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;达布定理：导数的介值性。证明考虑利用最值定理找导数为 $0$ 的点（先否定端点是最值点）。也就是说，导数只能有震荡间断点。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;导数与图像的关系&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;最值&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;极值点处，导数不存在或等于 $0$。反之不一定成立。&lt;/li&gt;
&lt;li&gt;如果 $\exists n\in\N_+$，$f$ 在 $x_0$ 处的 $1\sim 2n-1$ 阶导均为 $0$，且 $2n$ 阶导为正/负，则 $x_0$ 处是严格极小/大值点。证明考虑归纳，利用二阶导是个极值点推回。&lt;/li&gt;
&lt;li&gt;有可能无法通过任何阶导判断极值点。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;单调性&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;开区间还是闭区间无所谓。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;单点的导数不能说明任何单调性，必须是区间。反例：$f(x)=\begin{cases}x+2x^2\sin(1/x),&amp;amp;x\ne0\\ 0,&amp;amp;x=0\end{cases}$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果区间上导数恒正，则严格单增；如果恒非负，则单增。严格单增的充要条件是，任意子区间内导数不恒为 $0$。&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/585000983/answer/2900992507&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;证明&lt;/a&gt;，&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/648122351/answer/3427887373&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;拓展&lt;/a&gt;。严格单增并不意味着导数非 $0$，反例：$x^{2n}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果 $\exists n\in\N_+$，$f$ 在 $x_0$ 处的 $1\sim 2n$ 阶导均为 $0$，且 $2n+1$ 阶导为正/负，则 $x_0$ 附近严格单增/减，也就是说一阶和三阶及以上在这里是不一样的。证明考虑归纳，用上面那个说明一阶导是极值点。&lt;/p&gt;
&lt;p&gt;高阶导均为 $0$ 不能说明单调性。单调：$f(x)=\begin{cases}\e^{-1/x^2},&amp;amp;x\ne0\\ 0,&amp;amp;x=0\end{cases}$；不单调：$f(x)=\begin{cases}\e^{-1/|x|}(0.1+\sin^2(1/x)),&amp;amp;x\ne0\\ 0,&amp;amp;x=0\end{cases}$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;连续性&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;连续可能处处不可导：Weierstrass 函数。&lt;/li&gt;
&lt;li&gt;单点可导要求单点连续。&lt;/li&gt;
&lt;li&gt;单点连续不说明邻域连续。$xD(x)$&lt;/li&gt;
&lt;li&gt;单点可导不说明邻域连续。$x^2D(x)$&lt;/li&gt;
&lt;li&gt;区间可导不说明导数连续。$f(x)=\begin{cases}x^2\sin(1/x),&amp;amp;x\ne0\\ 0,&amp;amp;x=0\end{cases}$&lt;/li&gt;
&lt;li&gt;连续且趋近于单点的导数极限存在说明单点导数存在且等于导数极限。&lt;/li&gt;
&lt;li&gt;两个达布函数（有介值性的）函数之和不一定是达布函数。$\pm \sin(1/x)$，$0$ 处取 $\pm 1$。&lt;/li&gt;
&lt;li&gt;达布函数可能处处不连续：&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Conway_base_13_function&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Conway base 13 function&lt;/a&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;凸性&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;定义：琴森不等式。一阶导（严）单增/减 $\Leftrightarrow$（严）下/上凸，二阶导非负/正 $\Leftrightarrow$ 下/上凸。&lt;/p&gt;
&lt;p&gt;不等式语言与导数语言的转化：$f^\prime_-(x_0)\le f^\prime_+(x_0)\le f^\prime_-(x&amp;gt;x_0)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一阶导严单当且仅当严凸，二阶导恒正则严凸，但严凸不一定二阶导非零。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;相关不等式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Jensen&lt;/li&gt;
&lt;li&gt;Information&lt;/li&gt;
&lt;li&gt;Hölder&lt;/li&gt;
&lt;li&gt;Minkowski&lt;/li&gt;
&lt;li&gt;Young&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;洛必达法则与泰勒公式&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;注意洛必达要求 $g^\prime(x)\ne0$。&lt;/li&gt;
&lt;li&gt;泰勒公式的皮亚诺余项形式只要求单点 $n$ 阶可导，拉格朗日余项形式必须在 $[x_0,x]$ 连续，$[x_0,x)$ $n+1$ 阶可导。&lt;/li&gt;
&lt;li&gt;泰勒多项式唯一。&lt;/li&gt;
&lt;li&gt;注意只有在满足可导条件下说泰勒多项式才有意义。&lt;/li&gt;
&lt;li&gt;有些情况下在某一阶之后就没法展了，比如 $x^{非整数}$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;不定积分&#34;&gt;不定积分
&lt;/h2&gt;&lt;p&gt;第二类换元法要保证 $x=u(t)$ 的值域要包含原被积函数的定义域，在 $u(t)$ 整体反函数多值时，要指出 $t$ 的取值。&lt;/p&gt;
&lt;p&gt;分部积分有一个很简单的几何直观。&lt;/p&gt;
&lt;p&gt;特定的积分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\frac{\d x}{x^2\pm a^2}
$$&lt;/p&gt;
&lt;p&gt;部分分式
$$
\frac{1}{x^2\pm a^2}=\frac{1}{2\sqrt{\pm a}}\left(\frac{1}{x-\sqrt{\pm a}}-\frac{1}{x+\sqrt{\pm a}}\right)
$$
或换元 $+:a\tan t$，$-:a\tanh t,a\coth t$
$$
\int\frac{\d x}{x^2+a^2}=\frac1a\arctan\frac xa+C
$$&lt;/p&gt;
&lt;p&gt;$$
\int\frac{\d x}{a^2-x^2}=\left\{\begin{aligned}&amp;amp;\frac1a\arctanh\frac xa+C,&amp;amp;|x|&amp;lt;a\\ &amp;amp;\frac1a\arccoth\frac xa+C,&amp;amp;|x|&amp;gt;a\end{aligned}\right.=\frac1{2a}\ln\left\lvert\frac{a+x}{a-x}\right\rvert+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\frac{\d x}{\sqrt{\pm x^2\pm a^2}}
$$&lt;/p&gt;
&lt;p&gt;换元 $+a^2:a\tan t,a\sinh t$，$-a^2:a\sec t,a\cosh t$，$a^2-:a\sin t$
$$
\int\frac{\d x}{\sqrt{x^2+a^2}}=\arcsinh\frac xa+C=\ln\left(x+\sqrt{x^2+a^2}\right)+C
$$&lt;/p&gt;
&lt;p&gt;$$
\int\frac{\d x}{\sqrt{x^2-a^2}}=\sgn(x)\arccosh\left\lvert\frac xa\right\rvert+C=\ln\left\lvert x+\sqrt{x^2-a^2}\right\rvert+C
$$&lt;/p&gt;
&lt;p&gt;$$
\int\frac{\d x}{\sqrt{a^2-x^2}}=\arcsin\frac xa+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\frac{\d x}{x\sqrt{\pm x^2\pm a^2}}
$$&lt;/p&gt;
&lt;p&gt;换元 $+a^2:a\tan t,a\csch t$，$-a^2:a\sec t$，$a^2-:a\sin t$
$$
\int\frac{\d x}{x\sqrt{x^2+a^2}}=-\frac1a\arccsch\left\lvert\frac xa\right\rvert+C=-\frac1a\ln\left\lvert\frac{a+\sqrt{x^2+a^2}}{x}\right\rvert+C
$$&lt;/p&gt;
&lt;p&gt;$$
\int\frac{\d x}{x\sqrt{x^2-a^2}}=\frac1a\arcsec\left\lvert\frac xa\right\rvert+C
$$&lt;/p&gt;
&lt;p&gt;$$
\int\frac{\d x}{x\sqrt{a^2-x^2}}=-\frac1a\arcsech\left\lvert\frac xa\right\rvert+C=-\frac1a\ln\left\lvert\frac{a+\sqrt{x^2-a^2}}{x}\right\rvert+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\sqrt{\pm x^2\pm a^2}\d x
$$&lt;/p&gt;
&lt;p&gt;分部积分
$$
\int\sqrt{\pm x^2\pm a^2}\d x=x\sqrt{\pm x^2\pm a^2}-\int\frac{\pm x^2\d x}{\sqrt{\pm x^2\pm a^2}}=x\sqrt{\pm x^2\pm a^2}-\int\sqrt{\pm x^2\pm a^2}\d x\pm\int\frac{a^2\d x}{\sqrt{\pm x^2\pm a^2}}
$$
或换元 $+a^2:a\tan t$，$-a^2:a\sec t$，$a^2-:a\sin t$
$$
\int\sqrt{*}\d x=\frac12\left(x\sqrt{*}\pm a^2\int\frac{\d x}{\sqrt{*}}\right)
$$
其中 $-a^2$ 取负，其余取正。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int x^n\e^{kx}\d x
$$&lt;/p&gt;
&lt;p&gt;反复分部积分
$$
\int x^n\e^{kx}\d x=\e^{kx}\sum_{i=0}^{n}\frac{(-1)^in^{\underline{i}}}{k^{i+1}}x^{n-i}+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int x^n\ln^kx\d x
$$&lt;/p&gt;
&lt;p&gt;反复分部积分
$$
\int x^n\ln^kx\d x=x^{n+1}\sum_{i=0}^n\frac{(-1)^ik^{\underline{i}}}{(n+1)^{i+1}}\ln^{k-i}x+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\frac{\d x}{(a^2\pm x^2)^n}
$$&lt;/p&gt;
&lt;p&gt;分部积分递推
$$
\begin{align*}
\int\frac{\d x}{(a^2\pm x^2)^n}&amp;amp;=\frac{1}{a^2}\left[\int\frac{(a^2\pm x^2)\d x}{(a^2\pm x^2)^n}\mp\int\frac{x^2\d x}{(a^2\pm x^2)^n}\right]\\
&amp;amp;=\frac{1}{a^2}\left[\int\frac{\d x}{(a^2\pm x^2)^{n-1}}+\frac{1}{2(n-1)}\int x\d\frac{1}{(a^2\pm x^2)^{n-1}}\right]\\
&amp;amp;=\frac{1}{a^2}\left[\int\frac{\d x}{(a^2\pm x^2)^{n-1}}+\frac{x}{2(n-1)(a^2\pm x^2)^{n-1}}-\frac{1}{2(n-1)}\int\frac{\d x}{(a^2\pm x^2)^{n-1}}\right]\\
\Longrightarrow a^2I_n&amp;amp;=\left[1-\frac{1}{2(n-1)}\right]I_{n-1}+\frac{x}{2(n-1)(a^2\pm x^2)^{n-1}}
\end{align*}
$$
或部分分式分解
$$
\frac{1}{(a^2-x^2)^n}=\sum_{i=1}^n\frac{\binom{2n-i-1}{n-1}}{(2a)^{2n-i}}\left[\frac{1}{(a+x)^i}+\frac{1}{(a-x)^i}\right]
$$&lt;/p&gt;
&lt;p&gt;$$
\int\frac{\d x}{(a^2-x^2)^n}=\frac{\binom{2n-2}{n-1}}{(2a)^{2n-1}}\ln\left\lvert\frac{a+x}{a-x}\right\rvert+\sum_{i=1}^{n-1}\frac{\binom{2n-i-2}{n-1}}{i(2a)^{2n-i-1}}\left[\frac{1}{(a-x)^i}-\frac{1}{(a+x)^i}\right]+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\sin^nx\cos^mx\d x
$$&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;分部积分递推（点火公式）
$$
\begin{align*}
\int\sin^nx\cos^mx\d x
&amp;amp;=\int\sin^nx\cos^{m-1}x\d\sin x\\
&amp;amp;=\sin^{n+1}x\cos^{m-1}x-\int\sin x\left[n\sin^{n-1}x\cos^mx-(m-1)\sin^{n+1}x\cos^{m-2}x\right]\d x\\
&amp;amp;=\sin^{n+1}x\cos^{m-1}x-(n+m-1)\int\sin^nx\cos^mx\d x+(m-1)\int\sin^nx\cos^{m-2}x\d x\\
\Longrightarrow I_{n,m}&amp;amp;=\frac{1}{n+m}\left[\sin^{n+1}x\cos^{m-1}x+(m-1)I_{n,m-2}\right]
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;当 $n,m$ 有一个是奇数时换元
$$
\int\sin^nx\cos^mx\d x=\int\sin^nx\left(1-\sin^2x\right)^{(m-1)/2}\d\sin x=\int t^n\left(1-t^2\right)^{(m-1)/2}\d t
$$
都是偶数时只能用二倍角公式归约为 $\cos 2x$ 的多项式。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;欧拉公式秒了！&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\tan^nx\d x
$$&lt;/p&gt;
&lt;p&gt;凑换元递推
$$
\int\tan^nx\d x=\int\tan^{n-2}\sec^2x\d x-\int\tan^{n-2}x\d x=\frac{\tan^{n-1}x}{n-1}-\int\tan^{n-2}x\d x
$$
或直接换元
$$
\int\tan^nx\d x\xlongequal{t=\tan x}\int\frac{t^n\d t}{1+t^2}=
\sum_{i=1}^{n/2}\frac{(-1)^{i-1}\tan^{n-2i+1}x}{n-2i+1}+
\left\{\begin{aligned}
&amp;amp;x,&amp;amp;2\mid n\\
&amp;amp;\ln\lvert\sec x\rvert,&amp;amp;2\nmid n
\end{aligned}\right.
+C
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\sec^nx\d x
$$&lt;/p&gt;
&lt;p&gt;分部积分递推
$$
\int\sec^nx\d x=\int\sec^{n-2}x\d\tan x=\sec^{n-2}x\tan x-\int(n-2)\sec^{n-2}x(\sec^2x-1)\d x
$$
或直接换元
$$
\int\sec^{2n}x\d x=\int\sec^{2n-2}x\d\tan x=\int(1+t^2)^{n-1}\d t
$$&lt;/p&gt;
&lt;p&gt;$$
\int\sec^{2n-1}x\d x=\int\frac{\d\sin x}{\cos^{2n}x}=\int\frac{\d t}{(1-t^2)^n}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\e^x\sin^nx\d x
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;有理函数（&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/619998711&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;参考&lt;/a&gt;），复数法的本质是扩展变成复变解析函数，相关的求导公式形式与实变函数类似。&lt;/p&gt;
&lt;p&gt;首先把复根全部搞出来，分母不要留二次项。考虑确定以下系数：
$$
f(x)=\frac{P(x)}{(x-x_0)^kQ(x)}=\sum_{i=1}^k\frac{A_i}{(x-x_0)^i}+R(x)
$$
其中 $(x-x_0)\nmid Q(x)$。&lt;/p&gt;
&lt;p&gt;两边同乘 $(x-x_0)^k$，然后不断求导，代入 $x=x_0$，可得
$$
A_i=\frac{1}{(k-i)!}\left.\left[\frac{P(x)}{Q(x)}\right]^{k-i}\right|_{x=x_0}
$$
如果有复根，我们知道它们一定是一对对的。容易证明在 $f$ 的系数是实数时，$(x-z_0)^{-i}$ 与 $(x-\overline{z_0})^{-i}$ 的系数是共轭的。&lt;/p&gt;
&lt;p&gt;对于 $i=1$ 的部分，积出
$$
\begin{align*}
&amp;amp;(c+\i d)\ln(x-a-\i b)+(c-\i d)\ln(x-a+\i b)\\
={}&amp;amp;(c+\i d)\left[\ln\sqrt{(x-a)^2+b^2}+\i\arg(x-a-\i b)\right]+(c-\i d)\left[\ln\sqrt{(x-a)^2+b^2}+\i\arg(x-a+\i b)\right]+C\\
={}&amp;amp;c\ln\left(x^2-2ax+a^2+b^2\right)+2d\arctan\frac{b}{x-a}+C
\end{align*}
$$
注意到 $\arctan t=\arctan(-1/t)+C$。&lt;/p&gt;
&lt;p&gt;对于 $i&amp;gt;1$ 的部分，就全是分式了
$$
\begin{align*}
&amp;amp;-\frac{1}{i-1}\left[\frac{c+\i d}{(x-a-\i b)^{i-1}}+\frac{c-\i d}{(x-a+\i b)^{i-1}}\right]\\
={}&amp;amp;-\frac{2}{(i-1)(x^2-2ax+a^2+b^2)^{i-1}}\left[c\sum_{j=0}^{\lceil i/2\rceil-1}\binom{i-1}{2j}(-1)^jb^{2j}(x-a)^{i-1-2j}-d\sum_{j=0}^{\lfloor i/2\rfloor-1}\binom{i-1}{2j+1}(-1)^jb^{2j+1}(x-a)^{i-2-2j}\right]
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\frac{\d x}{x^n+1}
$$&lt;/p&gt;
&lt;p&gt;直接部分分式分解。取 $\omega$ 为 $2n$ 次单位根 $\e^{\i\pi/n}$。
$$
\begin{align*}
&amp;amp;\int\frac{\d x}{x^n+1}\\
={}&amp;amp;\int\frac{\d x}{\displaystyle\prod_{k=0}^{n-1}\left(x-\omega^{2k+1}\right)}\\
={}&amp;amp;\int\d x\sum_{k=0}^{n-1}\frac{\displaystyle\lim_{x\to\omega^{2k+1}}\frac{x-\omega^{2k+1}}{x^n+1}}{x-\omega^{2k+1}}\\
\xlongequal{\rm l&amp;rsquo;H}{}&amp;amp;\int\d x\sum_{k=0}^{n-1}\frac{\displaystyle\frac{1}{n\omega^{(n-1)(2k+1)}}}{x-\omega^{2k+1}}\\
={}&amp;amp;-\frac1n\int\d x\sum_{k=0}^{n-1}\frac{\omega^{2k+1}}{x-\omega^{2k+1}}\\
={}&amp;amp;-\frac1n\sum_{k=0}^{n-1}\omega^{2k+1}\ln(x-\omega^{2k+1})+C\\
={}&amp;amp;-\frac1n\sum_{k=0}^{n-1}\left(\cos\frac{(2k+1)\pi}{n}+\i\sin\frac{(2k+1)\pi}{n}\right)\left(\ln\sqrt{x^2-2x\cos\frac{(2k+1)\pi}{n}+1}+\i\arg\left(x-\cos\frac{(2k+1)\pi}{n}-\i\sin\frac{(2k+1)\pi}{n}\right)\right)+C\\
={}&amp;amp;-\frac1n\sum_{k=0}^{n-1}\left[\frac12\cos\frac{(2k+1)\pi}{n}\ln\left(x^2-2x\cos\frac{(2k+1)\pi}{n}+1\right)+\sin\frac{(2k+1)\pi}{n}\arctan\frac{\displaystyle\cos\frac{(2k+1)\pi}{n}-x}{\displaystyle\sin\frac{(2k+1)\pi}{n}}\right]+C
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;二项式微分的积分（$m,n,p\in\mathbb Q$）
$$
\int x^m(a+bx^n)^p\d x
$$
有初等表示当且仅当 $p$、$(m+1)/n$、$p+(m+1)/n$ 中有一个是整数。&lt;/p&gt;
&lt;p&gt;$p$ 为负整数的情况，取 $l$ 为 $m$、$n$ 分母的 $\operatorname{lcm}$：
$$
\int x^m(a+bx^n)^p\d x\xlongequal{x=t^l}k\int t^{ml+k-1}(a+bt^{nl})^p\d t
$$
$(m+1)/n$ 为整数的情况：
$$
\int x^m(a+bx^n)^p\d x\xlongequal{t=a+bx^n}\frac1n\int t^p\left(\frac{t-a}{b}\right)^{\frac{m+1}{n}-1}\d t
$$
$p+(m+1)/n$ 为整数的情况：
$$
\int x^m(a+bx^n)^p\d x=\int x^{m+np}(ax^{-n}+b)^p\d x
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\frac{\d x}{\sqrt[n]{1+x^n}}
$$&lt;/p&gt;
&lt;p&gt;这个复合上面第三种形式，但是如果直接换元 $t^n=x^{-n}+1$，会要开 $n$ 次根导致一些正负号很烦的问题。所以这里有个换元（&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/a/306187&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;来源&lt;/a&gt;）：
$$
\int\frac{\d x}{\sqrt[n]{1+x^n}}\xlongequal[\d t=\frac{t-t^{n-1}}{x}\d x]{t=\frac{x}{\sqrt[n]{1+x^n}}}\int\frac{\d t}{1-t^n}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;复杂根分式积分：&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/559773120&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/559773120&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int\sqrt{\tan x}\d x
$$
直接换元，剩下的分式有比直接部分分式分解简单点的方法。
$$
\begin{align*}
\int\sqrt{\tan x}\d x
&amp;amp;\xlongequal{t=\sqrt{\tan x}}\int\frac{2t^2}{1+t^4}\d t\\
&amp;amp;=2\int\frac{\d t}{t^2+t^{-2}}\\
&amp;amp;=\int\frac{1-t^{-2}+1+t^{-2}}{t^2+t^{-2}}\d t\\
&amp;amp;=\int\frac{1-t^{-2}}{(t+t^{-1})^2-2}\d t+\int\frac{1+t^{-2}}{(t-t^{-1})^2+2}\d t\\
&amp;amp;\xlongequal[v=t-t^{-1}]{u=t+t^{-1}}\int\frac{\d u}{u^2-2}+\int\frac{\d v}{v^2+2}\\
&amp;amp;=\frac1{2\sqrt2}\ln\frac{u-\sqrt2}{u+\sqrt2}+\frac1{\sqrt2}\arctan\frac v{\sqrt2}+C\\
&amp;amp;=\frac1{2\sqrt2}\ln\frac{t^2-\sqrt2t+1}{t^2+\sqrt2t+1}+\frac1{\sqrt2}\arctan\frac{t^2-1}{\sqrt2t}+C\\
&amp;amp;=\frac1{2\sqrt2}\ln\frac{\tan x-\sqrt{2\tan x}+1}{\tan x+\sqrt{2\tan x}+1}+\frac1{\sqrt2}\arctan\frac{\tan x-1}{\sqrt{2\tan x}}+C
\end{align*}
$$
注意 $\sqrt{\sin x}$ 是积不了的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;定积分&#34;&gt;定积分
&lt;/h2&gt;&lt;p&gt;点火公式用的很多，这里先写一下。
$$
\int_0^{\pi/2}\sin^n x\d x=\left.-\sin^{n-1}x\cos x\right|_0^{\pi/2}+(n-1)\int_0^{\pi/2}\cos^2x\sin^{n-2}x\d x=(n-1)\int_0^{\pi/2}\sin^{n-2}x\d x-(n-1)\int_0^{\pi/2}\sin^nx\d x
$$
于是 $I_n=\frac{n-1}{n}I_{n-2}$，然后 $I_0=\pi/2$，$I_1=1$。$I_2=\frac12\frac\pi2=\frac\pi4$，$I_3=\frac23$，$I_4=\frac34\frac\pi4=\frac{3\pi}{16}$，$I_5=\frac45\frac23=\frac8{15}$。$I_{2n}=\frac{(2n-1)!!}{(2n)!!}\frac\pi2$，$I_{2n+1}=\frac{(2n)!!}{(2n+1)!!}$。同理可以得出
$$
\int_0^{\pi/2}\sin^nx\cos^mx\d x=\frac{(n-1)!!(m-1)!!}{(n+m)!!}\cdot\left\{\begin{aligned}&amp;amp;\frac\pi2,&amp;amp;2\mid n\land 2\mid m\\ &amp;amp;1,&amp;amp;\text{otherwise}\end{aligned}\right.
$$&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;定积分的基本性质：拼区间、反向、线性性、保序性。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;微积分基本定理。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;内容：
&lt;ol&gt;
&lt;li&gt;若被积函数可积，则积分上限函数连续。&lt;/li&gt;
&lt;li&gt;若被积函数连续，则积分上限函数可导且导数对应相等。于是就是原函数，从而原函数两点的差就是被积函数两点间的积分。&lt;/li&gt;
&lt;li&gt;若原函数的&lt;strong&gt;导数可积&lt;/strong&gt;，则原函数两点的差就是导数两点间的积分。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;注意：$\int_a^bf(x)\d x=F(b)-F(a)$ 仅在 $\forall x\in[a,b]$，$F^\prime(x)=f(x)$ 时可以用，但凡有一个间断点就不行。&lt;/li&gt;
&lt;li&gt;证明 1：考虑 $g(t)=\int_a^tf(x)\d x-(F(t)-F(a))$，这个函数连续（因为它可导且导数处处为零）。如果它不是处处为零，就能找到导数非零的点。&lt;br&gt;
证明 2：$F(b)-F(a)=\sum(F(x_i)-F(x_{i-1}))=\sum F^\prime(\xi_i)(x_i-x_{i-1})=S(F^\prime,P,\xi)\to\int_a^bF^\prime(x)\d x$。&lt;/li&gt;
&lt;li&gt;注意：积分上限函数的导数不一定是被积函数（可去间断点消失、跳跃间断点不可导、震荡间断点不确定）；&lt;strong&gt;一个函数的导数不一定可积&lt;/strong&gt;，反例：&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Volterra%27s_function&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://en.wikipedia.org/wiki/Volterra%27s_function&lt;/a&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;定积分换元，课内的使用条件是被积函数连续，换元函数的导数可积。如果换元函数的导数连续只需对换元前后的积分上限函数求导即可，如果导数不连续要一板一眼地用牛—莱证。课外（Kestelman）最松的条件是被积函数可积，换元函数是积分上限函数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;积分第一中值定理。使用条件：$f$ 在闭区间上连续，$g$（权重函数）可积且恒非负。$\xi$ 可以 $\in(a,b)$，需要讨论一下边界。&lt;/p&gt;
&lt;p&gt;记忆方法：
$$
\begin{align*}
&amp;amp;f(\xi)=\frac{\int_a^bf(x)g(x)\d x}{\int_a^bg(x)\d x}\\
&amp;amp;\frac{F^\prime(\xi)}{G^\prime(\xi)}=\frac{F(b)-F(a)}{G(b)-G(a)}\\
&amp;amp;F\leftrightarrow f\cdot g,\,G\leftrightarrow g
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;积分余项泰勒公式，证明思路反复分部积分。这里可以进行对比记忆：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;皮亚诺余项，只需单点 $n$ 阶可导，余项给得最不精确；&lt;/li&gt;
&lt;li&gt;拉格朗日余项，需要区间 $n+1$ 阶可导，余项给得精确些，但 $\xi$ 未知；&lt;/li&gt;
&lt;li&gt;积分余项，需要区间 $n+1$ 阶导数可积，给出确定可以计算的余项。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;积分余项与拉格朗日余项的关系可以根据积分中值定理得出：
$$
\int_{x_0}^x\frac{f^{(n+1)}(t)}{n!}(x-t)^n\d t=\frac{f^{(n+1)}(\xi)}{n!}\int_{x_0}^x(x-t)^n\d t=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
$$
关于这个有一个很有意思的关系，就是当你试图求一个函数的 $n$ 阶原函数时，你求的是
$$
\begin{align*}
F(x)&amp;amp;=\int_a^x\d x_1\left(\int_a^{x_1}\d x_2\left(\int_a^{x_2}\d x_3\left(\cdots\left(\int_a^{x_{n-1}}f(x_n)\d x_n+C_n\right)\cdots\right)+C_3\right)+C_2\right)+C_1\\
&amp;amp;=\int_a^x\d x_1\int_a^{x_1}\d x_2\int_a^{x_2}\d x_3\cdots\int_a^{x_{n-1}}f(x_n)\d x_n+C_n^\prime x^{n-1}+\cdots+C_3^\prime x^2+C_2^\prime x+C_1
\end{align*}
$$
而
$$
\begin{align*}
&amp;amp;\int_a^x\d x_1\int_a^{x_1}\d x_2\int_a^{x_2}\d x_3\cdots\int_a^{x_{n-2}}\d x_{n-1}\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;\left.\left(x_1\int_a^{x_1}\d x_2\int_a^{x_2}\d x_3\cdot\int_a^{x_{n-1}}f(x_n)\d x_n\right)\right|_a^x-\int_a^xx_1\d x_1\int_a^{x_1}\d x_3\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;\int_a^x(x-x_1)\d x_1\int_a^{x_1}\d x_3\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;{-\frac12}\int_a^x\d(x-x_1)^2\int_a^{x_1}\d x_3\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;{-\frac12}\left.\left[(x-x_1)^2\int_a^{x_1}\d x_3\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\right]\right|_a^x+\frac12\int_a^x(x-x_1)^2\d x_1\int_a^{x_1}\d x_4\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;\frac12\int_a^x(x-x_1)^2\d x_1\int_a^{x_1}\d x_4\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;{-\frac16}\int_a^x\d(x-x_1)^3\int_a^{x_1}\d x_4\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;\frac16\int_a^x(x-x_1)^3\d x_1\int_a^{x_1}\d x_5\cdots\int_a^{x_{n-1}}f(x_n)\d x_n\\
={}&amp;amp;\cdots\ \cdots\\
={}&amp;amp;\frac{1}{(n-1)!}\int_a^x(x-x_1)^{n-1}f(x_1)\d x_1
\end{align*}
$$
也就是说你得到了一个将 $n$ 个积分号缩成一个积分号的方法，而且为啥最后的结果跟柯西余项这么像呢？你考虑在 $x=a$ 处展开这个 $F$（忽略尾部多项式），你发现，刚好它 $0\sim n-1$ 阶导都是 $0$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;误差估计。对于取平均长的小段并进行左/右/中端高矩形、梯形、二次函数拟合的方法，分析误差的思路是泰勒展开。辛普森公式。推广情况：&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Newton%E2%80%93Cotes_formulas&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Newton-Cotes 公式&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cauchy-Schwartz 不等式。一个与用 $\Delta$ 等价的方法是，（配方）找到取最低点的 $t$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;定积分求面积。课上讲了一些和拓扑相关的简单东西，略。主要提两点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;将曲线（参数方程）分段成函数的方法：取所有竖切线。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参数方程定义的曲线（自然正向）的面积：
$$
S=-\int y\d x=\int x\d y=\frac12\int(x\d y-y\d x)=\frac12\int\b r\times\d\b r=\frac12\int r^2\d\theta
$$
前两个的思路就是用横/竖切线把区间分段函数化套用正常的定积分，叉乘这个相信会计算凸包面积的小朋友们一定不陌生。&lt;/p&gt;
&lt;p&gt;我们可以证明积分式与参数的选择、与坐标系的选择无关，即在平移、旋转变换下为不变量。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;定积分求长度啥的。就是说，你在近似 + 无限小划分的过程中，关键的一点是，你取的端点必须在线上，不然就会导致 $\sqrt 2=2$、$\pi=4$、球表面积算错等情况。至于勾股定理，实际上它是个公理。&lt;/p&gt;
&lt;p&gt;另外讲了个重参数化，大概就是将自变量从任意的 $t$ 变成弧长 $t^\prime=l$，让 $|\d\b x/\d t^\prime|=1$。这个鬼玩意可以用来&lt;em&gt;定义&lt;/em&gt;三角函数。于是现在我们有三种严格定义三角函数的方法：公理法、弧长法和无穷级数法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;曲线相关（拓展），细节太多了，略。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一些应用的公式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;曲率，弧长参数下表达式很简单，$\kappa(l)=|\widetilde{\b x}^{\prime\prime}(l)|$。一般参数可以通过链式求导法则：
$$
\widetilde{\b x}^{\prime\prime}(l)=[\b x(t)]^{\prime\prime}_l=[\b x^\prime(t)t^\prime(l)]^\prime_l=\left[\frac{\b x^\prime(t)}{|\b x^\prime(t)|}\right]^\prime_l=\frac{\b x^{\prime\prime}(t)}{|\b x^\prime(t)|^2}-\b x^\prime(t)\frac{[|\b x^\prime(t)|]^\prime}{|\b x^\prime(t)|^3}=\frac{\b x^{\prime\prime}(t)}{|\b x^\prime(t)|^2}-\b x^\prime(t)\frac{\b x^\prime(t)\cdot\b x^{\prime\prime}(t)}{|\b x^\prime(t)|^4}
$$
极坐标
$$
\kappa=\frac{\left\lvert 2{r^\prime}^2-rr^{\prime\prime}+r^2\right\rvert}{\left({r^\prime}^2+r^2\right)^{3/2}}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;弧长：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;正常函数
$$
\int\sqrt{1+\left(\frac{\d y}{\d x}\right)^2}\d x
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参数方程
$$
\int\sqrt{\left(\frac{\d x}{\d t}\right)^2+\left(\frac{\d y}{\d t}\right)^2}\d t
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;极坐标
$$
\int\sqrt{(\d r)^2+(r\d\theta)^2}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;旋转体体积（绕 $x$ 轴）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;正常函数
$$
\pi\int y^2\d x
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参数方程（自然正向，即使有凹陷也行）
$$
-\pi\int y^2\frac{\d x}{\d t}\d t=\pi\int x^2\frac{\d y}{\d t}\d t
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;极坐标
$$
\pi\int y^2\d x=\pi\int r^2\sin^2\theta(r\sin\theta\d\theta-\cos\theta\d r)
$$
或（考虑用球近似每一个 $\d\theta$ 对应的体积贡献）
$$
\int_0^{\pi}\int_0^r2\pi r\sin\theta\cdot r\d\theta\d r=\frac{2\pi}{3}\int r^3\sin\theta\d\theta
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;高维球的体积。设为 $V_n(r)=C_nr^n$。
$$
\begin{align*}
V_n(r)&amp;amp;=\int_{-\pi/2}^{\pi/2} V_{n-1}(r\cos\theta)\d(r\sin\theta)\\
&amp;amp;=C_{n-1}r^n\int_{-\pi/2}^{\pi/2}\cos^n\theta\d\theta\\
&amp;amp;=(2+[2\mid n](\pi-2))\frac{(n-1)!!}{n!!}C_{n-1}r^n\\
&amp;amp;=\frac{2^{\lceil n/2\rceil}\pi^{\lfloor n/2\rfloor}}{n!!}r^n
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;旋转体表面积（绕 $x$ 轴）（注意题目可能会要加上底面积！）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;正常函数
$$
2\pi\int y\sqrt{1+\left(\frac{\d y}{\d x}\right)^2}\d x
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参数方程
$$
2\pi\int y\sqrt{\left(\frac{\d x}{\d t}\right)^2+\left(\frac{\d y}{\d t}\right)^2}\d t
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;极坐标
$$
2\pi\int y\sqrt{(\d x)^2+(\d y)^2}=2\pi\int r\sin\theta\sqrt{(\d r)^2+(r\d\theta)^2}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pappus-Guldin 定理其实就是质心的定义。在线密度均匀时，质心为
$$
\overline{y}=\frac{\int y\d l}{\int\d l}
$$
而旋转体表面积为
$$
2\pi\int y\d l
$$
在面密度均匀时，质心的 $y$ 为
$$
\overline{y}=\frac{\int y^2/2\d x}{\int y\d x}
$$
而旋转体体积为
$$
\pi\int y^2\d x
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意一般而言，体积的导数不等于表面积，面积的导数不等于周长！&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;有空补一下 $2t/(1+t^2)$ 的换元。&lt;/p&gt;
&lt;h2 id=&#34;广义积分&#34;&gt;广义积分
&lt;/h2&gt;&lt;p&gt;分析敛散性的手段：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;所有一般的定积分可用的处理手段都可以，包括四则运算、换元、分部积分、牛—莱（注意是单侧极限）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;柯西&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;比较，两种用法&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;比较（极限形式）：$f=\Omicron(g)$，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;如果 $g$ 绝对收敛，则 $f$ 绝对收敛；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果 $g$ 条件收敛，则得不出任何结论，如果 $g$ 恒非负，那就回到上一条。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;反例：$\int_0^{+\infty}\frac{\sin x}{\sqrt x}\d x$ 根据狄收敛，但 $\int_0^{+\infty}\frac{\sin x}{\sqrt x+\sin x}\d x$ 不收敛。因为
$$
\frac{\sin x}{\sqrt x}-\frac{\sin x}{\sqrt{x}+\sin x}=\frac{\sin^2x}{x+\sqrt x\sin x}&amp;gt;\frac{\sin^2x}{2x}
$$
而后者发散。但是这两个东西在 $x\to+\infty$ 时是等价无穷小。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;狄利克雷：$f$ 的积分上限函数有界，$g$ &lt;strong&gt;单调&lt;/strong&gt;且 $\to 0$。如果不单调，反例就在楼上。证明（假定 $f$ 连续，$g$ 导数连续）：
$$
\int_a^{+\infty}f(x)g(x)\d x=\lim_{x\to+\infty}F(x)g(x)-F(a)g(a)-\int_a^{+\infty}F(x)g^\prime(x)\d x
$$
其中 $F(x)g(x)\to 0$，$\int_a^{+\infty}|F(x)g^\prime(x)|\d x\le M\int_a^{+\infty}|g^\prime(x)|\d x=Mg(a)$。&lt;/p&gt;
&lt;p&gt;一般的证明见理论基础。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;阿贝尔：$f$ 的积分收敛（更强），$g$ 单调且有界（更弱）。证明就直接把 $\lim g$ 拎出来就行。&lt;/p&gt;
&lt;p&gt;不单调的反例：$\int_0^{+\infty}\left(\frac{\sin x}{\sqrt x}\right)^2$，单个这个玩意既是 $\to 0$，又是积分收敛，但是 $\int_0^{+\infty}\frac{\sin^2x}{x}$ 用二倍角公式得是发散的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;注意：无穷限积分收敛并不代表被积函数趋近于 $0$。&lt;/p&gt;
&lt;p&gt;特定的例子：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\frac{\d x}{x^a\ln^bx}
$$&lt;/p&gt;
&lt;p&gt;首先注意一下定义域，下面就不提定义域的问题了。&lt;/p&gt;
&lt;p&gt;$x\to+\infty$：$a&amp;gt;1$ 时与 $x^{-(a+1)/2}$ 比较以去掉 $\ln$，收敛；$a&amp;lt;1$ 时与 $x^{-1}$ 比较，发散。&lt;/p&gt;
&lt;p&gt;$x\to 1$：比较去掉 $x^a$，比较把 $\ln^bx$ 变成 $(x-1)^b$。$b\ge 1$ 时发散，$b&amp;lt;1$ 时收敛。&lt;/p&gt;
&lt;p&gt;$x\to 0^+$：关键是 $\forall\epsilon&amp;gt;0$，$\lim_{x\to0^+}x^\epsilon\ln^bx=0$。$a&amp;lt;1$ 时与 $x^{-(a+1)/2}$ 比较，收敛；$a&amp;gt;1$ 时与 $x^{-1}$ 比较，发散。这种情况还可以换元 $1/x$ 归约到 $x\to+\infty$。&lt;/p&gt;
&lt;p&gt;$a=1$：换元，$b\ne 1$ 时不定积分为 $1/(b-1)\ln^{b-1}x$，$b&amp;gt;1$ 时 $x\to+\infty$ 和 $x\to 0^+$ 收敛，$x\to 1$ 发散；$b&amp;lt;1$ 时 $x\to 1$ 收敛，其余发散；$b=1$ 时是 $\ln|\ln x|$，全部发散。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;$a&amp;gt;1$&lt;/th&gt;
&lt;th&gt;$a=1,b&amp;gt;1$&lt;/th&gt;
&lt;th&gt;$a=1,b=1$&lt;/th&gt;
&lt;th&gt;$a=1,b&amp;lt;1$&lt;/th&gt;
&lt;th&gt;$a&amp;lt;1$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$x\to+\infty$&lt;/td&gt;
&lt;td&gt;收敛&lt;/td&gt;
&lt;td&gt;收敛&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$x\to1$&lt;/td&gt;
&lt;td&gt;$\rightarrow$&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;收敛&lt;/td&gt;
&lt;td&gt;$\leftarrow$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$x\to0^+$&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;收敛&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;发散&lt;/td&gt;
&lt;td&gt;收敛&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;记忆方法：$a=1$ 换元，$a\ne 1$ 时 $x$ 是主要项。
$$
\int_M^{+\infty}\frac{\d x}{x^a\cdot\ln^bx\cdot\ln^c\ln\ln x\cdot\ln^d\ln\ln\ln x\cdot\cdots}
$$
这样的情况就依次看，不断换元。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\frac{\sin x}{x^a}\d x
$$&lt;/p&gt;
&lt;p&gt;$x\to+\infty$：$a\le 0$ 用柯西，发散。$a&amp;gt;1$ 时放缩至 $x^{-a}$，绝对收敛；$0&amp;lt;a\le 1$ 时，
$$
\int_1^{+\infty}\frac{\sin x}{x^a}\d x=\left.-\frac{\cos x}{x^a}\right|_1^{+\infty}-a\int_1^{+\infty}\frac{\cos x}{x^{a+1}}\d x
$$
两项都收敛。但是
$$
\int_1^{+\infty}\left\lvert\frac{\sin x}{x^a}\right\rvert\d x\ge\int_1^{+\infty}\frac{\sin^2x}{x^a}\d x=\int_1^{+\infty}\frac{1-\cos 2x}{2x^a}\d x=\left.-\frac{1}{2(a-1)}\frac{1}{x^{a-1}}\right|_1^{+\infty}-\frac12\int_1^{+\infty}\frac{\cos 2x}{x^a}\d x
$$
前一项（$a=1$ 时是 $\ln$）发散，后一项收敛，所以不绝对收敛。&lt;strong&gt;注意在实际考试时为保险起见，无论是四则运算还是分部积分，最好用柯西收敛准则的方式去说明。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;另一种证明思路是直接用狄利克雷说明 $a&amp;gt;0$ 时相对收敛。如果对于 $a\le 0$ 收敛，那么由
$$
\int_1^{+\infty}\sin x\d x=\int_1^{+\infty}\frac{\sin x}{x^a}x^a\d x
$$
由阿贝尔知 $\sin x$ 的积分收敛，矛盾。说明 $a&amp;gt;0$ 时的绝对收敛性还有一种神奇的方法，考虑取 $|\sin x|$ 的平均值 $2/\pi$。由于
$$
\left\lvert\int_0^A(|\sin x|-2/\pi)\d x\right\rvert=\left\lvert\int_0^{A\bmod\pi}(|\sin x|-2/\pi)\d x\right\rvert&amp;lt;2
$$
故由狄利克雷，
$$
\int_1^{+\infty}\frac{|\sin x|-2/\pi}{x^a}\d x
$$
收敛。而 $\int_1^{+\infty}2\d x/\pi x^a$仅在 $a&amp;gt;1$ 时收敛。&lt;/p&gt;
&lt;p&gt;$x\to0^+$：$\sin x\sim x$，所以 $a\ge 2$ 时发散。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\frac{\ln(1+x)}{x^a}\d x
$$&lt;/p&gt;
&lt;p&gt;$x\to+\infty$：$a\le 1$ 时显然发散，$a&amp;gt;1$ 时与 $x^{-(1+a)/2}$ 比较，收敛。&lt;/p&gt;
&lt;p&gt;$x\to 0^+$：$\ln(1+x)\sim x$，$a\ge 2$ 时发散。&lt;/p&gt;
&lt;p&gt;因此 $a\in(1,2)$ 时收敛。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\frac{\sin x}{x^a+\sin x}\d x
$$&lt;/p&gt;
&lt;p&gt;$x\to+\infty$：$a&amp;lt;0$ 时有无穷个间断点，但由于 $x^a$ 不是主项，故直接用柯即可，发散。$a=0$ 同。$a&amp;gt;0$ 时考虑依赖已知的结果：
$$
\frac{\sin x}{x^a+\sin x}=\frac{\sin x}{x^a}-\frac{\sin^2x}{x^a(x^a+\sin x)}
$$
由于后面一项恒非负，故可以用比较的极限形式，$\sim \sin^2x/x^{2a}$。根据之前的分析，$a\le 1/2$ 时发散，$a&amp;gt;1/2$ 时收敛。&lt;/p&gt;
&lt;p&gt;因此 $a&amp;gt;1$ 时绝对收敛，$1/2&amp;lt;a\le 1$ 是前一项相对收敛，后一项绝对收敛，所以是相对收敛；$0&amp;lt;a\le 1/2$ 时前一项相对收敛，后一项发散，所以是发散；$a\le 0$ 时发散。&lt;/p&gt;
&lt;p&gt;$x\to 0^+$：$a&amp;gt;1$ 时 $\to 1$，$a=1$ 时 $\to1/2$，$a&amp;lt;1$ 时 $\to 0$，故不用管。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;超纲不定积分无初等表示积分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}x^{a-1}\e^{-x}\d x
$$&lt;/p&gt;
&lt;p&gt;$x\to+\infty$：与 $-\e^{x/2}$ 比较，去掉 $x^{a-1}$，收敛。$x\to 0$：$a\le0$ 时发散。&lt;/p&gt;
&lt;p&gt;$\Gamma$ 函数。递推公式：
$$
\Gamma(n)=\int_0^{+\infty}x^{n-1}\e^{-x}\d x=\left.-x^{n-1}\e^{-x}\right|_0^{+\infty}+(n-1)\int_0^{+\infty}x^{n-2}\e^{-x}\d x=(n-1)\Gamma(n-1)
$$
余元公式：$\frac{1}{\Gamma(n)\Gamma(1-n)}=\frac{\sin\pi n}{\pi}$。证明思路：写成 $\Beta$ 函数后级数展开。&lt;/p&gt;
&lt;p&gt;推论：$\Gamma\big(\frac12\big)=\sqrt\pi$，也可以用高斯积分得到。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^1x^{a-1}(1-x)^{b-1}\d x
$$&lt;/p&gt;
&lt;p&gt;$x\to1^-$：$b\le 0$ 时发散。$x\to0^+$：$a\le 0$ 时发散。&lt;/p&gt;
&lt;p&gt;$\Beta$ 函数。递推公式：$\Beta(n,m)=\frac{m-1}{n+m-1}\Beta(n,m-1)$。&lt;/p&gt;
&lt;p&gt;与 $\Gamma$ 函数的关系：$\Beta(n,m)=\frac{\Gamma(n)\Gamma(m)}{\Gamma(n+m)}$。证明思路：二重积分的换元。&lt;/p&gt;
&lt;p&gt;与三角函数的关系：
$$
\begin{align*}
\int_0^{\pi/2}\sin^nx\cos^mx\d x&amp;amp;\xlongequal{t=\sin^2x}\int_0^1\frac{t^{n/2}(1-t)^{m/2}}{2\sin x\cos x}\d t\\
&amp;amp;=\frac12\int_0^1t^{(n-1)/2}(1-t)^{(m-1)/2}\d t\\
&amp;amp;=\frac12\Beta\left(\frac{n+1}2,\frac{m+1}2\right)
\end{align*}
$$
所以我们又得到了一种神秘的说明 $\Gamma(1/2)=\sqrt{\pi/2}$ 的方法。&lt;/p&gt;
&lt;p&gt;一个奇妙的关系：
$$
\begin{align*}
\int_0^{+\infty}\frac{\d x}{1+x^n}&amp;amp;\xlongequal{t=x^n}\frac1n\int_0^{+\infty}\frac{\d t}{t^{1-\frac1n}(1+t)}\\
&amp;amp;\xlongequal{u=\frac1{1+t}}\frac1n\int_0^1u^{-\frac1n}(1-u)^{\frac1n-1}\d u\\
&amp;amp;=\frac1n\Beta\left(1-\frac1n,\frac1n\right)\\
&amp;amp;=\frac1n\Gamma\left(1-\frac1n\right)\Gamma\left(\frac1n\right)\\
&amp;amp;=\frac{\pi}{n\sin\pi n}
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\frac{\sin x}x\d x
$$&lt;/p&gt;
&lt;p&gt;Dirichlet 积分，用费曼积分法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\sin x^2\d x
$$&lt;/p&gt;
&lt;p&gt;Fresnel 积分。收敛：换元 $t=x^2$ 变成 $\sin t/2\sqrt t$，套上面的。求的话要 Laplace 变换或转极坐标或留数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\e^{-x^2}\d x
$$&lt;/p&gt;
&lt;p&gt;Gauss 积分。收敛：同样换元。求可以用极坐标或其他二重积分方法。wxf 写了个不超纲的，借助点火公式的复杂方法，非常牛。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不超纲不定积分无初等表示积分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{+\infty}\frac{f(ax)-f(bx)}{x}\d x
$$&lt;/p&gt;
&lt;p&gt;Froullani 积分（$f$ 连续），考虑拆开定义证。
$$
\begin{align*}
&amp;amp;\int_0^{+\infty}\frac{f(ax)-f(bx)}x\d x\\
={}&amp;amp;\lim_{l\to 0}\lim_{r\to+\infty}\int_l^r\frac{f(ax)-f(bx)}x\d x\\
={}&amp;amp;\lim_{l\to 0}\lim_{r\to+\infty}\left(\int_l^r\frac{f(ax)}x\d x-\int_l^r\frac{f(bx)}x\d x\right)\\
={}&amp;amp;\lim_{l\to 0}\lim_{r\to+\infty}\left(\int_{la}^{ra}\frac{f(t)}t\d t-\int_{lb}^{rb}\frac{f(t)}t\d t\right)\\
={}&amp;amp;\lim_{l\to 0}\lim_{r\to+\infty}\left(\int_{la}^{lb}\frac{f(t)}t\d t-\int_{ra}^{rb}\frac{f(t)}t\d t\right)\\
={}&amp;amp;\lim_{l\to 0}\lim_{r\to+\infty}\left(f(\xi_l)\ln\frac ba-f(\xi_r)\ln\frac ba\right)\\
={}&amp;amp;\left(\lim_{x\to0^+}f(x)-\lim_{x\to+\infty}f(x)\right)\ln\frac ba
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^{\pi/2}\ln\sin x\d x
$$&lt;/p&gt;
&lt;p&gt;区间再现法的例题
$$
\begin{align*}
\int_0^{\pi/2}\ln\sin x\d x&amp;amp;=\int_0^{\pi/2}\ln\cos x\d x\\
&amp;amp;=\frac12\left(\int_0^{\pi/2}\ln(\sin x\cos x)\d x\right)\\
&amp;amp;=\frac12\left(\int_0^{\pi/2}(\ln\sin 2x-\ln 2)\d x\right)\\
&amp;amp;=\frac14\int_0^\pi\ln\sin t\d t-\frac{\pi\ln2}4\\
&amp;amp;=\frac12\int_0^{\pi/2}\ln\sin t\d t-\frac{\pi\ln2}4\\
\Longrightarrow\int_0^{\pi/2}\ln\sin x\d x&amp;amp;=-\frac{\pi\ln2}2
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^1\frac{\ln(1+x)}{1+x^2}\d x
$$&lt;/p&gt;
&lt;p&gt;神秘的区间再现法
$$
\begin{align*}
\int_0^1\frac{\ln(1+x)}{1+x^2}\d x&amp;amp;=\left.\ln(1+x)\arctan x\right|_0^1-\int_0^1\frac{\arctan x}{1+x}\d x\\
&amp;amp;\xlongequal{x=\tan t}\frac{\pi\ln 2}4-\int_0^{\pi/4}\frac{t}{1+\tan t}\sec^2 t\d t\\
I=\int_0^{\pi/4}\frac{t}{1+\tan t}\sec^2 t\d t&amp;amp;=\int_0^{\pi/4}\frac{t\d t}{(\sin t+\cos t)\cos t}\\
&amp;amp;=\int_0^{\pi/4}\frac{t\d t}{\sqrt2\sin(t+\pi/4)\cos t}\\
&amp;amp;\xlongequal{u=\pi/4-t}\int_0^{\pi/4}\frac{(\pi/4-u)\d u}{\sqrt2\cos u\cos(\pi/4-u)}\\
&amp;amp;=\frac\pi4\int_0^{\pi/4}\frac{\sec^2u\d u}{1+\tan u}-I\\
&amp;amp;=\frac{\pi\ln2}4-I\\
&amp;amp;=\frac{\pi\ln2}8
\end{align*}
$$
神秘的换元法 from &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/512255255/answer/2355309447&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/512255255/answer/2355309447&lt;/a&gt;：$x=\frac{1-t}{1+t}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^\pi\frac{x\sin x}{1+\cos^2x}\d x
$$&lt;/p&gt;
&lt;p&gt;无聊的区间再现法，答案是 $\pi^2/4$。感兴趣可以看&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/100951677&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这个&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
\int_0^\pi\frac{\sin nx}{\sin x}\d x
$$&lt;/p&gt;
&lt;p&gt;赖皮方法：三角函数展开成 $\e$。正常方法：
$$
\begin{align*}
I_n=\int_0^\pi\frac{\sin nx}{\sin x}\d x&amp;amp;=\int_0^\pi\frac{\sin(n-1)x\cos x+\sin x\cos(n-1)x}{\sin x}\d x\\
&amp;amp;=\int_0^\pi\frac{\sin nx+\sin(n-2)x}{2\sin x}\d x\\
&amp;amp;=\frac12\left(I_n+I_{n-2}\right)\\
&amp;amp;=I_{n-2}\\
&amp;amp;=(n\bmod 2)\pi
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;微分方程&#34;&gt;微分方程
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;如果遇到没法用下面方法解的微分方程，尝试两边同时求导！如果带积分还可以设 $g(x)=\int_0^xf(t)\d t$ 这种。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$y^\prime=f(x)$。最基本，直接不定积分。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$y^\prime=f(y)$。将 $x$ 和 $y$ 的地位互换，得到 $x^\prime_y=1/f(y)$，归为 1。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$y^\prime=f(x)g(y)$。分离变量型，把 $g$ 除过去，两边积分。这应该是唯一一个不能归约基本型的方程，几何意义也不是特别容易理解，硬要理解可以用下面这种方法：&lt;/p&gt;
&lt;p&gt;考虑 $f(x,y)\d x+g(x,y)\d y=0$ 形式的微分方程，它的解是以 $(f,g)$ 为梯度场的二元函数的等高线。设原函数为 $\varphi(x,y)$，那么要求
$$
\varphi(x,y)=\int f(x,y)\d x+C_y(y)=\int g(x,y)\d y+C_x(x)
$$
这个连等要求了一个事，就是 $\int f(x,y)\d x-\int g(x,y)\d y$ 中不能有同时跟 $x$ 和 $y$ 有关的项，也就是
$$
\frac{\partial f}{\partial y}=\frac{\partial g}{\partial x}
$$
解为
$$
\int f(x,y)\d x+\int\left(g(x,y)-\frac{\partial}{\partial y}\int f(x,y)\d x\right)\d y=0
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$y^\prime=f(y/x)$。这说明 $x$ 和 $y$ 的同步伸缩不改变向量场。而 1 容易解是因为 $y$ 的上下移动不改变向量场，也就是走向只与 $x$ 有关。如果能把这个方程的伸缩不变性也变成 1 中的这个性质就好做的。所以可以换元$p=y/x$，$z=\ln|x|$，得到 $z^\prime_p=\frac{1}{f(p)-p}$，或者换元 $x=\e^{u}\cos\theta$，$y=\e^u\sin\theta$，得到
$$
\frac{u^\prime_\theta\tan\theta+1}{u^\prime_\theta-\tan\theta}=f(\tan\theta)\Longleftrightarrow u^\prime_\theta=\frac{f(\tan\theta)\tan\theta+1}{f(\tan\theta)-\tan\theta}
$$
为什么要换 $\ln$ 不直接换 $r$ 或 $x$？因为要求换元后是平移不变，而如果直接用 $(r,\theta)$ 去表示的话，其实是不满足的——因为在用极坐标表示位置的同时，也要用它表示向量场，而极坐标的切向基向量（未经单位化）$\b e_\theta=r\b{\hat\theta}$ 它的长度不是 $1$，就会导致原来看起来相等的向量在极坐标里不等。而如果改成换 $u=\ln r$ 的话，就利用对数把伸缩变成了平移，$\b e_\theta=\e^u\b{\hat\theta}$，而 $\b e_u=\e^u\b{\hat u}$，向量场在 $u$ 平移是两维同时伸缩的，由于我们只关心方向，故相当于不变。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
y^\prime=f\left(\frac{a_1x+b_1y+c_1}{a_2x+b_2y+c_2}\right)
$$&lt;/p&gt;
&lt;p&gt;分平行和非平行考虑。平行换元分母转分离变量，非平行平移交点到原点后变为齐次。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;不含 $y$ 和不含 $x$，两种降阶方法。核心思想是增加未知函数，增加方程数，减少求导阶数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$y^\prime=a(x)y+f(x)$。非齐次一阶，用常数变易法：先求出无 $f(x)$ 时的解 $y=\e^{\int a(x)\d x}$，然后设解为 $y=C(x)\e^{\int a(x)\d x}$（由于 $\e^*$ 恒非零故不会漏解），展开得 $C(x)=\int f(x)\e^{-\int a(x)\d x}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\b y^\prime=A\b y$。常系数一阶线性方程组。求出 $A$ 的 Jordan 标准型 $P^{-1}AP=J$，方程变为 $\b y^\prime=PJP^{-1}\b y$ 即 $(P^{-1}\b y)^\prime=J(P^{-1}\b y)$，然后直接解，再乘回来。对于可对角化的情况，有一个很优美的写法：
$$
\b y=P\mat{C_1\e^{\lambda_1x}\\ \vdots\\ C_n\e^{\lambda_nx}}=\sum_{i=1}^nC_iv_i\e^{\lambda_ix}=\mat{\e^{\lambda_1x}&amp;amp;\cdots&amp;amp;0\\ \vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;\cdots&amp;amp;\e^{\lambda_nx}}\b y(0)=\e^\Lambda\b y(0)
$$
对于 Jordan 块
$$
\b u^\prime=\mat{\lambda&amp;amp;1&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ 0&amp;amp;\lambda&amp;amp;1&amp;amp;\cdots&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;1\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda}_{k\times k}\b u
$$
容易解得
$$
\b u=\mat{(C_kx^{k-1}+\cdots+C_1)\e^{\lambda x}\\ (C_kx^{k-2}+\cdots+C_2)\e^{\lambda x}\\ \vdots\\ (C_kx+C_{k-1})\e^{\lambda x}\\ C_k\e^{\lambda x}}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
y^{(n)}+\sum_{i=0}^{n-1}a_iy^{(i)}=0
$$
常系数高阶线性。核心思想是导数也是线性变换。求出左边对应多项式的根 $\lambda_1\sim\lambda_n$。于是整个可以写成
$$
\left[\prod_{i=1}^n\left(\frac{\d}{\d x}-\lambda_i\right)\right]y=0
$$
于是可以逐一求解。实际上不用暴力求——如果去重后根为 $\lambda_1\sim\lambda_k$ 且重数分别为 $m_1\sim m_k$，容易代入验证 $y$ 可以写成以下函数的线性组合：
$$
\e^{\lambda_1},x\e^{\lambda_1},\cdots,x^{m_1-1}\e^{\lambda_1},\cdots
$$
对于有非齐次项的情况，可以用常数变易法，更一般的方法见后。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
x^ny^{(n)}+\sum_{i=0}^{n-1}a_ix^iy^{(i)}=0
$$
Euler 方程。同样可以待定系数
$$
\left[\prod_{i=1}^n\left(\frac{x\d}{\d x}-\lambda_i\right)\right]y=0
$$
然后暴解。注意到 $x\d/\d x=\d/\d\ln|x|$，于是考虑直接把自变量换成 $t=\ln|x|$。于是
$$
\frac{x^i\d^i}{\d x^i}=\frac{x\d}{\d x}\left(\frac{x^{i-1}\d^{i-1}}{\d x^{i-1}}\right)-(i-1)\frac{x^{i-1}\d^{i-1}}{\d x^{i-1}}=\cdots=\prod_{j=0}^{i-1}\left(\frac{\d}{\d t}-j\right)
$$
于是原方程变为上一种类型
$$
\sum_{j=0}^ny^{(j)}_t\sum_{i=j}^n(-1)^{i-j}\begin{bmatrix}i\\ j\end{bmatrix}a_i=0
$$
其中 $\begin{bmatrix}i\\ j\end{bmatrix}$ 是第一类斯特林数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一些特殊的因式分解。例如：
$$
x\frac{\d^2}{\d x^2}-(x+1)\frac{\d}{\d x}+1=\left(x\frac{\d}{\d x}-1\right)\left(\frac{\d}{\d x}-1\right)
$$&lt;/p&gt;
&lt;p&gt;$$
x(x+1)\frac{\d^2}{\d x^2}-(4x+2)\frac{\d}{\d x}+6=\left(x\frac{\d}{\d x}-2\right)\left((x+1)\frac{\d}{\d x}-3\right)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
y^{(n)}+\sum_{i=0}^{n-1}a_i(x)y^{(i)}=f(x)
$$&lt;/p&gt;
&lt;p&gt;高阶非齐次线性。我们写成矩阵的形式：
$$
\mat{y\\ y^\prime\\ \vdots\\ y^{(n-1)}}^\prime=\mat{0&amp;amp;1&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1\\ -a_0(x)&amp;amp;-a_1(x)&amp;amp;-a_2(x)&amp;amp;\cdots&amp;amp;-a_{n-2}(x)&amp;amp;-a_{n-1}(x)}\mat{y\\ y^\prime\\ \vdots\\ y^{(n-1)}}+\mat{0\\ 0\\ \vdots\\ f(x)}
$$&lt;/p&gt;
&lt;p&gt;$$
\b y^\prime=A\b y+\b f
$$&lt;/p&gt;
&lt;p&gt;假设在齐次的情况下，解得了 $n$ 个线性无关解 $y_1,\cdots,y_n$，把它们的 $0\sim n-1$ 阶导写成列向量，排起来成为 $U_{n\times n}$。使用常数变易法，考虑
$$
\b C=\mat{C_1(x)\\ C_2(x)\\ \vdots\\ C_n(x)},\;\b y=U\b C
$$
那么
$$
U^\prime\b C+U\b C^\prime=\b y^\prime=A\b y+\b f
$$
而
$$
U^\prime\b C=AU\b C=A\b y
$$
因此要解的就是
$$
U\b C^\prime=\b f\Longrightarrow\b C=\int U^{-1}\b f\d x
$$
以 $n=2$ 为例，最后要解的就是
$$
\left\{\begin{aligned}
y_1C_1^\prime(x)+y_2C_2^\prime(x)&amp;amp;=0\\
y_1^\prime C_1^\prime(x)+y_2^\prime C_2^\prime(x)&amp;amp;=f(x)
\end{aligned}\right.
$$
这个矩阵方法很自然地加入了额外的 $n-1$ 条限制，其本质是在设 $\b y=U\b C$ 时默认了通解 $y$ 的高阶导由基础解系线性组合的系数与零阶组合的系数相同。这个其实是“冒险”的，但下面对解的性质的分析保证了这个是对的。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;如果方程有个两个解 $\b y_1$，$\b y_2$，$\b y_1|_{x=x_0}=\b y_2|_{x=x_0}$，则 $\b y_1=\b y_2$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证：$\b y_1-\b y_2$ 是 $\b y^\prime=A\b y$ 的解，从而可以写成 $U\b C$ 的形式，其中 $\b C$ 与 $x$ 无关。而 $(U\b C)|_{x=x_0}=\b 0$，从而 $\b C=U^{-1}|_{x=x_0}\b 0=\b 0$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;当我们说“$n$ 个线性无关的解”时，我们不需要明确是在哪个 $x$ 处线性无关。$\set{\b y_1,\cdots,\b y_n}$ 线性无关，当且仅当对于某个 $x_0$，这组函数向量在 $x_0$ 处的实数向量线性无关。&lt;/p&gt;
&lt;p&gt;引理（Liouville）：对于齐次情况（不要求 $\b y_i$ 形如一个 $y$ 的 $0\sim n-1$ 阶导），$\dat{U}^\prime=\tr A\dat{U}$。$\dat{U}$ 称为 $n$ 个解的 Wronsky 行列式。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证：根据乘积的导数 → $\b y$ 满足的等式 → 行列式的性质，（$y_{j,k}$ 表示第 $j$ 个解的第 $k$ 项）
$$
\dat{U}^\prime=\sum_{r=1}^n\dat{\Set{y_{j,i}^{([i=r])}}_{n\times n}}=\sum_{r=1}^n\dat{\Set{\begin{cases}y_{j,i},&amp;amp;i\ne r\\ \sum_{k=1}^nA_{i,k}y_{j,k},&amp;amp;i=r\end{cases}}_{n\times n}}=\sum_{r=1}^nA_{r,r}\dat{U}=\tr A\dat{U}
$$
而 $\dat{U}^\prime=\tr A\dat{U}$ 是一个一阶齐次线性的方程，直接解得 $\dat{U}=\e^{\int\tr A\d x}$，代入初始条件得 $\dat{U}=\dat{U}|_{x=x_0}\e^{\int_{x_0}^x\tr A|_{x=t}\d t}$。由于 $\e^*$ 恒正，故只要某个 $x_0$ 处线性无关，就处处线性无关。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;当 $A$ 的各项都是连续函数时，$\b y^\prime=A\b y$ 对于任何初始条件都存在解。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证明见理论基础（咕）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
y^{\prime\prime}+a_1(x)y^\prime+a_0(x)y=0
$$&lt;/p&gt;
&lt;p&gt;假定已经知道了一个解 $y_1$，求另一个线性无关的解 $y_2$。设 $y_2=C(x)y_1$。代入可得：
$$
C^\prime(x)=\frac{C}{y_1^2\e^{\int_{x_0}^xa_1(t)\d t}}
$$
再积回去即可，取 $C\ne 0$ 容易验证可以得到一个线性无关的解。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$$
y^\prime+a(x)y=b(x)y^n\;(n\ne 0,1)
$$&lt;/p&gt;
&lt;p&gt;Bernoulli 方程。换元 $z=y^{1-n}$，等式两边同除以 $y^n$：
$$
\frac{y^\prime}{y^n}+\frac{a(x)}{y^{n-1}}=b(x)\Longleftrightarrow\frac{z^\prime}{1-n}+a(x)z=b(x)
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;杂题&#34;&gt;杂题
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;证明 $\R$ 是唯一的完备序域。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;答案见理论基础。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lagrange 恒等式的几何意义？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;能否构造在 $\Q$ 处间断，$\R\setminus\Q$ 处连续的单增函数？能否构造在 $\Q$ 处连续，$\R\setminus\Q$ 处间断的单增函数？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;如果不要求单增，那就用黎曼函数。要求单增也不难，构造奇函数 $f$：
$$
f(x&amp;gt;0)=\sum_{0&amp;lt;p/q\le x}2^{-q}
$$
容易知道这玩意是收敛的，但是我们发现一个新的有趣的问题：求
$$
\sum_{i\ge 1}\mu(i)2^{-i}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;不能。增函数的间断点都是跳跃间断点，这个跳跃处一定包含有理数，因此间断点是至多可数的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;证明 $\N$ 和 $\R$、$\N$ 和 $\mathcal{P}(\N)$ 不等势。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;对角线法；或考虑 $\set{i\mid i\notin A_i}$，这个集合不能是某个 $A_j$，否则 $j$ 既不能 $\in A_j$，又不能 $\notin A_j$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;证明 Stolz 定理：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\set{b_n}$ 严增，$\lim b_n=+\infty$，$\lim\Delta a_n/\Delta b_n\in\R\cup\set{\pm\infty}$，则 $\lim a_n/b_n=\lim\Delta a_n/\Delta b_n$。&lt;/li&gt;
&lt;li&gt;$\set{b_n}$ 严降，$\lim b_n=\lim a_n=0$，$\lim\Delta a_n/\Delta b_n\in\R\cup\set{\pm\infty}$，则 $\lim a_n/b_n=\lim\Delta a_n/\Delta b_n$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;设 $\lim\Delta a_n/\Delta b_n=L$，$\forall\varepsilon&amp;gt;0$，$\exists N$，$\forall n&amp;gt;N$，
$$
(L-\varepsilon)(b_{n+1}-b_n)&amp;lt;a_{n+1}-a_n&amp;lt;(L+\varepsilon)(b_{n+1}-b_n)
$$
于是
$$
(L-\varepsilon)(b_{n+1}-b_{N+1})&amp;lt;a_{n+1}-a_{N+1}&amp;lt;(L+\varepsilon)(b_{n+1}-b_{N+1})
$$
即（容易取到 $b$ 为正）
$$
\left\lvert\frac{a_{n+1}}{b_{n+1}}-\frac{a_{N+1}}{b_{n+1}}-L+L\frac{b_{N+1}}{b_{n+1}}\right\rvert&amp;lt;\left(1-\frac{b_{N+1}}{b_{n+1}}\right)\varepsilon&amp;lt;\varepsilon
$$
取足够大的 $n$，即可
$$
\left\lvert\frac{a_{n+1}}{b_{n+1}}-L\right\rvert\le\left\lvert\frac{a_{n+1}}{b_{n+1}}-\frac{a_{N+1}}{b_{n+1}}-L+L\frac{b_{N+1}}{b_{n+1}}\right\rvert+\left\lvert\frac{a_{N+1}}{b_{n+1}}-L\frac{b_{N+1}}{b_{n+1}}\right\rvert&amp;lt;2\varepsilon
$$
Remark. 这里主要是考虑去除 $a_N$ 和 $b_N$ 的“垃圾”影响。如果硬处理的话，可以直接比对已知不等式和目标不等式，硬解出 $n$ 的范围，但这样会麻烦。这个证法主要是通过保留 $1-b_{N+1}/b_{n+1}$ 因子的方式，减少了讨论的复杂程度。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设 $\lim\Delta a_n/\Delta b_n=L$，$\forall\varepsilon&amp;gt;0$，$\exists N$，$\forall n&amp;gt;N$，
$$
(L-\varepsilon)(b_{n+1}-b_n)&amp;lt;a_{n+1}-a_n&amp;lt;(L+\varepsilon)(b_{n+1}-b_n)
$$
于是 $\forall n^\prime &amp;gt;n$，
$$
(L-\varepsilon)(b_{n^\prime+1}-b_n)&amp;lt;a_{n^\prime+1}-a_n&amp;lt;(L+\varepsilon)(b_{n^\prime+1}-b_n)
$$
即
$$
\left\lvert\frac{a_n}{b_n}-\frac{a_{n^\prime+1}}{b_n}-L+L\frac{b_{n^\prime+1}}{b_n}\right\rvert&amp;lt;\left(1-\frac{b_{n^\prime+1}}{b_n}\right)\varepsilon&amp;lt;\varepsilon
$$
取足够大的 $n^\prime$，即可
$$
\left\lvert\frac{a_n}{b_n}-L\right\rvert\le\left\lvert\frac{a_n}{b_n}-\frac{a_{n^\prime+1}}{b_n}-L+L\frac{b_{n^\prime+1}}{b_n}\right\rvert+\left\lvert\frac{a_{n^\prime+1}}{b_n}-L\frac{b_{n^\prime+1}}{b_n}\right\rvert&amp;lt;2\varepsilon
$$
Remark. 这种情况奇怪的点在于，不能扔前缀的部分了，因为越前反而越大。所以要找到影响够小的部分，只能到后面去找，再减回来。洛必达法则的 $0/0$ 形式的思路也是类似。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;$$
\lim_{n\to\infty}\frac{n^k}{a^n}
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;解 1：
$$
*=\lim_{n\to\infty}\left(\frac{n}{a^{n/k}}\right)^k=k^k\left(\lim_{t\to\infty}\frac{t}{a^t}\right)^k=0
$$
因为
$$
\frac{t}{a^t}=\frac{t}{(1+a-1)^t}\le\frac{t}{\binom t2(a-1)^2}=\frac{2}{(t-1)(a-1)^2}\to 0
$$
解 2：当 $n&amp;gt;1/(1-a^{-1/k})$ 时，
$$
\frac{n^k/a^n}{(n+1)^k/a^{n+1}}=a\left(1-\frac1{n+1}\right)^k&amp;gt;1
$$
即递减，故极限存在。对
$$
\frac{n^k}{a^n}=a\left(\frac{n}{n+1}\right)^k\frac{(n+1)^k}{a^{n+1}}
$$
两边取极限得
$$
\lim_{n\to\infty}\frac{n^k}{a^n}=a\lim_{n\to\infty}\frac{n^k}{a^n}\Longrightarrow\lim_{n\to\infty}\frac{n^k}{a^n}=0
$$
解 3：取对数硬证。&lt;/p&gt;
&lt;p&gt;解 4：用 Stolz 定理 + 归纳证。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不用洛必达，证明
$$
\lim_{x\to0^+}x\ln x=0
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\lim_{x\to 0^+}x\ln x=\lim_{x\to 0^+}\e^{\ln x}\ln x\xlongequal{y=-\ln x}-\lim_{y\to+\infty}\frac{y}{\e^y}=0
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$$
\lim_{x\to 0}\frac{(1+nx)^{1/m}-(1+mx)^{1/n}}{x}
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\begin{align*}
&amp;amp;\lim_{x\to 0}\frac{(1+nx)^{1/m}-(1+mx)^{1/n}}{x}\\
={}&amp;amp;\lim_{x\to 0}\frac{(1+nx)^{1/m}-1}{x}-\lim_{x\to 0}\frac{(1+mx)^{1/n}-1}{x}\\
\xlongequal{t=(1+nx)^{1/m},u=(1+mx)^{1/n}}{}&amp;amp;\lim_{t\to 1}\frac{n(t-1)}{t^m-1}-\lim_{u\to 1}\frac{m(u-1)}{u^n-1}\\
={}&amp;amp;\lim_{t\to 1}\frac{n}{t^{m-1}+\cdots+1}-\lim_{u\to 1}\frac{m}{u^{n-1}+\cdots+1}\\
={}&amp;amp;\frac{n}{m}-\frac{m}{n}
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;另一种麻烦些的处理方法是考虑
$$
\begin{align*}
&amp;amp;\lim_{x\to 0}\frac{(1+x)^p-1}{x}\\
={}&amp;amp;\lim_{x\to 0}\frac{\e^{p\ln(1+x)}-1}{x}\\
={}&amp;amp;\lim_{x\to 0}\frac{\e^{p\ln(1+x)}-1}{\ln(1+x)}\\
\xlongequal{t=p\ln(1+x)}{}&amp;amp;p\lim_{t\to 0}\frac{\e^t-1}{t}\\
\xlongequal{u=\e^t-1}{}&amp;amp;p\lim_{u\to 0}\frac{u}{\ln(1+u)}\\
={}&amp;amp;p
\end{align*}
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$\e$ 相关：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;证明 $(1+1/n)^n$ 单增且有界，$(1+1/n)^{n+1}$ 单减且有界，从而两者极限存在且相等。&lt;/li&gt;
&lt;li&gt;证明 $(1+1/x)^x$ 在 $\R^\pm$ 上分别单增，$\lim_{x\to\infty}(1+1/x)^x=\e$。&lt;/li&gt;
&lt;li&gt;证明 $\sum_{i=0}^{+\infty}1/i!=\e$。&lt;/li&gt;
&lt;li&gt;证明 $\e\notin\Q$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;证 1（比值比较法）：
$$
\begin{align*}
&amp;amp;\frac{\left(1+\frac1{n+1}\right)^{n+1}}{\left(1+\frac1n\right)^n}\\
={}&amp;amp;\left(\frac{1+\frac1{n+1}}{1+\frac1n}\right)^n\frac{n+2}{n+1}\\
={}&amp;amp;\left(1-\frac{1}{(n+1)^2}\right)^n\frac{n+2}{n+1}\\
&amp;gt;{}&amp;amp;\left(1-\frac{n}{(n+1)^2}\right)\frac{n+2}{n+1}\\
={}&amp;amp;\frac{n^3+3n^2+3n+2}{n^3+3n^2+3n+1}\\
&amp;gt;{}&amp;amp;1
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;其中第一个 $&amp;gt;$ 是（归纳法可以证的）伯努利不等式。&lt;/p&gt;
&lt;p&gt;证 2（均值不等式）：
$$
\left(1+\frac1n\right)^n=1\cdot\left(1+\frac1n\right)^n\le\left(\frac{1+n+1}{n+1}\right)^{n+1}=\left(1+\frac1{n+1}\right)^{n+1}
$$
证 3（二项式展开）：
$$
\begin{align*}
\left(1+\frac1n\right)^n
&amp;amp;=\sum_{i=0}^n\frac{n^{\underline{i}}}{i!}n^{-i}\\
&amp;amp;=\sum_{i=0}^n\frac1{i!}\prod_{j=0}^{i-1}\left(1-\frac jn\right)\\
&amp;amp;&amp;lt;\sum_{i=0}^{n+1}\frac1{i!}\prod_{j=0}^{i-1}\left(1-\frac j{n+1}\right)=\left(1+\frac1{n+1}\right)^{n+1}
\end{align*}
$$
另一个：
$$
\begin{align*}
&amp;amp;\frac{\left(1+\frac1n\right)^{n+1}}{\left(1+\frac1{n+1}\right)^{n+2}}\\
={}&amp;amp;\left(\frac{1+\frac1n}{1+\frac1{n+1}}\right)^{n+1}\frac{n+1}{n+2}\\
={}&amp;amp;\left(1+\frac{1}{n(n+2)}\right)^{n+1}\frac{n+1}{n+2}\\
&amp;gt;{}&amp;amp;\left(1+\frac{n+1}{n(n+2)}\right)\frac{n+1}{n+2}\\
={}&amp;amp;\frac{n^2+4n^2+4n+1}{n^3+4n^2+4n}\\
&amp;gt;{}&amp;amp;1
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$&amp;gt;0$ 的情况：
$$
\left(1+\frac1{\lfloor x\rfloor+1}\right)^{\lfloor x\rfloor}\le\left(1+\frac1x\right)^x\le\left(1+\frac1{\lfloor x\rfloor}\right)^{\lfloor x\rfloor+1}
$$&lt;/p&gt;
&lt;p&gt;夹逼即可。$&amp;lt;0$ 时：
$$
\lim_{x\to-\infty}\left(1+\frac1x\right)^x=\lim_{x\to-\infty}\left(\frac{x}{x+1}\right)^{-x}=\lim_{t\to+\infty}\left(1+\frac{1}{t+1}\right)^t=\e
$$
似乎没有简单的方法证明其本身的单调性。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一方面，
$$
\left(1+\frac1n\right)^n=\sum_{i=0}^n\frac1{i!}\prod_{j=0}^{i-1}\left(1-\frac jn\right)\le\sum_{i=0}^n\frac1{i!}
$$
另一方面，
$$
\lim_{n\to\infty}\left(1+\frac1n\right)^n\ge\lim_{n\to\infty}\sum_{i=0}^k\frac1{i!}\prod_{j=0}^{i-1}\left(1-\frac jn\right)=\sum_{i=0}^k\frac1{i!}
$$
或者也可以利用伯努利不等式（from &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/427108293/answer/3227359998&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/427108293/answer/3227359998&lt;/a&gt;）
$$
\left(1+\frac1n\right)^n=\sum_{i=0}^n\frac1{i!}\prod_{j=0}^{i-1}\left(1-\frac jn\right)\ge\sum_{i=0}^n\frac1{i!}\left(1-\frac{i(i-1)}{n}\right)=\left(1-\frac1n\right)\sum_{i=0}^n\frac1{i!}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;（from &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/341220643/answer/868684204&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/341220643/answer/868684204&lt;/a&gt;）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;若
$$
\sum_{i=0}^{+\infty}\frac{1}{i!}=\e=\frac qp\Longrightarrow\sum_{i=0}^pp^{\underline{p-i}}+\sum_{i=p+1}^{+\infty}\frac1{i^{\underline{i-p}}}=q(p-1)!
$$
则
$$
\sum_{i=p+1}^{+\infty}\frac1{i^{\underline{i-p}}}&amp;lt;\sum_{i=1}^{\infty}\frac1{(p+1)^i}=\frac1p\le 1
$$
是整数，矛盾。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$$
\lim_{x\to 0}\frac{\sin(x^2\sin(1/x))}{x}
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;错误解法：
$$
\lim_{x\to 0}\frac{\sin(x^2\sin(1/x))}{x}=\lim_{x\to 0}\frac{x^2\sin(1/x)}{x}=\lim_{x\to 0}x\sin\frac{1}{x}=0
$$
错误之处：当我们说 $\sin(x^2\sin(1/x))\sim x^2\sin(1/x)$ 时，我们实际上在说
$$
\lim_{x\to 0}\frac{\sin(x^2\sin(1/x))}{x^2\sin(1/x)}=1
$$
这个极限是在 $\R\setminus\set{0}\setminus\set{1/k\pi\mid k\in\Z\setminus\set{0}}$ 上说的，但是原极限并没有去掉这些点，而等价无穷小替换的原理是“硬拆出一个分式”方法，所以这样不行。&lt;/p&gt;
&lt;p&gt;正确解法 1：夹逼。&lt;/p&gt;
&lt;p&gt;正确解法 2：
$$
\lim_{x\to 0}\frac{\sin(x^2\sin(1/x))}{x}=\lim_{x\to 0}\frac{x^2\sin(1/x)}{x}=\lim_{x\to 0}x\sin\frac{1}{x}=0
$$
欸欸欸，不是，怎么跟上面的错误解法一样啊？&lt;/p&gt;
&lt;p&gt;别急，我们这里用的是 wxf 的等价无穷小定义：$f\sim g$ 定义为 $f=g+\omicron(g)$，或者说 $\forall\varepsilon&amp;gt;0$，$\exists\delta&amp;gt;0$，$\forall|x-x_0|&amp;lt;\delta$，$|f(x)-g(x)|\le\varepsilon|g(x)|$（注意这里必须是 $\le$，不然 $0$ 就爆了）。容易验证还是有 $\sin(x^2\sin(1/x))\sim x^2\sin(1/x)$，于是
$$
\lim_{x\to 0}\frac{\sin(x^2\sin(1/x))}{x}=\lim_{x\to 0}\frac{x^2\sin(1/x)+\omicron(x^2\sin(1/x))}{x}=\lim_{x\to 0}\left(x\sin\frac 1x+\omicron\left(x\sin\frac 1x\right)\right)=0
$$&lt;/p&gt;
&lt;p&gt;这个定义在保证应用时可以替换的情况下，避免了除法。&lt;/p&gt;
&lt;p&gt;说到这个定义，我们就不禁会关心一个东西：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;证明：$x\to x_0$，$f=g+\omicron(g)\Leftrightarrow g=f+\omicron(f)$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;设 $f-g=\omicron(g)$。$\forall\varepsilon\in(0,1)$，已知 $\exists\delta&amp;gt;0$，$\forall|x-x_0|&amp;lt;\delta$，
$$
\begin{align*}
|f(x)-g(x)|&amp;amp;\le\frac{\varepsilon}{1+\varepsilon}|g(x)|\\
&amp;amp;=\frac{\varepsilon}{1+\varepsilon}|g(x)-f(x)+f(x)|\\
&amp;amp;\le\frac{\varepsilon}{1+\varepsilon}|f(x)-g(x)|+\frac{\varepsilon}{1+\varepsilon}|f(x)|\\
\Longrightarrow\frac{1}{1+\varepsilon}|f(x)-g(x)|&amp;amp;\le\frac{\varepsilon}{1+\varepsilon}|f(x)|\\
\Longrightarrow|f(x)-g(x)|&amp;amp;\le\varepsilon|f(x)|
\end{align*}
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$y_n=2y_{n-1}^2-1, |y_0|\le 1$， 分析 $\set{y_n}$ 的敛散性。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;设 $y_n=\cos\theta_n$, 则 $y_n=\cos(2^n\theta_0)$.&lt;/p&gt;
&lt;p&gt;对于 $\theta_0$ 是 $\pi$ 的有理数倍的情况, 设 $\theta_0=q\pi/p$, 其中 $p,q$ 互质, $p&amp;gt;0$. 如果 $p=2^k$, 那么 ${y_n}$ 收敛至 $1$; 如果 $p=3\cdot 2^k$, 那么 ${y_n}$ 收敛至 $-1/2$; 否则 ${y_n}$ 震荡不收敛.&lt;/p&gt;
&lt;p&gt;对于 $\theta_0$ 是 $\pi$ 的无理数倍的情况, $y_n\ne 1$. 如果 $\lim_{n\to\infty}y_n=1$, 那么 $\exists N$, $\forall n\ge N$, $1-y_n&amp;lt;1/2$. 设 $d_n=1-y_n$. 有 $d_n=2(1+y_{n-1})d_n$. 那么当 $n&amp;gt;N$ 时, $d_n&amp;gt;3d_{n-1}&amp;gt;\cdots&amp;gt;3^{n-N}d_N$. 取 $n=N-\lceil\log_3d_N\rceil$, 则 $d_n&amp;gt;1/2$, 矛盾.&lt;/p&gt;
&lt;p&gt;同样, $y_n\ne-1/2$. 如果 $\lim_{n\to\infty}y_n=-1/2$, 那么 $\exists N$, $\forall n\ge N$, $|y_n+1/2|&amp;lt;1/4$. 设 $c_n=|y_n+1/2|$, 有 $c_n=2|y_n-1/2|c_{n-1}$. 那么当 $n&amp;gt;N$ 时, $c_n&amp;gt;(3/2)c_{n-1}&amp;gt;\cdots&amp;gt;(3/2)^{n-N}c_N$. 取 $n=N-\lceil\log_{3/2}c_N\rceil$, 则 $c_n&amp;gt;1/4$, 矛盾. 故 ${y_n}$ 不收敛.&lt;/p&gt;
&lt;p&gt;综上所述, ${y_n}$ 收敛的充要条件是 $\arccos y_0\in{q\pi/2^k,q\pi/(3\cdot 2^k)\mid q,k\in\N}$.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$x_1=a$，$y_1=b$，$x_{n+1}=(x_n+y_n)/2$，$y_{n+1}=\sqrt{x_ny_n}$。分析两个数列收敛到的同一个值。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Arithmetic%E2%80%93geometric_mean&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://en.wikipedia.org/wiki/Arithmetic%E2%80%93geometric_mean&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$x_1=1$，$x_{n+1}=x_n+1/S_n$。分析 $\lim_{n\to\infty}\e^{x_n^2}/S_n$ 是否收敛。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;求教教/kel&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不用微分中值定理证明洛必达定理。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$0/0$：已知存在 $x_0$ 的一个邻域，使得邻域内 $|f^\prime(x)/g^\prime(x)-A|&amp;lt;\varepsilon$。由于导数的介值性，可以假定 $g^\prime(x)$ 恒 $&amp;gt;0$。所以 $f^\prime(x)-(A-\varepsilon)g^\prime(x)&amp;gt;0$，$f^\prime(x)-(A+\varepsilon)g^\prime(x)&amp;lt;0$，所以 $f(x)-(A-\varepsilon)g(x)$ 严格单增，$f(x)-(A+\varepsilon)g(x)$ 严格单减。又由于在 $x_0$ 处这两者都等于 $0$，故 $x&amp;lt;x_0$ 时 $f(x)-(A-\varepsilon)g(x)&amp;lt;0$，同时 $g(x)&amp;lt;0$，故 $A-\varepsilon&amp;lt;f(x)/g(x)$。同理讨论其他三种情况，得 $A-\varepsilon&amp;lt;f(x)/g(x)&amp;lt;A+\varepsilon$。&lt;/p&gt;
&lt;p&gt;这种情况因为要处理 $0^\pm$ 的情况所以用上了达布，不好看。下面这种情况会看起来比较牛：&lt;/p&gt;
&lt;p&gt;$*/\infty$：只考虑左侧。设 $\lim_{x\to x_0^-}g(x)=+\infty$，从而 $g^\prime(x)&amp;gt;0$。同理我们会得到在 $x\in(x_1,x_0)$ 内 $f(x)-(A-\varepsilon)g(x)$ 严格单增。现在取 $x_0$ 的另一个左邻域 $(x_2,x_0)\subset(x_1,x_0)$ 使得 $\forall x\in(x_2,x_0)$，$-\varepsilon g(x)&amp;lt;f(x_1)-(A-\varepsilon)g(x_1)$，因为 $g(x)\to+\infty$ 所以这是可以的。这时对于其中的 $x$，
$$
f(x)-(A-\varepsilon)g(x)&amp;gt;f(x_1)-(A-\varepsilon)g(x_1)&amp;gt;-\varepsilon g(x)\Longrightarrow\frac{f(x)}{g(x)}&amp;gt;A-2\varepsilon
$$
其余情况同理。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$f(x)\in\mathscr{C}[0,1]$ 满足 $|f(x)|\le 1+\int_0^x|f(t)|\d t$。证明 $|f(x)|\le\e^x$。&lt;/p&gt;
&lt;p&gt;这个题的非积分形式在教积分之前也出现过（5.1.13）。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证 1：令 $g(x)=|f(x)|-\e^x$，则 $|g(x)|-\int_0^xg(x)\d x\le 0$。如果 $g(x)$ 出现了正的，取 $x_0=\operatorname{argmax}g(x)$。由中值定理，
$$
g(x_0)\le\int_0^{x_0}g(t)\d t=x_0g(\xi)\;(\xi\in(0,x_0))
$$
如果 $x_0=1$，让 $x_0=\xi$ 后再做一遍。现在 $g(\xi)\ge g(x_0)/x_0&amp;gt;g(x_0)$，与 $g(x_0)$ 最大矛盾。&lt;/p&gt;
&lt;p&gt;证 2：令 $g(x)=\int_0^x|f(t)|\d t$。则
$$
g^\prime(x)\le 1+g(x)\Longrightarrow\frac{g^\prime(x)}{1+g(x)}\le 1\Longrightarrow\ln(1+g(x))\le x\Longrightarrow1+g(x)\le\e^x\Longrightarrow|f(x)|\le\e^x
$$
这种方法更通用。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;对于 $[0,1]$ 上的连续函数 $f$ 与以 $1$ 为周期的非负可积函数 $g$，证明
$$
\lim_{n\to\infty}\int_0^1f(x)g(nx)\d x=\int_0^1f(x)\d x\int_0^1g(x)\d x
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\begin{align*}
&amp;amp;\lim_{n\to\infty}\int_0^1f(x)g(nx)\d x\\
={}&amp;amp;\lim_{n\to\infty}\sum_{i=0}^{n-1}\int_{i/n}^{(i+1)/n}f(x)g(nx\bmod 1)\d x\\
={}&amp;amp;\lim_{n\to\infty}\frac1n\sum_{i=0}^{n-1}f(\xi_{n,i})\int_0^1g(x)\d x\\
={}&amp;amp;\int_0^1f(x)\d x\int_0^1g(x)\d x
\end{align*}
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;设 $f(x)=\int_x^{x+1}\sin(t^2)\d t$。证明 $\forall x&amp;gt;0$，$|f(x)|\le 1/x$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;既然不能直接用 Dirichlet 判别法，就考虑其原理，试图魔改其证明的过程。
$$
\begin{align*}
\left|\int_{x^2}^{(x+1)^2}\frac{\sin u}{2\sqrt u}\d u\right|&amp;amp;=\left|-\left.\frac{\cos u}{2\sqrt u}\right|_{x^2}^{(x+1)^2}-\int_{x^2}^{(x+1)^2}\frac{\cos u}{4u^{3/2}}\d u\right|\\
&amp;amp;\le\frac{1}{2(x+1)}+\frac{1}{2x}+\int_{x^2}^{(x+1)^2}\frac{\d u}{4u^{3/2}}\\
&amp;amp;=\frac{1}{2(x+1)}+\frac{1}{2x}-\frac{1}{2(x+1)}+\frac{1}{2x}\\
&amp;amp;=\frac1x
\end{align*}
$$&lt;/p&gt;
</description>
        </item>
        <item>
        <title>微积分的理论基础</title>
        <link>https://littlereuben.github.io/study/course-calculus-0/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-calculus-0/</guid>
        <description>&lt;p&gt;$\gdef\s{\operatorname{S}}\gdef\F{\mathbb{F}}\gdef\d{\mathrm{d}}\gdef\Q{\mathbb{Q}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h3 id=&#34;实数理论&#34;&gt;实数理论
&lt;/h3&gt;&lt;p&gt;参考：chenxia25 与我的讨论、&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/48859870&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/48859870&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;所有 $\forall/\exists a$ 形式的东西，$a$ 默认属于当前讨论的集合。当你看见 $\Rightarrow$ 时，就说明不是形式语言。&lt;/p&gt;
&lt;p&gt;Definition 1. 自然数集，利用 Peano 公理定义：&lt;/p&gt;
&lt;p&gt;Axiom 1.0. 等价关系的确立&lt;br&gt;
P.S. 这里我们默认了等价关系满足 $m=n\Rightarrow \s(m)=\s(n)$ 及其推论，也就是说“等价关系”在保证不产生矛盾的情况下被内化为了可替换关系。这是需要区分的，后面关于减法的定义就需要验证其良定义性。&lt;/p&gt;
&lt;p&gt;Axiom 1.1. $0\in\N$&lt;/p&gt;
&lt;p&gt;Axiom 1.2. $\forall i(i\in\N\rightarrow \s(i)\in\N)$&lt;/p&gt;
&lt;p&gt;Axiom 1.3. $\forall i\forall j(\s(i)=\s(j)\rightarrow i=j)$（$\s$ 是单射）&lt;/p&gt;
&lt;p&gt;Axiom 1.4. $\forall i(\s(i)\ne 0)$&lt;/p&gt;
&lt;p&gt;Axiom 1.5. $\forall A((0\in A\land \forall n(n\in A\rightarrow \s(n)\in A))\rightarrow \N\subseteq A)$（数学归纳法原理）&lt;/p&gt;
&lt;p&gt;Property 1.1. $\N=\set{0}\cup \s(\N)$，或者说 $\s$ 是到 $\N\setminus\set{0}$ 的满射（从而是双射）。&lt;br&gt;
Proof. 3 和 6 保证了两个方向。&lt;/p&gt;
&lt;p&gt;Definition 1.1. 加法，利用逐点归纳定义，$m+\s(n)=\s(m+n)$。我们将 $m+1$ 与 $\s(m)$ 划等号。&lt;/p&gt;
&lt;p&gt;Definition 1.2. 乘法，利用逐行归纳定义，$m\cdot \s(n)=m\cdot n+m$。&lt;/p&gt;
&lt;p&gt;下文中的归纳，均依赖于 Axiom 1.5。&lt;/p&gt;
&lt;p&gt;Property 1.2. $\forall a(0+a=a+0=a)$（加法幺元）&lt;br&gt;
Proof. $0+a=a$ 只需对 $a$ 归纳。&lt;/p&gt;
&lt;p&gt;Property 1.3. $\forall a\forall b(a+b=b+a)$（加法交换律）&lt;br&gt;
Proof. 对 $b$ 归纳。一种方法是，只需证明 $\s(b)+a=\s(b+a)$，对 $a$ 归纳，命题为 $\s(b)+\s(a)=\s(b+\s(a))$，由 $\s(b)+\s(a)\xlongequal{\text{def}}\s(\s(b)+a)\xlongequal{\text{ind}}\s(\s(b+a))\xlongequal{\text{def}}\s(b+\s(a))$ 得。另一种方法是，借助结合律，先证 $a+1=1+a$，再得 $a+\s(b)=a+(b+1)=(a+b)+1=(b+a)+1=b+(a+1)=b+(1+a)=(b+1)+a=\s(b)+a$。&lt;/p&gt;
&lt;p&gt;Property 1.4. $\forall a\forall b\forall c((a+b)+c=a+(b+c))$（加法结合律）&lt;br&gt;
Proof. 对 $c$ 归纳，不用 Property 1.3。可能需要单独证 $c=1$ 情况。&lt;/p&gt;
&lt;p&gt;Property 1.5. $\forall a\forall b\forall c(a+c=b+c\rightarrow a=b)$（加法消去律）&lt;/p&gt;
&lt;p&gt;Property 1.6. $\forall a(1\cdot a=a\cdot 1=a)$（乘法幺元）&lt;/p&gt;
&lt;p&gt;Property 1.7. $\forall a\forall b(a\cdot b=b\cdot a)$（乘法交换律）&lt;br&gt;
Proof. 同样首先证明 $\s(b)\cdot a=b\cdot a+a$，对 $a$ 归纳，命题为 $\s(b)\cdot\s(a)=b\cdot\s(a)+\s(a)$，由 $\s(b)\cdot\s(a)\xlongequal{\text{def}}\s(b)\cdot a+\s(b)\xlongequal{\text{ind}}b\cdot a+a+\s(b)\xlongequal{\text{def}}b\cdot a+\s(a+b)\xlongequal{\text{P1.3}}b\cdot a+\s(a)+b\xlongequal{\text{com}}b\cdot a+b+\s(a)\xlongequal{\text{def}}b\cdot\s(a)+\s(a)$ 得。于是原命题对 $b$ 归纳，$a\cdot\s(b)=a\cdot b+a=b\cdot a+a=\s(b)+a$。&lt;/p&gt;
&lt;p&gt;Property 1.8. $\forall a\forall b\forall c((a\cdot b)\cdot c=a\cdot(b\cdot c))$（乘法结合律）&lt;br&gt;
Proof. 对 $c$ 归纳，利用 Property 1.9。&lt;/p&gt;
&lt;p&gt;Property 1.9. $\forall a\forall b\forall c((a+b)\cdot c=a\cdot c+b\cdot c)$（乘法对加法的分配律）&lt;br&gt;
Proof. 对 $c$ 归纳。&lt;/p&gt;
&lt;p&gt;Property 1.10 $\forall a\forall b\forall c((c\ne 0\land a\cdot c=b\cdot c)\rightarrow a=b)$（乘法消去律）&lt;/p&gt;
&lt;p&gt;Definition 2. 整数集，以“减法字符串”定义其中的元素，同时定义了①相等的判断、②元素的加法、③元素的乘法。同时证明了加法和乘法是良定义的。同时定义了 $\Z_+$ 是 $\N\setminus\set{0}$ 对应的部分。&lt;/p&gt;
&lt;p&gt;P.S. 我们常用的整数集实际上是书里这个整数集关于等价关系 $m+q=p+n\Leftrightarrow m-n=p-q$ 的商集。&lt;/p&gt;
&lt;p&gt;下文的 $0$ 代指 $0-0$。&lt;/p&gt;
&lt;p&gt;Property 2.1&amp;amp;2&amp;amp;3. 加法幺元、交换律、结合律&lt;/p&gt;
&lt;p&gt;Property 2.4 $\forall a\exists b(a+b=b+a=0)$ 且 $b=-a$ 唯一（加法逆元）&lt;br&gt;
Proof. 构造容易，证唯一性可以不用抽象代数的方法：设 $a+b=a+c=0$，即 $(a_1+b_1)-(a_2+b_2)=(a_1+c_1)-(a_2+c_2)$，即 $a_1+b_1+a_2+c_2=a_1+c_1+a_2+b_2$，利用 Property 1.5 得 $b_1+c_2=c_1+b_2$ 即 $b=c$。&lt;/p&gt;
&lt;p&gt;Property 2.5&amp;amp;6&amp;amp;7&amp;amp;8. 乘法幺元、交换律、结合律、分配律&lt;/p&gt;
&lt;p&gt;Property 2.9. $\forall a([a\in\Z_+]+[a=0]+[-a\in\Z_+])=1$&lt;br&gt;
Proof. $\ge 1$ 好证，$\le 1$ 的证明方法是，如果 $a\in\Z_+\land-a\in\Z_+$，则设 $a_1-a_2=\s(k)-0$，$a_2-a_1=\s(l)-0$，两式相加得 $0-0=(\s(k)+\s(l))-0=\s(\s(k)+l)-0$ 与 $\s(\cdot)\not\equiv 0$ 矛盾。&lt;br&gt;
P.S. 再次注意，这里“两式相加”的操作基于的是等号和加号的良定义性。&lt;/p&gt;
&lt;p&gt;P.S. 环，自动有加法幺元等于乘法零元（$a\cdot 0=a\cdot (0+0)=a\cdot 0+a\cdot 0$ 两边消去）&lt;/p&gt;
&lt;p&gt;Corollary 2.1. $\forall a(-(-a)=a)$&lt;/p&gt;
&lt;p&gt;Corollary 2.2. $\forall a(a=-a\leftrightarrow a=0)$&lt;/p&gt;
&lt;p&gt;Corollary 2.3. $\forall a\forall b(a,b\in\N\rightarrow a+(-b)=a-b)$&lt;/p&gt;
&lt;p&gt;Corollary 2.4. $\forall a\forall b(a\cdot(-b)=(-a)\cdot b=-(a\cdot b))$&lt;/p&gt;
&lt;p&gt;Definition 3. 有理数集，以“分数字符串”定义其中的元素，同时定义了①相等的判断、②元素的加法、③元素的乘法。同时证明了加法和乘法是良定义的。同时定义了 $\Q_+$ 是分子分母均为正整数对应的部分。&lt;/p&gt;
&lt;p&gt;下文的 $0,1$ 分别代指 $0/1,1/1$。&lt;/p&gt;
&lt;p&gt;Property 3.1&amp;amp;2&amp;amp;3&amp;amp;4 加法幺元、交换律、结合律、逆元&lt;/p&gt;
&lt;p&gt;Property 3.5&amp;amp;6&amp;amp;7&amp;amp;8. 乘法幺元、交换律、结合律、分配律&lt;/p&gt;
&lt;p&gt;Property 3.9. $\forall a(a\ne 0\rightarrow\exists b(a\cdot b=b\cdot a=1))$ 且 $b=a^{-1}$ 唯一（乘法逆元）&lt;/p&gt;
&lt;p&gt;Corollary 3.1&amp;amp;2&amp;amp;3&amp;amp;4. 同上&lt;/p&gt;
&lt;p&gt;Corollary 3.5. $\forall a(a\ne 0\rightarrow(a^{-1})^{-1}=a)$&lt;/p&gt;
&lt;p&gt;Corollary 3.6. $\forall a(a=a^{-1}\leftrightarrow a=1)$&lt;/p&gt;
&lt;p&gt;Corollary 3.7. $\forall a(a\ne 0\rightarrow(-a)^{-1}=-(a^{-1}))$&lt;/p&gt;
&lt;p&gt;Corollary 3.8. $\forall a\forall b(a,b\ne 0\rightarrow (ab)^{-1}=a^{-1}b^{-1})$&lt;/p&gt;
&lt;p&gt;Corollary 3.9. $\forall a\forall b((a,b\in\Z\land b\ne 0)\rightarrow a\cdot b^{-1}=a/b)$&lt;/p&gt;
&lt;p&gt;Corollary 3.10. $\forall a\forall b((a,b\in\Z\land b\ne 0)\rightarrow a/(-b)=(-a)/b=-(a/b))$&lt;/p&gt;
&lt;p&gt;Corollary 3.11. $\forall a\forall b((a,b\in\Z\land a,b\ne 0)\rightarrow (a/b)^{-1}=b/a)$&lt;/p&gt;
&lt;p&gt;Definition 4. 序关系，利用减法与 $\Q_+$ 定义；序域。&lt;/p&gt;
&lt;p&gt;Corollary 4.1. $\forall a\forall b([a&amp;lt;b]+[a=b]+[a&amp;gt;b]=1)$（三分律）&lt;/p&gt;
&lt;p&gt;Corollary 4.2. $\forall a\forall b\forall c(a&amp;lt;b\rightarrow a+c&amp;lt;b+c)$&lt;/p&gt;
&lt;p&gt;Corollary 4.3. $\forall a\forall b\forall c((a&amp;gt;0\land b&amp;gt;0\land c&amp;gt;0)\rightarrow(a&amp;lt;b\rightarrow a\cdot c&amp;lt;b\cdot c))$&lt;/p&gt;
&lt;p&gt;Corollary 4.4. $\forall a(a\le a)$（自反性）&lt;/p&gt;
&lt;p&gt;Corollary 4.5. $\forall a\forall b((a\le b\land b\le a)\rightarrow(a=b))$（反对称性）&lt;/p&gt;
&lt;p&gt;Corollary 4.6. $\forall a\forall b\forall c((a\le b\land b\le c)\rightarrow(a\le c))$（传递性）&lt;/p&gt;
&lt;p&gt;Corollary 4.7. $\forall a\forall b\forall c\forall d((a\le b\land c\le d)\rightarrow a+c\le b+d)$&lt;/p&gt;
&lt;p&gt;Corollary 4.8. $\forall a\forall b\forall c\forall d((0\le a\le b\land 0\le c\le d)\rightarrow a\cdot c\le b\cdot d)$&lt;/p&gt;
&lt;p&gt;Corollary 4.1&amp;amp;2&amp;amp;3 说明 $\Q$ 是一个序域。显然序域一定是无限的，且一定构成全序集。Corollary 4.4&amp;amp;5&amp;amp;6 是全序集的定义，从而是序域的性质。&lt;/p&gt;
&lt;p&gt;Theorem 4.1. $\Q$ 是最小的序域，这个“最小”的意义在证明中给出。&lt;br&gt;
Proof. 考虑域 $\F$。考虑其乘法幺元，它可以通过加法得到 $\Z$（它在加法群里的生成子群必须是无限的，否则无序），再通过乘法得到 $\Q$。&lt;/p&gt;
&lt;p&gt;Definition 5. 实数集，以 Dedekind 分割定义。上面的 Definition 1&amp;amp;2&amp;amp;3&amp;amp;4 都没写明定义，这里很重要，所以写一下。&lt;/p&gt;
&lt;p&gt;实数的四则运算和全序的性质略。&lt;/p&gt;
&lt;p&gt;（from ycx）当我们定义一个结构的时候，有两种方法——一种是把它直接构造出来，一种是用一些不自相矛盾的公理声明这个结构所满足的性质，并“声称它存在”。例如 $\N$，第一种定义方法是用 ZFC 的无穷公理加 $\sup$ 构造 $M=\set{\varnothing,\set{\varnothing},\set{\varnothing,\set{\varnothing}},\cdots}$，一种就是用 Peano 公理。给出了存在性，然后容易验证其唯一性（唯一用同构映射定义）。&lt;/p&gt;
&lt;p&gt;那么 $\R$ 也是一样的。我们先给出它的构造性定义。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（Dedekind 分割）实数 $A$ 是一个集合，它满足：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$A\subset\Q$&lt;/li&gt;
&lt;li&gt;$A$ 存在上界&lt;/li&gt;
&lt;li&gt;$\forall x\forall y((x\in A\land y&amp;lt;x)\rightarrow y\in A)$&lt;/li&gt;
&lt;li&gt;若 $A$ 存在上确界，则 $A$ 的上确界 $\in A$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;$\R$ 就是所有这样的 $A$。&lt;/p&gt;
&lt;p&gt;定义实数的 $\le$ 就是 $\subseteq$。定义 $A+B=\set{x+y\mid x\in A,y\in B}$。定义 $A\cdot B=\overline{\set{xy\mid x\in\overline{A},y\in\overline{B}}}$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;解释：在 $\Q$ 上，不是所有有上界的集合都有上确界。&lt;br&gt;
4 不成立的话就会出现 $\set{x\mid x&amp;lt;1}$ 的东西，或者说可以理解为造成 $0.999\cdots\ne 1$。&lt;/p&gt;
&lt;p&gt;我们再给出公理法定义。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（Dedekind 原理，$1$）$\R$ 满足：
$$
\forall A\forall B((A\subseteq\R\land B\subseteq\R\land A\ne\varnothing\land B\ne\varnothing\land\forall a\forall b((a\in A\land b\in B)\rightarrow a\le b))\rightarrow\exists c\forall a\forall b((a\in A\land b\in B)\rightarrow a\le c\le b))
$$
后面我们就尽量不用反人类语言了。&lt;/p&gt;
&lt;p&gt;说的是，任何非空集 $A$，$B\subset\R$，$A$ 中元素全部 $\le$ $B$ 中元素，那么存在一个 $c$ 夹在 $A$，$B$ 之间。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们给出一些等价的公理：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（确界原理，$2$）$\R$ 满足：&lt;/p&gt;
&lt;p&gt;$\forall A\subseteq\R$，$A\ne\varnothing$，$A$ 有上界 $\Rightarrow$ $A$ 有上确界。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$1\Rightarrow 2$：对于 $A$，取 $B=\set{b\mid\forall a,a\le b}$。由于 $A$ 有上界，故 $B\ne\varnothing$。由 1，得到一个 $c$，这个 $c$ 是 $A$ 的上界，接下来说明是上确界。如果有更小的上界 $c^\prime&amp;lt;c$，那么 $c^\prime\in B$，与 $c$ 是 $B$ 的下界矛盾。&lt;/p&gt;
&lt;p&gt;$2\Rightarrow 1$：在 1 的 $\exists c$ 中，取 $c=\sup A$。既然 $\forall a\in A$，$b\in B$，都有 $a\le b$，那么 $B$ 中的元素都是 $A$ 的上界，于是 $c$ 不可能大于 $B$ 中的元素，于是 $c$ 满足条件。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（单调有界定理，$3$）$\R$ 上的数列 $a$ 如果单调有界，则必收敛（$\exists A\forall\varepsilon\exist N\forall n(n&amp;gt;N\rightarrow |a_n-A|&amp;lt;\varepsilon)$）。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$2\Rightarrow 3$：直接用确界就行。&lt;/p&gt;
&lt;p&gt;$3\Rightarrow 2$：构造数列 $\set{a_n}$：$a_1$ 为 $A$ 中任一数（不妨设 $a_1$ 不是上界，否则就证完了），$a_{n+1}$ 通过 $a_n+d$ 得到，$d$ 这样确定：一开始考虑 $d=1$，如果 $a_n+d$ 成为上界了，就将 $d$ 除以 $2$。我们首先证明 $d$ 一定能取到——如果取不到，就意味着，$\forall k\ge 0$，$a_n+2^{-k}\ge\forall a\in A$，（$\Alpha^\prime$）故 $a_n\ge\forall a\in A$，也就是说 $a_n$ 就是上界了，这与构造 $d$ 的方式矛盾。&lt;br&gt;
然后我们证明 $l=\lim_{n\to\infty}a_n$ 是上确界。如果 $l$ 不是上界，设 $A\ni a&amp;gt;l$，取 $\varepsilon=a-l$，那么有 $l-\varepsilon&amp;lt;a_n\le a$。如果 $a_{n+1}\ne a_n$，那么 $d$ 可以大一倍；如果 $a_{n+1}=a_n$，那由（$\Alpha^\prime$）也是不对的。如果 $l$ 不是确界，设 $l^\prime&amp;lt;l$ 也是上界，取 $\varepsilon=l-l^\prime$，那就有 $A\ni a&amp;gt;l^\prime$ 了，矛盾。&lt;br&gt;
最后证 $\Alpha^\prime$：$\lim_{n\to\infty}2^{-n}=0$（与阿基米德性等价）。首先它一定有极限，然后如果它 $&amp;gt;0$，设为 $L$，取 $\varepsilon=L$，那么有 $2^{-n}&amp;lt;2L$，那么 $2^{-(n+1)}&amp;lt;L$，矛盾。&lt;/p&gt;
&lt;p&gt;既然提到了，那也顺便讲好吧。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（Archimedes 性，$\Alpha$）任意实数都不是 $\N$ 的上界。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$2\Rightarrow\Alpha$：设有，那一定有上确界 $s$，那么 $\exists n\in\N$，$n&amp;gt;s-1$，故 $n+1&amp;gt;s$，矛盾。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（致密性定理，$4$）有界实数列必有收敛子列。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$2+3\Rightarrow 4$：构造子列 $\set{b_n}$：如果 $\set{a_n}$ 的上确界包含其中，为 $a_s$，那么取 $b_1=a_s$，接着看 $\set{a_{n+s}}$ 的上确界，以此类推。如果一直有，那么构造出单调不升的有界数列 $b$，收敛；如果某次发现上确界不包含其中了，那可以构造 $b_1=$ 此后随便一个数，然后 $b_{n+1}$ 为 $b_n$ 之后随便一个 $&amp;gt;b_n$ 的数（不可能不存在，否则由有限情况 $\sup=\max$ 就存在确界了），这样构造出单调不降的有界数列 $b$，收敛。&lt;/p&gt;
&lt;p&gt;$3\Rightarrow 4$：设 $\set{a_n}$ 界为 $[l,r]$，取 $[l,(l+r)/2]$ 和 $[(l+r)/2,r]$ 之中，包含 $\set{a_n}$ 中无限项的一个区间，不断推下去。取 $b_i$ 为第 $i$ 次区间中对应的任意元素，只需保证 $b$ 取的下标递增即可（由于无限项，故一定可以取到）。$3$ 可得区间左右端点都收敛，由夹逼定理，$\set{b_n}$ 收敛。注意夹逼定理是不需要任何公理就可以证明的。&lt;/p&gt;
&lt;p&gt;$2\Rightarrow 4$ 直接把 $3\Rightarrow 4$ 里的单调有界换成确界即可。&lt;/p&gt;
&lt;p&gt;$4\Rightarrow 3$：取这个单调有界数列 $\set{a_n}$ 的收敛子列 $\set{b_n}$，$\forall\varepsilon&amp;gt;0$，$\set{b_n}$ 中有一项及之后都与极限值差少于 $\varepsilon$，取 $b$ 中这项对应 $a$ 中位置及之后即可。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（聚点定理，$5$）$\R$ 的有界无限子集 $S$ 必有聚点。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$4\Rightarrow 5$：构造 $\set{a_n}$，$a_{n+1}$ 取 $S\setminus\set{a_{1\sim n}}$ 中任一点，于是我们找到一个收敛点列，它收敛到的点就是聚点。&lt;/p&gt;
&lt;p&gt;$5\Rightarrow 4$：将有界数列视作有界无限集，取一聚点 $A$，取数列 $\set{b_n}$，$b_i$ 为 $\mathring{U}(A,1/i)$ 内的一个点，同时保证 $b$ 对应在 $a$ 中的位置递增（这是可以做到的，因为 $\mathring{U}(A,1/i)$ 里有无限个点）。由 $\Alpha^{\prime\prime}$，$\set{b_n}$ 收敛到 $A$。&lt;br&gt;
$\Alpha^{\prime\prime}$：$\lim_{n\to\infty}1/n=0$。这个也和 $\Alpha$ 等价，可以直接用 $5$ 导出。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（有限覆盖定理，$6$）如果开区间 $\cal I$ 构成了闭区间 $[a,b]$ 的覆盖，则它有一个有限子集也是 $[a,b]$ 的覆盖。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Remark. 这个对 $\Q$ 不成立的原因是，在 $\Q$ 上 $[-\sqrt2,+\sqrt2]\cap\Q$ 是闭集（同时也是开集），只需搞一列不跨 $\sqrt2$ 的区间覆盖它就是反例。&lt;/p&gt;
&lt;p&gt;$2\Rightarrow 6$：设 $S=\set{x\le b\mid [a,x]\,可以被有限覆盖}$，$S$ 有上确界 $s$。找 $\cal I$ 中包含 $s$ 的开区间 $(l,r)$，显然 $l\in S$，因此 $(s+r)/2\in S$，与 $\sup S=s$ 矛盾。&lt;br&gt;
Remark. 如果 $b$ 开，那么 $\cal I$ 中可能找不到包含 $s$ 的区间。&lt;/p&gt;
&lt;p&gt;$6\Rightarrow 2$：假设有界集合 $A\subseteq[a,b]$ 无上确界。现在我们考虑构造一些覆盖 $[a,b]$ 开区间。对于 $x$，如果 $x$ 不是 $A$ 的上界，即 $\exists A\ni y&amp;gt;x$，则取 $(2x-y,y)$；如果 $x$ 是 $A$ 的上界，即 $\exists y&amp;lt;x$ 也是 $A$ 的上界，则取 $(y,2x-y)$。每个 $x$ 搞出一个开区间，这些区间形成一个覆盖，必有有限子集也是覆盖。但这些区间的每个，要么在某个 $a\in A$ 左侧，要么在所有 $a\in A$ 右侧，因此必存在一个 $a$ 处于这两类区间之间，没被覆盖到，矛盾。&lt;/p&gt;
&lt;p&gt;$6\Rightarrow 5$：假设 $S\subseteq[a,b]$ 无聚点，那么每个点都存在一个开邻域只包含它本身一个 $S$ 中的点。取 $[a,b]$ 的每个点的这样的开邻域，它们的一个有限子集同样形成 $[a,b]$ 的覆盖，与 $S$ 无限矛盾。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（柯西收敛定理，$\text{C}$）数列 $a$ 收敛，当且仅当 $\forall\varepsilon\exists N\forall m\forall n(m,n&amp;gt;N\rightarrow|a_m-a_n|&amp;lt;\varepsilon)$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$4\Rightarrow\text{C}$：一个方向是显然的，也不需完备性。另一个方向：显然 $a$ 有界。找到其一个收敛子列，容易利用柯西列性质证明整个序列也收敛到这个值。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;（闭区间套定理，$\text{N}$）对于不降数列 $\set{a_n}$ 和不增数列 $\set{b_n}$，如果 $a_n\le b_n$，且 $\lim_{n\to\infty}(b_n-a_n)=0$，那么存在 $c$，$\lim_{n\to\infty}a_n=\lim_{n\to\infty}b_n=c$ 且 $c$ 是满足 $\forall n$，$a_n\le c\le b_n$ 的唯一数。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$1/2/3\Rightarrow\text{N}$：证明至多一个不需要完备性，只需用极限的定义；证明存在一个，可以构造 $A=\set{a\mid\exists a_n\ge a}$ 和 $B=\set{b\mid\exists b_n\le b}$ 后用 $1$，也可以直接对 $\set{a_n}$ 用 $2/3$。&lt;/p&gt;
&lt;p&gt;$\text{C}\Rightarrow\text{N}$：
$$
\begin{align*}
\lim_{n\to\infty}(b_n-a_n)=0&amp;amp;\Rightarrow\fbox{blabla}(n&amp;gt;m&amp;gt;N\rightarrow|b_m-a_m-b_n+a_n|&amp;lt;\varepsilon)\\
&amp;amp;\Rightarrow\fbox{blabla}(n&amp;gt;m&amp;gt;N\rightarrow a_n-a_m&amp;lt;\varepsilon\land b_m-b_n&amp;lt;\varepsilon)\\
&amp;amp;\Rightarrow\lim_{n\to\infty}a_n=A\land\lim_{n\to\infty}b_n=B
\end{align*}
$$
然后就是证明 $\forall a_n\le A,B\le\forall b_n$，再说明 $A=B$ 即可。&lt;/p&gt;
&lt;p&gt;$\text{N}\Rightarrow\text{C}$：对于一个柯西列，构造一列不断缩紧的区间，我们的想法是，考虑一个收敛于 $0$ 的正数列 $\set{d_n}$。根据柯西列的性质，每个 $d_n$ 都可以找到一个 $N_n$，使 $\forall m&amp;gt;N_n$，$|a_m-a_{N_n}|&amp;lt;d_n$。这样，取 $[l_n,r_n]=[a_{N_n}-d_n,a_{N_n}+d_n]\cap[l_{n-1},r_{n-1}]$，这样就得到了一个符合条件的闭区间列，于是就搞出了极限 $c$。要证明 $\set{a_n}$ 极限为 $c$，$\forall\varepsilon&amp;gt;0$，找到 $d_m&amp;lt;\varepsilon/2$，于是 $c$ 和 $\set{a_{n+N_m}}$ 的所有元素都在这个长度 $&amp;lt;\varepsilon$ 的区间 $[l_m,r_m]$ 中。&lt;br&gt;
但是怎么找 $\set{d_n}$ 呢？你发现没了 $\Alpha$，啥都干不成。但是这里摆着一个几乎能用的序列——$\Delta\set{a_n}$，但是要去掉里面为 $0$ 的项。因此要特殊讨论一下 $\Delta\set{a_n}$ 只有有限项非零的情况。&lt;/p&gt;
&lt;p&gt;$\text{N}+\Alpha\Rightarrow 2$：对于有上界的集合 $A$，取区间 $[a,s]$，其中 $a\in A$（可以假设 $a$ 不是上界），$s$ 是 $A$ 的上界。每次取区间中点，如果中点是上界，那么往左半缩小，否则往右半缩小。根据 $\Alpha$，区间长度 $\to 0$。根据保序性，极限是上界。如果不是上确界，容易得到某个区间的左端点也不是上界，从而与构造矛盾。&lt;/p&gt;
&lt;p&gt;$\text{N}+\Alpha\Rightarrow 3/4$ 都很简单。&lt;/p&gt;
&lt;p&gt;实际上，连续函数的一些性质也可以作为实数公理，但这里就略去了。&lt;/p&gt;
&lt;p&gt;容易验证 Dedekind 分割构造的集合满足公理，那么现在考虑唯一性。&lt;/p&gt;
&lt;p&gt;Theorem 5.1. $\R$ 是唯一的完备序域。&lt;br&gt;
Proof. 设这样的序域为 $\F$。首先 $\F$ 一定包含 $\Q$，设 $\varphi$ 是自然嵌入，我们考虑扩展 $\varphi$。$\forall A\in\R$，$\sup\varphi(A)$（显然上界存在，又由确界原理）在 $\F$ 中找到了 $A$ 对应的元素，同时上确界的唯一性很重要。如果 $\F$ 中还有别的元素 $x$，拿出 $\set{y\mid y\le x}\cap\varphi(\Q)=X$，由阿基米德性，$\varphi(\Q)$ 中有 $&amp;gt;x$ 的元素，因此 $\varphi^{-1}(X)$ 的上界存在，从而 $x=\varphi\left[\sup{\varphi^{-1}(X)}\right]$。于是就双射了。&lt;/p&gt;
&lt;p&gt;Theorem 5.2. $\R$ 中有理数和无理数都是稠密的。&lt;br&gt;
Proof. $\forall a,b\in\R$，$a&amp;lt;b$，由阿基米德性，$\exist n\in\N_+$，$1/n&amp;lt;b-a$。取 $c=\sup\set{k/n\mid k\in\Z}\cap(-\infty,b)$，同理可证这个交非空，然后 $c$ 就是 $\in(a,b)$ 的有理数。找到 $\left(a-\sqrt 2,b-\sqrt 2\right)$ 中的一个有理数 $c^\prime$，$c&amp;rsquo;+\sqrt{2}$ 就是 $\in(a,b)$ 的无理数。&lt;br&gt;
P.S. 尽管 $(a,b)$ 尚未定义，但这里可以不用这个语言，所以只是为了方便才这么写。&lt;/p&gt;
&lt;p&gt;Example 5.1. $\set{x\mid x&amp;lt;0\lor x^2&amp;lt;2}$ 对应的实数不是有理数。&lt;/p&gt;
&lt;p&gt;Theorem 5.3. 定义区间 $I$ 为满足 $\forall x&amp;lt;y\in I,\forall x&amp;lt;z&amp;lt;y,z\in I$ 的集合。则 $I$ 只可能是 $[a,b]$、$[a,b)$、$(a,b]$、$(a,b)$、$(-\infty,b]$、$(-\infty,b)$、$[a,+\infty)$、$(a,+\infty)$、$(-\infty,+\infty)$ 中的一类。&lt;/p&gt;
&lt;p&gt;Theorem 5.4. $y=x^n\,(n\in\N_+)$ 在 $[0,+\infty)$ 上严格单调递增；对于 $y\ge 0$，对应的 $x$ 唯一存在。&lt;br&gt;
Proof. 考虑归纳。由 Corollary 4.8，对于 $0\le x_1&amp;lt;x_2$，$x_1^n&amp;lt;x_2^n\rightarrow x_1^{n+1}&amp;lt;x_2^{n+1}$。&lt;br&gt;
考虑解 $x_0=\sup\set{x\mid x^n&amp;lt;y}$。由于 $\max\set{y,1}^n\ge y$ 故上界存在。&lt;br&gt;
如果 $x_0^n&amp;lt;y$，那么考虑构造 $[x_0(1+\varepsilon)]^n&amp;lt;y$ 即 $(1+\varepsilon)^n&amp;lt;y/x_0^n$，这个构造可考虑放缩
$$
(1+\varepsilon)^n=\frac{1}{\left(\frac{1}{1+\varepsilon}\right)^n}=\frac{1}{\left(1-\frac{\varepsilon}{1+\varepsilon}\right)^n}&amp;lt;\frac{1}{1-\frac{n\varepsilon}{1+\varepsilon}}&amp;lt;\frac{y}{x_0^n}\Rightarrow\frac{n\varepsilon}{1+\varepsilon}&amp;lt;1-\frac{x_0^n}{y}
$$
解一下可以解出合适的 $\varepsilon&amp;gt;0$，于是与 $x_0$ 是上界矛盾；如果 $x_0^n&amp;gt;y$，那么考虑构造 $(1-\varepsilon)^n&amp;gt;1-n\varepsilon&amp;gt;y/x_0^n$，与 $x_0$ 是确界矛盾。&lt;/p&gt;
&lt;p&gt;Definition 6.1. 对于 $y\ge 0$，$\sqrt[n]{y}$ 为使得 $x^n=y$ 的唯一的 $x$。&lt;/p&gt;
&lt;p&gt;P.S. 这类定义问题可以利用连续性和介值定理作为通法证明存在性，但这里就不讲这种方法了。&lt;/p&gt;
&lt;p&gt;Definition 6.2. 对于 $y&amp;gt;0$，$y^{m/n}=\left(\sqrt[n]{y}\right)^m$。&lt;/p&gt;
&lt;p&gt;Definition 6.3. 对于 $y\ge 1$，$y^\alpha=\sup_{a\in(-\infty,\alpha]\cap\Q}\set{y^a}$；对于 $0&amp;lt;y&amp;lt;1$，$y^\alpha=(1/y)^{-\alpha}$。&lt;/p&gt;
&lt;p&gt;P.S. 这里我们只考虑 $y\ge 0$ 的情况。$y&amp;lt;0$ 属于复变函数的内容。&lt;/p&gt;
&lt;p&gt;Corollary 6.1. 指数函数和幂函数的运算法则和单调性等。略。&lt;/p&gt;
&lt;p&gt;Theorem 5.5. 对于 $a&amp;gt;1$，$y=a^x$ 在 $\R$ 上严格单调递增；对于 $y&amp;gt;0$，对应的 $x$ 唯一存在。&lt;br&gt;
Lemma. $\inf_{n\in\N_+}\set{a^{1/n}}=1$。&lt;br&gt;
Proof. $a^{1/n}&amp;gt;1$ 故下界存在且 $\ge 1$。如果下界为 $b&amp;gt;1$ 则 $\forall n$，$a^{1/n}\ge b\Rightarrow a\ge b^n&amp;gt;1+n(b-1)$ 即 $n&amp;lt;(a-1)/(b-1)$，与 $\Alpha$ 矛盾。&lt;br&gt;
Proof. 我们可以不依赖 Corollary 6.1 证明单调性。对于 $x_1&amp;lt;x_2$，由 Theorem 5.2，$\exists q_1/p_1&amp;lt;q_2/p_2\in(x_1,x_2)\cap\Q$。我们知道 $a^{q_2/p_2}/a^{q_1/p_1}=\left(\sqrt[p_1p_2]{a}\right)^{q_2p_1-q_1p_2}\ge\sqrt[p_1p_2]{a}&amp;gt;\sqrt[p_1p_2]{1}=1$。于是 $a^{x_1}\le x^{q_1/p_1}&amp;lt;x^{q_2/p_2}\le a^{x_2}$。&lt;br&gt;
考虑解 $x_0=\sup\set{x\mid a^x&amp;lt;y}$。由于 $a^{\lceil(y-1)/(a-1)\rceil}&amp;gt;y$（根据伯努利不等式）故上界存在。&lt;br&gt;
如果 $a^{x_0}&amp;lt;y$，则 $\exists n$，$a^{1/n}&amp;lt;y/a^{x_0}$，故 $a^{x_0+1/n}&amp;lt;y$，与 $x_0$ 是上界矛盾；如果 $a^{x_0}&amp;gt;y$ 也是类似的。&lt;/p&gt;
&lt;p&gt;Definition 6.4. 对于 $y&amp;gt;0$，$a&amp;gt;1$，$\log_ay$ 为使得 $a^x=y$ 的唯一的 $x$；对于 $0&amp;lt;a&amp;lt;1$，$\log_ay=-\log_{1/a}y$。&lt;/p&gt;
&lt;p&gt;Corollary 6.2. 对数函数的运算法则和单调性等。略。&lt;/p&gt;
&lt;p&gt;P.S. 我们可以用 $x^\alpha=\mathrm{e}^{\alpha\ln x}$ 来定义幂函数，但我看不出有什么必要。&lt;/p&gt;
&lt;p&gt;Definition 6.5. 定义 $\sin x$ 和 $\cos x$ 为满足以下公理的两个 $\R\to\R$ 的函数（可以说明它们是唯一的）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\cos 0=\sin\pi/2=1$，$\cos\pi=-1$。&lt;/li&gt;
&lt;li&gt;$\cos(x-y)=\cos x\cos y+\sin x\sin y$。&lt;/li&gt;
&lt;li&gt;$\forall x\in(0,\pi/2)$，$0&amp;lt;\cos x&amp;lt;\sin x/x&amp;lt;1/\cos x$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;定积分理论&#34;&gt;定积分理论
&lt;/h3&gt;&lt;p&gt;Definition 0. 一个区间 $[a,b]$ 的划分 $P$ 为一个有限的严格递增列 $a=x_0&amp;lt;x_1&amp;lt;\cdots&amp;lt;x_n=b$。定义其范数 $\lVert P\rVert=\max{x_{i}-x_{i-1}}$。&lt;/p&gt;
&lt;p&gt;Definition 1. 对于定义在 $[a,b]$ 上的&lt;strong&gt;有界&lt;/strong&gt;函数 $f$，与一个 $[a,b]$ 的划分 $P$，定义 $f$ 关于 $P$ 的 Darboux 上和为
$$
\overline{S}(f,P)=\sum_{i=1}^n(x_i-x_{i-1})\cdot\sup_{x\in[x_{i-1},x_i]}f(x)
$$
下和同理。&lt;/p&gt;
&lt;p&gt;Definition 2. （语境略）定义 Darboux 上积分为
$$
\overline{S}(f)=\overline{\int_a^b}f(x)\d x=\inf_P\overline{S}(f,P)
$$
下积分同理。如果上下积分存在且相等，就定义 Darboux 积分为这个相等的值，称 $f$ 在 $[a,b]$ 上 Darboux 可积。&lt;/p&gt;
&lt;p&gt;Property 1. 对于两个划分 $P$，$Q$，$\underline{S}(f,P)\le\underline{S}(f,P\cup Q)\le\overline{S}(f,P\cup Q)\le\overline{S}(f,Q)$。&lt;br&gt;
Proof. 直接使用 $\inf$ 和 $\sup$ 的性质。&lt;/p&gt;
&lt;p&gt;Theorem 1.
$$
\underline{S}(f)=\overline{S}(f)
\Longleftrightarrow\forall\varepsilon&amp;gt;0,\exists P,\overline{S}(f,P)-\underline{S}(f,P)&amp;lt;\varepsilon
\Longleftrightarrow\exists I,\forall\varepsilon&amp;gt;0,I-\varepsilon&amp;lt;\underline{S}(f,P)\le I\le\overline{S}(f,P)&amp;lt;I+\varepsilon
$$
Proof. 只证 $2\Rightarrow 3$。取 $I=\underline{S}(f)$。$\forall\varepsilon&amp;gt;0$，$\exists P$，$\underline{S}(f,P)\le I\le\overline{S}(f)\le\overline{S}(f,P)&amp;lt;\underline{S}(f,P)+\varepsilon\le\underline{S}(f)+\varepsilon$。&lt;/p&gt;
&lt;p&gt;Property 2. （大前提有界）递增函数、连续函数、间断点有限函数均 Darboux 可积。&lt;br&gt;
Proof. 递增函数：$\overline{S}(f,P)-\underline{S}(f,P)\le(f(b)-f(a))\lVert P\rVert$。连续函数：利用一致连续性。间断点有限函数：在各间断点处搞个足够小的区间。&lt;/p&gt;
&lt;p&gt;Property 3. $(a,b)$ 上连续的函数也 Darboux 可积。&lt;br&gt;
Proof. 设极差为 $M$。对于 $\varepsilon$，考虑左右两端取短段 $\delta$ 以排除端点处震荡间断的影响，于是 $[a+\delta,b-\delta]$ 上一致连续。对于中间，如果对于 $\varepsilon^\prime$ 来说，一致连续保证 $\delta^\prime$ 内震荡 $&amp;lt;\varepsilon^\prime$，则总的就是
$$
\overline{S}(f,P)-\underline{S}(f,P)\le2\delta M+(b-a-2\delta)\varepsilon^\prime
$$
取要求 $\varepsilon^\prime=\varepsilon/2(b-a)$，以及 $\delta=\min{\delta^\prime,\varepsilon/4M}$ 即可。&lt;/p&gt;
&lt;p&gt;Definition 3. 在 $P$ 的基础上额外加一组表示点 $\xi_{1\sim n}$，$\xi_i\in[x_{i-1},x_i]$。定义对应的 Riemann 和
$$
S(f,P,\xi)=\sum_{i=1}^n(x_i-x_{i-1})f(\xi_i)
$$
如果 $\exists I$，$\forall\varepsilon&amp;gt;0$，$\exists\delta&amp;gt;0$，$\forall P:\lVert P\rVert&amp;lt;\delta$，$\forall\xi$，$|S(f,P,\xi)-I|&amp;lt;\varepsilon$，则称 $I$ 为 $f$ 在 $[a,b]$ 上的 Riemann 积分，$f\in\mathscr{R}[a,b]$。
$$
I=\int_a^bf(x)\d x
$$
Remark. Darboux 定义的是无向的积分，更容易高维推广；Riemann 定义的是有向积分，处理正负更方便。&lt;/p&gt;
&lt;p&gt;Definition 4. 一个点集为零测度集，定义为，$\forall\varepsilon&amp;gt;0$，存在一列开区间覆盖所有点，且长度和 $&amp;lt;\varepsilon$。&lt;/p&gt;
&lt;p&gt;Property 4. 可数集为零测度集。&lt;br&gt;
P.S. 零测度集可能不可数，如康托集。&lt;/p&gt;
&lt;p&gt;Theorem 2.（Darboux 定理）若 $\overline{S}(f)$ 存在，则 $\displaystyle\lim_{\lVert P\rVert\to 0}\overline{S}(f,P)=\overline{S}(f)$。（不明确写这个 $\lim$ 的定义了，容易脑补）&lt;br&gt;
Proof. 设极差为 $M$。$\forall\varepsilon&amp;gt;0$，由 $\inf$ 的定义，$\exists P$，$\overline{S}(f,P)&amp;lt;\overline{S}(f)+\varepsilon^\prime$。$\forall P^\prime:\lVert P^\prime\rVert&amp;lt;\delta$，考虑 $\overline{S}(f,P)$、$\overline{S}(f,P^\prime)$ 与 $\overline{S}(f,P\cup P^\prime)$ 的关系：当划分从 $P^\prime$ 变成 $P\cup P^\prime$ 时，至多 $|P|$ 个 $P^\prime$ 中的区间被细分了，假设这些细分的区间的贡献都变化极大，也就只有 $\overline{S}(f,P^\prime)-\overline{S}(f,P\cup P^\prime)\le|P|\delta M$。于是 $\overline{S}(f,P^\prime)\le\overline{S}(f,P\cup P^\prime)+|P|\delta M\le\overline{S}(f,P)+|P|\delta M&amp;lt;\overline{S}(f)+\varepsilon^\prime+|P|\delta M$。取 $\delta=\varepsilon/2|P|M$，$\varepsilon^\prime=\varepsilon/2$ 即可。&lt;/p&gt;
&lt;p&gt;Theorem 3.（Lebesgue 可积性定理）$f$ 在 $[a,b]$ 上 Riemann 可积 $\Longleftrightarrow$ $f$ 在 $[a,b]$ 上有界且 Darboux 可积 $\Longleftrightarrow$ $f$ 在 $[a,b]$ 上的间断点为零测度集。&lt;br&gt;
Proof. $1\Rightarrow 2$ 易（需先证有界）。$2\Rightarrow 1$ 用 Theorem 2。&lt;br&gt;
定义 $f$ 在点 $x$ 处的振幅为
$$
\omega(x)=\lim_{\delta\to 0}\left(\sup_{x^\prime\in U(x,\delta)}f(x^\prime)-\inf_{x^\prime\in U(x,\delta)}f(x^\prime)\right)
$$
那么不连续点即为 $\omega&amp;gt;0$ 的点。&lt;/p&gt;
&lt;p&gt;$2\Rightarrow 3$：由于存在划分 $P$ 使得 $\overline{S}(f,P)-\underline{S}(f,P)&amp;lt;\varepsilon/2k$，故所有 $\omega\ge1/k$ 的间断点形成的集合 $D_{1/k}$，一定能被长度 $&amp;lt;\varepsilon$ 的区间覆盖。这是因为，所有处于 $P$ 中非分割端点的 $D_{1/k}$ 中元素，它们对应的总段长至多 $\varepsilon/2$，在端点处的随意处理。从而 $D_{1/k}$ 是零测度集。现在，所有间断点的集合 $D=\bigcup_{k=1}^{\infty}D_{1/k}$，而可数个零测度集的并仍为零测度集。&lt;br&gt;
$3\Rightarrow 2$：$\forall\varepsilon&amp;gt;0$，我们知道 $D_{\varepsilon/2(b-a)}$ 可以被一族长度和 $&amp;lt;\varepsilon/2M$ 的开区间覆盖，对于 $\omega&amp;lt;\varepsilon/2(b-a)$ 的每一点，都可以找到其一邻域，该邻域的振幅 $&amp;lt;[\omega+\varepsilon/2(b-a)]/2&amp;lt;\varepsilon/2(b-a)$。于是我们现在得到 $[a,b]$ 的一组开覆盖，从而有有限开覆盖 $C$。将该开覆盖的各端点作为划分点，得到的上下和之差必不超过各开区间振幅乘长度之和，而后者小于 $M\cdot\varepsilon/2M+(b-a)\cdot\varepsilon/2(b-a)=\varepsilon$。&lt;br&gt;
参考：&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/450983357&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/450983357&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;狄利克雷判别法&#34;&gt;狄利克雷判别法
&lt;/h3&gt;&lt;p&gt;Theorem 1.（微分中值定理）对于 $g\in\mathscr{R}[a,b]$，$f$ 在 $[a,b]$ 上单调不增，$\exists\xi\in[a,b]$，
$$
\int_a^bf(x)g(x)\d x=f(a)\int_a^\xi g(x)\d x+f(b)\int_\xi^bg(x)\d x
$$
Proof. 我们先考虑 $f(b)=0$ 的情况。令 $G$ 为 $g$ 的积分上限函数（以 $a$ 为下限），$M$ 为 $g$ 的界。第一步我们希望把乘积的积分的一半拆成和式：对于 $[a,b]$ 的一个划分 $P$，
$$
\begin{align*}
&amp;amp;\left\lvert\sum_{i=1}^nf(x_{i-1})\int_{x_{i-1}}^{x_i}g(x)\d x-\int_a^bf(x)g(x)\d x\right\rvert\\
={}&amp;amp;\left\lvert\sum_{i=1}^n\int_{x_{i-1}}^{x_i}(f(x_{i-1})-f(x))g(x)\d x\right\rvert\\
\le{}&amp;amp;M\sum_{i=1}^n\int_{x_{i-1}}^{x_i}(f(x_{i-1})-f(x))\d x\\
\le{}&amp;amp;M\sum_{i=1}^n(f(x_{i-1})-f(x_i))(x_i-x_{i-1})\\
\le{}&amp;amp;M|P|\sum_{i=1}^n(f(x_{i-1})-f(x_i))\\
={}&amp;amp;M|P|f(a)\to 0\;(|P|\to 0)
\end{align*}
$$
从而（$\in$ 号用了 $f$ 单调的性质）
$$
\begin{align*}
&amp;amp;\int_a^bf(x)g(x)\d x\\
={}&amp;amp;\lim_{|P|\to 0}\sum_{i=1}^nf(x_{i-1})(G(x_i)-G({x_{i-1}}))\\
={}&amp;amp;\lim_{|P|\to 0}\left(\sum_{i=0}^{n-1}f(x_i)G(x_{i+1})-\sum_{i=0}^nf(x_i)G(x_i)\right)\\
={}&amp;amp;\lim_{|P|\to 0}\left(\sum_{i=1}^nf(x_{i-1})G(x_i)-\sum_{i=1}^nf(x_i)G(x_i)\right)\\
={}&amp;amp;\lim_{|P|\to 0}\sum_{i=1}^n(f(x_{i-1})-f(x_i))G(x_i)\\
\in{}&amp;amp;\left[\lim_{|P|\to 0}\sum_{i=1}^n(f(x_{i-1})-f(x_i))\cdot\min_{x\in[a,b]}G(x),\lim_{|P|\to 0}\sum_{i=1}^n(f(x_{i-1})-f(x_i))\cdot\max_{x\in[a,b]}G(x)\right]\\
={}&amp;amp;f(a)\left[\min_{x\in[a,b]}G(x),\max_{x\in[a,b]}G(x)\right]
\end{align*}
$$
由于 $G$ 连续，故存在 $\xi$ 使
$$
\int_a^bf(x)g(x)\d x=f(a)\int_a^\xi g(x)\d x
$$
对于 $f(b)\ne 0$ 的情况，我们知道存在 $\xi$ 使
$$
\int_a^b(f(x)-f(b))g(x)\d x=(f(a)-f(b))\int_a^\xi g(x)\d x
$$
移项即可。&lt;br&gt;
参考：&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/596132013/answer/3487524727&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/596132013/answer/3487524727&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Theorem 2.（狄利克雷判别法）对于 $g\in\mathscr{R}[a,\forall b]$，$f$ 在 $[a,+\infty)$ 上单调不增，若 $G$ 有界，$f$ 趋近于 $0$，则
$$
\int_a^{+\infty}f(x)g(x)\d x
$$
存在。&lt;br&gt;
Proof. 考虑使用柯西来判。考虑到 $\exists\xi\in[l,r]$，
$$
\int_l^rf(x)g(x)\d x=f(l)\int_l^\xi g(x)\d x+f(r)\int_\xi^rg(x)\d x=f(l)(G(\xi)-G(l))+f(r)(G(r)-G(\xi))
$$
由于 $G$ 有界，故只需取足够大的 $l$ 使 $f$ 足够小即可。&lt;/p&gt;
&lt;h3 id=&#34;高阶线性微分方程解的存在性&#34;&gt;高阶线性微分方程解的存在性
&lt;/h3&gt;&lt;p&gt;比较复杂（Picard-Lindelöf 定理），先咕了。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>线代的一些题</title>
        <link>https://littlereuben.github.io/study/course-linear-algebra/</link>
        <pubDate>Wed, 22 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-linear-algebra/</guid>
        <description>&lt;p&gt;$\gdef\ker{\mathop{\mathrm{Ker}}}\gdef\im{\mathop{\mathrm{Im}}}\gdef\e{\mathrm{e}}\gdef\d{\mathrm{d}}\gdef\F{\mathbb{F}}\gdef\r{\operatorname{rank}}\gdef\L{\mathsf{L}}\gdef\mat#1{\begin{bmatrix}#1\end{bmatrix}}\gdef\dat#1{\begin{vmatrix}#1\end{vmatrix}}\gdef\T{\mathsf{T}}\gdef\U{\mathsf{U}}\gdef\E{\mathsf{E}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h3 id=&#34;前言&#34;&gt;前言
&lt;/h3&gt;&lt;p&gt;完全从线性变换角度去讲线性代数，主要就是六个递进的难点：秩—零化度定理、行列秩相等、Cayley–Hamilton 定理、对偶、内积空间下的对偶、正交相关定理。反而行列式、SVD、Jordan 之类的没有那么难理解，只是麻烦罢了。&lt;/p&gt;
&lt;p&gt;线性变换最难解释的是转置，转置没有一个直观的意义，例如转置的行列式等于原行列式这种东西。无论是否在内积空间下，转置只能用范畴论去理解，画出对偶的交换图，它其实也是很自然的，但再往后，到了复正规矩阵和实对称矩阵可以正规对角化这里，就完全不懂了，只能背证明。&lt;/p&gt;
&lt;p&gt;但总的来说我线性代数没记特别多东西，Cayley–Hamilton 定理和对偶相关的理解就咕掉了。&lt;/p&gt;
&lt;h3 id=&#34;题&#34;&gt;题
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;只使用线性变换的知识（不使用初等行变换）证明 $\dim\ker f+\dim\im f=\dim V$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$\ker f$ 是 $V$ 的一个子空间。取出它的一组基 $\set{v_{1\sim n}}$，并将它扩展成 $V$ 的基 $\set{v_{1\sim n},v_{n+1\sim m}}$。现在 $f(v_{1\sim n})=0$，而我们要证的是，$\set{f(v_{n+1\sim m})}$ 线性无关，从而它是 $\im f$ 的基。
$$
\sum c_if(v_i)=0\Longleftrightarrow f\left(\sum c_iv_i\right)=0\Longleftrightarrow \sum c_iv_i\in\ker f
$$
这里 $\sum$ 是 $\sum_{i=n+1}^m$。要么 $c$ 全都是 $0$，要么 $\set{v_{1\sim m}}$ 不是基。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;只使用线性变换的知识（不使用初等行变换）证明行秩等于列秩。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;考虑 $A_{n\times m}$ 的行空间的对偶空间，这个空间就是 $\F^m/\ker A$，于是
$$
行秩=m-\dim\ker A=m-(m-\dim\im A)=列秩
$$
这里的核心思路是说，将 $A$ 以两种方式看成同一个线性变换：一种是将 $A$ 视作某个对偶空间（对偶空间的对偶空间与原空间间存在自然映射，在这个问题里更简单，就是个点乘）——这个是行的，一种是直接考虑 $A$ 的线性变换——这个是列的。那么剩下的问题其实是证明原空间和对偶空间的维数相等，这个是用基来证的。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/course-linear-algebra/rrecr.png&#34;
	width=&#34;1317&#34;
	height=&#34;816&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;161&#34;
		data-flex-basis=&#34;387px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$f:V\to V$。证明 $\exists k$，$V=\ker f^k\oplus\im f^k$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们知道 $\im f^{k+1}\subseteq\im f^k$，于是 $\exists k$，$\dim V&amp;gt;\dim\im f&amp;gt;\dim\im f^2&amp;gt;\cdots&amp;gt;\dim\im f^k=\dim\im f^{k+1}=\dim\im f^{k+2}=\cdots$。如果 $\ker f^k\cap\im f^k\supseteq\set{0,v}$，则 $f^{2k}(v)=0$，矛盾。&lt;/p&gt;
&lt;p&gt;这个命题在抽代里也有一个对应的版本。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$A_{n\times m}$，$B_{m\times l}$。证明 $\r(A)+\r(B)-m\le\r(AB)$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;首先，我们有，对于 $f:U\to V$，$g:V\to W$，
$$
\dim\ker f+\dim\ker g\ge\dim\ker(g\circ f)
$$
直观上很好理解，证明：
$$
\dim\ker(g\circ f)=\dim(\ker f\oplus\ker g|_{\im f})=\dim\ker f+\dim\ker g|_{\im f}\le\dim\ker f+\dim\ker g
$$&lt;/p&gt;
&lt;p&gt;于是
$$
\begin{align*}
\r(AB)&amp;amp;=\dim\im\L_{AB}\\
&amp;amp;=\dim\im(\L_A\circ\L_B)\\
&amp;amp;=l-\dim\ker(\L_A\circ\L_B)\\
&amp;amp;\ge l-\dim\ker\L_A-\dim\ker\L_B\\
&amp;amp;=l-m+\dim\im\L_A-l+\dim\im\L_v\\
&amp;amp;=\r(A)+\r(B)-m
\end{align*}
$$
可选的一种类似的思路：先证 $\dim\im(g\circ f)\ge\dim\im f-\dim\ker g$：$\dim\im f=\dim\ker g|_{\im f}+\dim\im g|_{\im f}$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$A_{n\times n}$，$B_{n\times n}$，$AB=BA=O$，$\r(A^2)=\r(A)$。证明 $\r(A+B)=\r(A)+\r(B)$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;思路 1：证明 $\ker\L_{A+B}=\ker\L_A\cap\ker\L_B$ 与 $\ker\L_A+\ker\L_B=\R^n$。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$(A+B)x=0\Rightarrow Ax=A(A+B)x=0$，$(A+B)x=0\Rightarrow Bx=-Ax=0\Rightarrow\ker\L_{A+B}\subseteq\ker\L_A\cap\ker\L_B$。&lt;/li&gt;
&lt;li&gt;$\r(A^2)=\r(A)\Rightarrow\ker\L_A\oplus\im\L_A=\R^n$，$BA=0\Rightarrow\im\L_A\subseteq\ker\L_B\Rightarrow\ker\L_A+\ker\L_B=\R^n$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;思路 2：证明 $\im\L_{A+B}=\im\L_A+\im\L_B$ 与 $\im\L_A\cap\im\L_B=\set{0}$。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\im\L_A=\im\L_{A^2+BA}=\im\L_{(A+B)A}\subseteq\im\L_{A+B}$；$\im\L_B=\im\L_{A+B-A}\subseteq\im\L_{A+B}+\im\L_A=\im\L_{A+B}$。&lt;/li&gt;
&lt;li&gt;$\r(A^2)=\r(A)\Rightarrow\ker\L_A\oplus\im\L_A=\R^n$，$AB=O\Rightarrow\im\L_B\subseteq\ker\L_A$。&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;$A_{m\times n}$，$B_{n\times m}$，证明 $\r(AB)=\r(A)\Rightarrow\exists C_{m\times n},A=ABC$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;设 $A=[\alpha_i]$。$Ae_i=\alpha_i$，而 $\ker\L_{AB}=\ker\L_A$ 故 $\exists\gamma_i$，$AB\gamma_i=\alpha_i$。令 $C=[\gamma_i]$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$A_{n\times n}$。证明若 $\forall x\in\R^n$，$x\ne 0$，$|x^\top Ax|&amp;lt;|x^\top x|$，则 $I-A^2$ 可逆。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$|x^\top Ax|&amp;lt;|x^\top x|$ 展开：
$$
-\sum x_i^2&amp;lt;\sum\sum x_ix_ja_{ij}&amp;lt;+\sum x_i^2\\
\Longrightarrow
\left\{
\begin{aligned}
x^\top(I-A)x=\sum\sum x_ix_j(\delta_{ij}-a_{ij})&amp;gt;0\\
x^\top(I+A)x=\sum\sum x_ix_j(\delta_{ij}+a_{ij})&amp;gt;0
\end{aligned}
\right.
$$
如果 $I-A$ 不可逆，则 $\exists x\ne 0$，$(I-A)x=0$，那么 $x^{\top}(I-A)x=0$，矛盾。&lt;/p&gt;
&lt;p&gt;同理 $I+A$ 可逆，于是 $I-A^2$ 可逆。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$A_{m\times n}$，$B_{n\times m}$，证明 $\r(I_m+AB)-\r(I_n+BA)=m-n$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\begin{bmatrix}I_m+AB&amp;amp;O\\ O&amp;amp;I_n\end{bmatrix}\sim\begin{bmatrix}I_m+AB&amp;amp;A\\ O&amp;amp;I_n\end{bmatrix}\sim\begin{bmatrix}I_m&amp;amp;A\\ -B&amp;amp;I_n\end{bmatrix}\sim\begin{bmatrix}I_m&amp;amp;A\\ O&amp;amp;I_n+BA\end{bmatrix}\sim\begin{bmatrix}I_m&amp;amp;O\\ O&amp;amp;I_n+BA\end{bmatrix}
$$&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/473406438&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/473406438&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;TMD 为什么我记了这个期末考却没想起来？？&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$A_{l\times m}$，$B_{n\times p}$，$C_{l\times p}$。证明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$W_{p\times n}$，$BWB=B$ 总是有解。&lt;/li&gt;
&lt;li&gt;$X_{m\times n}$，$AXB=C$ 有解 $\Leftrightarrow \r(A)=\r(\begin{bmatrix}A&amp;amp;C\end{bmatrix})\land\r\left(\begin{bmatrix}B\\ C\end{bmatrix}\right)$&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;设 $\r(B)=r$。通过消成相抵标准形，可以得到 $B=PQ$ 满秩分解，其中 $P_{n\times r}$ 是列满秩，$Q_{r\times p}$ 是行满秩。构造 $W=B^+=Q^\top(QQ^\top)^{-1}(P^\top P)^{-1}P^\top$。只需证明 $\r(QQ^\top)=\r(P^\top P)=r$ 即可，这个直接用一般的公式（同解证）。&lt;/p&gt;
&lt;p&gt;$\Leftarrow$：构造 $X=A^+CB^+$。根据条件，$AY=C$、$ZB=C$ 均有解，故
$$
AXB=AA^+CB^+B=AA^+AYB^+B=AYB^+B=CB^+B=ZBB^+B=ZB=C
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$a\in\R^n$，求 $\dat{I+aa^\top}$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;思路 1：根据行列式的拆分公式，可以把 $\dat{I+aa^\top}$ 拆成 $2^n$ 个行列式的和，其中如果有两行都取自 $aa^\top$ 就是 $0$，剩下的就是 $1+\sum a_i^2$。&lt;/p&gt;
&lt;p&gt;思路 2：考虑 $(I+aa^\top)v=\lambda v\Leftrightarrow aa^\top v=(\lambda-1)v$。我们知道 $a\ne 0$ 时 $\dim aa^\top=1$，故有 $n-1$ 重 $\lambda-1=0$。另一重怎么考虑呢？代入 $v=a$ 得 $aa^\top v=a(a^\top v)=\braket{a,a}a$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$$
\dat{\lambda&amp;amp;1&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ n&amp;amp;\lambda&amp;amp;2&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-1&amp;amp;\lambda&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;1&amp;amp;\lambda}
$$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;思路 1：令原式为 $D_n(\lambda)$。
$$
\begin{align*}
D_n(\lambda)={}&amp;amp;\dat{\lambda&amp;amp;1&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ n&amp;amp;\lambda&amp;amp;2&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-1&amp;amp;\lambda&amp;amp;3&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;n-2&amp;amp;\lambda&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda&amp;amp;n-1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda}\\
\xlongequal{r_1\xleftarrow{+}r_2+\cdots+r_{n+1}}{}&amp;amp;\dat{\lambda+n&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;\cdots&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;\lambda+n\\ n&amp;amp;\lambda&amp;amp;2&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-1&amp;amp;\lambda&amp;amp;3&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;n-2&amp;amp;\lambda&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda&amp;amp;n-1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda}\\
\xlongequal{c_2,\cdots,c_{n+1}\xleftarrow{-}c_1}{}&amp;amp;\dat{\lambda+n&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ n&amp;amp;\lambda-n&amp;amp;2-n&amp;amp;-n&amp;amp;\cdots&amp;amp;-n&amp;amp;-n&amp;amp;-n\\ 0&amp;amp;n-1&amp;amp;\lambda&amp;amp;3&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;n-2&amp;amp;\lambda&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda&amp;amp;n-1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda}\\
\xlongequal{r_1}{}&amp;amp;\dat{\lambda-n&amp;amp;2-n&amp;amp;-n&amp;amp;\cdots&amp;amp;-n&amp;amp;-n&amp;amp;-n\\ n-1&amp;amp;\lambda&amp;amp;3&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-2&amp;amp;\lambda&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda&amp;amp;n-1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda}\cdot(\lambda+n)\\
\xlongequal{r_1\xleftarrow{+}r_2+\cdots+r_n}{}&amp;amp;\dat{\lambda-1&amp;amp;\lambda&amp;amp;\lambda&amp;amp;\cdots&amp;amp;\lambda&amp;amp;\lambda&amp;amp;\lambda\\ n-1&amp;amp;\lambda&amp;amp;3&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-2&amp;amp;\lambda&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda&amp;amp;n-1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda}\cdot(\lambda+n)\\
\xlongequal{r_2\xleftarrow{+}r_3+\cdots+r_n}{}&amp;amp;\cdots\cdots\\
\xlongequal{r_{n-1}\xleftarrow{+}r_n}{}&amp;amp;\dat{\lambda-1&amp;amp;\lambda&amp;amp;\lambda&amp;amp;\cdots&amp;amp;\lambda&amp;amp;\lambda&amp;amp;\lambda\\ n-1&amp;amp;\lambda+n-2&amp;amp;\lambda+n&amp;amp;\cdots&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;\lambda+n\\ 0&amp;amp;n-2&amp;amp;\lambda+n-3&amp;amp;\cdots&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;\lambda+n\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda+2&amp;amp;\lambda+n&amp;amp;\lambda+n\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda+1&amp;amp;\lambda+n\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda}\cdot(\lambda+n)\\
\xlongequal{c_n\xleftarrow{-}c_{n-1}}{}&amp;amp;\dat{\lambda-1&amp;amp;\lambda&amp;amp;\lambda&amp;amp;\cdots&amp;amp;\lambda&amp;amp;\lambda&amp;amp;0\\ n-1&amp;amp;\lambda+n-2&amp;amp;\lambda+n&amp;amp;\cdots&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;0\\ 0&amp;amp;n-2&amp;amp;\lambda+n-3&amp;amp;\cdots&amp;amp;\lambda+n&amp;amp;\lambda+n&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda+2&amp;amp;\lambda+n&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda+1&amp;amp;n-1\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda-1}\cdot(\lambda+n)\\
\xlongequal{c_{n-1}\xleftarrow{-}c_{n-2}}{}&amp;amp;\cdots\cdots\\
\xlongequal{c_2\xleftarrow{-}c_1}{}&amp;amp;\dat{\lambda-1&amp;amp;1&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ n-1&amp;amp;\lambda-1&amp;amp;2&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-2&amp;amp;\lambda-1&amp;amp;\cdots&amp;amp;0&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;\lambda-1&amp;amp;n-2&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;2&amp;amp;\lambda-1&amp;amp;n-1\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;1&amp;amp;\lambda-1}\cdot(\lambda+n)\\
={}&amp;amp;(\lambda+n)D_{n-1}(\lambda-1)\\
={}&amp;amp;(\lambda+n)(\lambda+n-2)D_{n-2}(\lambda-2)\\
={}&amp;amp;\cdots\cdots\\
={}&amp;amp;\prod_{i=0}^n(\lambda+n-2i)
\end{align*}
$$
思路 2：&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/a/340611&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/a/340611&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;思路 3：记
$$
A=\mat{0&amp;amp;1&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ n&amp;amp;0&amp;amp;2&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ 0&amp;amp;n-1&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;n\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;1&amp;amp;0}
$$
（该矩阵被称为 Kac matrix）&lt;/p&gt;
&lt;p&gt;考虑 $Ax=\lambda x$，其中 $x=\mat{x_0&amp;amp;\cdots&amp;amp;x_n}^\top$。具体写成：
$$
\left\{\begin{align*}
x_1&amp;amp;=\lambda x_0\\
nx_0+2x_2&amp;amp;=\lambda x_1\\
(n-1)x_1+3x_3&amp;amp;=\lambda x_2\\
\cdots&amp;amp;\cdots\\
x_{n-1}&amp;amp;=\lambda x_n
\end{align*}\right.
$$
令 $f(t)=\sum x_it^i$，可以写成 $t(nf-tf^\prime)+f^\prime=\lambda f$ 即
$$
\frac{f^\prime(t)}{f(t)}=\frac{nt-\lambda}{t^2-1}=\frac{n+\lambda}{2(t+1)}+\frac{n-\lambda}{2(t-1)}
$$
两端同时积分得
$$
f(t)=C(t+1)^{(n+\lambda)/2}(t-1)^{(n-\lambda)/2}
$$
也就是说，仅有这些 $f$ 展开可以作为 $x$，且这样的 $f$ 还需满足没有超过 $x^n$ 的项，因此只能有 $|\lambda|\le n$ 且 $\lambda$ 为与 $n$ 奇偶的整数。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;证明：如果一个方阵 $A$ 只有行列异奇偶的位置非零，则其特征值一定正负成对出现。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;考虑 $D=\operatorname{diag}(1,-1,1,-1,\cdots)$。注意到 $D^{-1}AD=-A$。因此，若 $Av=\lambda v$，则
$$
A(Dv)=(AD)v=-(DA)v=-D(Av)=-D\lambda v=-\lambda(Dv)
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;求
$$
A=\mat{b&amp;amp;c&amp;amp;0&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ a&amp;amp;b&amp;amp;c&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ 0&amp;amp;a&amp;amp;b&amp;amp;\cdots&amp;amp;0&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;b&amp;amp;c\\ 0&amp;amp;0&amp;amp;0&amp;amp;\cdots&amp;amp;a&amp;amp;b}
$$
的特征值与特征向量。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们知道，
$$
\dat{A}=\left\{\begin{aligned}&amp;amp;\frac1{\sqrt\Delta}\left[\left(\frac{b+\sqrt\Delta}2\right)^{n+1}-\left(\frac{b-\sqrt\Delta}2\right)^{n+1}\right],&amp;amp;\Delta\ne0\\ &amp;amp;(n+1)\left(\frac b2\right)^n,&amp;amp;\Delta=0\end{aligned}\right.
$$
如果 $ac=0$，那么唯一的特征值为 $b$，否则
$$
\lambda=b-2\sqrt{ac}\cos\frac{k\pi}{n+1}\;(k=1,\cdots,n)
$$
特征向量似乎有点难。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;求循环矩阵 $\Set{a_{(n-i+j)\bmod n}}$ 的特征值与特征向量。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这个反倒很简单，既然知道求行列式的套路是
$$
\mat{a_0&amp;amp;a_1&amp;amp;\cdots&amp;amp;a_{n-1}\\ a_{n-1}&amp;amp;a_0&amp;amp;\cdots&amp;amp;a_1\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ a_1&amp;amp;a_2&amp;amp;\cdots&amp;amp;a_0}\mat{\omega^{0\cdot0}&amp;amp;\omega^{1\cdot0}&amp;amp;\cdots&amp;amp;\omega^{(n-1)\cdot0}\\ \omega^{0\cdot1}&amp;amp;\omega^{1\cdot1}&amp;amp;\cdots&amp;amp;\omega^{(n-1)\cdot1}\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \omega^{0\cdot(n-1)}&amp;amp;\omega^{1\cdot(n-1)}&amp;amp;\cdots&amp;amp;\omega^{(n-1)\cdot(n-1)}}=\mat{\omega^{0\cdot0}f(\omega^0)&amp;amp;\omega^{1\cdot0}f(\omega^1)&amp;amp;\cdots&amp;amp;\omega^{(n-1)\cdot0}f(\omega^{n-1})\\ \omega^{0\cdot1}f(\omega^0)&amp;amp;\omega^{1\cdot1}f(\omega^1)&amp;amp;\cdots&amp;amp;\omega^{(n-1)\cdot1}f(\omega^{n-1})\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \omega^{0\cdot(n-1)}f(\omega^0)&amp;amp;\omega^{1\cdot(n-1)}f(\omega^1)&amp;amp;\cdots&amp;amp;\omega^{(n-1)\cdot(n-1)}f(\omega^{n-1})}
$$
那就知道特征值和特征向量分别是
$$
f(\omega^k),\,\mat{\omega^{k\cdot0}\\ \omega^{k\cdot1}\\ \vdots\\ \omega^{k\cdot(n-1)}}\;(k=0,\cdots,n-1)
$$
其中 $f(x)=\sum a_ix^i$，$\omega=\e^{2\pi\mathrm{i}/n}$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;对于 $A_{m\times n}$，$B_{n\times m}$，证明 $I_m-AB$ 可逆 $\Leftrightarrow$ $I_n-BA$ 可逆。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证 1：若 $(I-AB)C=I$，则 $(I-BA)(BC)=BC-B(C-I)=B$，故 $(I-BA)(BCA)=BA=I-(I-BA)$，故 $(I-BA)(BCA+I)=I$。&lt;/p&gt;
&lt;p&gt;证 2：若对于某个 $x\ne 0$，$(I-AB)x=0$，则 $(I-BA)Bx=Bx-BABx=Bx-Bx=0$，其中 $Bx\ne 0$ 因为否则 $(I-AB)x=x\ne 0$。&lt;/p&gt;
&lt;p&gt;证 3：
$$
\mat{I-AB&amp;amp;O\\ B&amp;amp;I}\sim\mat{I&amp;amp;A\\ B&amp;amp;I}\sim\mat{I&amp;amp;A\\ O&amp;amp;I-BA}
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$A^2=I$，证明 $A$ 可对角化。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\begin{align*}
&amp;amp;(A+I)(A-I)=0\\
\Longrightarrow{}&amp;amp;\im\L_{A-I}\subseteq\ker\L_{A+I}\\
\Longrightarrow{}&amp;amp;n-\dim\ker\L_{A-I}=\dim\im\L_{A-I}\le\dim\ker\L_{A+I}\\
\Longrightarrow{}&amp;amp;\dim\ker\L_{A-I}+\dim\ker\L_{A+I}\ge n
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;又知道特征空间的维数和不能超过 $n$，故 $\dim\ker\L_{A-I}+\dim\ker\L_{A+I}=n$。&lt;/p&gt;
&lt;p&gt;这类问题可以扩展到最小多项式相关的定理：如果一个矩阵/线性变换的最小多项式为 $\prod(t-\lambda_i)^{m_i}$，那它的 Jordan 标准型中 $\lambda_i$ 对应的 Jordan 块的最大大小就是 $m_i$。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;对于 Jordan 块 $J_{n\times n}$，求 $J^k$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;众所周知矩阵的幂次有一个组合意义：$A_{i,j}$ 表示 $i$ 到 $j$ 的边权，$(A^k)_{i,j}$ 表示 $i$ 到 $j$ 恰好走 $k$ 步，所有可能路径的边权之积的和。所以 $(J^k)_{i,j}$ 就是走 $j-i$，每次走 $0$ 或 $1$ 步，这个显然是
$$
\binom{k}{j-i}\lambda^{k-j+i}
$$&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;证明对于可对角化的 $\T$ 和 $\U$，$\T$ 和 $\U$ 可同时对角化当且仅当 $\T\U=\U\T$。如果 $\T$ 和 $\U$ 可正交对角化，类似的结论也成立。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;对于 $\T$ 的特征向量 $v\in\E_\lambda$，$\T\U(v)=\U\T(v)=\lambda\U(v)$ 从而 $\E_\lambda$ 是 $\U$ 的不变子空间。取 $\U$ 在其上的对角化即可。需要证明可对角化 $\Rightarrow$ 在不变子空间内可对角化，略。&lt;/p&gt;
&lt;p&gt;正交对角化的情况，考虑 $\mathbb{C}$。还是随便取一个 $\E_\lambda$，只需证明 $\E_\lambda^\perp$ 也是 $\T$ 和 $\U$ 的不变子空间即可。首先由内积的操作知道 $\E_\lambda^\perp$ 是 $\T^*$ 的不变子空间，其次 $\T^*$ 的特征向量都是 $\T$ 的特征向量，从而 $\E_\lambda^\perp$ 也是 $\T$ 的不变子空间。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>微积分 A(1) 期中复习—一些有意思的难题</title>
        <link>https://littlereuben.github.io/study/course-calculus-1-1/</link>
        <pubDate>Sun, 03 Nov 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/course-calculus-1-1/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;embed src= &#34;cal1_midterm.pdf&#34; width= &#34;100%&#34; height= &#34;800px&#34; type=&#34;application/pdf&#34; &gt;
&lt;a href=&#34;cal1_midterm.pdf&#34; style=&#34;display:block;text-align:center;&#34;&gt;&lt;b&gt;[PDF file]&lt;/b&gt;&lt;/a&gt;
</description>
        </item>
        <item>
        <title>高中物理中的拓展问题</title>
        <link>https://littlereuben.github.io/study/physics0/</link>
        <pubDate>Fri, 30 Aug 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/physics0/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/physics0/cover.jpg" alt="Featured image of post 高中物理中的拓展问题" /&gt;&lt;p&gt;$\gdef\d{\mathrm{d}}\gdef\sgn{\operatorname{sgn}}\gdef\e{\mathrm{e}}\gdef\bm#1{\boldsymbol{#1}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;这些内容主要写于 2024 年上半年我自学高中物理时想到的一些问题。实际上是 2025.2.23 upload 这个文章的，现在看起来很幼稚了，就只是当作记录吧。&lt;/p&gt;
&lt;h3 id=&#34;小球上半圆弧模型&#34;&gt;小球上半圆弧模型
&lt;/h3&gt;&lt;p&gt;众所周知，上到一半是 $\sqrt{2gr}$，从顶上飞出去是 $\sqrt{5gr}$。那斜抛刚好落到圆弧与水平面连接处呢？&lt;/p&gt;
&lt;p&gt;设斜抛起始点与圆心连线与水平夹角为 $\theta$，高度为 $h$。
$$
\left\{\begin{align*}
h&amp;amp;=r(1+\sin\theta)\\
\dfrac 12mv_0^2&amp;amp;=\dfrac 12mv^2+mgh\\
m\dfrac{v^2}r&amp;amp;=mg\sin\theta\\
h&amp;amp;=\dfrac 12gt^2-vt\cos\theta\\
r\cos\theta&amp;amp;=vt\sin\theta
\end{align*}\right.
$$
解得 $\sin\theta=\frac 12,v_0=\sqrt{3.5gr}$。&lt;/p&gt;
&lt;h3 id=&#34;恒定功率加速问题&#34;&gt;恒定功率加速问题
&lt;/h3&gt;&lt;p&gt;考虑机车从静止开始以恒定功率 $P$ 加速，阻力为 $f$，希望求出 $v$ 关于 $t$ 的表达式。根据牛二，
$$
\frac Pv-f=m\dot v
$$
即
$$
\dfrac{mv}{P-fv}\d v=\d t
$$&lt;/p&gt;
&lt;p&gt;两边积分然后根据 $v|_{t=0}=0$ 即可解得 $C$。&lt;/p&gt;
&lt;p&gt;当 $f=0$ 时，解得
$$
v=\sqrt{\frac{2Pt}m}
$$
其余情况下有
$$
\frac mf\left(\frac Pf\ln\frac P{P-fv}-v\right)=t
$$
当 $t\to+\infin$ 时 $v\to P/f$。$v$ 关于 $t$ 不存在初等表达式，需借助 Lambert W 函数。&lt;/p&gt;
&lt;p&gt;如果阻力正比于 $v$ 即 $f(v)=kv$，则
$$
v=\sqrt{\frac{P(1-\e^{-\frac{2k}mt})}k}
$$&lt;/p&gt;
&lt;h3 id=&#34;真正的自由落体运动&#34;&gt;真正的自由落体运动
&lt;/h3&gt;&lt;p&gt;method from zby（的同学）.&lt;/p&gt;
&lt;p&gt;视星体为质量为 $M$ 的质点，记 $y$ 为轻物体（如果是两个星体，以其中一个为参考系即可）距质点的距离。初始 $y|_{t=0}=d$，速度为 $0$。&lt;/p&gt;
&lt;p&gt;然后会得到这样一个微分方程：
$$
\ddot yy=GM
$$
不会解……&lt;/p&gt;
&lt;p&gt;换一个思路，由能量守恒，
$$
-{GM}d=-{GM}y+\frac12{\dot y}^2
$$
即
$$
\dot y=\sqrt{2GM\left(\frac 1y-\frac 1d\right)}
$$
那就是（我们来详细推导一下）
$$
\begin{align*}
t={}&amp;amp;\int_{y}^d\frac{\d x}{\sqrt{2GM\left(\frac 1x-\frac 1d\right)}}\\
\xlongequal{z=\sqrt{\frac 1x-\frac 1d}}{}&amp;amp;\sqrt{\frac{2}{GM}}\int_{0}^{\sqrt{\frac 1y-\frac 1d}}\frac{\d z}{\left(z^2+\frac 1d\right)^2}\\
\xlongequal{\tan\alpha=\sqrt dz}{}&amp;amp;\sqrt{\frac{2d^3}{GM}}\int_0^{\arctan\sqrt{\frac dy-1}}\cos^2\alpha\d\alpha\\
={}&amp;amp;\sqrt{\frac{2d^3}{GM}}\left.\left(\frac{\sin2\alpha}{4}+\frac\alpha2\right)\right|_0^{\arctan\sqrt{\frac dy-1}}\\
={}&amp;amp;\sqrt{\frac{d}{2GM}}\left(y\sqrt{\frac dy-1}+d\arctan\sqrt{\frac dy-1}\right)
\end{align*}
$$
因此，相撞时刻为
$$
t|_{y\to 0}=\frac\pi2d\sqrt\frac d{2GM}
$$&lt;/p&gt;
&lt;h3 id=&#34;开普勒推万有引力&#34;&gt;开普勒推万有引力
&lt;/h3&gt;&lt;h4 id=&#34;开普勒第一定律&#34;&gt;开普勒第一定律
&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;所有行星绕恒星运动的轨道都是椭圆，且恒星处在椭圆的某个焦点上。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;以 $F_1$ 为极点，$F_1F_2$ 为极轴建立极坐标系，行星轨迹为&lt;/p&gt;
&lt;p&gt;$$
r=\frac{ep}{1-e\cos\theta}
$$&lt;/p&gt;
&lt;h4 id=&#34;开普勒第二定律&#34;&gt;开普勒第二定律
&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;一对特定恒星与行星的连线在相等时间内所扫过的面积相等。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;设 $S$ 为单位时间内扫过的面积，则
$$
2S=r^2\dot\theta
$$&lt;/p&gt;
&lt;h4 id=&#34;开普勒第三定律&#34;&gt;开普勒第三定律
&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;对于一个恒星，其所有行星轨道半长轴的立方与公转周期的平方成正比。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;设该比例为 $k$，即
$$
\frac{a^3}{T^2}=k
$$
又
$$
T\cdot S=\pi ab
$$
故
$$
S^2=\frac{\pi^2kb^2}{a}
$$&lt;/p&gt;
&lt;h4 id=&#34;极坐标下的加速度&#34;&gt;极坐标下的加速度
&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;将极坐标下的加速度正交分解成径向加速度 $a_r$ 与切向加速度 $a_\theta$。&lt;/p&gt;
&lt;p&gt;极坐标下有径向基矢 $\hat r=\hat x\cos\theta+\hat y\sin\theta$ 和 切向基矢 $\hat\theta=-\hat x\sin\theta+\hat y\cos\theta$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;首先有
$$
\begin{align*}
\d\hat r&amp;amp;=\hat\theta\d\theta\\
\d\hat\theta&amp;amp;=-\hat r\d r
\end{align*}
$$
故
$$
\begin{align*}
\frac{\d(r\hat r)}{\d t}&amp;amp;=\dot r\hat r+r\hat\theta\\
\frac{\d^2(r\hat r)}{\d t^2}&amp;amp;=\left(\ddot r-r\dot\theta^2\right)\hat r+\left(2\dot r\dot\theta+r\ddot\theta\right)\hat\theta\\
\end{align*}
$$
即
$$
\begin{align*}
a_r&amp;amp;=\ddot r-r\dot\theta^2\\
a_\theta&amp;amp;=2\dot r\dot\theta+r\ddot\theta
\end{align*}
$$&lt;/p&gt;
&lt;h4 id=&#34;推导&#34;&gt;推导
&lt;/h4&gt;&lt;p&gt;综合上述公式，
$$
\begin{align*}
\dot r&amp;amp;=-\frac{e^2p\sin\theta}{(1-e\cos\theta)^2}\dot\theta\\
&amp;amp;=-\frac{r^2\dot\theta}{p}\sin\theta\\
&amp;amp;=-\frac{2S}{p}\sin\theta\\
\ddot r&amp;amp;=-\frac{2S}{p}\dot\theta\cos\theta\\
&amp;amp;=-\frac{2S}{p}\left(\frac 1e-\frac pr\right)\dot\theta\\
a_r&amp;amp;=\ddot r-r\dot\theta^2\\
&amp;amp;=-\frac{2S}{ep}\dot\theta+\frac{2S}{r}\dot\theta-\frac{2S}{r}\dot\theta\\
&amp;amp;=-\frac{2S}{ep}\cdot\frac{2S}{r^2}\\
&amp;amp;=-\frac{4\pi^2kb^2}{aepr^2}\\
&amp;amp;=-\frac{4\pi^2k}{r^2}\\
a_\theta&amp;amp;=2\dot r\dot\theta+r\ddot\theta\\
&amp;amp;=\frac{\d(r^2\theta)}{r\d t}\\
&amp;amp;=0
\end{align*}
$$
由牛二，引力方向为两星球连线，大小为
$$
F=\frac{4\pi^2km}{r^2}
$$
设恒星与行星质量分别为 $m_1,m_2$，对应常数分别为 $k_1,k_2$，由牛三，
$$
\frac{4\pi^2k_1m_2}{r^2}=\frac{4\pi^2k_2m_1}{r^2}
$$
即
$$
\frac{k_1}{m_1}=\frac{k_2}{m_2}
$$
由此可见，存在一常数，所有物体的 $k$ 比 $m$ 均为该常数，设其为 $\frac{G}{4\pi^2}$，则
$$
F=\frac{Gm_1m_2}{r^2}
$$&lt;/p&gt;
&lt;h3 id=&#34;非质点的库仑力计算&#34;&gt;非质点的库仑力计算
&lt;/h3&gt;&lt;p&gt;对于一个半径为 $R$，均匀带电 $Q$ 的圆环，与圆心连线垂直于圆面且长为 $D$ 的点处的电场大小为（相似三角形分解力）
$$
\frac{kQD}{(R^2+D^2)^{\frac 32}}
$$
对于一个半径为 $R$，均匀带电 $Q$ 的球壳，与球心距离为 $D$ 处的电场大小为
$$
\begin{align*}
&amp;amp;\int_{-\frac\pi 2}^{\frac\pi 2}\frac{k\left(\frac{2\pi R^2\cos\theta\d\theta}{4\pi R^2}Q\right)(D-R\sin\theta)}{\left[R^2\cos^2\theta+(D-R\sin\theta)^2\right]^{\frac 32}}\\
={}&amp;amp;\frac{kQ}{2}\int_{-\frac\pi 2}^{\frac\pi 2}\frac{\cos\theta\d\theta(D-R\sin\theta)}{\left(R^2+D^2-2RD\sin\theta\right)^{\frac 32}}\\
={}&amp;amp;\frac{kQ}{2}\left.\frac{D\sin\theta-R}{D^2\sqrt{R^2+D^2-2RD\sin\theta}}\right|_{-\frac\pi 2}^{\frac\pi 2}\\
={}&amp;amp;\frac{kQ}{2D^2}(1+\sgn(D-R))
\end{align*}
$$
于是一个半径为 $R$，均匀带电 $Q$ 的实心球，与球心距离为 $D$ 处的电场大小为
$$
\left\{\begin{align*}
&amp;amp;\dfrac{kQD}{R^3},&amp;amp;D&amp;lt;R\\
&amp;amp;\dfrac{kQ}{D^2},&amp;amp;D\ge R
\end{align*}\right.
$$
因此均匀带电的球对于某点的电场，等效于去除在该点外围的球的部分后，球心对其的电场。&lt;/p&gt;
&lt;p&gt;对于一个半径为 $R$，均匀带电 $Q$ 的圆板，与圆心连线垂直于圆面且长为 $D$ 的点处的电场大小为
$$
\begin{align*}
&amp;amp;\int_0^R\frac{k\left(\frac{2\pi r\d r}{\pi R^2}Q\right)D}{\left(r^2+D^2\right)^{\frac 32}}\\
={}&amp;amp;\frac{2kQD}{R^2}\int_0^R\frac{r\d r}{(r^2+D^2)^{\frac 32}}\\
={}&amp;amp;\frac{2kQD}{R^2}\left(\left.-\frac{1}{\sqrt{R^2+D^2}}\right|_0^R\right)\\
={}&amp;amp;\frac{2kQ}{R^2}\left(1-\frac{D}{\sqrt{R^2+D^2}}\right)
\end{align*}
$$
$R\to+\infty$ 可导出电荷面密度为 $\sigma$ 的无限大均匀带电平面的电场大小为 $2\pi k\sigma$（与距离无关），同时可以导出电容的决定式
$$
C=\frac QU=\frac Q{Ed}=\frac Q{2\cdot 2\pi k\sigma\cdot d}=\frac S{4\pi kd}
$$
对于一个电荷线密度为 $\lambda$ 的无限长均匀带电导线，与它距离为 $D$ 处的电场大小为
$$
\int_{-\infty}^{\infty}\frac{k(\lambda\d x)D}{(x^2+D^2)^{\frac 32}}=\frac{2k\lambda}{D}
$$&lt;/p&gt;
&lt;p&gt;对于一个半径为 $R$，均匀带电，电荷线密度为 $\lambda$ 的圆环，在圆所在平面内，与圆心距离为 $D$ 处的电场大小为
$$
\int_0^{2\pi}\frac{k(R\d\theta\cdot\lambda)(D-R\sin\theta)}{(R^2+D^2-2RD\sin\theta)^{\frac32}}
$$
然后这个玩意 TM 积不出来！是个椭圆积分。反而下面这个是可以积的：&lt;/p&gt;
&lt;p&gt;对于一个半径为 $R$，均匀带电，电荷面密度为 $\sigma$ 的无限长圆筒，与轴心距离为 $D$ 处的电场大小为
$$
\int_0^{2\pi}\frac{2k(R\d\theta\cdot\sigma)(D-R\sin\theta)}{R^2+D^2-2RD\sin\theta}=\frac{2\pi k\sigma R}D(1+\sgn(D-R))
$$
于是一个半径为 $R$，均匀带电，电荷体密度为 $\rho$ 的无限长圆柱，与轴心距离为 $D$ 处的电场大小为
$$
\left\{\begin{align*}
&amp;amp;2\pi k\rho D,&amp;amp;D&amp;lt;R\\
&amp;amp;\dfrac{2\pi k\rho R^2}{D},&amp;amp;D\ge R
\end{align*}\right.
$$
因此均匀带电的圆柱对于某点的电场，等效于去除在该点外围的圆柱的部分后，轴心对其的电场。&lt;/p&gt;
&lt;h3 id=&#34;通电导线的磁场&#34;&gt;通电导线的磁场
&lt;/h3&gt;&lt;p&gt;直导线的磁场分布和带电导线的电场分布是类似的，都是与距离成反比，只是方向不同。&lt;/p&gt;
&lt;p&gt;对于一个半径为 $R$，电流为 $I$ 的圆导线，与圆心距离为 $D$ 处的磁感应强度大小为
$$
\int_0^{2\pi}这部分咕了
$$&lt;/p&gt;
&lt;h3 id=&#34;通电螺线管的磁场&#34;&gt;通电螺线管的磁场
&lt;/h3&gt;&lt;p&gt;对于一个半径为 $R$，面电流密度为 $\sigma$（$\sigma$ 在数值上等于 $nI$，$n$ 为单位宽度上的匝数。电流为逆时针方向）的无限长通电螺线管，与轴心距离为 $D$ 处的磁感应强度大小为：&lt;/p&gt;
&lt;p&gt;假设螺线管轴心与 $z$ 轴重合，现拿出一段宽为 $\d l$，与 $z$ 轴平行的无限长条，设它的电流方向为 $(d_x,d_y,0)$（模长为 $1$）。若将它平移到 $z$ 轴处，它对 $(x,y,0)$ 处的磁感应强度为
$$
\begin{align*}
&amp;amp;\d l\int_{-\infty}^{+\infty}\frac{k\sigma\d z\cdot(d_x,d_y,0)\times(x,y,-z)}{\left(x^2+y^2+z^2\right)^{\frac32}}\\
={}&amp;amp;k\sigma\d l\cdot(d_x,d_y,0)\times\left(\frac{2x}{x^2+y^2},\frac{2y}{x^2+y^2},0\right)\\
={}&amp;amp;2k\sigma\d l\frac{d_xy-d_yx}{x^2+y^2}\cdot\vec k
\end{align*}
$$
回到原问题
$$
\int_0^{2\pi}2k\sigma R\d\theta\frac{-\sin\theta(D-R\sin\theta)-\cos\theta(-R\cos\theta)}{R^2+D^2-2RD\sin\theta}=2\pi k\sigma(1-\sgn(D-R))
$$
因此理想的通电螺线管，管内为强度为 $\mu_0\sigma$ 的匀强磁场，管上的强度为管内的一半，管外无磁场。&lt;/p&gt;
&lt;h3 id=&#34;电容充放电过程&#34;&gt;电容充放电过程
&lt;/h3&gt;&lt;p&gt;充电过程中，设电源电压为 $E$，电容电压为 $U$，整个电路的电阻为 $R$。
$$
C\dot U=\dot Q=I=\frac{E-U}{R}
$$
解得
$$
U=E(1-\e^{-\frac t{CR}})
$$
同理可得到放电过程（这里的 $E$ 指电容的初始电压）
$$
U=E\e^{-\frac t{CR}}
$$
无论哪种情况，都有
$$
I=\frac{\e^{-\frac t{CR}}}{R}
$$&lt;/p&gt;
&lt;h3 id=&#34;碰撞问题的理解&#34;&gt;碰撞问题的理解
&lt;/h3&gt;&lt;p&gt;关于非弹性碰撞时的能量损耗，可以理解为两者相对于质心的速度的减小，详见&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/371215495/answer/1018301871&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这个回答&lt;/a&gt;。在这个回答中提到说，一个系统的动能等于其质心动能加上各部分相对于质心的动能，这是一个有趣的结论：
$$
\sum m_i\bm{v_i}^2=M\bm{V}^2+\sum m_i(\bm{v_i}-\bm{V})^2\\
\text{which }M=\sum m_i,\bm{V}=\sum\bm{v_i}
$$
直接展开即证。&lt;/p&gt;
&lt;p&gt;关于完全非弹性碰撞必定共速的原因，可以从两个角度理解。&lt;/p&gt;
&lt;p&gt;第一个角度就是直接求最值：
$$
\max;\frac12m_1v_1^2+\frac12m_2v_2^2-\frac12m_1{v_1&amp;rsquo;}^2-\frac12m_2{v_2&amp;rsquo;}^2\\
\text{s.t.};m_1v_1+m_2v_2=m_1v_1&amp;rsquo;+m_2v_2&amp;rsquo;
$$
建立一个坐标系，横轴是 $\sqrt{m_1}v_1$，纵轴是 $\sqrt{m_2}v_2$。那么所有合法的情况都处于一条斜率为 $-\sqrt{m_1/m_2}$ 的直线上。完全非弹性碰撞就是其上与原点距离最近的点，也就是原点到该直线的垂足，而这条垂线的斜率为 $\sqrt{m_2/m_1}$，其上面的点就是 $v_1=v_2$。弹性碰撞可以视作关于这条垂线对称。&lt;/p&gt;
&lt;p&gt;第二个角度就是假想两球之间连了一个轻弹簧。那么弹簧长度最小或最大时，两球相对静止，这时弹簧的弹性势能最大，动能减少量最大。&lt;/p&gt;
&lt;p&gt;对了，考虑求一下弹簧的长度关于时间的函数？设伸长量为 $x$，初始为 $0$。
$$
\left\{\begin{align*}
\dot{v_1}&amp;amp;=\frac{kx}{m_1}\\
\dot{v_2}&amp;amp;=-\frac{kx}{m_2}\\
\dot{x}&amp;amp;=v_2-v_1
\end{align*}\right.\Rightarrow \ddot{x}=-k\left(\frac1{m_1}+\frac1{m_2}\right)x
$$
解得 $x=\dfrac{v\sin\sqrt cx}{\sqrt c}$，其中 $c=k\left(\dfrac1{m_1}+\dfrac1{m_2}\right)$，$v$ 为初始的相对速度。&lt;/p&gt;
&lt;p&gt;因此这时实际上做的是类似简谐运动。同时可以轻松求出能量损耗最大值为
$$
\frac 12kx_{\max}^2=\frac{m_1m_2v^2}{2(m_1+m_2)}
$$&lt;/p&gt;
&lt;h3 id=&#34;单摆相关&#34;&gt;单摆相关
&lt;/h3&gt;&lt;p&gt;考察一个初始时轻绳与竖直方向夹角为 $\theta_0$ 且初速度为 $0$ 的摆的周期。&lt;/p&gt;
&lt;p&gt;夹角到 $\theta$ 时，速度满足
$$
\frac12mv^2=mgl(\cos\theta-\cos\theta_0)
$$
故周期为
$$
\begin{align*}
T(\theta_0)={}&amp;amp;4\int_0^{\theta_0}\frac{l\d\theta}{\sqrt{2gl(\cos\theta-\cos\theta_0)}}\\
={}&amp;amp;2\sqrt{\frac lg}\int_0^{\theta_0}\frac{\d\theta}{\sqrt{\sin^2\frac{\theta_0}{2}-\sin^2\frac{\theta}{2}}}\\
\xlongequal{\sin\alpha=\frac{\sin\frac{\theta}{2}}{\sin\frac{\theta_0}{2}}}{}&amp;amp;4\sqrt{\frac lg}\int_0^{\frac\pi2}\frac{\d\alpha}{\sqrt{1-\sin^2\frac{\theta_0}{2}\sin^2\alpha}}\\
={}&amp;amp;4\sqrt{\frac lg}\cdot K\left(\sin\frac{\theta_0}{2}\right)
\end{align*}
$$
其中 $K(a)$ 为第一类完全椭圆积分。推导中最难的一步是换元，我也是从知乎上看来的（几篇都是这么搞的）。&lt;/p&gt;
&lt;p&gt;从而也可以验证书中的公式 $\lim_{\theta_0\to 0}T(\theta_0)=2\pi\sqrt{l/g}$。另外 $T(\pi/2)\approx 7.4163\sqrt{l/g}$。&lt;/p&gt;
&lt;p&gt;如果换成轻杆也是一样的。对于能绕一整周的情况，设在顶部时速度为 $v_0$，那么周期为
$$
2\int_0^\pi\frac{l\d\theta}{\sqrt{2gl(1+\cos\theta)+v_0^2}}=\frac{4l}{\sqrt{4gl+v_0^2}}K\left(\sqrt\frac{4gl}{4gl+v_0^2}\right)
$$&lt;/p&gt;
&lt;p&gt;可以将上面的两种情况统一一下。如果能量等效高度为 $h$，令 $r=h/2l$，
$$
T&amp;rsquo;(r)=\left\{\begin{align*}&amp;amp;2\sqrt{\dfrac lg}K\left(\sqrt r\right),\quad&amp;amp;r&amp;lt;1\\ &amp;amp;2\sqrt{\dfrac l{gr}}K\left(\frac 1{\sqrt r}\right),\quad&amp;amp;r&amp;gt;1\end{align*}\right.
$$
为了整齐起见，$r&amp;lt;1$ 时 $T&amp;rsquo;(r)$ 表示半周期。&lt;/p&gt;
&lt;h3 id=&#34;悬链线&#34;&gt;悬链线
&lt;/h3&gt;&lt;p&gt;设曲线的函数为 $y=f(x)$，其中最低点在 $y$ 轴上，两头在 $(\pm d,0)$。&lt;/p&gt;
&lt;p&gt;首先，由于悬空部分只受重力作用，故绳每一点的张力横向分力均相等，设为 $T$。则点 $x$ 处的张力纵向分力大小为 $T\cdot\lvert f&amp;rsquo;(x)\rvert$。&lt;/p&gt;
&lt;p&gt;取绳上小段 $x$ 到 $x+\d x$，由受力平衡，
$$
T(f&amp;rsquo;(x+\d x)-f&amp;rsquo;(x))=\rho g\sqrt{1+f&amp;rsquo;(x)^2}\d x
$$
即
$$
y&amp;rsquo;&amp;rsquo;=\frac{\rho g}T\sqrt{1+{y&amp;rsquo;}^2}
$$
记 $k=\rho g/T$，解得
$$
y=\frac{\cosh kx-\cosh kd}{k}
$$
其中 $T$ 一般由绳长 $l$ 确定，满足
$$
l=\frac{2\sinh kd}{k}
$$&lt;/p&gt;
&lt;h3 id=&#34;机械振动&#34;&gt;机械振动
&lt;/h3&gt;&lt;h4 id=&#34;简谐振动&#34;&gt;简谐振动
&lt;/h4&gt;&lt;p&gt;简谐振动满足方程
$$
\ddot x=-\frac kmx
$$
有通解
$$
x=A\sin(\omega t+\varphi)
$$
其中 $A,\omega,\varphi$ 可以由系统已知量和初始情况 $x_0,v_0$ 确定（记 $\alpha=k/m$）：
$$
\begin{align*}
\omega&amp;amp;=\sqrt\alpha\\
A&amp;amp;=\sqrt{x_0^2+\frac{v_0^2}\alpha}\\
\varphi&amp;amp;=\mathrm{atan2}\left(x_0,\frac{v_0}{\sqrt\alpha}\right)
\end{align*}
$$&lt;/p&gt;
&lt;h4 id=&#34;阻尼振动&#34;&gt;阻尼振动
&lt;/h4&gt;&lt;p&gt;阻尼振动满足方程（阻力正比于速度）
$$
\ddot x=-\alpha x-\beta\dot x
$$
根据微分方程相关理论，要讨论 $\Delta=\beta^2-4\alpha$ 的正负。&lt;/p&gt;
&lt;h5 id=&#34;临界阻尼&#34;&gt;临界阻尼
&lt;/h5&gt;&lt;p&gt;当 $\Delta=0$ 时
$$
x=\e^{-\frac\beta2t}\left(x_0+\frac\beta2x_0t+v_0t\right)
$$&lt;/p&gt;
&lt;p&gt;临界阻尼是收敛最快的。&lt;/p&gt;
&lt;h5 id=&#34;过阻尼&#34;&gt;过阻尼
&lt;/h5&gt;&lt;p&gt;当 $\Delta&amp;gt;0$ 时
$$
x=\e^{-\frac\beta2t}\left(x_0\cosh\frac{\sqrt\Delta}2t+\frac{\beta x_0+2v_0}{\sqrt\Delta}\sinh\frac{\sqrt\Delta}2t\right)
$$&lt;/p&gt;
&lt;h5 id=&#34;欠阻尼&#34;&gt;欠阻尼
&lt;/h5&gt;&lt;p&gt;当 $\Delta&amp;lt;0$ 时
$$
x=\e^{-\frac\beta2t}A\sin(\omega t+\varphi)
$$
其中
$$
\begin{align*}
\omega&amp;amp;=\frac{\sqrt{-\Delta}}2\\
A&amp;amp;=\sqrt{x_0^2-\frac{(\beta x_0+2v_0)^2}\Delta}\\
\varphi&amp;amp;=\mathrm{atan2}\left(\frac{x_0}A,\frac{\beta x_0+2v_0}{\sqrt{-\Delta}A}\right)
\end{align*}
$$
由此可知欠阻尼振动的周期为
$$
T=\frac{4\pi}{\sqrt{4\alpha-\beta^2}}
$$&lt;/p&gt;
&lt;h5 id=&#34;对比图&#34;&gt;对比图
&lt;/h5&gt;&lt;p&gt;令 $\alpha=1,x_0=1,v_0=0$。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/physics0/%E9%98%BB%E5%B0%BC%E6%8C%AF%E5%8A%A8.png&#34;
	width=&#34;799&#34;
	height=&#34;436&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;183&#34;
		data-flex-basis=&#34;439px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;（有没有人能告诉我 Mathematica 里 Plot Legended 的图例的线长怎么改啊）&lt;/p&gt;
&lt;h4 id=&#34;受迫振动&#34;&gt;受迫振动
&lt;/h4&gt;&lt;p&gt;受迫振动满足方程
$$
\ddot x=-\alpha x-\beta\dot x+\gamma\cos\omega t
$$
解微分方程过程中，可以发现它能被拆分成无策动力的阻尼振动和频率为策动力频率的简谐振动。&lt;/p&gt;
&lt;p&gt;对于 $\beta\ne 0$ 的情况，前者趋近于 $0$，后者振幅为（完整表达式这里就不算了）
$$
A=\frac\gamma{\sqrt{(\alpha-\omega^2)^2+(\beta\omega)^2}}
$$
如果 $\beta^2&amp;lt;2\alpha$，则取到最大值时
$$
\omega=\sqrt{\alpha-\frac{\beta^2}2},A=\frac\gamma{\beta\sqrt{\alpha-\dfrac{\beta^2}4}}
$$
否则 $\omega\to 0$ 时，$A\to A_{\max}=\gamma/\alpha$。&lt;/p&gt;
&lt;p&gt;对于 $\beta=0$ 的情况，假设初始 $x|_{t=0}=\dot x|_{t=0}=0$。如果 $\omega^2\ne \alpha$，则
$$
x=\frac\gamma{\alpha-\omega^2}\left(\cos\omega t-\cos\sqrt\alpha t\right)
$$
在 $\omega/\sqrt\alpha\in\R\setminus\mathbb{Q}$ 时，$\sup\lvert x\rvert=2\gamma/\lvert\alpha-\omega^2\rvert$，其余情况下 $x_{\max}$ 或 $x_{\min}$ 会很难求。实际分析时，我们会认为 $\beta$ 较小但不为 $0$，这样 $A\approx\gamma/\lvert\alpha-\omega^2\rvert$。&lt;/p&gt;
&lt;p&gt;如果 $\omega^2=\alpha$，则
$$
x=\frac{\gamma t\sin\omega t}{2\omega}
$$
综上，$A$ 的公式可以推广到任意 $\alpha,\omega&amp;gt;0,\beta\ge 0$。&lt;/p&gt;
&lt;h5 id=&#34;对比图-1&#34;&gt;对比图
&lt;/h5&gt;&lt;p&gt;令 $\alpha=\gamma=1$。蓝色虚线表示最优顶点。由此可见，当 $\beta\ll\alpha$ 时，$\omega=\sqrt\alpha$ 会导致共振。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/physics0/%E5%8F%97%E8%BF%AB%E6%8C%AF%E5%8A%A8.png&#34;
	width=&#34;801&#34;
	height=&#34;466&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;171&#34;
		data-flex-basis=&#34;412px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;粒子在磁场中的运动轨迹&#34;&gt;粒子在磁场中的运动轨迹
&lt;/h3&gt;&lt;p&gt;一个质量为 $m$，电荷量为 $+q$ 的带电粒子在磁感应强度为 $B$ 的匀强磁场中静止释放，考虑重力。取垂直于磁场的面作平面直角坐标系，磁场向内，原点为初始位置，向右为 $x$ 轴正方向，向下为 $y$ 轴正方向。
$$
\left\{\begin{align*}
qB\dot y&amp;amp;=m\ddot x\\
-qB\dot x+mg&amp;amp;=m\ddot y
\end{align*}\right.
$$
令 $k=qB/m$。两式分别求导代入另一式，结合初始条件解得
$$
\left\{\begin{align*}
x&amp;amp;=\frac g{k^2}(kt-\sin kt)\\
y&amp;amp;=\frac g{k^2}(1-\cos kt)
\end{align*}\right.
$$
这是摆线。&lt;/p&gt;
&lt;h3 id=&#34;章动&#34;&gt;章动
&lt;/h3&gt;&lt;p&gt;以陀螺脚为参考点。考虑质心在圆盘中心，设质量为 $m$，质心为 $\vec{l}$，转动惯量为 $I$，角动量为 $\vec{L}$。&lt;/p&gt;
&lt;p&gt;陀螺在一个瞬间的运动可以用两个量描述：自转的角速度 $\omega$，公转的速度 $\vec{v}$。
$$
\left\{\begin{align*}
\vec{l}\cdot\vec{v}&amp;amp;=\vec{0}\\
m\vec{l}\times\vec{v}+I\omega\cdot\frac{\vec{l}}{\lvert\vec{l}\rvert}&amp;amp;=\vec{L}
\end{align*}\right.
$$
解得
$$
\left\{\begin{align*}
\omega&amp;amp;=\frac{\vec{L}\cdot\vec{l}}{I\lvert\vec{l}\rvert}\\
m\vec{l}\times\vec{v}&amp;amp;=\vec{L}-\frac{\vec{L}\cdot\vec{l}}{\vec{l}\cdot\vec{l}}\cdot\vec{l}
\end{align*}\right.
$$
另有
$$
\dot{\vec{L}}=\vec{l}\times\vec{G}
$$
不会解。猜想：$\vec{l}$ 是关于时间的三角函数。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>OI 出题列表</title>
        <link>https://littlereuben.github.io/study/problemsetting/</link>
        <pubDate>Thu, 08 Aug 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/problemsetting/</guid>
        <description>&lt;div style=&#34;background-color: #A1C2D9; color: #042F4E; padding-left: 1em; border-left: 4px solid #30678E; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;收集&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;第三列是样例输出一的第一个字符串，可用于校验。&lt;/p&gt;
&lt;p&gt;adhoc 包括分析性质结论、线性扫描、推式子，还有一些基础算法（二分、倍增等）和数据结构（队列、栈等）。&lt;/p&gt;
&lt;p&gt;难度为预估 CF 评分除以 100。&lt;/p&gt;
&lt;p&gt;以下不含原题，但有可能考后被发现恰巧是已有类似的题。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;中文名&lt;/th&gt;
&lt;th&gt;英文名&lt;/th&gt;
&lt;th&gt;SO1&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;难度&lt;/th&gt;
&lt;th&gt;备注&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;挑战群同构&lt;/td&gt;
&lt;td&gt;npc&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;数论&lt;/td&gt;
&lt;td&gt;32&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;配对&lt;/td&gt;
&lt;td&gt;pair&lt;/td&gt;
&lt;td&gt;&lt;code&gt;5&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ds&lt;/td&gt;
&lt;td&gt;33&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;天桥&lt;/td&gt;
&lt;td&gt;bridge&lt;/td&gt;
&lt;td&gt;&lt;code&gt;3&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ds&lt;/td&gt;
&lt;td&gt;33&lt;/td&gt;
&lt;td&gt;&amp;gt;1 被爆标了&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;连连看&lt;/td&gt;
&lt;td&gt;game&lt;/td&gt;
&lt;td&gt;&lt;code&gt;332748215&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;poly&lt;/td&gt;
&lt;td&gt;35+&lt;/td&gt;
&lt;td&gt;23 互测&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;原子&lt;/td&gt;
&lt;td&gt;atom&lt;/td&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;构造&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;旅行计划&lt;/td&gt;
&lt;td&gt;plan&lt;/td&gt;
&lt;td&gt;&lt;code&gt;3&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;图论&lt;/td&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;禁止套娃&lt;/td&gt;
&lt;td&gt;nest&lt;/td&gt;
&lt;td&gt;&lt;code&gt;23&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;dp&lt;/td&gt;
&lt;td&gt;27&lt;/td&gt;
&lt;td&gt;&amp;gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;简单题&lt;/td&gt;
&lt;td&gt;easy&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;数论&lt;/td&gt;
&lt;td&gt;34&lt;/td&gt;
&lt;td&gt;&amp;gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;染色数组&lt;/td&gt;
&lt;td&gt;color&lt;/td&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;adhoc&lt;/td&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;博弈&lt;/td&gt;
&lt;td&gt;game&lt;/td&gt;
&lt;td&gt;&lt;code&gt;5&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;博弈&amp;amp;dp&lt;/td&gt;
&lt;td&gt;33&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;消消乐&lt;/td&gt;
&lt;td&gt;bubbles&lt;/td&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;adhoc&lt;/td&gt;
&lt;td&gt;34&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;土豆田&lt;/td&gt;
&lt;td&gt;potato&lt;/td&gt;
&lt;td&gt;&lt;code&gt;4&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;adhoc&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;CF627E 弱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;像素原神&lt;/td&gt;
&lt;td&gt;mc&lt;/td&gt;
&lt;td&gt;&lt;code&gt;5&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;dp&lt;/td&gt;
&lt;td&gt;32&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;区间操作&lt;/td&gt;
&lt;td&gt;oper&lt;/td&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ds&lt;/td&gt;
&lt;td&gt;35&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;猜排列&lt;/td&gt;
&lt;td&gt;interact&lt;/td&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;adhoc&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;异或&lt;/td&gt;
&lt;td&gt;xor&lt;/td&gt;
&lt;td&gt;&lt;code&gt;24&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;adhoc&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;机器车路径规划问题&lt;/td&gt;
&lt;td&gt;path&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FAIL&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;构造&lt;/td&gt;
&lt;td&gt;26&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;猴子排序&lt;/td&gt;
&lt;td&gt;sort&lt;/td&gt;
&lt;td&gt;&lt;code&gt;1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;dp&lt;/td&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;最简洁的题面&lt;/td&gt;
&lt;td&gt;simple&lt;/td&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;数论&lt;/td&gt;
&lt;td&gt;35+&lt;/td&gt;
&lt;td&gt;×&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
        </item>
        <item>
        <title>线代（上）自学笔记</title>
        <link>https://littlereuben.github.io/study/linear-algebra-1/</link>
        <pubDate>Fri, 26 Jul 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/linear-algebra-1/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/linear-algebra-1/cover.png" alt="Featured image of post 线代（上）自学笔记" /&gt;&lt;p&gt;$\gdef\rank{\operatorname{rank}}\gdef\nul{\operatorname{Nul}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;书是丘维生的《高等代数（上册）》。由于自己以前学过一些线代，所以这里列出的都是一些细节。&lt;/p&gt;
&lt;p&gt;所有矩阵默认 $n$ 行 $m$ 列，秩为 $r$。&lt;/p&gt;
&lt;p&gt;1.1：这里证明以下最简行阶梯形唯一。第一步是证明主元位置相同。假设 $A$ 化为了 $B=\begin{bmatrix}\beta_1&amp;amp;\cdots&amp;amp;\beta_n\end{bmatrix}^\top$ 与 $C=\begin{bmatrix}\gamma_1&amp;amp;\cdots&amp;amp;\gamma_n\end{bmatrix}^\top$，已知 $\set{\beta_i}\cong\set{\gamma_i}$。如果它们在第 $k$ 行第一次出现了主元不同，不妨设 $B$ 的这行主元在前，就会发现 $\set{\gamma_i}$ 无法表出 $\beta_k$，因为 $\gamma_{1\sim k-1}$ 的系数必须是 $0$，而 $\gamma_{k\sim n}$ 又无能为力。第二步是证明 $\beta_i=\gamma_i$，同样是线性表出，其他向量的系数都必须是 $0$。&lt;br&gt;
另外再证明非主元列是左侧主元列的线性组合。首先阶梯型矩阵中，左侧主元列形成上三角，必满秩，即证。如果要证明原矩阵也符合该性质，只需利用行变换不改变列向量之间关系的性质即可。&lt;/p&gt;
&lt;p&gt;2.4 &amp;amp; 2.6：展开的证明。核心：行列地位相等，$\tau(p)=\tau(q)+\tau(p&amp;rsquo;)$，其中 $\set{(i,p_i)}=\set{(q_i,p&amp;rsquo;_i)}$。&lt;/p&gt;
&lt;p&gt;2.4：范德蒙德行列式的证明。要避免 $a_i^k-a_1^k$ 就需要差分，倒过来减。&lt;/p&gt;
&lt;p&gt;2.7.例5：三对角行列式，结论可以记一下。&lt;/p&gt;
&lt;p&gt;2.*：循环矩阵行列式的处理思路。先乘个 $F$，最后可以除掉，或者我的思路是直接单位根反演。另外，计算 $|F|$ 如果只是平方一下，会遇到正负无法确定的问题，处理方法详见 &lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/507677010&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/507677010&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;2.5：Cramer 法则。理解：考虑魔改高斯消元的过程：第 $j$ 列当作不存在，$j-1$ 列主元出来了之后直接搞 $j+1$ 列。这样最后一行只有 $a_j$ 和 $b$。这个时候 $|A|$ 就是所有主元再乘上 $a_{n,j}$，$|B_j|$ 就是所有主元乘上 $b_n$，因此除一下就是 $x_j$。&lt;/p&gt;
&lt;p&gt;2.4.例3：加边法。有点神秘。&lt;/p&gt;
&lt;p&gt;2.4.定理4：mark.&lt;/p&gt;
&lt;p&gt;3：线性无关性、极大线性无关组的大小、秩、行列式、线性空间维数（及基大小）、方程解数、可逆性，这么几个角度。&lt;/p&gt;
&lt;p&gt;3.5：行秩等于列秩。无论是行、列秩，行列式，它们的性质都是通过初等变换下的不变性来证的。&lt;/p&gt;
&lt;p&gt;3.7.例3：理解：$k$ 行这个方程没用，$x_l$ 是自由元，取它为 $A_{kl}$，所以它可以移到右边。然后用 Cramer 解。$B_j$ 和 $A_{kj}$ 之间首先差了个负号，然后 $x_l$ 对应列对齐要交换 $|j-l|-1$ 次，还有就是代数余子式的负号。因此&lt;br&gt;
$$
(-1)^{k+j}B_j=(-1)^{|j-l|}A_{kj}\\
\eta_j=\frac{B_j}{M_{kl}}A_{kl}=(-1)^{k+l}B_j=(-1)^{k+l+k+j+j+l}A_{kj}=A_{kj}
$$
3.7.习8：他乡遇故知。太逆天了。&lt;/p&gt;
&lt;p&gt;3.9：应用大天地，值得一看。&lt;/p&gt;
&lt;p&gt;4.3：关于 $|A||B|=|AB|$ 的证明思路，一个是分块，一个是拆成初等矩阵（也是相当常见的证明思路，书里没写是因为依赖于 4.4.性质6）。Cauchy-Binet 证明图：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\cauchybinet.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;4.4：证明左逆等于右逆的三个思路。与抽代不同的是这里要给出逆元存在的构造性证明，所以书里是第三种。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;设左逆为 $B$，则 $AB=AIB=ABAB\Rightarrow I=(AB)^{-1}AB=(AB)^{-1}ABAB=AB$。&lt;/li&gt;
&lt;li&gt;设左逆为 $B$，右逆为 $C$，则 $B=BI=BAC=IC=C$。&lt;/li&gt;
&lt;li&gt;先证明存在 $B$ 既是左逆也是右逆，再同 2 证没别的逆。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;4.4.性质4&amp;amp;例4：mark.&lt;/p&gt;
&lt;p&gt;4.5：分块矩阵初等变换。注意行变换只能左乘（且行列数分别为 to、from 行数），列变换只能右乘（且行列数分别为 from、to 列数），&lt;strong&gt;哪怕所有块都是方阵&lt;/strong&gt;。另外分块初等矩阵只适用于对角是方阵的情况。&lt;/p&gt;
&lt;p&gt;4.9.例17：注意 $A$ 的零空间是与其行空间互为正交补，而不是列空间。因此 $Ax=0$ 的那些 $x$ 并不与 $\operatorname{Im}\mathcal{A}$ 垂直，注意几何直观别搞错了。&lt;/p&gt;
&lt;p&gt;5：关于矩阵秩的若干等式、不等式，不是很熟，记一下。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$\dim W=m-\rank(A)$。构造证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank(AB)\le\min(\rank(A),\rank(B))$。线性表出证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank(A+B),\rank[A,B]\le\rank(A)+\rank(B)$。线性表出证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank(AA^\top)=\rank(A^\top A)=\rank(A)$。同解或行列式证（复矩阵不成立）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank(A^m)=\rank(A^{m+1})\Rightarrow\forall k,\rank(A^m)=\rank(A^{m+k})$。同解证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank\begin{bmatrix}A&amp;amp;0\\ 0&amp;amp;B\end{bmatrix}=\rank(A)+\rank(B)$、$\rank\begin{bmatrix}A&amp;amp;C\\ 0&amp;amp;B\end{bmatrix}\ge\rank(A)+\rank(B)$。线性表出或行列式证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$AB=0\Rightarrow\rank(A)+\rank(B)\le m$。从齐次方程组解角度证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank(AB)\ge\rank(A)+\rank(B)-m$。分块证，也可以用线性变换证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左乘列满秩、右乘行满秩，秩不变。同解或用 8 证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;幂等 $\Leftrightarrow \rank(A)+\rank(I-A)=n$，对合 $\Leftrightarrow \rank(I+A)+\rank(I-A)=n$。分块或 2+3 证。&lt;/p&gt;
&lt;p&gt;补充：我想到 $\Leftarrow$ 的一个比较妙的证明：$\rank(A)+\rank(I-A)=n$，由于 $\rank+\dim\nul=n$，故 $\dim\nul A+\dim\nul(I-A)=n$，又 $\nul A\cap\nul(I-A)=0$，故 $\nul A\times\nul(I-A)=\R^n$。于是任意 $x$，$Ax=0$ 或 $x$，于是 $Ax=A^2x\Rightarrow (A^2-A)x=0$ 对于所有 $x$ 成立，即 $A^2-A=0$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\rank(A)=r\Leftrightarrow\exists B_{n\times r},C_{r\times m},\rank(B)=\rank(C)=r,A=BC$。分别用相抵、9 或 2+3 证。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;4.6：看着看着发现上三角矩阵的几个性质不是很清楚，记一下。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;上三角矩阵之积还是上三角，上三角矩阵的逆还是上三角。直观或代数证。&lt;/li&gt;
&lt;li&gt;上三角矩阵的伴随矩阵还是上三角。&lt;/li&gt;
&lt;li&gt;若上三角矩阵 $A$ 满足 $AA^\top=A^\top A$，则它为对角矩阵。若 $A$ 是正交矩阵，则 $A$ 的对角全是 $\pm1$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;lu-分解&#34;&gt;LU 分解
&lt;/h3&gt;&lt;p&gt;LU 分解用于避开逆矩阵求解线性方程组。$L$ 是 $n\times n$，$U$ 是 $n\times m$。&lt;/p&gt;
&lt;p&gt;一般的 LU 分解要求可以不用交换行将 $A$ 化简为行阶梯形（注意“各阶顺序主子式非 $0$”仅适用于满秩方阵）。&lt;/p&gt;
&lt;p&gt;求 $L$ 可以理解为：① 对 $L$ 做同样的事情可以变成 $I$；② $L$ 作用于 $U$ 可以变回 $A$（我感觉这种好理解，就是 $L$ 是所有变换顺序倒过来，然后正负互换）。这就是为什么 $L$ 可以由每次行变换乘的系数得出。注意就算目前行对应（下一个主元）位置为 $0$ 也不一定会出事，如果该列下面全 $0$，那就直接往后找。同时允许 $U$ 最后几行全零。&lt;/p&gt;
&lt;p&gt;出现主元问题时用 LUP 分解。通过 $PA=LU$（直接在 $A$ 中剩余行中对换，作用效果与 $U$ 中对换相同，又不会破坏 $L$ 的下三角性质），可以避免一堆奇怪的讨论。看一个例子（注意，当交换两行时，$L$ 中对应行除对角 $1$ 外也要交换）：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;$P$&lt;/th&gt;
&lt;th&gt;$L$&lt;/th&gt;
&lt;th&gt;$U$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}0&amp;amp;2&amp;amp;1&amp;amp;0\\ 4&amp;amp;2&amp;amp;13&amp;amp;2\\ 2&amp;amp;2&amp;amp;7&amp;amp;1\\ 2&amp;amp;3&amp;amp;7.5&amp;amp;.5\end{bmatrix}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\begin{bmatrix}0&amp;amp;1&amp;amp;0&amp;amp;0\\ 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}4&amp;amp;2&amp;amp;13&amp;amp;2\\ 0&amp;amp;2&amp;amp;1&amp;amp;0\\ 2&amp;amp;2&amp;amp;7&amp;amp;1\\ 2&amp;amp;3&amp;amp;7.5&amp;amp;.5\end{bmatrix}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\begin{bmatrix}0&amp;amp;1&amp;amp;0&amp;amp;0\\ 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ .5&amp;amp;0&amp;amp;1&amp;amp;0\\ .5&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}4&amp;amp;2&amp;amp;13&amp;amp;2\\ 0&amp;amp;2&amp;amp;1&amp;amp;0\\ 0&amp;amp;1&amp;amp;.5&amp;amp;0\\ 0&amp;amp;2&amp;amp;1&amp;amp;-.5\end{bmatrix}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\begin{bmatrix}0&amp;amp;1&amp;amp;0&amp;amp;0\\ 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ .5&amp;amp;.5&amp;amp;1&amp;amp;0\\ .5&amp;amp;1&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}4&amp;amp;2&amp;amp;13&amp;amp;2\\ 0&amp;amp;2&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;-.5\end{bmatrix}$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\begin{bmatrix}0&amp;amp;1&amp;amp;0&amp;amp;0\\ 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\\ 0&amp;amp;0&amp;amp;1&amp;amp;0\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ .5&amp;amp;1&amp;amp;1&amp;amp;0\\ .5&amp;amp;.5&amp;amp;0&amp;amp;1\end{bmatrix}$&lt;/td&gt;
&lt;td&gt;$\begin{bmatrix}4&amp;amp;2&amp;amp;13&amp;amp;2\\ 0&amp;amp;2&amp;amp;1&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;-.5\\ 0&amp;amp;0&amp;amp;0&amp;amp;0\end{bmatrix}$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;在解具体方程时，只需解 $Ly=Pb$ 与 $Ux=y$ 即可。注意不要搞错成 $P^{-1}b$。&lt;/p&gt;
&lt;p&gt;LDU 分解只是对满秩方阵而言，就是简单地把 $U$ 的对角元变成 $1$。&lt;/p&gt;
&lt;h3 id=&#34;正交相关&#34;&gt;正交相关
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;根据点乘的几何意义，可得在单个向量上的投影。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一般的正交投影，我们从两个角度理解。&lt;/p&gt;
&lt;p&gt;代数角度：希望写成 $y=\hat y+z$ 的形式，其中 $\hat y=\sum c_iu_i$，$z\cdot u_i=0$。后一个式子可以写成
$$
0=(y-\hat y)\cdot u_i=(y-\sum c_iu_i)\cdot u_i=y\cdot u_i-c_iu_i^2\Rightarrow c_i=\frac{y\cdot u_i}{u_i\cdot u_i}
$$
几何角度就是若干个“分量投影”的和。&lt;/p&gt;
&lt;p&gt;而最佳逼近定理就是由 $z\perp W$ 加上勾股定理，勾股定理的本质就是正交向量的点积为 $0$。正交相关的一切内容都是围绕这一性质展开的。&lt;/p&gt;
&lt;p&gt;如果 $y\in W$，那正交投影的公式就给出的线性表出的构造。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意如果不是正交方阵，而是若干正交单位向量组成的矩阵 $U=\begin{bmatrix}u_1&amp;amp;\cdots&amp;amp;u_n\end{bmatrix}$，那么 $U^\top U=I$，但 $UU^\top\ne I$——而且 $UU^\top y$ 给出了 $y$ 在 $W$ 上的投影。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;qr-分解&#34;&gt;QR 分解
&lt;/h3&gt;&lt;p&gt;QR 分解就是用矩阵表示出了 Gram-Schmidt 正交化的过程。&lt;/p&gt;
&lt;p&gt;使用条件：$A$ 列向量线性无关。&lt;/p&gt;
&lt;p&gt;推导很简单，就是记住是正交矩阵在左即可。
$$
\begin{bmatrix}\alpha_1&amp;amp;\cdots&amp;amp;\alpha_m\end{bmatrix}=\begin{bmatrix}u_1&amp;amp;\cdots&amp;amp;u_m\end{bmatrix}\begin{bmatrix}\alpha_1\cdot u_1&amp;amp;\alpha_2\cdot u_1&amp;amp;\cdots&amp;amp;\alpha_m\cdot u_1\\ 0&amp;amp;\alpha_2\cdot u_2&amp;amp;\cdots&amp;amp;\alpha_m\cdot u_2\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;\cdots&amp;amp;\alpha_m\cdot u_m\end{bmatrix}
$$
这里对矩阵作了一点简化，其思路是
$$
\alpha_i=\sum_{j\le i}\frac{\alpha_i\cdot v_j}{v_j\cdot v_j}v_j=\sum_{j\le i}\frac{\alpha_i\cdot(|v_j|u_j)}{|v_j|^2}(|v_j|u_j)=\sum_{j\le i}(\alpha_i\cdot u_j)u_j
$$
如果觉得别扭也可以把 $v_i$ 拿出来单独讨论。&lt;/p&gt;
&lt;p&gt;实操方法 1：在 Gram-Schmidt 正交化的时候写清楚那个下三角形的公式，写成矩阵，最后第 $i$ 行乘 $|v_i|$ 即可。&lt;/p&gt;
&lt;p&gt;实操方法 2：直接求出单位正交基 $Q$，然后由 $Q^\top A=R$ 算出 $R$。&lt;/p&gt;
&lt;p&gt;唯一性见 4.6.例5。&lt;/p&gt;
&lt;h3 id=&#34;最小二乘法&#34;&gt;最小二乘法
&lt;/h3&gt;&lt;p&gt;理解角度 1：在不求出正交基的情况下求投影，即利用垂直的性质。$\alpha_i\cdot(Ax-b)=0$。&lt;/p&gt;
&lt;p&gt;理解角度 2：要最小化 $|Ax-b|$，也就是最小化 $(Ax-b)\cdot(Ax-b)$。
$$
0=\frac{\partial(\sum\alpha_jx_j-b)^2}{\partial x_i}=2\sum \alpha_i\cdot\alpha_jx_j-2\alpha_i\cdot b
$$
这里 $\sum \alpha_jx_j=Ax$，于是式子就变成 $A^\top Ax=A^\top b$。&lt;/p&gt;
&lt;p&gt;从代数角度证明必有解：一方面，$[A^\top A,A^\top b]$ 的列向量都是 $A^\top$ 之列向量的线性组合，故秩不超过 $\rank(A)$。另一方面 $\rank(A^\top A)=\rank(A)$。&lt;/p&gt;
&lt;p&gt;当 $A$ 列满秩时，$A^\top A$ 满秩，即有唯一解。&lt;/p&gt;
&lt;p&gt;另外，如果想把 $A$ 正交分解了再 $b$ 去投影，也没问题。设 $A=QR$，$b$ 的正交投影为 $QQ^\top b$。如果要转成用 $A$ 列向量的线性组合来表示，那就是 $Ax=QQ^\top b\Rightarrow QRx=QQ^\top b\Rightarrow Rx=Q^\top b\Rightarrow x=R^{-1}Q^\top b$（其实都是 $\Leftrightarrow$）&lt;/p&gt;
&lt;p&gt;应用理解：有若干样本点 $(a_i,b_i)$，考虑用一个函数 $y=\sum c_if_i(x)$ 去拟合（$c_i$ 未知，$f_i$ 已知。例如直线就取 $f_1(x)=1,f_2(x)=x$），误差就是 $y$ 与对应 $b_i$ 的差的平方和。那这时其实就是求以下方程的最小二乘解：
$$
\begin{bmatrix}f_1(a_1)&amp;amp;\cdots&amp;amp;f_m(a_1)\\ \vdots&amp;amp;\ddots&amp;amp;\vdots\\ f_1(a_n)&amp;amp;\cdots&amp;amp;f_m(a_n)\end{bmatrix}\begin{bmatrix}c_1\\ \vdots\\ c_m\end{bmatrix}=\begin{bmatrix}b_1\\ \vdots\\ b_n\end{bmatrix}
$$
这里的函数可以是多自变量函数。&lt;/p&gt;
&lt;h3 id=&#34;矩阵的相抵与相似&#34;&gt;矩阵的相抵与相似
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;相抵矩阵秩相同。将矩阵转换成相抵标准型的过程，类比将满秩方阵拆分成初等矩阵的过程。其最大作用就是拆矩阵简化证明。非满秩的矩阵在推式子时会出现类似“丢失信息”的现象。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;广义逆矩阵是不易直观理解的部分，几个性质的证明动机也不清晰，我只能记下书里基础的东西，其实都是些废话：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;处理广义逆矩阵相关问题的基本方式是将 $A$ 写成 $PIQ$。&lt;/li&gt;
&lt;li&gt;广义逆矩阵的阶为 $m\times n$。形式为 $A^-=Q^{-1}\begin{bmatrix}I_r&amp;amp;B\\ C&amp;amp;D\end{bmatrix}P^{-1}$。$Q$ 为 $m\times m$，$P$ 为 $n\times n$，中间为 $m\times n$。&lt;/li&gt;
&lt;li&gt;$Ax=b$ 有解当且仅当 $b=AA^-b$。直接用定义+后面的构造证。解为所有 $A^-b$。证明所有解都可以表示为这种形式的方式的思路是，先把 $A$ 拆开，然后 $P,Q$ 就出来了，分析一下构造 $B,C,D$ 即可（这里 $b\ne 0$，不然构造会找不到非 $0$ 元）。&lt;/li&gt;
&lt;li&gt;$Ax=0$ 的解为 $(I_m-A^-A)\gamma$（$A^-$ 随便固定一个，$\gamma$ 取所有）。一个解直接对应 $\gamma=x$。&lt;/li&gt;
&lt;li&gt;后面 $A^+$ 我直接投降。其应用就是，$A$ 列满秩时，$Ax=b$ 的最小二乘解就是 $A^+b$。另外，列满秩矩阵满足 $A^-A=I$，其中一个特殊的 $A^-$ 是 $(A^\top A)^{-1}A^\top$；行满秩矩阵满足 $AA^-=I$，其中一个特殊的 $A^-$ 是 $A^\top(AA^\top)^{-1}$。无论是否列/行满秩，$A^-$ 都不是唯一的，只有满秩方阵才有 $A^-=A^{-1}$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;矩阵的相似可以从线性变换的角度来理解。想象一个线性变换，它将自然基下的向量 $x$ 映射到 $Ax$。现在我们想知道，在另一个基下这样的变换该如何描述。假设另一个基为 $P$（$P$ 的列向量为所有基向量），根据基变换相关的内容我们知道：在这个基的表示下的向量 $x$，在自然基下的表示为 $Px$；反之在自然基表示下的向量 $x$，在这个基的表示为 $P^{-1}x$（空间和向量永远不动，只是表出会变）。&lt;/p&gt;
&lt;p&gt;对于这个基下的向量 $x$，先将它用自然基表出，然后 $A$ 作用，再变回去。这就是 $P^{-1}APx$。$B=P^{-1}AP$ 就是在这个基下的变换矩阵。正如 3b1b 所说，基变换和相似就是一个“语言翻译”的过程。&lt;/p&gt;
&lt;p&gt;所以说，两个矩阵相似，就说明可以通过选取合适的基，使它们对应的线性变换看起来相同。这里我们可以联系抽代里半直积本质相同的判别方式（第 12 章性质 2）来理解——如果自同构是共轭的，就说明可以选取不同的元素作为生成元，使得这两个自同构分别在两种生成元下形式完全相同，那就说明这两个半直积同构。&lt;/p&gt;
&lt;p&gt;对角化的几何解释见 &lt;a class=&#34;link&#34; href=&#34;https://www.bilibili.com/video/BV1TH4y1L7PV/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.bilibili.com/video/BV1TH4y1L7PV/&lt;/a&gt;。简而言之就是把基变成那些特征向量，然后线性变换就变成简单的各维分别缩放了。这其实让我想到了卷积定理。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关于特征值和特征向量。首先要明确，相似变换下，行列式、秩、迹、特征值都不变，但特征向量会变。&lt;/p&gt;
&lt;p&gt;无论是否满秩，特征值数量（算上重数）总为 $n$，但特征子空间的维数和就不一定了。如果满秩，则特征值全部非零，但是不满秩时，特征值 $0$ 的重数并不等于 $n-r$，而是大于等于，例如 $\begin{bmatrix}0&amp;amp;1\\ 0&amp;amp;0\end{bmatrix}$。相关证明见 &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/297458474/answer/1362625976&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/297458474/answer/1362625976&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;几何重数小于等于代数重数的证明直观是很好理解的，你都构造出那几个线性无关的特征向量了，那不得至少有这几个嘛。证明的思路就是基变换，把这几个特征向量作为基，别的任选，然后 $|\lambda I-A^\prime|=0$ 就行。&lt;/p&gt;
&lt;p&gt;不同特征值对应的特征向量不同，这个只需看一个简单情况就可以理解证明思路：如果 $A\alpha_1=\lambda_1\alpha_1,A\alpha_2=\lambda_2\alpha_2,c\alpha_1=\alpha_2$，那么 $\lambda_1c\alpha_1=Ac\alpha_1=A\alpha_2=\lambda_2\alpha_2=\lambda_2c\alpha_1\Rightarrow\lambda_1=\lambda_2$。后面的东西都是比较显然的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一些特殊矩阵的特征值。幂等矩阵有 $\rank(A)$ 重特征值 $1$，$n-\rank(A)$ 重特征值 $0$。证明这个的步骤是，首先说明特征值只能是 $0$ 或 $1$，然后利用几何重数说明代数重数。对合矩阵也是类似。幂零矩阵与它们的不同点仅在于不能对角化。注意不能从特征值判断特殊矩阵。注意可对角化和满秩之间没有关系。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;现在距离抽代里那个自同构的分析，我们还有两个障碍：一个是 Jordan 标准型还没学，一个是不允许复数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;简单提一下 Cayley-Hamilton 定理的证明：对角阵易证，因为相当于每个特征值代进特征多项式。从而可对角化的情况易证，因为 $f(P^{-1}AP)=P^{-1}f(A)P$，然后可以用 &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/31557902/answer/1636767376&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/31557902/answer/1636767376&lt;/a&gt; 这种来理解。另一个证明思路是，先通过证明乘每个 $\varepsilon_i$ 均为 $0$ 来证明上三角矩阵满足，然后再把任意一个矩阵相似化为上三角：&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/657653840&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/657653840&lt;/a&gt;。最后，书里的证明思路是，通过比对 $(\lambda I-A)(\lambda I-A)^\star=|\lambda I-A|I$ 两侧的系数证明。&lt;/p&gt;
&lt;p&gt;它的一个重要作用是给出了 $A^n$ 关于 $A^{0\sim n-1}$ 的表达式，从而可以递推（P4723）。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>Hugo 博客搭建经验</title>
        <link>https://littlereuben.github.io/study/blog-tutorial/</link>
        <pubDate>Thu, 25 Jul 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/blog-tutorial/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/blog-tutorial/logo.png" alt="Featured image of post Hugo 博客搭建经验" /&gt;&lt;div style=&#34;background-color: #FFE1B9; color: #794500; padding-left: 1em; border-left: 4px solid #DE9B41; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;摘抄笔记&lt;/b&gt;。&lt;br&gt;本文适合不了解 html 和 scc 但想自己建博客的读者看。&lt;/div&gt;
&lt;h3 id=&#34;本地初始操作&#34;&gt;本地初始操作
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;下载 git，更新用户名和邮箱信息。&lt;/li&gt;
&lt;li&gt;下载 hugo，选 extended。&lt;/li&gt;
&lt;li&gt;建文件夹，里面存所有网站的文件夹。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hugo new site 名字&lt;/code&gt;，会出现一个子文件夹（下称为主文件夹），对应一个网站。&lt;/li&gt;
&lt;li&gt;进入，找想要的主题，通过 &lt;code&gt;git clone&lt;/code&gt; 或直接复制粘贴的方式放到 themes 文件夹中，最好只有一个主题（实际是可以在配置的 theme 改），然后主题的文件夹名别动。&lt;/li&gt;
&lt;li&gt;把主题对应的 exampleSite 内文件复制到主文件夹。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hugo&lt;/code&gt; 可以编译（生成 public/ 内的网页文件），&lt;code&gt;hugo server&lt;/code&gt; 在 &lt;code&gt;hugo&lt;/code&gt; 的基础上开了个 localhost 网页以供实时预览，每次运行即可查看效果，随时改（保存）随时更新，不需要“编译”。Ctrl+C 停止。注意，有的时候改风格或页面布局时出现语法问题，&lt;strong&gt;就算改回来也会没反应&lt;/strong&gt;（停留在一个编译错误页面或没有改动效果），这时应当停止再运行。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;主题相关stack&#34;&gt;主题相关（stack）
&lt;/h3&gt;&lt;p&gt;如果遇到其他主题需求，一个通用方法是，如果想改某些样式或大小或长宽，则找 assets 里 scss 文件；如果想改页面布局，则找 layouts 里 html 文件。具体可以按文件名实际意思找，也可以 F12 出调试工具后找对应的项名字或数值，然后用查找文件内容在主题文件夹里直接暴力找。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;注意主题对浏览器页面不同大小的时候做了适配，所以会发现有 respond(…) 这种东西，阈值参见 breakpoint.scss。一般建议改参数（某些距离之类）的时候，顺带各种尺寸情况都改了，然后最后拿手机、平板之类的访问一下看看是否合适。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置文件应当放在主文件夹中，名字为 hugo.*，后缀可以是 yaml，toml 或 json。建议直接按上面第 6 点，把 exampleSite 的配置文件复制过来，删掉原来的 hugo.toml。&lt;strong&gt;下文简称该文件为“配置”。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把配置里的 baseurl 改一下。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;多语言选项直接关了完事，配置里 DefaultContentLanguage 改 zh-cn，hasCJKLanguage 改 false，language 删了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;网站图标：配置里 params.favicon。.ico 文件放到 static/ 里。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;头像放 assets/img/。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左右边栏最大宽度：grid.css 里 .container&amp;amp;.extended 的 respond(xl) 内。&lt;strong&gt;会相应改变中间主题的宽度。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左右边栏与页面左右边缘距离：grid.css 里 .main-container 的 respond(md) 内。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;头像大小，头像、博客标题、博客描述居中：sidebar.scss 里 .left-sidebar 的  &amp;ndash;sidebar-avatar-size，.sidebar header 的 .site-avatar（其实不改就行）、.site-name、.site-description 内加 text-align: center;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左右边栏额外两侧空白：sidebar.scss 里 .left-sidebar、.right-sidebar 内额外加 padding-left: ?px; 和 padding-right: ?px; 即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左右边栏和中间主体的间距：variables.scss 里 :root 的 &amp;ndash;section-separation。&lt;/p&gt;
&lt;p&gt;所以，如果你想真的让左边栏内容完美居中，所要做的就是：把 4 和 7 调成相等，6 的 left、right 不要不相等。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左侧边栏之页面 second method 的高亮：主题文件夹/layouts/partials/sidebar/left.html 里找到这段：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $currentPage := . }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ range .Site.Menus.main }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $active := or (eq $currentPage.Title .Name) (or ($currentPage.HasMenuCurrent &amp;#34;main&amp;#34; .) ($currentPage.IsMenuCurrent &amp;#34;main&amp;#34; .)) }}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;删掉改成：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $currentPage := . }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $siteTitle := .Site.Title }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ range .Site.Menus.main }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $active := or (eq $currentPage.Title .Name) (or ($currentPage.HasMenuCurrent &amp;#34;main&amp;#34; .) ($currentPage.IsMenuCurrent &amp;#34;main&amp;#34; .)) }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $active := or ($active) (and (eq $currentPage.Title $siteTitle ) (eq .Identifier &amp;#34;home&amp;#34;)) }}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;目录的行间距：layout/article.scss 里 .widget&amp;ndash;toc#TableOfContents 里面有个 margin 后面带四个数的，分别是上边缘、右边缘、每行下方、左边缘。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左侧边栏图标与文字的距离：variables.scss 里 :root 的 &amp;ndash;menu-icon-separation。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;最后修改时间：&lt;a class=&#34;link&#34; href=&#34;https://shitao5.org/posts/hugo-stack/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://shitao5.org/posts/hugo-stack/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;branch 页面的标题形式：在 layout/_default/list.html 里，我是直接把 section-title 注释掉的（因为无论如何它都只会显示章节两字），希望这个自定义的话我也不大会，但是网上好像可以查到？&lt;a class=&#34;link&#34; href=&#34;https://discourse.gohugo.io/t/how-can-i-get-a-user-friendly-section-name-title/10880/3&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://discourse.gohugo.io/t/how-can-i-get-a-user-friendly-section-name-title/10880/3&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;段内行距：variables.scss 里 :root 的 &amp;ndash;article-line-height。段间行距：layout/article.scss 里 .article-content 里有个 margin: 1.5em 0;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关于段首缩进：爆了，下面这个方法会导致列表的编号和内容间有过大的距离，应该无解。&lt;/p&gt;
&lt;p&gt;在 layout/article.scss 里 .article-content 里加一句 text-indent: 2em; 这样会发现它缩进过度了。在 variables.scss 里改 &amp;ndash;card-padding。&lt;/p&gt;
&lt;p&gt;这里有两个注意点，一个是你发现 F12 之后两侧 padding 变了，这个在不是 layout 里的 article.scss 里 .article-list&amp;ndash;tile 的 .article-details 的 padding 改。&lt;/p&gt;
&lt;p&gt;一个是注意到包括标题、图片在内的东西都会被缩进，标题我觉得这样挺好看的，图片的话会导致右侧被遮，这里我的解决方法是用 html 格式的图片，还可以调大小，更好用，唯一可惜的是用不上 stack 自带的图片文字描述下方显示，不过这个也可以写一段 html。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;大标题大小：不是 layout 里的 article.scss 里 .article-title 的 font-size。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;F12 时头像不居中问题：sidebar.scss 里 .sidebar header 的 .site-avatar 的 margin 改成 auto（注意这类 margin 的东西如果不填 0 或 auto，则必须填四个数，分别代表上右下左）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;网站名称颜色：光把 sidebar.scss 里 .site-name 的 color 改掉没用，还要把 left.html 里 site-name 的链接去掉。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;文章主题图片的高度：layout/article.scss 里 .article-page 的 .article-header 的 .article-image 的 img 的 max-height。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;回到顶部：&lt;a class=&#34;link&#34; href=&#34;https://www.blain.top/p/renovation/#%E8%BF%94%E5%9B%9E%E9%A1%B6%E9%83%A8%E6%8C%89%E9%92%AE&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.blain.top/p/renovation/#%E8%BF%94%E5%9B%9E%E9%A1%B6%E9%83%A8%E6%8C%89%E9%92%AE&lt;/a&gt; 配合 &lt;a class=&#34;link&#34; href=&#34;https://yelleis.top/p/61fdb627/#%E8%BF%94%E5%9B%9E%E9%A1%B6%E9%83%A8&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://yelleis.top/p/61fdb627/#%E8%BF%94%E5%9B%9E%E9%A1%B6%E9%83%A8&lt;/a&gt;。可以平滑的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左边栏项过多但不想滚轮：sidebar.scss 里 .left-sidebar 的 max-height。左边栏各项间距：menu.scss 里 #main-menu 的 gap。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;归档里 CATEGORIES 不是中文：archives.html 里改 &lt;code&gt;&amp;lt;h2 class=&amp;quot;section-title&amp;quot;&amp;gt;{{ $taxonomy.Title }}&amp;lt;/h2&amp;gt;&lt;/code&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;归档的分类卡片大小：list.scss 里 .subsection-list 的 .article-list&amp;ndash;tile 的 article 的 width、height。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;文章先后（默认按时间）、左侧栏、归档分类等都可以用 md 开头 yaml 里 weight 调优先级。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左侧栏“个性签名”换行：不知为何 &lt;code&gt;\n&lt;/code&gt; 会被空格代替，&lt;code&gt;&amp;lt;br/&amp;gt;&lt;/code&gt; 没用。我找遍了整个 theme 文件夹只找到一处把换行替换为空格的代码，去掉之后还是没用。所以只能在 left.html 里硬编码了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;归档分类卡片渐变颜色：main.ts 里 articleDetails.style.background。我觉得不改也挺好看。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;归档多栏：&lt;a class=&#34;link&#34; href=&#34;https://blog.grew.cc/posts/stack#%E5%BD%92%E6%A1%A3%E9%A1%B5%E5%8F%8C%E6%A0%8F&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://blog.grew.cc/posts/stack#%E5%BD%92%E6%A1%A3%E9%A1%B5%E5%8F%8C%E6%A0%8F&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;图标可以在 &lt;a class=&#34;link&#34; href=&#34;https://tablericons.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tablericons.com/&lt;/a&gt; 找，放在主题的 assets/icons 里。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关闭 toc 的编号：layout/article.scss 里 li a:first-of-type::before 部分注释掉。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;代码行号：配置里 markup:highlight:lineNos。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;“评论”标题：在 layouts/partials/comments/include.html 的第一二行间加 &lt;code&gt;&amp;lt;h2 style=&amp;quot;color: var(--card-text-color-main)&amp;quot;&amp;gt;评论&amp;lt;/h2&amp;gt;&lt;/code&gt;。这样暗色模式不会还是黑的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果觉得 &lt;code&gt;![]()&lt;/code&gt; 图片和封面图片糊得不正常且难看，可以把配置里的 imageProcessing 下面两个改成 false。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;阅读量：&lt;a class=&#34;link&#34; href=&#34;https://hyrtee.github.io/2023/start-blog/#%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://hyrtee.github.io/2023/start-blog/#%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90&lt;/a&gt;。这里有个问题就是首页的每篇文章的阅读量是无法正常显示的，这个我也不会解决，只能只在具体文章页面显示该阅读量。但是问题在于首页的卡片的 details 和文章的 details 是共用 layout/partials/article/components/details.html 的，就无法区别处理。我的处理方法是复制一份 header.html 和 details.html 然后改一份有统计量的。显然这并不是个简介的解决方案，主要我不会 html 里 &lt;code&gt;partial&lt;/code&gt; 情况下的传参。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;内嵌 pdf：&lt;a class=&#34;link&#34; href=&#34;https://github.com/anvithks/hugo-embed-pdf-shortcode&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/anvithks/hugo-embed-pdf-shortcode&lt;/a&gt;。Better choice：&lt;a class=&#34;link&#34; href=&#34;https://bugdrivendevelopment.net/pdf-reader-hugo-sites/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://bugdrivendevelopment.net/pdf-reader-hugo-sites/&lt;/a&gt;，如果希望像我一样在 pdf 下面再显示一个原文件的链接，可以加一行 &lt;code&gt;&amp;lt;a href=&amp;quot;{{ .Get 0 }}&amp;quot; style=&amp;quot;display:block;text-align:center;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;[PDF file]&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&lt;/code&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;content-目录结构&#34;&gt;content 目录结构
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;博客里的页面分为 branch 和 leaf 两类，branch 就是下面还有子页面的页面。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;content 文件夹对应 home 页面，是 branch 类型。home 就是主页。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;content 的文件夹结构与网站链接结构完全对应，&lt;strong&gt;一个文件夹一个页面&lt;/strong&gt;，branch 对应的文件夹下如果有其他 md 或含 index.md 的子文件夹，就会在对应页面也显示出来。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;content 内所有想要能显示出来的页面，必须要包含 index.md 或 _index.md 文件，前者是给 leaf 用的，后者是给 branch 用的。这个 md 的开头应当有一段 yaml（或其他格式）给出其相关信息。对于 branch，就不用写别的东西了（写了也没用）；对于 leaf，yaml 之后就是正文。&lt;/p&gt;
&lt;p&gt;实际上 leaf 页面可以在 post 或对应的 branch 文件夹里直接放 md，但是最好还是按照上面的习惯来。&lt;/p&gt;
&lt;p&gt;这样的一段 yaml 应当符合 &lt;a class=&#34;link&#34; href=&#34;https://stack.jimmycai.com/writing/frontmatter&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://stack.jimmycai.com/writing/frontmatter&lt;/a&gt; 的格式（有漏，可以看 &lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/688275787&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/688275787&lt;/a&gt; 里“我的模板”，&lt;strong&gt;注意冒号之后必须加空格！复杂字符串如果出问题需要两边打引号！&lt;/strong&gt;）。特殊地，有几类特殊的布局，可以加上 layout 信息，参见 exampleSite 的 page/。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;建议建文件夹 content/page/ 以存放所有出现在左边栏内的页面。所有希望出现在左边栏中的页面（包括 home 的 _index.md 以及 page 的 index.md），它们开头的 yaml 需要额外以 &lt;a class=&#34;link&#34; href=&#34;https://stack.jimmycai.com/config/menu&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://stack.jimmycai.com/config/menu&lt;/a&gt; 里 first method 的方法写一下。second method 是直接写在配置里的，配合上面第 10 点。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;主页的中间，会显示所有属于 content/post/ 里的内容——这是由配置里 params.mainSection 决定的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;除了按上述方式配置的 content/_index.md、post（mainSection 的条目）、page 内 md 外，其余东西一律没有导航界面（包括别的 branch），只能在浏览器上改链接来访问，因此其实可以在博客里“藏”东西。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后还有一个特殊的文件夹 content/categories，这里面放的东西会和每个文章的分类联系在一起，参见 exampleSite。如果不用这个文件夹，直接写每篇文章的 categories 也是没问题的，就是归档里会没图片。如果用这个文件夹，可以设置 categories 的标签颜色、图片等，而且可以将一个类别的 id 和名称分开来，文件夹名、slug、调用时用 id，title 写名称。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;markdownkatex-相关&#34;&gt;Markdown、KaTeX 相关
&lt;/h3&gt;&lt;div style=&#34;color: red; font-weight: bold&#34;&gt;这部分很重要，请务必注意！&lt;/div&gt;
&lt;p&gt;无论如何要当心任何位置出现的特殊字符，尤其是 Typora 里没出问题的 &lt;code&gt;\&lt;/code&gt;。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;支持内嵌 html。&lt;/li&gt;
&lt;li&gt;同普通 Markdown，如果两段间不留空行且第一段末尾没有俩空格，则渲染出来是不换行的。&lt;/li&gt;
&lt;li&gt;关于列表的分段，Typora 是显示出来一律是分段的行距，但对于从未在标号（或项目点）前退格的列表，源码会不留空行，在网页里是不分段的行距（对比本列表和上一个列表）。这个可能会有点难看，如果介意的话，要手动改一下。另外列表内分段是按照缩进来的。&lt;/li&gt;
&lt;li&gt;公式支持 KaTeX 功能（如果没渲染检查一下配置和 frontmatter 里有没有开 math），行间公式上下不留空行也没事。&lt;/li&gt;
&lt;li&gt;如果要利用全局 \def，必须使用 \gdef。这个和 Typora 是不一样的，Typora 不识别 \gdef 但 \def 是全局的。&lt;/li&gt;
&lt;li&gt;矩阵等多行的东西，需要打三个 &lt;code&gt;\&lt;/code&gt; 后再来个空格，以换行。这个很奇怪。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;\,&lt;/code&gt;、&lt;code&gt;\;&lt;/code&gt; 之类的小空格必须改成 &lt;code&gt;\\,&lt;/code&gt;、&lt;code&gt;\\;&lt;/code&gt;。这个也很奇怪。&lt;/li&gt;
&lt;li&gt;表格里公式偷懒不用 &lt;code&gt;\lvert\rvert&lt;/code&gt; 直接打 &lt;code&gt;|&lt;/code&gt; 时会出现与表格边界混淆的情况（Typora 会自动正确处理），这时要加转义 &lt;code&gt;\&lt;/code&gt;。&lt;code&gt;\set&lt;/code&gt; 里第一个 &lt;code&gt;|&lt;/code&gt; 会被识别为“满足”符号，自动适应左右高度。&lt;/li&gt;
&lt;li&gt;公式内星号 &lt;code&gt;*&lt;/code&gt;、百分号 &lt;code&gt;%&lt;/code&gt; 要加转义 &lt;code&gt;\&lt;/code&gt;（Typora 会自动正确处理）。&lt;/li&gt;
&lt;li&gt;还有很多不加 &lt;code&gt;\&lt;/code&gt; 就会爆的情况。我遇到最诡异的是 &lt;code&gt;${a}_{b}{c}_{d}$&lt;/code&gt; 无法渲染。这种是因为垃圾 Markdown 渲染器把公式内外搞混了（两个下划线之间被识别为斜体，一般会出现在 &lt;code&gt;|_&lt;/code&gt;（代入值）和 &lt;code&gt;}_&lt;/code&gt; 这种地方）。遇到这种情况反正就在各个特殊字符前试着加 &lt;code&gt;\&lt;/code&gt; 就行。甚至多行推不等式出现多个 &lt;code&gt;&amp;gt;&lt;/code&gt; 会识别成引用，无语。&lt;/li&gt;
&lt;li&gt;连接自动识别在遇到标点时会有问题，建议还是用 &lt;code&gt;&amp;lt;&amp;gt;&lt;/code&gt; 括起来。&lt;/li&gt;
&lt;li&gt;撇号如果直接用 &lt;code&gt;&#39;&lt;/code&gt; 会很丑（$&amp;rsquo;$），必须用 &lt;code&gt;^\prime&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;html 格式的图片要居中必须单独写 center。&lt;/li&gt;
&lt;li&gt;如果希望强制调整表格列宽，可以用 &lt;code&gt;&amp;lt;div style=&amp;quot;width: 宽度&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&lt;/code&gt;。注意其副作用是在不同宽度的屏幕上可能会显示得不好看。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;github-部署&#34;&gt;Github 部署
&lt;/h3&gt;&lt;p&gt;Github 部署的思路如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Github 上一个公开的 repo 放网页文件。&lt;/li&gt;
&lt;li&gt;每次 &lt;code&gt;hugo&lt;/code&gt; 完，把 public/ 内东西放到 repo 里。&lt;/li&gt;
&lt;li&gt;如果不想手动操作，可以再建一个（可以私有）放整个博客的 repo，每次 push 之后用 github action 自动编译、更新到网页 repo 里。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;由于我想经常调试博客的 theme，而且第三步略麻烦，所以我就是手动更新。&lt;/p&gt;
&lt;p&gt;总的操作方法见 &lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/568470172&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/568470172&lt;/a&gt;（有三篇）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;网址只能是 &lt;code&gt;github用户id.github.io&lt;/code&gt;，github settings pages 里改域名的选项是得自己先买域名的。&lt;/li&gt;
&lt;li&gt;hugo 编译后，public 里老的文件是会留着的（例如你反复给一篇文章换主题图片，它都会留着）。如果你不希望别人来翻你的 github repo 看到这些，得每次手动删除。&lt;/li&gt;
&lt;li&gt;每次把网页复制到本地仓库前，最好先删光（别手动删！git 会自动追踪仓库里的文件，可能会出问题。具体处理方法见下文）。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;评论&#34;&gt;评论
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;disqus 有广告。&lt;/li&gt;
&lt;li&gt;giscus 必须登录 github 才能评论。&lt;/li&gt;
&lt;li&gt;twikoo 似乎有审查。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;cusdis 万岁！&lt;/p&gt;
&lt;p&gt;免费版 cusdis 一个月 10 条 quick approve 和 100 条需要 approve 的评论（大概就是你得在邮箱的评论通知里点一下），完全够。&lt;/p&gt;
&lt;p&gt;upd：但是有个缺点，就是选填的 Email 谁也看不到，而且 reply 也不会通知评论者，相当于没用。&lt;/p&gt;
&lt;p&gt;upd：似乎 quick approve 界面可以看到。&lt;/p&gt;
&lt;p&gt;操作非常简单：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;注册个账号。输入博客网址与 notification 邮箱。&lt;/li&gt;
&lt;li&gt;配置里 params 的 comments 的 provider 改成 cusdis，下面 cusdis 里 host 和 id 改一下，具体改的内容看 cusdis 里你的 dashboard 上方的 Embeded Code。&lt;/li&gt;
&lt;li&gt;如果想改中文，在 layout/partial/comments/provider/cusdis.html 里 &lt;code&gt;&amp;lt;script async defer src=&amp;quot;{{ $host }}/js/cusdis.es.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt; 的上面加一句 &lt;code&gt;&amp;lt;script async defer src=&amp;quot;https://cusdis.com/js/widget/lang/zh-cn.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Cusdis 的块非常矮，目前我没有找到一个能使块长随着评论数量变化的方法，一个差一点的解决方法见 &lt;a class=&#34;link&#34; href=&#34;https://barthpaleologue.github.io/Blog/posts/add-and-customize-cusdis-hugo/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://barthpaleologue.github.io/Blog/posts/add-and-customize-cusdis-hugo/&lt;/a&gt;。upd：问题已解决，见该博客评论。强迫症会发现暗色模式时底部有一像素高的区域会是纯黑（&lt;code&gt;#121212&lt;/code&gt;），这个似乎没法解决。&lt;/p&gt;
&lt;h3 id=&#34;日常维护&#34;&gt;日常维护
&lt;/h3&gt;&lt;p&gt;我一般习惯这样：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在另外的文件夹里写博客。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;每次手动新建文章文件夹，md 复制过去改名成 index.md，开头加上那段 yaml（我不习惯 &lt;code&gt;hugo new&lt;/code&gt;）。yaml 我用的模板：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;description&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;categories&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;math&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;comments&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;更新到 github。我写了以下脚本（须在 git bash 下运行，我的博客文件夹和 repo 文件夹并列）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; blog/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rm public/* -r
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hugo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../LittleReuben.github.io/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git rm * -r
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cp -rf blog/public/* LittleReuben.github.io/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; LittleReuben.github.io/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git add --all
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git commit -m &lt;span class=&#34;s2&#34;&gt;&amp;#34;upd&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git push -u origin main
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注意博客网页更新较慢，大概要等个 2min。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;我这边发现一个问题：一旦 commit 了过大的文件并 push 失败，这个文件就会永远存在历史记录 &lt;code&gt;.git/object/&lt;/code&gt; 里，导致后续就算删了也无法 push。其实博客这种东西本身没必要记录每次 commit 的 history，但是 git 要删 history 很麻烦，所以我的思路是，直接把整个 &lt;code&gt;*.github.io/&lt;/code&gt; 文件夹删空（包括 &lt;code&gt;.git/&lt;/code&gt;），然后重新远程 clone 过来上一个正常的版本。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;如果想搭博客也可以直接问我要魔改的 theme。&lt;/del&gt;&lt;/p&gt;
&lt;h3 id=&#34;参考链接&#34;&gt;参考链接
&lt;/h3&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://thirdshire.com/hugo-stack-renovation-part-two/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://thirdshire.com/hugo-stack-renovation-part-two/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://xrg.fj.cn/p/hugo-stack%E4%B8%BB%E9%A2%98%E6%9B%B4%E6%96%B0%E5%B0%8F%E8%AE%B0/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://xrg.fj.cn/p/hugo-stack%E4%B8%BB%E9%A2%98%E6%9B%B4%E6%96%B0%E5%B0%8F%E8%AE%B0/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://munlelee.github.io/post/hugo%E5%8D%9A%E5%AE%A2-stack%E4%B8%BB%E9%A2%98%E4%BF%AE%E6%94%B9%E7%AC%AC%E4%B8%80%E7%AB%99/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://munlelee.github.io/post/hugo%E5%8D%9A%E5%AE%A2-stack%E4%B8%BB%E9%A2%98%E4%BF%AE%E6%94%B9%E7%AC%AC%E4%B8%80%E7%AB%99/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://zhixuan2333.github.io/posts/ac760353/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhixuan2333.github.io/posts/ac760353/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.linsnow.cn/p/modify-hugo/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://blog.linsnow.cn/p/modify-hugo/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/685991593&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/685991593&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://yelleis.top/p/61fdb627/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://yelleis.top/p/61fdb627/&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>抽代（群论部分）自学笔记</title>
        <link>https://littlereuben.github.io/study/gtm73-group-theory/</link>
        <pubDate>Thu, 25 Jul 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/gtm73-group-theory/</guid>
        <description>&lt;img src="https://littlereuben.github.io/study/gtm73-group-theory/GTM73.png" alt="Featured image of post 抽代（群论部分）自学笔记" /&gt;&lt;p&gt;$\gdef\lcm{\operatorname{lcm}}\gdef\ker{\operatorname{Ker}}\gdef\im{\operatorname{Im}}\gdef\syl{\operatorname{Syl}}\gdef\or{\operatorname{or}}\gdef\aut{\operatorname{Aut}}\gdef\norm{\vartriangleleft}\gdef\inn{\operatorname{Inn}}\gdef\out{\operatorname{Out}}\gdef\F{\mathbb{F}}$&lt;/p&gt;
&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;br&gt;本文仅供参考，学习顺序是不合理的。如果希望深入研究有限群分类，请先学完环和域。&lt;/div&gt;
&lt;p&gt;&lt;del&gt;原来是为了醋包的饺子。不想看无聊细节的可以直奔第 12 节。&lt;/del&gt;&lt;/p&gt;
&lt;h2 id=&#34;gtm73-之-我只来得及看完群论了&#34;&gt;GTM73 之 我只来得及看完群论了
&lt;/h2&gt;&lt;p&gt;这本教材内容是比较全的，对初学者不友好的点就是解说较少，就是大量的定理—证明，很多证明能看懂它是对的，但是无法理解它的思路是怎么想到的。&lt;/p&gt;
&lt;h3 id=&#34;1-三个代数结构&#34;&gt;1. 三个代数结构
&lt;/h3&gt;&lt;h4 id=&#34;大纲&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;半群、幺半群、群的定义，能导出它们的性质以及它们能导出的性质。&lt;/li&gt;
&lt;li&gt;构建新群的方法：直积、用等价类划分。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;幺元的定义是对每个元素都有一个&lt;strong&gt;同样&lt;/strong&gt;的元素与它运算后不变，幺元的唯一性也是指在刚才这个定义中的唯一。对于半群与幺半群，对某个特定的 $a$，$ab=a$ 的 $b$ 可能有多个，例如含不互质元素的乘法半群，按位与、或的半群。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;由半群到群的判定：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;存在左幺元与左逆元的半群是群。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;存在左幺元与右逆元的半群不一定是群（$xy=y$）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;存在左幺元与唯一右逆元的半群不一定是群（$xy=y$）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;存在唯一左幺元与右逆元的半群一定是群。&lt;/p&gt;
&lt;p&gt;证：$e=a^{-1}(a^{-1})^{-1}=a^{-1}e(a^{-1})^{-1}=a^{-1}aa^{-1}(a^{-1})^{-1}=a^{-1}ae$，因此 $a^{-1}a$ 也是逆元，$a^{-1}a=e$。&lt;br&gt;
感觉这个证明没那么自然，可能是为了硬凑 $a^{-1}a$ 形式。能否给出更自然的证明？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;存在左逆元与右逆元的半群一定是群（这里没有定义幺元，所以左右逆元可以定义为 $ax=b$ 与 $ya=b$ 均有解）。&lt;/p&gt;
&lt;p&gt;证：$(\exists x,ax=a)\land(\forall b,\exists y,ya=b)\Rightarrow\forall b,bx=b$，因此存在右幺元。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;具有左右消去律的有限半群一定是群。&lt;/p&gt;
&lt;p&gt;证：由消去律 $aG=G$（双射），可以得到幺元以及逆元。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;具有左右消去律的无限半群不一定是群。（$\N$）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;存在左逆元的幺半群一定是群。&lt;/p&gt;
&lt;p&gt;证：$xa=e\land yx=e\Rightarrow y=yxa=a$ 于是右逆元存在。$xa=ya\Rightarrow x=xaa^{-1}=yaa^{-1}=y$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一般的幺半群中不一定有左逆元等于右逆元。（&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/655186/in-a-non-commutative-monoid-is-the-left-inverse-of-an-element-also-the-right-in&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/655186/in-a-non-commutative-monoid-is-the-left-inverse-of-an-element-also-the-right-in&lt;/a&gt;）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-同构同态子群循环群&#34;&gt;2. 同构、同态、子群、+循环群
&lt;/h3&gt;&lt;h4 id=&#34;大纲-1&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;同态、单同态、满同态、同构、自同态、自同构的定义。&lt;/li&gt;
&lt;li&gt;核、像的定义。&lt;/li&gt;
&lt;li&gt;子群、生成子群、循环群的定义。&lt;/li&gt;
&lt;li&gt;以上概念相关性质（仅限群）：
&lt;ol&gt;
&lt;li&gt;单位元、逆元与子群在映射下的对应性，核、像也是子群，子群的交也是子群；&lt;/li&gt;
&lt;li&gt;核大小为 $1$ 则为单同态；&lt;/li&gt;
&lt;li&gt;子群的判定、生成子群的结构（最小）；&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-1&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;几个书里的理解问题：
&lt;ol&gt;
&lt;li&gt;单同态：$G$ 与 $H$ 的子群同构；满同态：$G$ 的商类与 $H$ 同构。&lt;/li&gt;
&lt;li&gt;幺半群同态，幺元可能不对应，是因为可以找 $H$ 中某个平方等于自身的非幺元，把 $G$ 中所有元素都映射到它。然而群中是找不到这样的元素的。如果是满同态就对应了。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;群同态中，每个有原像的元素，它们的原像集合大小相等。&lt;/li&gt;
&lt;li&gt;群中一个元素不断自乘，是不可能形成 ρ 形的。于是有限子群的判定只需要看封闭性即可。&lt;/li&gt;
&lt;li&gt;无限群一定有无限个子群，这是因为取出其每个元素的循环子群，如果只有有限个，那么必定有一个子群为无限的，那取其的子群即可。&lt;/li&gt;
&lt;li&gt;循环群基本上讲的是废话，但是有个性质还是挺重要的，在数论中用得很多。对于阿贝尔群：
&lt;ol&gt;
&lt;li&gt;$|a|\perp|b|\Rightarrow|ab|=|a||b|$。证明思路有两个：① 如果 $a^t=b^{-t}=x\ne e$，那么 $|x|\mid|a|\land|x|\mid|b|$，故 $|x|=1$，矛盾；② 如果 $(ab)^t=e$，那么 $a^{t|b|}=(ab)^{t|b|}=e=(ab)^{t|a|}=b^{t|a|}$，故 $|a|\mid t\land|b|\mid t$。&lt;/li&gt;
&lt;li&gt;$\exists c,|c|=\lcm(|a|,|b|)$。设 $|a|=xy^\prime$，$|b|=x^\prime y$，设所有在 $|a|$ 中次数 $\ge$ 在 $|b|$ 的质因子乘积为 $X$，其余为 $Y$，$x=\gcd(|a|,X^\infin)$，其余同理。取 $c=a^yb^x$，由于 $|a^y|=x\perp|b^x|=y$，故 $|c|=xy=\lcm(|a|,|b|)$。&lt;/li&gt;
&lt;li&gt;$|a|=p^x,|b|=p^y,x&amp;lt;y\Rightarrow|ab|=p^y$。若有 $z&amp;lt;x$ 使 $(ab)^{p^z}=1$，则 $p^{x-z}=|a^{p^z}|=|b^{p^z}|=p^{y-z}$。&lt;/li&gt;
&lt;li&gt;2 的形式对于（不一定循环）子群也成立。这个学了后面的知识就显然了，阿贝尔是个很强的性质。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;3-lagrange-定理相关&#34;&gt;3. Lagrange 定理相关
&lt;/h3&gt;&lt;h4 id=&#34;大纲-2&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;群中左/右同余、左/右陪集、左/右商集的定义及性质。&lt;/li&gt;
&lt;li&gt;指标、子群乘积的定义及相关性质：
&lt;ol&gt;
&lt;li&gt;（拉格朗日定理）$[G:H]=|G|/|H|$&lt;/li&gt;
&lt;li&gt;$[G:K]=[G:H][H:K]$&lt;/li&gt;
&lt;li&gt;$|HK|=|H||K|/|H\cap K|$&lt;/li&gt;
&lt;li&gt;$[H:H\cap K]\le [G:K]$，取等 $\Leftrightarrow G=HK$&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-2&#34;&gt;笔记
&lt;/h4&gt;&lt;p&gt;关键抓住两句话：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;同一陪集内的元素对应的陪集仍为该陪集。&lt;/li&gt;
&lt;li&gt;陪集形成等大的划分。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;阶为质数的群一定与 $\Z_p$ 同构，可以取 $\set e$ 以外的循环子群，利用拉格朗日定理。&lt;/p&gt;
&lt;p&gt;另外，拉格朗日定理本质上就是 Burnside 引理的引理 $|E||Z|=|G|$，这个后面会详细讲。&lt;/p&gt;
&lt;h3 id=&#34;4-正规子群与商群&#34;&gt;4. 正规子群与商群
&lt;/h3&gt;&lt;h4 id=&#34;大纲-3&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;正规子群的定义、等价表述、相关性质。&lt;/li&gt;
&lt;li&gt;由正规子群的陪集构成的商群，其性质。&lt;/li&gt;
&lt;li&gt;群的三个同构定理：
&lt;ol&gt;
&lt;li&gt;$G$ 关于其同态核的商群，同构于同态映射的像。&lt;/li&gt;
&lt;li&gt;某一子群关于一正规子群（与其交）的商群，同构于两者的积关于该正规子群的商群。&lt;/li&gt;
&lt;li&gt;两个具有包含关系的正规子群，原群关于小者的商群与大者关于小者的商群，同样构成正规子群关系，且原群关于大者的商群，同构于两者分别关于小者取商群后再取的商群。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;满同态下子群、正规子群、商群的一一对应性（当然，得是符合某些简单条件的）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;下文所有“正规子群”都默认为除 $\set{e}$ 与本身外的正规子群。&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;笔记-3&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;正规子群的核心是可以将群拆成“两层子群”，原理是左右幺元的同一。只有正规子群能生成商群（证明：&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/525584612/answer/2419749410&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/525584612/answer/2419749410&lt;/a&gt;）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一个群可能有多个同样大小的正规子群。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$K\norm H\norm G\nRightarrow K\norm G$。而 $K\norm G,K\sub H\sub G\Rightarrow K\norm H$，因为子群与正规子群的交是子群的正规子群。另外 $H,K\norm G\Rightarrow H\cap K,HK\norm G$。另外直积因子的直积因子是正规的。另外若 $K$ 是 $H$ 的正规 Sylow 子群且 $H\norm G$，则 $K\norm G$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关于群的三个同构定理的理解：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;（5.6）一个同态在缩了核之正规子群后，可以认为啥也没变，只是原像“类型转换”了一下。&lt;/li&gt;
&lt;li&gt;（一）从同态在 $H$ 中的行为可看出，$a\ker G$ 表现得和 $f(a)$ 完全一样，$\ker G$ 表现得和 $e_G$ 一样。也正是因为左右幺元为同一个，故 $\ker G\norm G$。&lt;/li&gt;
&lt;li&gt;（二）两种情况下商群结构完全相同，$K/(N\cap K)=\set{k(N\cap K)}$，$NK/N=\set{kN}$。注意与另一种情况区分：$NK\subset H$，这时 $K/(N\cap K)$ 相比于 $H/N$ 会漏一些。&lt;/li&gt;
&lt;li&gt;（三）取商群就是划分等价类，只是把某些原来不同的元素视为相同，而保留原先的运算关系（行为），因此原群与大者分别关于小者取商群，并不会真正改变什么。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;del&gt;你甚至可以把（二）（三）都理解成类似约分的东西，一个是同乘的时候约分，一个是链式约分。&lt;/del&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;本节相关命题的证明思路：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;只是证明正规或交换律。书里基本上都是用代数推导，也就是先用等价表述 (iv)，即设 $ana^{-1}$，在需要的时候用 (iii)，即令 $an_1=n_2a$。代数推导缺点是没那么直观，我会喜欢只用 (iii)，但有的命题必须用代数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;证明同构。要么直接构造双射，要么用群的第一同构定理（需要凑同态，一般不难），这里给出二、三同构定理依赖于第一同构定理的证明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;（二）构造 $K\to NK/N$，这边需要 $nkN=kN$ 以证明满同态。这个映射干了两个事，一个是划分 $K$ 中的等价类（同时确立了核为 $N\cap K$），另一个是纯类型转换，把 $k(N\cap K)$ 转换为 $kN$。&lt;/li&gt;
&lt;li&gt;（三）构造 $G/K\to G/H$。这个映射单纯就是个类型转换，把 $gK$ 转换为 $gH$，当然这个类型转换就伴随着等价类划分（$K\sub H$ 故不同元素数变少），即按核 $H/K$ 划分。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;可以得到一种感觉，就是这种同态的构造就是一种“缩”（按等价类划分），这种缩是伴随着类型转换（小正规子群的陪集到大正规子群的陪集）出现的（注：（二）中的缩其实是 $k\set e\to k(N\cap K)$）。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;5-对称群交错群二面体群&#34;&gt;5. 对称群、交错群、二面体群
&lt;/h3&gt;&lt;h4 id=&#34;大纲-4&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;某些 OIer 众所周知的东西。&lt;/li&gt;
&lt;li&gt;对称群（$n\ge 5$）有唯一正规子群。&lt;/li&gt;
&lt;li&gt;证明交错群的单性：
&lt;ol&gt;
&lt;li&gt;证明三轮换能生成原群，以及包含三轮换的正规子群是原群。&lt;/li&gt;
&lt;li&gt;证明正规子群不管长什么样，都得包含三轮换。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;二面体群的刻画。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-4&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在对置换较复杂的处理中，不要想着把置换看作作用于某一排列的移动，而应当把它看作一个双射。运算时直接看每个元素从右往左经过映射后到哪就行。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;为了更轻松地理解证明的动机，需要熟悉以下几个置换的运算：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;称形如 $ana^{-1}$ 的东西为 $n$ 的共轭。书里没讲的一点是，$\tau(i_1\cdots i_r)\tau^{-1}=(\tau(i_1)\cdots\tau(i_r))$。这给出了“偷换”轮换中某些元素而不改变结构的一个极佳手段。&lt;/li&gt;
&lt;li&gt;$(aJ)(aI)=(aIJ)$，其中 $I\cap J=\varnothing$。这边用大写字母表示一段元素。相当于用一个元素把两个轮换“串”起来了（8 字形）。一个特例是 $(i_1\cdots i_r)=(i_1i_r)\cdots(i_1i_2)$。&lt;/li&gt;
&lt;li&gt;$(aJ_1bJ_2)(aI_1bI_2)=(aI_1J_2)(bI_2J_1)$，其中 $I\cap J=\varnothing$。对于三轮换的情况：$(ab)(abc)=(bc)$、$(abc)(ab)=(ac)$、$(abd)(abc)=(ad)(bc)$、$(adb)(abc)=(bcd)$、$(abd)(acb)=(acd)$、$(adb)(acb)=(ac)(bd)$。另外还有 $(abc)^2=(acb)$、$(acb)(abc)=e$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;证明单群要找出三轮换，无非就是自乘和构造 $\nu^{-1}\tau\nu\tau^{-1}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对 $S_n$ 子群的总结：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;除 $S_4$ 外，其余群只有唯一正规子群 $A_n$，因为如果有另一个，它与 $A_n$ 的交就是 $A_n$ 的正规子群，必须是 $\set{e}$，那这样的一个正规子群必须恰好包含 $e$ 和一个奇置换（如果有两个，奇奇得偶 $\ne e$ 就爆了），这个奇置换必须由奇数个对换组成，随便用共轭替换掉其中一两个元素就爆了。&lt;/li&gt;
&lt;li&gt;$K_4\norm A_4\norm S_4$ 且 $K_4\norm S_4$。主要就是只要由若干共轭类组成，就至少满足了正规性，只需要再保证封闭即可。$K_4$ 神奇地封闭了，就是这样。$S_4$ 仅有这两个正规子群，$A_4$ 也仅有这个正规子群，证明直接考虑大小。&lt;/li&gt;
&lt;li&gt;$A_4$ 没有 $6$ 阶子群。考虑 $3$ 阶元。&lt;/li&gt;
&lt;li&gt;$S_n$ 中指数为 $2$ 的子群仅有 $A_n$（利用指数为 $2$ 的子群一定是正规子群，$n=4$ 时如果还有的话，交大小就得是 $6$，矛盾）。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;满足二面体群性质的群结构唯一，这个证明比较典型。后面自由群给了一般性的证明。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$S_n$ 和 $A_n$ 的子群无法刻画。关于 $D_n$：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;正规子群。如果 $a^xb\in H$，则 $H\ni(a^ib)(a^xb)(a^ib)=a^{2i-x}b$。因此正规子群有 $\lang a^d\rang$（$d\mid n$），如果 $2\mid n$，则还有 $\lang a^2,b\rang$ 和 $\lang a^2,ab\rang$。&lt;/li&gt;
&lt;li&gt;子群。如果 $H\cap\set{a^ib}\ne\varnothing$，那么要么 $|H|=2$，要么 $H\cap\set{a^i}=\lang a^d\rang$（$d\mid n$）。后面一种情况下，$H\cap\set{a^ib}=\set{a^{kd+r}b}$（$0\le r&amp;lt;d$）。如果还有别的元素，就可以用类似循环群子群的证明方法找到更小的 $a^{d^\prime }$。因此真子群有 $\lang a^ib\rang$、$\lang a^d\rang$、$\lang a^d,a^rb\rang$。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关于 $S_4/K_4\cong S_3$ 与 $A_4/K_4\cong Z_3$，固然可以用第二同构定理证，但这里从置换的作用出发给出了一个直观的证明：&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/302654/show-that-s-4-v-is-isomorphic-to-s-3-where-v-is-the-klein-four-group&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/302654/show-that-s-4-v-is-isomorphic-to-s-3-where-v-is-the-klein-four-group&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;这个证明说了一个事，当使用第一同构定理时，从群的作用意义上来说，我们实际上考虑了被作用对象的一部分特征，而那个同构的小群，就是这部分特征所作出的变化本质不同的作用方式形成的群。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;6-直积&#34;&gt;6. 直积
&lt;/h3&gt;&lt;h4 id=&#34;大纲-5&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;直积、外直积、内直积的定义，在同态、取商情况下的性质。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-5&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;$\lang\rang$ 符号是有限生成， 内、外直积都是在此基础上定义。注意有限和无限情况不同，例如无限位二进制数的异或，逐位为一的直积的阶为 $\aleph_1$，内、外直积的阶为 $\aleph_0$。这个就像有理数与无理数间的关系。&lt;/li&gt;
&lt;li&gt;在满足条件时，内、外直积的区别只在于类型不同。当我们说（内）直积，或者说一个群等于一些子群的积时，默认这个直积不是多元组的形式，而是直接相乘的形式，也就是说，当且仅当每个 $N_i$ 均为正规子群且与别的子群的积交为 $\set e$ $\Longleftrightarrow$ 每个元素的表达方式唯一 $\Longleftrightarrow$ $e$ 的表达方式唯一时，这个说法才有意义。而当我们说外直积，或者说一个群同构于一些小群的积时，默认是多元组的形式。&lt;/li&gt;
&lt;li&gt;注意，$N\times(G/N)\cong G$ 是不一定成立的，例如 $2\Z_4\oplus(\Z_4/2\Z_4)\cong\Z_2\oplus\Z_2\not\cong\Z_4$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;7-自由群&#34;&gt;7. 自由群
&lt;/h3&gt;&lt;h4 id=&#34;大纲-6&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;自由群的定义。&lt;/li&gt;
&lt;li&gt;用自由群生成任何群。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-6&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;虽说自由群也是有运算的群，但我们可以将它理解成字符串，这种字符串刻画的是一堆元素的运算，其中关键的一点是，只要运算式字面上不同，就认为实质不同，这一点在其余群中是基本不会出现的，否则这样的群就没啥性质了。&lt;/p&gt;
&lt;p&gt;但是，这里需要避免混淆的一点是，字内字母的排列，与两个字的运算，都写成了顺次拼接的形式。在证明自由群的结合律时，如果要硬证的话，必须讨论三个字 $a,b,c$ 以不同顺序考虑抵消时实际的抵消情况来证明，或者用归纳法。而不能说“由于每个字都可以看成若干个单 $x^{\pm 1}$ 运算在一起，而所有 $x^{\pm 1}$ 是有结合律的，因此所有元素都满足结合律”（相当于只证了部分元素的结合律）。不过，书里的这个证明很有意思：赋予每个元素一个实际含义“对所有字的置换”，这样既保证了区分任何字面不同的情况，又将结合律的证明归约到了对称群的结合律。&lt;/p&gt;
&lt;p&gt;另外，这节的理论很好地解释了 [CSP-S 2023] 消消乐 的 trie 树做法的动机——找所有 $s_i\cdots s_j=e$，就可以转化成找所有 $(s_1\cdots s_{i-1})^{-1}s_1\cdots s_j=e$，也就是 $s_1\cdots s_j=s_1\cdots s_i$。这题唯一的特殊性是给定了关系 $xx=e$，不过没什么影响。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;自由群的子群均为自由群，这个证明很难。另外自由群子群的最小生成元集大小可能大于原群的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;所有群都同构于自由群的商群，以及给定生成元集和关系可以唯一确定“最大”的群，这个很重要。几点理解：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;这个证明的核心是，在自由群的基础上添加特定群的额外关系后不会出现矛盾，而这是平凡的（否则自由群就不够自由了……）。&lt;/li&gt;
&lt;li&gt;关系的生成正规子群，这个东西的确定，依赖于正规子群的交仍为正规子群。关于 9.5 的证明，直观的理解就是，最大的群对应那个最小的核，有大核的话有可以它通过 5.6 或 5.8 搞个满射。&lt;/li&gt;
&lt;li&gt;一个群的商群可能不同构于其子群，否则由“自由群的子群均为自由群”，就会出现很诡异的事情。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;证明某一个表示对应的群是某个群：先验证符合，然后再通过关系的代数推导，得出“所有的元素都能表示为某类形式”，从而证明大小的上界。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;8-有限生成-abel-群结构定理&#34;&gt;8. 有限生成 Abel 群结构定理
&lt;/h3&gt;&lt;h4 id=&#34;大纲-7&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;自由阿贝尔群的定义。&lt;/li&gt;
&lt;li&gt;用自由阿贝尔群生成任何阿贝尔群。&lt;/li&gt;
&lt;li&gt;若干种取子群的方式（$mG,G[m],G(p),G_t$）的定义及性质。&lt;/li&gt;
&lt;li&gt;有限秩的自由阿贝尔群的子群的结构，即所有有限生成阿贝尔群的结构。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-7&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;我们来大致梳理以下整个刻画过程的思路：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;定义自由阿贝尔群，知道自由群后，这个定义是很自然的。处理自由阿贝尔群的性质时，套路是和线性代数很相似的，唯一不同的点是线性代数允许一个向量乘有理数加给另一个向量（以及向量本身乘一个数），而阿贝尔群不允许。也正是这一点，导致了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;导出自由阿贝尔群的一些性质：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每个元素表示唯一、基在某个元素乘若干倍加给另一个元素的操作下仍为基，以及它的“自由”性（同样，自由的证明仅需要证明良定义即可）。&lt;/li&gt;
&lt;li&gt;额外地，证明自由阿贝尔群的基大小唯一。这里对秩有限情况的证明策略是通过取商群，将无限转化为有限，而秩无限的情况就直接用定义和序数理论。我们会注意到，对于唯一性的证明，套路一般就是通过一种不依赖于具体分解的方式，取子群或商群，然后通过这两个不能不相等，证回唯一。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;有限秩的自由阿贝尔群的子群的结构。这个证明最好的方式其实是给出一个构造性的算法：首先考虑用自由群的基线性表出子群的各个生成元，写成一个矩阵。对这个矩阵列变换就是改变基，行变换就是改变生成元集。为了保证改变后可生成性不变，只能使用交换两行/列、一个乘整数倍加给另一个、以及一行/列乘 $-1$。现在可以通过一个算法将矩阵化为&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Smith_normal_form&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;史密斯标准形&lt;/a&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;每次通过多元素的辗转相除法，将左上角元素变为所在行或所在列的 $\gcd$，并把对应行/列的其他元素全部减成 $0$。注意到，一旦 $\gcd$ 不缩小，就可以将行列均变为 $0$，那这样就可以归约到两维各减一的子矩阵。（这里我有一个时间复杂度更优的算法）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;现在可以假定只有 $a_{1,1}$ 到 $a_{r,r}$ 非零。注意到可以用：
$$
\begin{bmatrix}a&amp;amp;0\\ 0&amp;amp;b\end{bmatrix}\xrightarrow{\mathrm{B\acute{e}zout}}\begin{bmatrix}a&amp;amp;g\\ 0&amp;amp;b\end{bmatrix}\rightarrow\begin{bmatrix}a&amp;amp;g\\ -l&amp;amp;0\end{bmatrix}\rightarrow \begin{bmatrix}g&amp;amp;0\\ 0&amp;amp;l\end{bmatrix}
$$
将两个元素分别变为它们的 $\gcd$ 和 $\lcm$。那就可以用类似冒泡的过程，将这个对角线上的元素调整为依次整除。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;而书里用了一个类似无穷递降法的过程。根据证明贪心的一些经验，由于一般反证只干掉单步，故会比构造性的过程简单一些。书里的思路是：首先找到所有可行生成元被所有基表出的所有系数中最小的一个系数对应的一项 $d_1x_1$，这个 $d_1x_1$ 能作为第一个生成元，然后接着归约就行。其递降的核心是，若不整除，则余数会导致更小项。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后就是利用第一同构定理加商群在直积下的同构性，直接导出任何有限生成阿贝尔群存在一种预想的拆分方式。合数阶的拆分太显然了。最后是证明拆分的唯一性：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\Z$ 部分，商掉挠子群，归到自由阿贝尔群表示的唯一性。&lt;/li&gt;
&lt;li&gt;“唯一分解定理”，处理方式仍然是抽出子群证相等或矛盾。注意到有限阿贝尔群的商群和子群是可以打通的（&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/64982/is-every-quotient-of-a-finite-abelian-group-g-isomorphic-to-some-subgroup-of&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/64982/is-every-quotient-of-a-finite-abelian-group-g-isomorphic-to-some-subgroup-of&lt;/a&gt;），所以用哪种无所谓。&lt;/li&gt;
&lt;li&gt;依次整除的表示唯一。这个看起来不大直觉，但是把每个阶都拆开来排成矩阵，就显然了。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;阶为 $n$ 的阿贝尔群的数量 $f(n)$ 是积性函数，其中 $f(p^k)=p(k)$，$p(k)$ 是 $k$ 的无序拆分数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;练习 2.2 的思路：只考虑指数幂情况。归纳，找到一个阶为质数的，与 $\lang x\rang$ 交为 $\set{0}$ 的群 $H$（直接找循环群即可），然后归纳。归纳有个细节，就是 $G/H=(\lang x\rang H)\oplus(K/H)$ 推到 $G=\lang x\rang+K+H=\lang x\rang\oplus K$ 时，要用直积那节交为 $\set{0}$ 的性质。然后推大结论用的是所有元素的阶都整除最大阶。&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://math.libretexts.org/Bookshelves/Abstract_and_Geometric_Algebra/Abstract_Algebra%3A_Theory_and_Applications_%28Judson%29/13%3A_The_Structure_of_Groups/13.01%3A_Finite_Abelian_Groups&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.libretexts.org/Bookshelves/Abstract_and_Geometric_Algebra/Abstract_Algebra%3A_Theory_and_Applications_(Judson)/13%3A_The_Structure_of_Groups/13.01%3A_Finite_Abelian_Groups&lt;/a&gt; 的 Lemma 13.9。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意挠群不一定有限，例如 Prüfer 群 $\Z(p^\infin)$，它是无限个 $\Z_p$ 的内直积。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;9-krull-schmidt-定理&#34;&gt;9. Krull-Schmidt 定理
&lt;/h3&gt;&lt;h4 id=&#34;大纲-8&#34;&gt;大纲
&lt;/h4&gt;&lt;p&gt;最看不懂的一集。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;不可分解群、升降链的定义与关系，正规自同态、幂零的定义。&lt;/li&gt;
&lt;li&gt;为证明 Krull-Schmidt 定理所作的准备，自同态在满足升降链条件的情况下的四条性质。&lt;/li&gt;
&lt;li&gt;Krull-Schmidt 定理。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-8&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;不可分解的条件比单群弱。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;梳理一下证明思路。Krull-Schmidt 定理核心说的就是，ACC 和 DCC 同时成立的情况下分解唯一（我怎么感觉有限群之外一般都用不了这个……）&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;满足 ACC&amp;amp;DCC 的不可分解群的自同态要么是自同构，要么是幂零。可根据 $G=(\ker f^n)(\im f^n)$ 直接导出，而 3.4 和 3.5(Fitting) 都是把链设出来之后妙妙推式子。注意在 DCC 是 $f$ 需要正规只是为了 DCC 正规，而正规最终是为了和内直积对上。&lt;/li&gt;
&lt;li&gt;在 $G=G_1\times\cdots\times G_r\times H_{r+1}\times\cdots\times H_t$ 的情况下，要找到一个 $H_j\cong G_{r+1}$。找的思路是，$G$ 中的元素，它在全 $G_i$ 分解中的 $G_{r+1}$ 分量，在当前分解中体现为 $H_{r+1}\sim H_t$ 分量的一部分，用书中的代数语言写，就是如果让 $\varphi$、$\psi$ 为取分量操作，$\varphi_r=\sum_{j\ge r}\varphi_r\psi_j$。$\varphi_r$ 是 $G_r$ 下的单位映射，所以右式不能全是幂零。&lt;/li&gt;
&lt;li&gt;要证明最后一句话，就是要证幂零自同态之和封闭 $\Rightarrow$ 幂零。容易想到反证，因为直觉上来说，多个幂零的东西加起来也是幂零的。但直接取幂，由于自同态关于加法没有交换律，所以搞不了。这里证明搞了个 $g_i=f_i(f_1+f_2)^{-1}$，然后一波妙妙推式子就交换了。这边加法和复合构成环。&lt;/li&gt;
&lt;li&gt;回到原证明，找到一个不是幂零的也就是自同构，分析一下单、满射就可以得到 $\psi_j$ 和 $\varphi_r$ 是（正反方向）同构，然后就要证直接把 $H_j$ 换成 $G_r$ 就行了，就是说虽然 $H_j$ 和 $G_r$ 的东西不一样，但是它们乘上别的之后就得到了整个 $G$，从两个方面（不重——和别的交为 $\set{e}$，不漏——单+3.4=双）证即可。最后才导出 $s=t$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;3.4、3.5、3.7 都有妙妙推式子，我真没法理解思路，除了 3.4：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$\ker f^n=\ker f^{n+1}$ 的话，说明只有原来的核是新的核，也就是只有原来的 $e$ 是新的 $e$，则单射则双射。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\im f^n=\im f^{n+1}$ 的话，说明原来的像能覆盖新的像了，那像以外的部分就得汇聚到像内导致多对一，于是根本就不能有像以外的部分，则满射则双射。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;然后怎么理解 3.8 的这个“逐一替换”强于单说同构呢？可以看 &lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/2982433/krull-schmidt-theorem-for-groups&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/2982433/krull-schmidt-theorem-for-groups&lt;/a&gt;，本质上就是内直积它是直接子群直积，避开了多元组然后同构的步骤，也就是说 Krull-Schmidt 定理说的不单单是结构唯一，而且还能直接从 $G$ 里取出一堆来直接生成。&lt;/p&gt;
&lt;p&gt;另外，这个替换过程可以类比线代：比如 $\R^2$ 的基既可以是 $[1\quad0]$ 和 $[0\quad1]$，也可以是 $[1\quad0]$ 和 $[1\quad1]$，可以把 $G_r$ 和 $H_j$ 分别看成两个基的后者。&lt;/p&gt;
&lt;p&gt;另外注意证明过程中是否有：有限、$G\ne\set{e}$、either ACC/DCC 还是 both ACC&amp;amp;DCC。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;3.3 的证明就反证后随便找找子群（DCC 做个前缀和），不过存在不可分解群不满足 ACC 也不满足 DCC 吗？&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;10-群作用&#34;&gt;10. 群作用
&lt;/h3&gt;&lt;h4 id=&#34;大纲-9&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;群作用、轨道、稳定化子、共轭类、中心化子、正规化子、类方程、中心、内自同构的定义。&lt;/li&gt;
&lt;li&gt;关于它们的一些性质，主要是以 $|E||Z|=|G|$ 为核心思想的部分，和质数正规的部分。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-9&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;关于群作用的概念较多，研究的核心就是两个：作用者和被作用者。被作用者，我们主要关心其等价类与使它不变的“子”；作用者，主要关心其不动点。特别地，我们非常关心群自身作用自身的情况，这时作用者和被作用者的地位可互换（中心，$gx=xg$）。&lt;br&gt;
在这几节中，每个定理我们都必须首先明确作用者和被作用者，不然马上就糊涂了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;指数为最小质因子的子群必正规，这个的证明思路是：考虑陪集 → $G$ 左作用给左陪集是置换 → $G$ 根据作用效果分类 → ① 置换子群最大质因子是 $p$ ② 划分得是 $|G|$ 的因子 → 只可能 $H$ 自身是核（核至多是 $H$）。&lt;/p&gt;
&lt;p&gt;这个过程还算易懂，但是是怎么想到绕这样一个弯证出来的？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;补充一下，内自同构是自同构群的正规子群，其商群成为外自同构。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;11-sylow-定理&#34;&gt;11. Sylow 定理
&lt;/h3&gt;&lt;h4 id=&#34;大纲-10&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;Sylow 定理的一些引理，主要是关于阶为质数的群的性质。&lt;/li&gt;
&lt;li&gt;Sylow $p$ 子群的定义、Sylow 三定理。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-10&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;这个部分主要有几个核心思想：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$|S|\equiv|S_0|\pmod p$ 一类。这个说的是，被作用者形成的等价类中，由于稳定化子的陪集构成整个轨道，故每个的大小都是 $p$ 的次幂，然后取 $p^0$（不动点）那部分。这个性质的唯一作用就是说非平凡不动点存在。注意用它的前提条件是作用者的阶必须是质数幂。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;有个重要的思想有点难表述，我们看下几个有相似点的证明思想：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;定理 5.5. $p$ 子群 $H$ 满足：它的“正规化陪集”数（显然，一个 $H$ 的陪集要么全是正规化子要么全不是），与它的陪集数同余。&lt;/p&gt;
&lt;p&gt;首先得明确，引理 5.1 只能用于同余式两边都是被作用者的情况，但是 5.5 的形式中，就算我们考虑把 &lt;strong&gt;$H$ 的陪集作为被作用者&lt;/strong&gt;，这个“正规化陪集”再怎么说都只能是作用者啊！都写明了是“使 $H$ 正规”。这里我们联想 4.7 证明里的一句话：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$g$ 是中心 $\Leftrightarrow$ $g$ 是不动点。（前提：$G$ 共轭作用给 $G$ 自身）&lt;br&gt;
说明：$gxg^{-1}=x\Leftrightarrow xgx^{-1}=g$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们得以从“中心”这一作用者的角度，转化为“不动点”这一被作用者的角度。那这里也是一样的。&lt;/p&gt;
&lt;p&gt;这里，选用的是 &lt;strong&gt;$H$ 的元素作为作用者（左作用）&lt;/strong&gt;，这个感觉有点怪异。那么 $|S_0|$ 就应该是在所有 $h$ 的作用下不动的陪集：$h(xH)=xH\Leftrightarrow xHx^{-1}=H$，于是就打通了。发现这个的本质和上面这种单点的是类似的。&lt;/p&gt;
&lt;p&gt;另外注意：$\forall h\in H,x^{-1}hx\in H\Rightarrow x^{-1}Hx=H$ 这个是在有限前提下的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第二定理：要证 $H\sub xPx^{-1}$，模仿上面的证明，逆向考虑，我们要找的应当是 $h(xP)=xP$（$p(xH)=xH$ 的话就倒反天罡了），即 &lt;strong&gt;$P$ 陪集为被作用者，$H$ 的元素为作用者（左）&lt;/strong&gt;。然后就是个 $[G:P]\not\equiv0$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第三定理：其实说的就是 $[G:N_G(P)]\equiv 1$，拿 5.5 除一下就出来了。不过多个思路也是好事。这里显然考虑&lt;strong&gt;被作用者是 $P$ 的所有共轭&lt;/strong&gt;，即 $\syl_p(G)$，然后让 $S_0=\set P$ 就行。&lt;strong&gt;$P$ 的元素为作用者&lt;/strong&gt;，于是 $\forall p\in P,pQp^{-1}=Q\Rightarrow P\sub N_G(Q)$ 然后由第二定理就得到 $P=Q$。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;容易发现，这里的通用构造是“某个小集合（可能就是这个子集）作用在所有子集的陪集上”，然后从不动点出发，去推一些神奇的结论。前一节中是将作用视作置换群，先从作用者的稳定性考虑，能推的不是很多（仅能推出 $\mid n!$ 相关的性质）。反正记住有这两类证的思路就行。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第一定理反而显得简单了，就是用柯西定理找个循环群，然后找稳定化子升幂即可。5.11 和第三定理思路中的一块是相同的，就是共轭不变 $+$ Sylow $p$ $\Rightarrow$ 唯一。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;看了第一定理后，会有一个直觉，就是 Sylow $p$ 子群唯一，感觉上如果有两个，可以乘一下搞出更大的。但是这个是不对的，可以看 &lt;a class=&#34;link&#34; href=&#34;https://planetmath.org/subgroupsofs4&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://planetmath.org/subgroupsofs4&lt;/a&gt; 为例。另外两个 Sylow $p$ 子群的交也可能非平凡：&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/24704/distinct-sylow-p-subgroups-intersect-only-at-the-identity-which-somehow-follo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/24704/distinct-sylow-p-subgroups-intersect-only-at-the-identity-which-somehow-follo&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;这里提一下 Sylow 第三定理的加强版本：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;设 $v_p(|G|)=m$ 且 $G$ 的所有 Sylow $p$ 子群中，&lt;strong&gt;交&lt;/strong&gt;最大大小为 $p^r$，则 $n_p(G)\equiv1\pmod{p^{m-r}}$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;证：我们仍然考虑某一 Sylow $p$ 子群 $P$ 共轭作用在 $\syl_p(G)$ 上。在上面的第三定理中，我们说明的是 $Q$ 不能不动即 $N_P(Q)\ne P$ 即 $P\not\sub N_G(Q)$，其证明手段是，$N_G(Q)$ 中只有唯一 Sylow $p$ 子群 $Q$。那这里也是一样的，$N_P(Q)=N_G(Q)\cap P$，现在我们额外地说，由于 $N_G(Q)\cap P$ 必须是 $p$ 子群，而 $N_G(Q)$ 的 $p$ 子群都包含于 $Q$ 中，因此 $N_P(Q)\sub P\cap Q$，故 $|N_P(Q)|\le|P\cap Q|\le p^r$，故 $p^{m-r}\mid|\mathrm{Orb}_P(Q)|$。&lt;/p&gt;
&lt;p&gt;这个在有限群分类、证明单群时可以用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;问题：是否会出现某个大小的 $p$ 子群唯一，但 Sylow $p$ 子群不唯一的情况？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;看个搞笑的：&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/36479927/answer/1554929023&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/36479927/answer/1554929023&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;12-有限群分类&#34;&gt;12. 有限群分类
&lt;/h3&gt;&lt;h4 id=&#34;大纲-11&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;$pq$、$8$、$12$ 阶群结构。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-11&#34;&gt;笔记
&lt;/h4&gt;&lt;p&gt;下文所有 $n_p$ 默认为 $n_p(G)$。&lt;/p&gt;
&lt;p&gt;主要的几个分析方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;最常用的几个基本定理：拉格朗日定理、第一同构定理、阿贝尔群结构、$G/C(G)$ 循环则阿贝尔、全 $2$ 阶则阿贝尔、指数为最小质因子则正规、$p$ 群中心非平凡、Sylow 定理。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一个极为有效的推导：$n_p=kp+1$ 且 $n_p\mid\frac{|G|}{\gcd(|G|,p^\infin)}$，然后要么就是单个正规子群，要么数量可能性少。单个正规子群时，可以从正规性和商群的角度列出两个式子 $bab^{-1}=a^?$ 与 $b^{[G:N]}=a^?$。处理共轭时常用的推导是 $ba^jb^{-1}=(bab^{-1})^j$ 以及 $b^{i}ab^{-i}=b^{i-1}a^kb^{-(i-1)}=\cdots=(bab^{-1})^{k^i}$。&lt;/p&gt;
&lt;p&gt;这样的一个推导实际上是在分析一个任意子群到正规子群自同构的同态。实际上我们主要会遇到：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\aut\Z_n=\Z_n^\times$。然后根据中国剩余定理与原根存在定理进行拆分。&lt;/li&gt;
&lt;li&gt;$\aut\Z_p^k\cong\mathrm{GL}_k(\F_p)$。就是 $\bmod p$ 下的 $k$ 阶满秩矩阵，其列向量对应每个生成元映射到哪。&lt;/li&gt;
&lt;li&gt;其他一些阿贝尔群的自同构。先尝试按质因子拆，包含多个 $\Z_{p^k}$ 直积因子可能会不好搞&lt;/li&gt;
&lt;li&gt;其他。只能讨论一些小的情况，另外可考虑正规子群的不动性。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果正规子群太小，可以用 Correspondence Theorem（或叫 Lattice Theorem）扩大。其实感觉比较平凡，就是说 $G/N$ 的正规子群对应 $G$ 的正规子群，其实在 I.5.11 提到过。然后这个反过来也是成立的，即 $G$ 的正规子群也对应 $G/N$ 的正规子群。&lt;/p&gt;
&lt;p&gt;如果正规子群太大，也可以考虑第 4 节笔记里的方法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果搞不出正规子群，我们一定要强制搞出来。有几个处理思路：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;考虑共轭 Sylow 子群多的话可能元素会分配不过来。&lt;/li&gt;
&lt;li&gt;考虑对子群的陪集或正规子群共轭的作用，同态于对称群。&lt;/li&gt;
&lt;li&gt;考虑中心，可以直接讨论，或者考虑共轭 Sylow 子群的交之类的。中心意味着直积。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;然后总结一下各种情况的证明思路。注意当给出一个生成关系时，应当证明它对应的群大小恰好是它且确实是群，不然是不够的，但是这里就略去了。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$p^2$。中心个数是 $p$ 的倍数，于是 $G/C(G)$ 是 $1$ 或 $p$ 阶的，后一种情况通过写出元素的形式可得交换，于是 $G$ 是阿贝尔群。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$pq,(p&amp;lt;q)$。存在唯一 Sylow $q$ 子群 $\lang a\rang$，$n_p&amp;gt;1$ 就必须是 $q\mid(p-1)$ 情况，取个其中的元素 $b$，$bab^{-1}=a^s\Rightarrow a=b^pab^{-p}=a^{s^p}\Rightarrow s^p\equiv 1\pmod q$。证明所有 $ba=a^sb$ 的群同构只需构造 $\varphi(a)=a^\prime ,\varphi(b)={b^\prime }^{\operatorname{ind}_{s^\prime }s}$ 即可，这给出了 $G\cong\Z_q\rtimes\Z_p$ 且半直积的下标可以省略。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$8$。非阿贝尔的情况一定有一个阶为 $4$ 的元素 $a$，取 $b\notin\lang a\rang$，① $b$ 对 $\lang a\rang$ 的共轭形成 $\lang a\rang$ 的自同构，于是不交换只能是 $bab^{-1}=a^3\Rightarrow ba=a^{-1}b$；② $b^2\in\lang a\rang\Rightarrow b^2=e\or a^2$。分别对应 $D_4$ 和 $Q_8$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$12$。类似证明指数为最小质因子的群正规的方式，考虑对 $4$ 个 Sylow $3$ 子群的陪集的左作用，到 $S_4$ 的同态。若核是 $\set{e}$，则 $G\cong A_4$；否则由于核是该 Sylow $3$ 子群的子群，故必为其本身，故 Sylow $3$ 子群正规，设为 $\lang a\rang$，它的中心化子里一定有 $|b|=2$，于是 $|ab|=6$。记 $c=ab$，则 $dcd^{-1}=c^5$（非交换）且 $d^2=c^{0\or2\or3\or4}$。如果是 $2\or 4$ 就会 $c^{\pm 2}=d^2=dc^{\pm2}d^{-1}=c^{\mp2}$ 矛盾，故 $d^2=e\or c^3$。&lt;br&gt;
这两种分别对应 $D_6$ 与 $\Z_6\rtimes\Z_2$……吗？？？如果是 $\Z_6\rtimes\Z_2$ 的话，含 $d$ 的元素的阶就全是 $2$ 了，就是 $D_6$。考虑以 $a$ 和 $d$ 作为生成元（$d^2=b$ 所以 $d$ 可以替代 $b$ 的功能），于是关系就变成了 $a^3=d^4=e,dad^{-1}=a^2$，这样就可以写成 $\Z_3\rtimes\Z_4$ 了。&lt;/p&gt;
&lt;p&gt;又看到一个不错的证明思路 &lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=dS-fIMHVNcE&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.youtube.com/watch?v=dS-fIMHVNcE&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;实际上回头看这里，考虑一个 Sylow $2$ 子群（$\Z_4$ 或 $\Z_2^2$）到 $\aut\Z_3$ 的同态（非平凡的只有一个）即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$p^3$。如果有 $p^2$ 阶元 $a$ 则 $\lang a\rang\norm G$，那么显然希望找到另一个 $p$ 阶元 $b$ 从而构成 $\Z_{p^2}\rtimes\Z_p$，这个可以先随便取一个 $b$，然后如果它的阶数不对的话，乘上某个 $a^?$ 就行，这个 $?$ 可以待定系数法解出来。然后容易证明所有的 $bab^{-1}=a^k$ 都是同构的，这里要求 $\delta_{p^2}(k)=p$，所以关系可以写成 $a^{p^2}=b^p=1,ba=a^{p+1}b$。&lt;/p&gt;
&lt;p&gt;如果没有，则选个 $p$ 阶中心 $c$（$|C(G)|=p$ 否则类似 $p^2$ 情况就阿贝尔了），选 $\lang c\rang$ 以外 $p$ 阶元 $a$，再选另外的 $b$。这里 $\Z_p^2\cong\lang c\rang\times\lang a\rang\norm G$，同样讨论在 $b$ 的共轭作用下这个正规子群会怎样自同构，这里讨论比较复杂，最后得出的同样是所有可能都是同构的，即 $\Z_p^2\rtimes\Z_p$，关系可以写成 $a^p=b^p=c^p=e,ac=ca,bc=cb,c=bab^{-1}a^{-1}$。推导细节详见 &lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/497442031/answer/3098229320&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/497442031/answer/3098229320&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在搜资料的时候我发现半直积的性质还是很重要的，所以这里先补充一下相关的知识：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;应该从内半直积开始理解，现在假设 $HK=G$，$H\cap K=\set{e}$，但只有 $H\norm G$。我们想使用类似直积的，$H\rtimes K\cong G$ 的方式来拆分 $G$，因此有同构映射 $f:(h,k)\mapsto hk$，运算必须满足
$$
f((h_1,k_1)\cdot(h_2,k_2))=f((h_1,k_1))f((h_2,k_2))=h_1k_1h_2k_2
$$
就需要应对 $h$ 与 $k$ 无法交换的问题（如果 $K\norm G$ 则根据 $hkh^{-1}k^{-1}\in H\cap K=\set{e}$ 可得交换性）。这里的关键是：
$$
h_1k_1h_2k_2=h_1(k_1h_2k_1^{-1})k_1k_2
$$
于是定义 $(h_1,k_1)\cdot(h_2,k_2)=(h_1\cdot k_1h_2k_1^{-1},k_1k_2)$，其余运算规则略，可验证其对应的群符合条件。&lt;/p&gt;
&lt;p&gt;外半直积也是一样的，我们知道在群中，共轭对应了内自同构。这里要构造群，就只需要是自同构就行了，即，若有同态（不能单单是映射，否则运算就不是良定义的了） $\varphi:K\to\aut H$，就可以定义 $(h_1,k_1)\cdot(h_2,k_2)=(h_1\varphi(k_1)(h_2),k_1k_2)$。这就是外半直积 $H\rtimes_\varphi K$，在不引起歧义时可省略 $\varphi$。&lt;/p&gt;
&lt;p&gt;以上内容参考了 &lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=Pat5Qsmrdaw&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.youtube.com/watch?v=Pat5Qsmrdaw&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;性质 1：对于 $\varphi:K\to\inn H$，$H\rtimes_\varphi K\cong H\times K$。&lt;/p&gt;
&lt;p&gt;证：根据 $\varphi$ 得到一个 $\psi:K\to H$，$(h_1,k_1)(h_2,k_2)=(h_1\psi(k_1)h_2\psi(k_1)^{-1},k_1k_2)$。构造同构映射 $f:(h,k)\mapsto h\psi(k)$，验证
$$
\begin{align*}
&amp;amp;f((h_1,k_1)(h_2,k_2))\\ ={}&amp;amp;h_1\psi(k_1)h_2\psi(k_1)^{-1}\psi(k_1k_2)\\ ={}&amp;amp;h_1\psi(k_1)h_2\psi(k_2)\\ ={}&amp;amp;f((h_1,k_1))f((h_2,k_2))
\end{align*}
$$&lt;/p&gt;
&lt;p&gt;性质 2：$\exists\chi\in\aut H,\forall k\in K,\psi(k)=\chi\circ\varphi(k)\circ\chi^{-1}\Rightarrow H\rtimes_\varphi K\cong H\rtimes_\psi K$。&lt;/p&gt;
&lt;p&gt;证：构造 $f:(h,k)\mapsto(\chi(h),k)^\prime $，验证
$$
\begin{align*}
&amp;amp;f((h_1,k_1)(h_2,k_2))\\ ={}&amp;amp;f((h_1\varphi(k_1)(h_2),k_1k_2))\\ ={}&amp;amp;(\chi(h_1)(\chi\circ\varphi(k_1))(h_2),k_1k_2)^\prime \\ ={}&amp;amp;(\chi(h_1)(\psi(k_1)\circ\chi)(h_2),k_1k_2)^\prime \\ ={}&amp;amp;(\chi(h_1),k_1)^\prime (\chi(h_2),k_2)^\prime \\ ={}&amp;amp;f((h_1,k_1))f((h_2,k_2))
\end{align*}
$$
这个反过来是不对的，一个简单的反例就是性质 1。&lt;/p&gt;
&lt;p&gt;直觉上来说，这个性质就是对自同构本身作了自同构，或者在实际证明时，往往形如“我们换 $H$ 的生成元（比如 $a$ 换成 $a^3$ 之类），发现它变成了另一个自同构”，于是这两（几）个就只需考虑一个。&lt;/p&gt;
&lt;p&gt;性质 3：对于有限循环群 $K$，$\exists\chi\in\aut H,\psi(K)=\chi\circ\varphi(K)\circ\chi^{-1}\Rightarrow H\rtimes_\varphi K\cong H\rtimes_\psi K$。&lt;/p&gt;
&lt;p&gt;证：设 $K=\lang k\rang$。首先循环群有性质 $\varphi(k^a)(h)=\varphi(k)^a(h)$，因此下面以 $\varphi,\psi$ 指代 $\varphi(k),\psi(k)$。&lt;/p&gt;
&lt;p&gt;设 $\psi^c=\chi\circ\varphi\circ\chi^{-1}$，构造 $f:(h,k^a)\mapsto(\chi(h),k^{ac})^\prime $，验证
$$
\begin{align*}
&amp;amp;f((h_1,k^a)(h_2,k^b))\\ ={}&amp;amp;f((h_1\varphi^a(h_2),k^{a+b}))\\ ={}&amp;amp;(\chi(h_1)(\chi\circ\varphi^a)(h_2),k^{(a+b)c})^\prime \\ ={}&amp;amp;(\chi(h_1)((\chi\circ\varphi\circ\chi^{-1})^a\chi)(h_2),k^{(a+b)c})^\prime \\ ={}&amp;amp;(\chi(h_1)(\psi^{ac}\circ\chi)(h_2),k^{(a+b)c})^\prime \\ ={}&amp;amp;(\chi(h_1),k^{ac})^\prime (\chi(h_2),k^{bc})^\prime \\ ={}&amp;amp;f((h_1,k^a))f((h_2,k^b))
\end{align*}
$$
注意，$K$ 有限时易验证 $c\perp|K|$，从而 $f$ 是双射。$K$ 无限时 $f$ 就不是双射了。&lt;/p&gt;
&lt;p&gt;更多的反例详见 &lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/624672/semi-direct-product-of-groups-with-one-of-them-cyclic&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/624672/semi-direct-product-of-groups-with-one-of-them-cyclic&lt;/a&gt; 和 &lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/527800/when-are-two-semidirect-products-isomorphic&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/527800/when-are-two-semidirect-products-isomorphic&lt;/a&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;由于群分类时大部分情况这个 $K$ 都是循环群，所以性质 3 会更好用。这个性质 3 相比性质 2 强的点在于，它只要求整个像共轭，而不用每个 $k$ 对应共轭。性质 3 和 $pq$ 情况的证明的核心思想是一样的。&lt;/p&gt;
&lt;p&gt;现在，我们可以从更高的角度理解 $p^3$ 情况的分析：若正规子群是 $\Z_{p^2}$，那么性质 3 就说有本质唯一的 $\varphi:\lang b\rang\to\set{f\in\aut\Z_{p^2}\mid f(a)=a^{kp+1},k\ne 0}$。若正规子群是 $\Z_p^2$，$\aut\Z_p^2\cong\mathrm{GL}_2(\F_p)$，而 $|\mathrm{GL}_2(\F_p)|=(p^2-1)(p^2-p)$，于是它的唯一 Sylow $p$ 子群共轭类 $\overline{\left\langle\begin{bmatrix}1&amp;amp;1\\ 0&amp;amp;1\end{bmatrix}\right\rangle}$ 就对应了所需的映射，于是半直积也是唯一的。&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;
&lt;p&gt;$p^2q$。这个情况需要一个我不会证的性质，先写出来：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;对于性质 3，如果 $|H|\perp|K|$，则反推也成立。&lt;/p&gt;
&lt;p&gt;这个性质是 &lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/a/1834299&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/a/1834299&lt;/a&gt; 的简单推论。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这使我们能快速说明分类后各类不同构。接下来是按 $([p\mid(q-1)],[q\mid(p^2-1)])$ 的四种情况来分讨。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$p\mid(q-1)\land q\mid(p^2-1)$。唯一的可能是 $p=2,q=3$，已经在上面讨论过。&lt;/li&gt;
&lt;li&gt;$p\nmid(q-1)\land q\nmid(p^2-1)$。阿贝尔。&lt;/li&gt;
&lt;li&gt;$p\nmid(q-1)\land q\mid(p^2-1)$。
&lt;ol&gt;
&lt;li&gt;Sylow $p$ 子群是 $\Z_{p^2}$。取个 $q$ 阶循环群，如果 $q\mid(p-1)$，类似于 $pq$ 的时候，会有一个非平凡的情况，就是 $bab^{-1}=a^s$，其中 $\delta_{p^2}(s)=q$。不同的 $s$ 对应的都是同构的。&lt;/li&gt;
&lt;li&gt;Sylow $p$ 子群是 $\Z_p^2$。这里的分析很复杂，概括一下就是，首先 $q\mid(p-1)\lor q\mid(p+1)$。分三种情况，$q=2$ 是简单的，$q\mid(p+1)$ 的情况有唯一共轭类，$q\mid(p-1)$ 的情况有 $(q+3)/2$ 种。这里核心思路是，从特征值角度出发分析 $\mathrm{GL}_2(\F_p)$ 中 $q$ 阶循环子群之间的共轭关系。细节详见 &lt;a class=&#34;link&#34; href=&#34;https://www.math.purdue.edu/~jlipman/5532011/order-p%5e2q.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.math.purdue.edu/~jlipman/5532011/order-p%5e2q.pdf&lt;/a&gt;，注意这篇文章 $q=2$ 多算了个错的。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;$p\mid(q-1)\land q\nmid(p^2-1)$。还是随便取一个 Sylow $p$ 子群。
&lt;ol&gt;
&lt;li&gt;它是 $\Z_{p^2}$。$bab^{-1}=a^s$ 的 $s$ 满足 $\delta_q(s)=p$ 或 $\delta_q(s)=p^2$（如果 $p^2\mid(q-1)$），分别对应一种。&lt;/li&gt;
&lt;li&gt;它是 $\Z_p^2$。这里用不了性质 3 了，但是也不难搞。设生成元为 $b,c$，$bab^{-1}=a^s,cac^{-1}=a^t$，满足 $\delta_q(s),\delta_q(t)\mid p$ 且不同时为 $1$。我们回顾 $pq$ 情况以及其他形如“不同的阶为 $q$ 的 $s$ 对应群都同构”的证明，它们的思路就是，将生成元换成 $b^?$ 使 $b^?ab^{-?}=a^{s_0}$，就是所有 $s$ 是等价的，所以同构。那 $\Z_p^2$ 的情况也可以类似地构造——设某个 $p$ 次单位根是 $s_0$。如果 $s,t$ 有个是 $1$ 那让另一个变成 $s_0$ 就行，否则设 $s^i\equiv t^{-1},t^j\equiv s_0$，这样将生成元换为 $b^\prime =b^ic,c^\prime =c^j$ 就可以了，显然 $b^\prime ,c^\prime $ 可以反过来表示 $b,c$。于是无论怎么样都可以变成 $b^\prime a{b^\prime }^{-1}=a,c^\prime a{c^\prime }^{-1}=a^{s_0}$，也就是唯一。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我们总结一下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;情况&lt;/th&gt;
&lt;th&gt;条件&lt;/th&gt;
&lt;th&gt;非阿贝尔群&lt;/th&gt;
&lt;th&gt;$n$ 例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;平凡&lt;/td&gt;
&lt;td&gt;$p\nmid(q-1)\land q\nmid(p^2-1)$&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;td&gt;$45,99,153,175,207$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$12$&lt;/td&gt;
&lt;td&gt;$n=12$&lt;/td&gt;
&lt;td&gt;$3$ 个：$\Z_3\rtimes\Z_4$、$\Z_3\rtimes\Z_2^2$、$\Z_2^2\rtimes\Z_3$&lt;/td&gt;
&lt;td&gt;$12$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$p$ 小&lt;/td&gt;
&lt;td&gt;$p\parallel(q-1)\land n\ne 12$&lt;/td&gt;
&lt;td&gt;$2$ 个：$\Z_q\rtimes\Z_{p^2}$、$\Z_q\rtimes\Z_p^2$&lt;/td&gt;
&lt;td&gt;$28,44,63,76,92$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$p^2$ 小&lt;/td&gt;
&lt;td&gt;$p^2\mid(q-1)$&lt;/td&gt;
&lt;td&gt;$3$ 个：同上、$\Z_q\rtimes_{\varphi^\prime }\Z_{p^2}$&lt;/td&gt;
&lt;td&gt;$20,52,68,116,148$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$2p^2$&lt;/td&gt;
&lt;td&gt;$q=2$&lt;/td&gt;
&lt;td&gt;$3$ 个：$\Z_{p^2}\rtimes\Z_2$、$\Z_p^2\rtimes_{\varphi,\varphi^\prime }\Z_2$&lt;/td&gt;
&lt;td&gt;$18,50,98,242,338$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$p+1$&lt;/td&gt;
&lt;td&gt;$q\mid(p+1)\land q\ne2\land n\ne 12$&lt;/td&gt;
&lt;td&gt;$1$ 个：$\Z_p^2\rtimes\Z_q$&lt;/td&gt;
&lt;td&gt;$75,363,867$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;td&gt;$q\mid(p-1)\land q\ne 2$&lt;/td&gt;
&lt;td&gt;$(q+5)/2$ 个：$\Z_{p^2}\rtimes\Z_q$、$\Z_p^2\rtimes_{\varphi_i}\Z_q$&lt;/td&gt;
&lt;td&gt;$147,507,605$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;注意 $\Z_n\rtimes\Z_2^2\cong\Z_{2n}\rtimes\Z_2\cong D_{2n}$。其余还有某些半直积可以写成循环群与二面体群/置换群/亚循环群的直积，但我不是很清楚是否有通用的转换方法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$pqr\;(p&amp;lt;q&amp;lt;r)$。首先进行以下简单推理：$n_r\in\set{1,pq}$ 且 $n_q\in\set{1,r,pr}$。若 $n_r=pq$ 且 $n_q\ne 1$，则 $G$ 中有 $pq(r-1)$ 个阶为 $r$ 的元素，以及 $r(q-1)$ 个阶为 $q$ 的元素，共 $pqr-pq+rq-r=pqr+(r-p)(q-1)-p&amp;gt;pqr$ 个，矛盾。故 $n_r=1\lor n_q=1$，无论哪个正规，取 $G$ 关于其的商群，商群中一定有 Sylow 另一个质数 子群，取出其对应原群中的部分，即得一 $qr$ 阶正规子群 $H$。同时，由于 $H$ 有正规 Sylow $r$ 子群，故该子群在 $G$ 中也正规。&lt;/p&gt;
&lt;p&gt;如果 $H\cong\Z_{qr}$，那就较简单：考虑 $\varphi:\Z_p\to\aut H\cong\Z_{q-1}\times\Z_{r-1}$，如果 $p\nmid(q-1)(r-1)$ 就只有阿贝尔群，如果 $p\mid(q-1)$ 与 $p\mid(r-1)$ 其一成立，就有一种，否则模 $q$ 和 $r$ 下的 $p$ 次单位根都可以取，可以固定其中一个单位根，有 $p+1$ 种（$(0,1)$、$(1,i)$）。&lt;/p&gt;
&lt;p&gt;$q\mid(r-1)$ 时能不能搞些别的？如果 $p\nmid(q-1)\land p\nmid(r-1)$，则 $G/\syl_r(G)$ 是个循环群，有 $p$ 阶正规子群，于是就有 $pr$ 阶循环正规子群，然后 $\Z_q$ 对它共轭即可，有一种。注意如果按下面的方式分析，得出的群是和这里同构的。&lt;/p&gt;
&lt;p&gt;其他情况就要直面 $\varphi:\Z_p\to\aut(\Z_r\rtimes\Z_q)$ 了。设 $\Z_r\rtimes\Z_q$ 中 $bab^{-1}=a^s\;(s^q\equiv1\pmod r\land s\not\equiv 1)$，其中 $|a|=r$。由于 $\lang a\rang$ 正规，故 $\varphi(c)(a)=a^t\;(t^p\equiv1\pmod r)$。在 $p\nmid(r-1)\land p\mid(q-1)$ 的时候，$\varphi(\forall)(a)=a$。设 $\varphi(c)(b)=a^xb^y$，则
$$
\varphi(c)(ba)=\varphi(c)(a^sb)\Rightarrow a^{x+s^y}b^y=a^{s+x}b^y\Rightarrow s^{y-1}\equiv1\pmod r\Rightarrow q\mid(y-1)\Rightarrow y=1\\
\varphi(c^p)(b)=b\Rightarrow a^{px}b=b\Rightarrow x=0
$$
于是 $\varphi(c)=\iota$，即 $(\Z_r\rtimes\Z_q)\times\Z_p$ 唯一。&lt;/p&gt;
&lt;p&gt;$p\mid(r-1)$ 时，若 $t\ne 1$，则
$$
\varphi(c)(ba)=\varphi(c)(a^sb)\Rightarrow a^{x+s^yt}b^y=a^{st+x}b^y\Rightarrow y=1\\
\varphi(c^p)(b)=b\Rightarrow a^{\frac{t^p-1}{t-1}x}b=b\Leftrightarrow\top
$$
所以其实跟前面没什么两样，就是 $t,x$ 都有多种取法。首先 $x=0$ 是一种特殊的。其他情况，而考虑变换生成元：$a$ 变成 $a^\alpha$，$b$ 变成 $b^\beta$，$c$ 变成 $c^\gamma$，则
$$
b^\beta a^\alpha b^{-\beta}=(a^\alpha)^{s^\beta}\\
\varphi(c^\gamma)(a^\alpha)=(a^\alpha)^{t^\gamma}\\
\varphi(c^\gamma)(b^\beta)=a^{\frac{t^\gamma-1}{t-1}\frac{s^\beta-1}{s-1}x}b^\beta
$$
容易发现是可以都变成某组 $(a^{s_0},a^{t_0},ab)$ 的。&lt;/p&gt;
&lt;p&gt;总结一下：&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;$[q\mid(r-1)]$&lt;/th&gt;
&lt;th&gt;$[p\mid(r-1)]$&lt;/th&gt;
&lt;th&gt;$[p\mid(q-1)]$&lt;/th&gt;
&lt;th&gt;非阿贝尔群&lt;/th&gt;
&lt;th&gt;$n$ 例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$0$&lt;div style=&#34;width: 75pt&#34;&gt;&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;$0$&lt;div style=&#34;width: 75pt&#34;&gt;&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;$0$&lt;div style=&#34;width: 75pt&#34;&gt;&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;td&gt;$255,345,435,455,561$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$1$ 个：$\Z_{qr}\rtimes\Z_p$&lt;/td&gt;
&lt;td&gt;$231,357,483,663,715$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$1$ 个：$\Z_{qr}\rtimes\Z_p$&lt;/td&gt;
&lt;td&gt;$105,195,285,385,429$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$p+1$ 个：$\Z_{qr}\rtimes_{\varphi_i}\Z_p$&lt;/td&gt;
&lt;td&gt;$30,66,70,102,130$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$1$ 个：$\Z_{pr}\rtimes\Z_q$&lt;/td&gt;
&lt;td&gt;$165,615,759$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$2$ 个：$\Z_{qr}\rtimes\Z_p$、$(\Z_r\rtimes\Z_q)\times\Z_p$&lt;/td&gt;
&lt;td&gt;$609,1265,1491$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$0$&lt;/td&gt;
&lt;td&gt;$3$ 个：$\Z_{qr}\rtimes\Z_p$、$(\Z_r\rtimes\Z_q)\times\Z_p$、$(\Z_r\rtimes\Z_q)\rtimes\Z_p$&lt;/td&gt;
&lt;td&gt;$465,915,2211$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;$p+3$ 个：$\Z_{qr}\rtimes_{\varphi_i}\Z_p$、$(\Z_r\rtimes\Z_q)\times\Z_p$、$(\Z_r\rtimes\Z_q)\rtimes\Z_p$&lt;/td&gt;
&lt;td&gt;$42,78,110,114,903$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;8&#34;&gt;
&lt;li&gt;
&lt;p&gt;$16$。主要有两个思路：分析 $8$ 阶正规子群、分析中心大小。这里考虑前一种。&lt;/p&gt;
&lt;p&gt;首先我们说明非阿贝尔的 $G$ 一定有 $\Z_8$ 或 $\Z_4\times\Z_2$ 作为子群，这里的推导很别扭：可以立即假设 $G$ 中元素的阶都 $\le 4$ 且至少有一个是 $4$，然后考虑 $C(G)$，如果大小是 $4$，那么 $G/C(G)\cong\Z_2^2$（否则阿贝尔），即得；否则 $C(G)=\set{1,c}$，若有 $|x|=4,\lang x\rang\cap C(G)=\set{e}$，那么即得，否则所有 $x^2=c\or e$，那么 $G/C(G)\cong\Z_2^3$，那么一个 $x$ 的共轭就只可能在 $xC(G)$ 内（否则 $G/C(G)$ 不是阿贝尔），那么 $C_G(x)=8$，那么可以找到另一个 $y$，使 $x,y,z$ 交换且 $y^2=z\or e$，都对应 $\Z_4\times\Z_2$。&lt;/p&gt;
&lt;p&gt;若 $\Z_8\norm G$，同样类似于 $p^3$ 的情况，可以找到外面一个 $2$ 阶元 $b$，然后分析自同构，$bab^{-1}=a^{1\or3\or5\or7}$，并且这四种互不同构。&lt;/p&gt;
&lt;p&gt;否则，考虑 $\Z_4\times\Z_2$ 的自同构（也可以用矩阵描述，但这个矩阵里元素的取值范围不同，不容易分析，事实上 $\aut(\Z_4\times\Z_2)\cong D_4$），设它的生成元为 $a,b$，$a\mapsto a^1\or a^3\or a^1b\or a^3b$，$b\mapsto b\or a^2b$（如果 $b\mapsto a^2$ 那就 $f(a)^2=f(b)^2$ 不对了）。在这些自同构中，$(a,b)\mapsto(ab,b)$ 和 $(a,b)\mapsto(a^3b,b)$ 共轭，$(a,b)\mapsto(a,a^2b)$ 和 $(a,b)\mapsto(a^3,a^2b)$ 共轭，$(a,b)\mapsto(ab,a^2b)$ 和 $(a,b)\mapsto(a^3b,a^2b)$ 共轭。&lt;/p&gt;
&lt;p&gt;现在找另一个元素 $c$。最后一个共轭类是一定不行的，因为无论 $|c|=2\or4$，$c^2$ 都在正规子群里，所以自同构的阶得 $\le2$。若 $|c|=2$，则四种互不同构；若 $|c|=4$，分类讨论：&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;$(a,b)\mapsto(a^3,b)$&lt;/th&gt;
&lt;th&gt;$(a,b)\mapsto(ab,b)$&lt;/th&gt;
&lt;th&gt;$(a,b)\mapsto(a,a^2b)$&lt;div style=&#34;width: 105pt&#34;&gt;&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$c^2=a^2$&lt;div style=&#34;width: 55pt&#34;&gt;&lt;/div&gt;&lt;/td&gt;
&lt;td&gt;$\lang a,b,c\mid a^4=b^2=[a,b]=[b,c]=e,c^2=a^2,ca=a^{-1}c\rang$&lt;/td&gt;
&lt;td&gt;$\lang ac,a\mid(ac)^4=a^4=e,a(ac)=(ac)^{-1}a\rang$&lt;/td&gt;
&lt;td&gt;$|bc|=2$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$c^2=b$&lt;/td&gt;
&lt;td&gt;$\lang a,c\mid a^4=c^4=e,ca=a^{-1}c\rang$&lt;/td&gt;
&lt;td&gt;$(ac)^2=a^2$&lt;/td&gt;
&lt;td&gt;不可能&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$c^2=a^2b$&lt;/td&gt;
&lt;td&gt;$\lang a,c\mid a^4=c^4=e,ca=a^{-1}c\rang$&lt;/td&gt;
&lt;td&gt;$|ac|=2$&lt;/td&gt;
&lt;td&gt;不可能&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;所以实际只有两类，至于如何发现第二类（$(1,2),(2,1),(3,1)$）这些情况同构的，只能说实在是注意力惊人，这个表我也是对着论文搞的。最后只需验证这两类无 $8$ 阶元，有 $3$ 个 $2$ 阶元，且不同构即可。&lt;/p&gt;
&lt;p&gt;总结一下，阿贝尔 $5$ 个，有 $8$ 阶元时 $3$ 个，无 $8$ 阶元时 $4+2=6$ 个，共 $14$ 个。&lt;/p&gt;
&lt;p&gt;参考：本方法：&lt;a class=&#34;link&#34; href=&#34;http://buzzard.ups.edu/courses/2015spring/projects/whitcomb-groups-16-ups-434-2015.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://buzzard.ups.edu/courses/2015spring/projects/whitcomb-groups-16-ups-434-2015.pdf&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://www.researchgate.net/publication/259147732_The_Groups_of_Order_Sixteen_Made_Easy&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.researchgate.net/publication/259147732_The_Groups_of_Order_Sixteen_Made_Easy&lt;/a&gt;。另一类方法：&lt;a class=&#34;link&#34; href=&#34;http://buzzard.ups.edu/courses/2012spring/projects/clausen-groups-16-ups-434-2012.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://buzzard.ups.edu/courses/2012spring/projects/clausen-groups-16-ups-434-2012.pdf&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://files.eric.ed.gov/fulltext/EJ1054466.pdf%e3%80%81https://hal.science/cel-01841041/document&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://files.eric.ed.gov/fulltext/EJ1054466.pdf、https://hal.science/cel-01841041/document&lt;/a&gt;。&lt;/p&gt;
&lt;ol start=&#34;9&#34;&gt;
&lt;li&gt;
&lt;p&gt;$p^4$。思路是用矩阵分析 $p^3$ 阶正规子群的自同构，太复杂了，见 &lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/pdf/1611.00461&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://arxiv.org/pdf/1611.00461&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://future-in-tech.net/17.4/R-Hasanat1.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://future-in-tech.net/17.4/R-Hasanat1.pdf&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$24$。如果 $n_3=1$，设 $\aut\Z_3=\set{1,f}$。考虑任一 Sylow $2$ 子群（多个 Sylow 子群必同构）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\Z_8$。只有一种，即 $a\mapsto f$。&lt;/li&gt;
&lt;li&gt;$\Z_4\times\Z_2$。两种，$(a,b)\mapsto(f,1)\or{}(1,f)$。$(a,b)\mapsto(f,f)$ 转 $(ab,b)\mapsto(1,f)$ 与后者同构。&lt;/li&gt;
&lt;li&gt;$\Z_2^3$。将两个 $\mapsto f$ 的元素相乘作为生成元，这样来变换，可统一归为 $(a,b,c)\mapsto(f,1,1)$。&lt;/li&gt;
&lt;li&gt;$D_4$。两种，$(a,b)\mapsto(f,1)\or{}(1,f)$。$(a,b)\mapsto(f,f)$ 转 $(a,ab)\mapsto(f,1)$ 与前者同构。&lt;/li&gt;
&lt;li&gt;$Q_8$。类似情况 3 只有一种。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;否则 $n_3=4$，考虑 $G$ 共轭作用在它上面形成的 $\varphi:G\to S_4$ 同态，讨论 $\ker\varphi$。由于每个 Sylow $3$ 子群的正规化子均是 $6$ 个，故 $|\ker\varphi|\mid6$。若 $|\ker\varphi|\in\set{3,6}$，则 $G$ 有大小为 $3$ 的正规子群 （$6$ 的情况取出唯一大小为 $3$ 的子群 $\set{e,a^2,a^4}$，由于共轭后 $3$ 阶子群，所以正规。这里的正规传递性是个例），矛盾。若 $|\ker\varphi|=1$，则 $G\cong S_4$。最后 $|\ker\varphi|=2$。这种情况下 $G/\ker\varphi\cong A_4$，由于 $\Z_2^2\norm A_4$，找到原像，即 $G$ 有正规 Sylow $2$ 子群。讨论它：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\Z_8$。无 $3$ 阶元。&lt;/li&gt;
&lt;li&gt;$\Z_4\times\Z_2$。在 $|G|=16$ 里讨论过它的自同构为 $D_4$，没有 $3$ 阶元。&lt;/li&gt;
&lt;li&gt;$\Z_2^3$。很棒的一点是，$3\parallel168=|\mathrm{GL}_3(\F_2)|$，于是共轭类唯一。这种情况其实是 $A_4\times\Z_2$。&lt;/li&gt;
&lt;li&gt;$D_4$。事实上 $\aut D_4也\cong D_4$，所以也不行。&lt;/li&gt;
&lt;li&gt;$Q_8$。事实上 $\aut Q_8\cong S_4$。$3$ 阶元是所有 $3$ 循环，所以唯一。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;上面所有一方正规的情况，另一方必不正规（否则两个正规之间可以交换，直接直积了）。最后总结得到，阿贝尔 $3$ 个，非阿贝尔直积 $2$ 个，Sylow $3$ 正规 $7$ 个，$S_4$ $1$ 个，Sylow $8$ 正规 $2$ 个，共 $15$ 个。&lt;/p&gt;
&lt;p&gt;参考：&lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=6TWuo2NO8vg&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.youtube.com/watch?v=6TWuo2NO8vg&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;http://www.brahmanandcollege.org.in/pg_math/Modern%20Algebra-01.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://www.brahmanandcollege.org.in/pg_math/Modern%20Algebra-01.pdf&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$56$。如果 $n_7=1$，则分讨跟 $|G|=24$ 一样（因为 $\aut\Z_7$ 除了一个 $2$ 阶元以外，其余都是 $3\or6$ 阶的，都不能碰）。否则就有 $48$ 个 $7$ 阶元，剩余 $8$ 个元素必形成一正规 Sylow $2$ 子群，这里就比楼上简单了。唯一的可能就是 $\Z_2^3$，同样 $7\parallel168$，所以唯一，共 $13$ 个。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$8p\;(p\ne3,7)$。这种情况必有 $n_p=1$。&lt;/p&gt;
&lt;p&gt;$40$ 的时候 $\aut\Z_5\cong\Z_4$，讨论任一 Sylow $2$：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$\Z_8$。$a\mapsto f^{1\or 2}$ 两种。&lt;/li&gt;
&lt;li&gt;$\Z_4\times\Z_2$。$(a,b)\mapsto(1,f^2)\or{}(f^2,1)\or{}(f,1)$。$(f^2,f^2)$ 同 $24$，$(f,f^2)$ 转 $(a,a^2b)\mapsto(f,1)$。&lt;/li&gt;
&lt;li&gt;$\Z_2^3$。一种。&lt;/li&gt;
&lt;li&gt;$D_4$。同 $24$。$(a,b)\mapsto(f,?)$ 之类的情况会导致 $\varphi(ba)\ne\varphi(a^{-1}b)$，故不行。&lt;/li&gt;
&lt;li&gt;$Q_8$。同 $24$。$(a,b)\mapsto(f,?)$（$a,b$ 即 $i,j$）之类的情况会导致 $\varphi(a^2)\ne\varphi(b^2)\or\varphi((ab)^2)$，故不行。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;总的就是 $5+2+3+1+2+1=14$ 种。$4\parallel(p-1)$ 的情况都是 $14$ 种。&lt;/p&gt;
&lt;p&gt;以 $136$ 为首的 $8\mid(p-1)$ 的情况就是多了个 $\Z_8$ 时 $|\varphi(a)|=8$ 的情况，共 $15$ 种。&lt;/p&gt;
&lt;p&gt;以 $88$ 为首的 $2\parallel(p-1)$ 的情况是 $5+1+2+1+2+1=12$。&lt;/p&gt;
&lt;p&gt;总结一下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;$p$&lt;/th&gt;
&lt;th&gt;$2$&lt;/th&gt;
&lt;th&gt;$3$&lt;/th&gt;
&lt;th&gt;$7$&lt;/th&gt;
&lt;th&gt;$v_2(p-1)=1$&lt;/th&gt;
&lt;th&gt;$v_2(p-1)=2$&lt;/th&gt;
&lt;th&gt;$v_2(p-1)\ge3$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$a(8p)$&lt;/td&gt;
&lt;td&gt;$14$&lt;/td&gt;
&lt;td&gt;$15$&lt;/td&gt;
&lt;td&gt;$13$&lt;/td&gt;
&lt;td&gt;$12$&lt;/td&gt;
&lt;td&gt;$14$&lt;/td&gt;
&lt;td&gt;$15$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;关于 $2^kp$ 见 &lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/69254703&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhuanlan.zhihu.com/p/69254703&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$36$。首先我们需要证明 $n_2=1\lor n_3=1$。看起来简单的东西推导很变态，我找了一堆证明（&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/3290888/if-g-36-then-g-has-either-a-normal-2-sylow-or-a-normal-3-sylow&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/3290888/if-g-36-then-g-has-either-a-normal-2-sylow-or-a-normal-3-sylow&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/2918359/a-group-of-order-36-has-either-a-normal-sylow-2-subgroup-or-a-normal-sylow&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/2918359/a-group-of-order-36-has-either-a-normal-sylow-2-subgroup-or-a-normal-sylow&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://math.berkeley.edu/~wodzicki/257/G36.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.berkeley.edu/~wodzicki/257/G36.pdf&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://max.book118.com/html/2017/0806/126207403.shtm&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://max.book118.com/html/2017/0806/126207403.shtm&lt;/a&gt;），没一个少于一页的。&lt;/p&gt;
&lt;p&gt;如果 $G$ 有 $4$ 个 Sylow $3$ 子群 $X_{1\sim 4}$，那么考虑 $G$ 共轭作用在它们上，形成一个 $\varphi:G\to S_4$ 的同态。$|\im \varphi|\mid\gcd(36,24)=12$，同时由于 $\forall i,\exists g,gX_1g^{-1}=X_i$，故 $\im\varphi$ 中每个 $\sigma(1)=1$ 的元素都与 $\sigma(1)=2,3,4$ 元素各一个对应，故 $4\mid|\im\varphi|$，故 $|\im\varphi|\in\set{4,12}$。若为 $4$，则 $|\ker\varphi|=9$ 矛盾；否则 $G/\ker\varphi\cong\im\varphi=A_4$，且 $\ker\varphi$ 是一个 $3$ 阶正规子群。① 这说明它是所有 Sylow $3$ 子群的子群，而 $9$ 阶群一定是阿贝尔群，故与 $\ker\varphi$ 的元素的中心化子至少为 $27$，于是 $\ker\varphi\sub C(G)$。② 如果 $n_2&amp;gt;1$，比如有 $Y_1,Y_2$，它们显然与 $\ker\varphi$ 交为 $\set{e}$，故它们对应到 $G/\ker\varphi$ 上也是 Sylow $2$ 子群，而 $A_4$ 的 Sylow $2$ 子群是唯一的 $\Z_2^2$，故 $Y_1\ker\varphi=Y_2\ker\varphi$。由 ①，它们都 $\cong\Z_3\times\Z_2^2$ 阿贝尔群，于是 $Y_1=Y_2$，因此 $n_2=1$。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;正规 Sylow $3$ 子群 $\Z_9$，Sylow $2$ 子群 $\Z_4$。由于 $\varphi(9)=6$（这个 $\varphi$ 是欧拉函数），故只有一种。&lt;/li&gt;
&lt;li&gt;正规 Sylow $3$ 子群 $\Z_9$，Sylow $2$ 子群 $\Z_2^2$。同 6.4.2，一种。&lt;/li&gt;
&lt;li&gt;正规 Sylow $3$ 子群 $\Z_3^2$，Sylow $2$ 子群 $\Z_4$。$\mathrm{GL}_2(\F_3)$ 在相似意义下有两个二阶元 $\begin{bmatrix}-1&amp;amp;0\\ 0&amp;amp;\pm1\end{bmatrix}$，一个四阶元 $\begin{bmatrix}0&amp;amp;1\\ -1&amp;amp;0\end{bmatrix}$，因此有三种。&lt;/li&gt;
&lt;li&gt;正规 Sylow $3$ 子群 $\Z_3^2$，Sylow $2$ 子群 $\Z_2^2$。记 $\Z_2^2$ 的两个生成元为 $a,b$，如果 $\varphi(a)\ne\varphi(b)$，则 $\im\varphi\cong\Z_2^2$，一种。否则可以认为 $\varphi(b)=1$（不是的话可以把 $b$ 换成 $ab$），$\varphi(a)$ 两种。共三种。&lt;/li&gt;
&lt;li&gt;正规 Sylow $2$ 子群 $\Z_4$，Sylow $3$ 子群 $\Z_9$。不行。&lt;/li&gt;
&lt;li&gt;正规 Sylow $2$ 子群 $\Z_4$，Sylow $3$ 子群 $\Z_3^2$。不行。&lt;/li&gt;
&lt;li&gt;正规 Sylow $2$ 子群 $\Z_2^2$，Sylow $3$ 子群 $\Z_9$。事实上 $\aut\Z_2\cong\mathrm{GL}_2(\F_2)\cong S_3$，有唯一 Sylow $3$ 子群，一种。&lt;/li&gt;
&lt;li&gt;正规 Sylow $2$ 子群 $\Z_2^2$，Sylow $3$ 子群 $\Z_3^2$。类似情况 2 也可以归为 $(1,f)$。一种。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;总共 $2^2+1+1+3+3+0+0+1+1=14$ 种（第一个加数对应阿贝尔，后同）。&lt;/p&gt;
&lt;p&gt;这里关于 $\aut\Z_3^2$ 的同构的共轭类是参照 &lt;a class=&#34;link&#34; href=&#34;https://groupprops.subwiki.org/wiki/General_linear_group:GL%282,3%29&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://groupprops.subwiki.org/wiki/General_linear_group:GL(2,3)&lt;/a&gt;，我不大会证这些，可能以后深入学线代会再补充。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$4p^2\;(p\ne3)$。这时必有 $n_p=1$，但同样由于我不会分析 $\aut\Z_p^2$ 而且网上没有按这种思路分析的资料所以这里就留坑了。这里先给出结论：$p=4k+1$ 时有 $16$ 个，$p=4k+3$ 时有 $12$ 个。见 &lt;a class=&#34;link&#34; href=&#34;https://xueshu.baidu.com/usercenter/paper/show?paperid=1m4n0tf0y90w0vh0py530vs0ax491706&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://xueshu.baidu.com/usercenter/paper/show?paperid=1m4n0tf0y90w0vh0py530vs0ax491706&lt;/a&gt;。注意 B 站有个讲 $10$、$100$、$1000$ 阶群分类的视频，讲得不完整，最难的部分整个略掉了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$2p^3$。也是直接得到正规，但是 $p^3$ 阶群的自同构难以分析。&lt;a class=&#34;link&#34; href=&#34;https://www.zhihu.com/question/637163090/answer/3346156282&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zhihu.com/question/637163090/answer/3346156282&lt;/a&gt; 这里是一个不完整的分析，问题和那个 B 站的视频类似，都是共轭设得不全。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$60$。我们首先希望 $n_5=1$。如果不是，那么 $n_5=6$，接下来证明 $G$ 是单群。如果 $G$ 有正规子群 $N$，如果 $5\mid|N|$，那么$|N|=10\or15\or20\or30$。前三种情况显然有正规 Sylow $5$ 子群，$30$ 的情况根据 $|G|=pqr$ 的分析也有正规 Sylow $5$，于是它也是 $G$ 的正规 Sylow $5$。否则 $|G/N|=5\or10\or15\or20\or30$，后四种情况可以乘回 $N$ 得到 $5\mid|N^\prime |$，第一种情况 $|N|=12$，它有正规 Sylow $2\or 3$，于是 $G$ 也有，归到前面。&lt;/p&gt;
&lt;p&gt;而 $60$ 阶单群只可能是 $A_5$。我们先证明它有 $12$ 阶子群。$n_2=3\or5\or15$，若为 $3$，则每个的正规化子有 $20$ 个，说明 $G$ 有 $20$ 阶子群，则 $G$ 作用在该子群的陪集上时，形成一个 $\varphi:G\to S_3$，进而 $\ker\varphi$ 是 $G$ 的正规子群；若为 $15$，那么如果这些子群两两只有平凡交，则 $2,4$ 阶元有 $15\times3=45$ 个，而 $5$ 阶元有 $6\times4=24$ 个，矛盾。因此存在两个 Sylow $2$ 子群 $X_1,X_2$，$X_1\cap X_2=\set{e,x}$。由于 $4$ 阶群必阿贝尔，故 $X_1,X_2\sub C_G(x)$，故 $C_G(x)=12\or20\or60$，后两种都不可能。现在 $G$ 有 $12$ 阶子群了，考虑作用在它的陪集上，形成 $\psi:G\to S_5$，且单性故 $\ker\psi$ 平凡，故 $G\cong\im\psi\cong A_5$，$n_2=5$ 的情况直接跳到这里。&lt;/p&gt;
&lt;p&gt;现在 $G$ 有正规 Sylow $5$ 子群 $H$，讨论 $n_3$。$G$ 的 Sylow $3$ 子群与 $G/H$ 的 Sylow $3$ 子群一一对应（正过来直接取，反过来是因为可以对应 $15$ 阶子群 $\cong\Z_{15}$ 从而有唯一 Sylow $3$ 子群），因此 $n_3\ne10$。如果 $n_3=4$，那么它们各自乘 $H$ 形成四个同构于 $\Z_{15}$ 的，两两交于 $H$ 的群，这意味着 $|N_G(H)|\ge 45$ 从而 $H\sub C(G)$，这大大简化了讨论——$G/H$ 的 Sylow $3$ 子群不正规，这意味着它 $\cong A_4$，类似于这段开头，$G/H$ 的唯一 Sylow $2$ 子群与 $G$ 的唯一 Sylow $2$ 子群对应（注意这里的对应依赖于 $H\sub C(G)$ 因为不然 $20$ 阶群的讨论就爆炸了），于是将这个正规 Sylow $2$ 子群与 Sylow $3$ 子群相乘，立即得到同构于 $A_4$ 的 $12$ 阶子群，从而 $G\cong\Z_5\times A_4$。PS：这里搞得这么麻烦的原因是，如果直接搞出正规子群 $\Z_5\times\Z_2^2$，自同构就很难讨论了。&lt;/p&gt;
&lt;p&gt;如果 $n_3=1$，那么只需考虑 $\Z_4\to\aut\Z_{15}$ 与 $\Z_2^2\to\aut\Z_{15}$，显然分别有五、四个。&lt;/p&gt;
&lt;p&gt;总共 $2+1+1+5+4=13$ 种。&lt;/p&gt;
&lt;p&gt;参考：&lt;a class=&#34;link&#34; href=&#34;https://www.math.utoronto.ca/alfonso/347/Groups60.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.math.utoronto.ca/alfonso/347/Groups60.pdf&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/3068904/group-of-order-60&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/3068904/group-of-order-60&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/1121248/classifying-groups-of-order-60&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/1121248/classifying-groups-of-order-60&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/360816/about-the-proof-that-a-simple-group-of-order-60-is-isomorphic-to-a5&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/360816/about-the-proof-that-a-simple-group-of-order-60-is-isomorphic-to-a5&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://epgp.inflibnet.ac.in/epgpdata/uploads/epgp_content/S000025MS/P001533/M016962/ET/1468557941E-textofChapter3Module4.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://epgp.inflibnet.ac.in/epgpdata/uploads/epgp_content/S000025MS/P001533/M016962/ET/1468557941E-textofChapter3Module4.pdf&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$90$。核心是说明 $G$ 有 $45$ 阶子群。若 $n_5=1$，则 $18$ 阶商群的 $n_3=1$，即得。否则，如果 $n_3&amp;gt;1$，那么我们说这些子群 $X_{1\sim 10}$ 不可能两两只有平凡交，因为反之则 $3$ 与 $9$ 阶元有 $80$ 个，但 $5$ 阶元有 $24$ 个。现在找到 $X_i\cap X_j=H\ne\set{e}$，考虑其正规化子数量： $|N_G(H)|\ge|X_1X_2|\ge27$。同时 $X_i&amp;lt;N_G(H)$ 故 $|N_G(H)|=45\or90$。后者即 $H\norm G$，由于 $G/H$ 这个 $30$ 阶群有 $15$ 阶子群，所以也得到 $45$ 阶。而 $45$ 阶群一定是阿贝尔群。&lt;/p&gt;
&lt;p&gt;那现在只需考虑 $\Z_2\to\aut\Z_{45}$ 与 $\Z_2\to\aut(\Z_3\times\Z_{15})$。前者有三种。后者，由于正规子群在自同构下不动，故 $\aut(\Z_3\times\Z_{15})\cong\aut\Z_3^2\times\aut\Z_5$，$\mathrm{GL_2}(\F_3)$ 的二阶共轭类有两种，故这个是 $3\times2-1=5$ 种。共 $2+3+5=10$ 种。&lt;/p&gt;
&lt;p&gt;参考：&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/360790/classifying-groups-of-order-90&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/360790/classifying-groups-of-order-90&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/146687/how-do-i-show-that-every-group-of-order-90-is-not-simple&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/146687/how-do-i-show-that-every-group-of-order-90-is-not-simple&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$132$。首先我们说明 $n_{11}=1$。若 $n_{11}=12$，若 $n_3=1$，则可得到商群的正规 Sylow $11$，然后得到 $G$ 的 $33$ 阶正规子群，由于 $33$ 阶群只能是 $\Z_{33}$，故 $11$ 阶正规；若 $n_3&amp;gt;1$，它不可能是 $22$，只可能是 $4$。于是有 $G$ 到 $S_4$ 的同态，其像大小整除 $12$ 且是 $4$ 的倍数（同 $|G|=36$ 第二段的分析），因此只可能是 $4\or 12$，对应核都说明 $11$ 阶正规。&lt;/p&gt;
&lt;p&gt;现在 $n_{11}=1$，这里的分析跟 $|G|=60$ 完全一样：由 $n_3&amp;gt;1$ 可得 $\Z_{11}\times A_4$，由 $n_3=1$ 可得正规子群 $\Z_{33}$，$\Z_4$ 和 $\Z_2^2$ 分别对应 $3$ 和 $4$ 个。共 $2+1+3+4=10$ 种。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$135$。立即得 $45$ 阶正规子群，考虑 $\Z_3$ 到 $\aut\Z_{45}$ 和 $\aut(\Z_3\times\Z_{15})$。根据 $|G|=36$ 最后的链接，$\mathrm{GL}_2(\F_3)$ 有唯一三阶共轭类，故总共 $3+1+1=5$ 种。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$140$。立即得 $35$ 阶正规，考虑 $\Z_4$ 和 $\Z_2^2$ 到 $\aut\Z_{35}$，和 $|G|=60$ 一样。共 $2+5+4=11$ 种。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$198$。立即得 $99$ 阶正规，考虑 $\Z_2$ 到 $\aut\Z_{99}$ 和 $\aut(\Z_3\times\Z_{33})$。后者是 $3\times2-1=5$ 种，共 $2+3+5=10$ 种。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如果说下一步要继续分析的话，$4pq$、$p^2q^2$、$p^2qr$ 可能是相对可做的，但目前感觉都很难了。以下是 $200$ 以内我不会分析的情况：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;$n$&lt;/th&gt;
&lt;th&gt;$a(n)$&lt;/th&gt;
&lt;th&gt;情况&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$32$&lt;/td&gt;
&lt;td&gt;$51$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$48$&lt;/td&gt;
&lt;td&gt;$52$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$54$&lt;/td&gt;
&lt;td&gt;$15$&lt;/td&gt;
&lt;td&gt;$2p^3$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$64$&lt;/td&gt;
&lt;td&gt;$267$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$72$&lt;/td&gt;
&lt;td&gt;$50$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$80$&lt;/td&gt;
&lt;td&gt;$52$&lt;/td&gt;
&lt;td&gt;变态，$n_2=1\or n_5=1$ 然后不会&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$81$&lt;/td&gt;
&lt;td&gt;$15$&lt;/td&gt;
&lt;td&gt;$p^4$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$96$&lt;/td&gt;
&lt;td&gt;$231$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$100$&lt;/td&gt;
&lt;td&gt;$100$&lt;/td&gt;
&lt;td&gt;$4p^2$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$108$&lt;/td&gt;
&lt;td&gt;$45$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$112$&lt;/td&gt;
&lt;td&gt;$43$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$120$&lt;/td&gt;
&lt;td&gt;$47$&lt;/td&gt;
&lt;td&gt;变态，&lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=t5YcYuDl0hk&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.youtube.com/watch?v=t5YcYuDl0hk&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$126$&lt;/td&gt;
&lt;td&gt;$16$&lt;/td&gt;
&lt;td&gt;$n_7=1$ 但 $63$ 阶群自同构不好分析&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$128$&lt;/td&gt;
&lt;td&gt;$2328$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$144$&lt;/td&gt;
&lt;td&gt;$197$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$150$&lt;/td&gt;
&lt;td&gt;$13$&lt;/td&gt;
&lt;td&gt;$n_5=1$ 但 $75$ 阶群自同构不好分析&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$156$&lt;/td&gt;
&lt;td&gt;$18$&lt;/td&gt;
&lt;td&gt;$n_{13}=1$ 但 $39$ 阶群不好分析&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$160$&lt;/td&gt;
&lt;td&gt;$238$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$162$&lt;/td&gt;
&lt;td&gt;$55$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$168$&lt;/td&gt;
&lt;td&gt;$57$&lt;/td&gt;
&lt;td&gt;变态，不过可以了解一下单群&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$176$&lt;/td&gt;
&lt;td&gt;$42$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$180$&lt;/td&gt;
&lt;td&gt;$37$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$189$&lt;/td&gt;
&lt;td&gt;$13$&lt;/td&gt;
&lt;td&gt;$n_7=1$ 但 $63$ 阶群自同构不好分析&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$192$&lt;/td&gt;
&lt;td&gt;$1543$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$196$&lt;/td&gt;
&lt;td&gt;$12$&lt;/td&gt;
&lt;td&gt;$4p^2$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$200$&lt;/td&gt;
&lt;td&gt;$52$&lt;/td&gt;
&lt;td&gt;变态&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;综合的参考资料：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;《有限群构造》（张远达）&lt;/li&gt;
&lt;li&gt;《有限群构造新论》（陈松良）&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.math.auckland.ac.nz/~obrien/research/gnu.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.math.auckland.ac.nz/~obrien/research/gnu.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://link.springer.com/article/10.1007/BF01443651&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://link.springer.com/article/10.1007/BF01443651&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://groupprops.subwiki.org/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://groupprops.subwiki.org/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;13-可解群&#34;&gt;13. 可解群
&lt;/h3&gt;&lt;h4 id=&#34;大纲-12&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;幂零群的定义与性质：直积幂零、正规化子严格包含、幂零群的等价刻画。&lt;/li&gt;
&lt;li&gt;换位子群、导子群、特征子群、全不变子群、极小正规子群的定义，特征子群的正规传递性。&lt;/li&gt;
&lt;li&gt;可解群的定义与性质：与幂零群的关系、子群与同态像可解、正规子群+商群可解、极小正规子群的结构、Hall 定理。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-12&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;幂零群的等价定义是，存在一个从 $\set{e}$ 到 $G$ 的列 $\set{G_i}$，只要求 $G_{i+1}/G_i\sub C(G/G_i)$ 即可。证明考虑归纳证 $G_i\sub C_i(G)$，这里的核心思想是，$G$ 的两个正规子群 $K\sub H$ 必满足 $\pi_K^{-1}(C(G/K))\sub\pi_H^{-1}(C(G/H))$。看起来简单的东西设得不好也会证不出来。一个好搞的形式是 $[x,y]\in K\Rightarrow[x,y]\in H$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;幂零群的子群和同态像也是幂零群。详见 &lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/1571815/need-help-proving-any-subgroup-and-quotient-of-a-nilpotent-group-is-nilpotent&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/1571815/need-help-proving-any-subgroup-and-quotient-of-a-nilpotent-group-is-nilpotent&lt;/a&gt;。这类问题证明思路都是类似的，就是选好归纳假设，然后分析同态，利用同构第二、四定理即可。反倒是可解群证明这类东西容易些，因为导列就是不断选子群。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可解群的等价定义是，存在一个从 $\set{e}$ 到 $G$ 的列 $\set{G_i}$，只要求 $G_i\norm G_{i+1}$ 且 $G_{i+1}/G_i$ 阿贝尔即可（注意换位子群是最小（其他都包含它）的这样的 $G_i$，这也是求一个群的导列的方法）。证明考虑归纳证 $G^{(i)}\sub G_{n-i}$，知道了换位子群最小这不就是显然的吗……&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意极小正规子群不一定唯一：&lt;a class=&#34;link&#34; href=&#34;https://math.stackexchange.com/questions/1402526/smallest-normal-subgroup-and-minimal-normal-subgroup-whats-the-difference&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://math.stackexchange.com/questions/1402526/smallest-normal-subgroup-and-minimal-normal-subgroup-whats-the-difference&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;幂零群结构定理证明的思路并不难，核心是找到一个矛盾：Sylow $p$ 子群的正规化子等于其正规化子的正规化子，以及幂零群中，正规化子是严格包含的。然后就是直积相关的简单东西。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hall 定理实在无法理解是怎么想到的，所以只能把思路记下来，这下真得死记硬背了。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;存在一个正规子群 $H$，阶不被 $n$ 整除。设阶与 $m,n$ 分别有公因子 $m_1,n_1$。(i) $G/H$ 里找 $m/m_1$ 阶，乘回 $H$ 变 $mn_1$，再找 $m$。(ii) 俩 $m$ 阶的 $B,C$，$|BH|=|CH|=mn_1$，$BH/H$ 与 $CH/H$ 在 $G/H$ 中共轭，于是 $BH$ 与 $CH$ 共轭，于是 $B$ 的共轭与 $C$ 在 $CH$ 中共轭。(iii) $k$ 阶 $D$，$G/H$ 里找包含 $DH/H$ 的，乘回 $H$ 变 $mn_1$ 阶，再找 $m$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;所有正规子群的阶都被 $n$ 整除。首先证明引理：可解群的极小正规子群为阿贝尔 $p$。$N^\prime $ 是 $N$ 的正规子群且只能是平凡的（不能是 $N$ 不然就不可解了，事实上这是整个证明中唯一用到可解性的地方），于是 $N$ 阿贝尔，且不能再有真 Sylow 子群。这里值得注意的是，极小正规子群的定义是不存在原群的正规子群是其子群，而并非其本身是单群，因此上述证明中利用与极小矛盾时，至少得说明是特征子群。&lt;/p&gt;
&lt;p&gt;现找出 $G$ 的极小正规子群 $H$，由于 $H$ 是阿贝尔 $p$，故只能 $|H|=n$ 从而 $H$ 是 Sylow。(i) 看图：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\hall.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;（黄色对应 $B$，蓝色对应 $D$，绿色对应 $DH\cap M$，蓝灰色对应 $D$ 所属的 $m$ 阶）&lt;/p&gt;
&lt;p&gt;取出 $G/H$ 的极小正规子群 $K/H$，$S$ 为 $K$ 的 Sylow $q$，$S\cap H=\set{e}$。记 $N=N_K(S),M=N_G(S)$，$N$ 之于 $K$ 相当于 $M$ 之于 $G$（因为 $S$ 的共轭都在 $K$ 里面），所以只需证明 $N=S$ 即得 $|M|=m$。$N\cap H$ 中元素与 $S,H$ 中元素均交换从而为 $K$ 的中心，而 $K$ 的中心作为 $G$ 的正规子群只能是 $\set{e}$。(ii) $m$ 阶子群 $B$ 交 $H$ 于 $\set{e}$，交 $K$ 于 Sylow $q$，故 $B\cap K$ 与 $S$ 共轭，正规化子也共轭，$N_G(B)=B$。 (iii) $k$ 阶子群 $D$ 的 $DH$ 交 $M$ 于一 $k$ 阶子群与 $D$ 共轭，扩到 $m$ 阶。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;14-正规列&#34;&gt;14. 正规列
&lt;/h3&gt;&lt;h4 id=&#34;大纲-13&#34;&gt;大纲
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;正规列、次正规列、精细、合成列、可解列的定义及它们之间的关系。&lt;/li&gt;
&lt;li&gt;Zassenhaus 引理、Schreier 精细定理、Hölder 定理。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;笔记-13&#34;&gt;笔记
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;理一下各种列之间的关系：首先讨论的所有列都是次正规列。次正规列有两种特殊情况：合成列和可解列。合成列是“划分最密”的。对于可解群，其导列是“划分最疏”的可解列，其可解列是所有“划分介于导列与合成列之间”的，其合成列具有因子为 $\Z_p$ 的性质，从而也是可解列（能不用 Hölder 证吗？）。除了可解群的导列和幂零群的中心列以外，所有提到的列都不一定是正规列。例如，$S_4\vartriangleright A_4\vartriangleright K_4\vartriangleright\textcolor{red}{\Z_2}\vartriangleright\set{e}$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Zassenhaus 引理也是完全看不懂作者是怎么想的，只能提要一下证明策略：先证明诸如 $(A\cap B^*)\norm(A\cap B)$ 之类的，再构造满同态证明
$$
\frac{A^*(A\cap B)}{A^*(A\cap B^*)}\cong\frac{A\cap B}{(A\cap B^*)(A^*\cap B)}\cong\frac{B^*(A\cap B)}{B^*(A^*\cap B)}
$$
后面两个定理反倒是很好理解的了。就是互相精细，然后合成列没法再精细了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意无限群不一定有合成列，例如 $\Z$ 没有，而 $A_\infin$ 就有。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;漏掉的东西&#34;&gt;漏掉的东西
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;群的扩张&lt;/li&gt;
&lt;li&gt;群的可视化（格、环图等）&lt;/li&gt;
&lt;li&gt;范畴论&lt;/li&gt;
&lt;li&gt;与无限群相关的理论&lt;/li&gt;
&lt;li&gt;$168$ 阶单群、有限单群分类、Lie 群&lt;/li&gt;
&lt;li&gt;可解性相关进一步的内容，例如 Burnside 定理、Feit-Thompson 定理&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>读论文系列 #3——Nash-Williams 定理</title>
        <link>https://littlereuben.github.io/study/paper3/</link>
        <pubDate>Wed, 29 May 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/paper3/</guid>
        <description>&lt;div style=&#34;background-color: #FFE1B9; color: #794500; padding-left: 1em; border-left: 4px solid #DE9B41; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;摘抄笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;这里主要讲一下 Nash-Williams 定理的证明。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;一张图 $G$ 的边集能划分成 $k$ 个森林 $\Leftrightarrow$ 其每个非空导出子图的 $\lvert E\rvert\le k(\lvert V\rvert-1)$。允许重边。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$\Rightarrow$ 显然，$\Leftarrow$ 的证明：&lt;/p&gt;
&lt;p&gt;以下称一个非空导出子图“合法”为 $\lvert E\rvert\le k(\lvert V\rvert-1)$，“满”为 $\lvert E\rvert=k(\lvert V\rvert-1)$。记 $G[S]$ 为 $G$ 中节点子集 $S$ 的导出子图。&lt;/p&gt;
&lt;p&gt;证 1（$k=2$，P5295/UOJ#168 题解里的证法）：归纳。现考虑度数最小的点 $u$，由鸽巢，其度数至多为 $3$。其余情况平凡，度数为 $3$ 时，设相连点为 $v_{1\sim 3}$，这时删去 $u$，待证的即为在这三个点间加某条边，可以划分，这样加回 $u$ 时只需在这条额外边中间放上 $u$ 即可。&lt;br&gt;
如果不行，也就是说分别存在包含 $v_1$ 与 $v_2$、包含 $v_1$ 与 $v_3$、包含 $v_2$ 与 $v_3$ 的三个满的导出子图（它们不能额外加边）由于 $G_1+G_2=G_1\cup G_2+G_1\cap G_2$，故两个有公共点的满子图，它们的交、并均为满。故存在一个包含 $v_1$、$v_2$ 与 $v_3$ 的满子图，那么包括进 $u$ 时，这个子图就不合法了，矛盾。&lt;/p&gt;
&lt;p&gt;这个思路在 $k\ge 2$ 时需要稍加修改才能沿用。&lt;/p&gt;
&lt;p&gt;证 2（&lt;a class=&#34;link&#34; href=&#34;https://tus.repo.nii.ac.jp/record/1510/files/02-enomoto.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;论文&lt;/a&gt;）：考虑度数最小的点 $u$，由鸽巢，其度数 $d\le 2k-1$，且 $d\le k$ 时平凡。设 $u$ 邻边的另一个端点从小到大依次为 $v_{1\sim d}$（可重），现在考虑以下过程：对 $i=1\sim d-k$，时刻 $i$ 时将 $e_i=(u,v_i)$ 去掉，加入 $e^\prime_i=(v_i,v_{i+k})$（显然 $v_i\ne v_{i+k}$）。记 $G^\prime$ 为改完的图。&lt;br&gt;
如果直到操作完都没有不合法，那就令 $S=V\setminus\set u$，$t=d-k$。否则假设时刻 $t+1$ 是第一个出现不合法的时刻，那么时刻 $t$ 可以找到一个不含 $u$ 的满子图 $G^\prime[S]$，不妨设 $t$ 及之前所有连上新边的点都在 $S$ 内。在时刻 $t$ 后中止上述过程。&lt;br&gt;
先归纳构造 $G^\prime[S]$ 的拆分方案，然后将 $S$ 缩成一个点，这时得到的图 $G^{\prime\prime}$ 的导出子图也均合法，第一种情况显然，第二种情况，如果找到了一个不合法的子图，那和 $G^\prime[S]$ 并在一起也不合法，矛盾。因此也构造出 $G^{\prime\prime}$ 的方案。对于 $G^\prime[S]$ 方案中的一个森林，如果有某个 $e^\prime_i$ 属于它，那么将它与 $G^{\prime\prime}[S]$ 中包含 $e_{i+k}$ 的那个并起来（有多个 $i$ 则任选），称这样得到的为第一类；对于其他森林，随意配对并起来，为第二类。显然目前并出的各图均为森林。&lt;br&gt;
现在类似于前面的思路，要把 $e^\prime_i$ 还原回中间接了个 $u$ 的原图方案，即在各个第一类森林中删 $e^\prime_i$ 加回 $e_i$。这样可能导致环，即 $u$ 原来就与 $v_i$ 通过 $e_i^\prime$ 以外的边连通，且删了 $e^\prime_i$ 后 $v_{i+k}$ 与 $u$ 不连通了（不然原来会有环）。找到包含 $e_{i+k}$ 的森林，它一定是第二类，这是因为归纳构造时 $S$ 被缩起来了，故 $e_{i+k}$ 不会与其他 $e_{j+k}$（$j\le t$）处于同一个森林中。把这两个森林里的 $e_{i}$ 与 $e_{i+k}$ 互换即可。这不会在这个第二类森林中引入环，也是因为构造时 $S$ 被缩起来，即 $u$ 与 $S$ 内 $v$ 间的边对连通性的影响是无区分的，而第二类森林两端在 $S$ 内的边又不会变动（如果不区分一二类森林，直接随便配对并，就可能在还原时无法避免环）。&lt;/p&gt;
&lt;p&gt;然后还有一个对边归纳的思路。&lt;/p&gt;
&lt;p&gt;证 3（&lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/pdf/1705.01648&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;论文&lt;/a&gt;）：任取一条边 $(u,v)$，归纳构造不含它的方案，这时如果在某个森林中 $u$、$v$ 不连通，则直接补进去即可；否则考虑某个森林 $G_1$ 中它们所在的连通块，设点集为 $S$。在其余森林中分别取出 $S$ 的导出子图，至少有一个导出子图不连通（否则加回 $(u,v)$ 时就不合法了），找出它对应的原森林 $G_2$。&lt;br&gt;
如果考虑进 $G_2$ 的所有边时，$S$ 中的点仍不连通，那么可从 $G_1[S]$ 中取出一条边改放到 $G_2$ 中使 $G_2$ 仍为森林（与图拟阵的证明相同）；否则，若将 $G_2[S]$ 中各连通块缩成点，那么这些点在 $G_2$ 中的位置关系形成类似树的结构，至少有两个叶子。这说的意思是，$G_2[S]$ 中存在至少两个连通块，如果断开其与 $S$ 之外的某条边，它就与其他 $G_2[S]$ 的连通块都不连通了。选出非 $u$ 所在的这样一个连通块，设其点集为 $S^\prime$，它与其他连通块连接的唯一“向外通道”为边 $e_1$，$e_1$ 在 $S$ 中侧端点为 $w$，考虑 $G_1$ 中 $u\rightsquigarrow w$ 路径上第一条一端在 $S^\prime$ 内的边 $e_2$。将 $e_1$ 换到 $G_1$，$e_2$ 换到 $G_2$，这样两图仍为森林，且 $G_1$ 中 $u$ 所在连通块变小。如此进行下去，直到 $G_1$ 中 $u$、$v$ 不连通即可。&lt;br&gt;
下图为最后一种情况，红色边为 $G_1$，蓝色与深蓝色边为 $G_2$，深蓝色边省略了在 $S$ 以外的中转点。实质上最后一种情况就是费尽心思想强制让 $G_1[S]$ 丢掉一些点，同时在丢掉点时 $u$ 所在部分不能和别的连通块连起来。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/paper3/1.png&#34;
	width=&#34;800&#34;
	height=&#34;531&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;150&#34;
		data-flex-basis=&#34;361px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;要判断一个图是否满足上述条件，问题就变为最大权闭合子图问题：选边为 $+1$，选点为 $-k$，要求结果 $\le -k$。为了避免空图，可以强制选一条边（增流）或一个点（退流）。&lt;/p&gt;
&lt;p&gt;对于 CF1951I，有另一个性质是，所有满足条件的连边情况构成一个拟阵，交换性的证明是，对于两张图的森林划分，考虑边数多的图边数最多的森林与边数少的图的边数最少的森林，套用图拟阵的证明方式即可。边不能一条条地加，考虑二分下一次加边失败的边权，失败后这条边就可以忽略了。时间复杂度 $\mathrm{O}(m^5\log mW)$。（这题用退流似乎没什么优势？）&lt;/p&gt;
</description>
        </item>
        <item>
        <title>[题解] CF1969F Card Pairing</title>
        <link>https://littlereuben.github.io/study/solution-cf1969f/</link>
        <pubDate>Tue, 21 May 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/solution-cf1969f/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;好题。考察了找阶段，和对 dp 原理的理解。&lt;/p&gt;
&lt;p&gt;下文提及手牌，指的是打牌后、拿牌前的状态。&lt;/p&gt;
&lt;p&gt;首先，原问题可以转化成：要求在某些 $a_i=a_j$ 之间连线（显然不会跨相同的数连），使得跨过每个 $a_{2t}$ 与 $a_{2t+1}$ 之间间隙的线的数量 $\le k-2$。这个转化是很直接的，因为连线左端的卡必须保留在手中。有可能产生疑问的一点是：如果一对 $a_{2t-1}$ 和 $a_{2t}$ 均为连线右端，那有一对卡就要顺延到后一轮才能打出，那就在待配对卡的基础上多了一对需要保留的牌啊？但由于这种情况跨 $a_{2t}$ 与 $a_{2t+1}$ 间隙的线的数量必然比跨 $a_{2t-1}$ 与 $a_{2t-1}$ 间隙的少 $2$，故这个间隙不必考虑。实际上就是能打出相同牌的轮，手牌数不变多。因此接下来认为如果拿到两张牌目前均可配对就一次性配掉，即手牌可以 $&amp;lt;k-2$。&lt;/p&gt;
&lt;p&gt;处理转化后的问题。首先，如果没有 $\le k-2$ 的限制，就是从左往右扫，发现配对了就连线（下称“贪心”）。由于手牌数不可能为奇（后续不可能配对的牌也要保留在手里），故只有为 $k$ 时会不合法，这时直觉上来说要决策放弃两张牌。但是光这么考虑，总感觉不完备，凭什么只用这种决策方式就一定能覆盖最优解？&lt;/p&gt;
&lt;p&gt;从另一个角度看，解的结构可以表述为：强制禁止某几对相同的数连线，然后剩余的贪心，要求最终合法。那么，如果某条线连了不会导致不合法，那禁掉它一定不优（如果不禁导致后面贪心得到的连线改变而不合法，可以在后面禁），因此可以在第一次发现不合法时禁。于是，上文 dp 的过程，就可以理解为决策禁哪些，然后分段贪心。&lt;/p&gt;
&lt;p&gt;令 $f_i$ 表示 $a_{2i}$ 与 $a_{2i+1}$ 处出现了不合法，前面的最优答案。没法直接枚举放弃的两张牌，先考虑直接往后贪心。注意到如果后面某一时刻手牌数为 $k-2$，那么如果放弃的是缺的两张牌，那么这个时刻就会不合法。如果这两张牌的组合在之前没出现过，则要转移。直接转移到末尾的情况需要讨论一下。&lt;/p&gt;
&lt;p&gt;一个实现问题是，如何快速求出缺的两张牌。可以记录缺的牌的和与平方和，也可以惰性删除，将所有新扫到的牌放在一个栈里，求时全拿出来判断。&lt;/p&gt;
&lt;p&gt;时间复杂度 $\mathrm{O}(n^2)$，&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/contest/1969/submission/261329499&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;代码&lt;/a&gt;。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>复合函数高阶导的公式</title>
        <link>https://littlereuben.github.io/study/faa-di-bruno/</link>
        <pubDate>Wed, 27 Mar 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/faa-di-bruno/</guid>
        <description>&lt;div style=&#34;background-color: #FFE1B9; color: #794500; padding-left: 1em; border-left: 4px solid #DE9B41; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;摘抄笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;考虑求 $(f\circ g)^{(n)}$。&lt;/p&gt;
&lt;p&gt;我们看几个例子：
$$
\begin{align*}
(f\circ g)^\prime&amp;amp;=f^\prime\circ g\cdot g^\prime\\
(f\circ g)^{\prime\prime}&amp;amp;=f^{\prime\prime}\circ g\cdot {g^\prime}^2+f&amp;rsquo;\circ g\cdot g^{\prime\prime}\\
(f\circ g)^{\prime\prime\prime}&amp;amp;=f^{\prime\prime\prime}\circ g\cdot {g^\prime}^3+3f^{\prime\prime}\circ g\cdot g^\prime\cdot g^{\prime\prime}+f^\prime\circ g\cdot g^{\prime\prime\prime}
\end{align*}
$$
注意到结果可以写成若干 $f^{(i)}\circ g\cdot h$ 的形式，其中 $h$ 是一些 $g^{(j)}$ 的积。&lt;/p&gt;
&lt;p&gt;考虑到 $(f^{(i)}\circ g\cdot h)^\prime=f^{(i+1)}\circ g\cdot g^\prime\cdot h+f^{(i)}\circ g\cdot h^\prime$，也就是说，有两种选择：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;将 $f$ 升一阶导并乘一个 $g^\prime$；&lt;/li&gt;
&lt;li&gt;导一下 $h$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;由于初始形式是 $f\circ g\cdot\mathbf{1}$，故根据决策会得到形如这样的 $h$：一个长为 $n$ 的操作序列，每次要么乘上一个 $g&amp;rsquo;$，要么导一下。而根据乘法法则，每次求导就相当于选一个先前的 $g$ 升一阶导。&lt;/p&gt;
&lt;p&gt;于是 $h$ 的模型就变成这样：一个可重数集，每次要么往里面加一个 $1$，要么选一个 $+1$。然后最终的集合大小就是 $f$ 导的阶数。&lt;/p&gt;
&lt;p&gt;发现直接对操作序列计数不好算。现考虑对于一个最终的集合（也就是结果中的一项），求出其系数。对于一个集合，它的数首先可以任意排列，代表加入它的顺序，然后一个数 $x$ 的后面要有 $x-1$ 个选中它的求导。&lt;/p&gt;
&lt;p&gt;如果把加入顺序的排列和求导选择的排列分开来计数，不容易搞。如果放在一起，就可以理解成，对于一个数 $x$，有 $x$ 个同种颜色无法区分的球（最终放在最开头的就算加入，其余算求导）。然后所有相同的 $x$ 对应的颜色无标号。那么这时如果数 $x$ 有 $m_x$ 个（集合中数的和一定是 $n$），总的系数就是：
$$
\frac{n!}{\displaystyle\prod_{x=1}^nm_x!x!^{m_x}}
$$
于是我们就可以写出最终的表达式：
$$
(f\circ g)^{(n)}=\sum_{\sum i\cdot m_i=n}\frac{n!}{\prod m_i!i!^{m_i}}f^{(\sum m_i)}\circ g\cdot\prod {g^{(i)}}^{m_i}
$$
其中 $\sum$ 和 $\prod$ 略去了 ${}_{i=1}^n$。&lt;/p&gt;
&lt;p&gt;这就是 &lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Fa%C3%A0_di_Bruno%27s_formula&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Faà di Bruno&amp;rsquo;s formula&lt;/a&gt;。它可以直接解决倒数、除法的高阶导（反函数和参数方程可能需要递推）。&lt;/p&gt;
&lt;p&gt;这个公式可以导出几个比较平凡的结论，在解题时可以用：
$$
(f(x+k))^{(n)}=f^{(n)}(x+k)\\
(f(kx))^{(n)}=k^nf^{(n)}(kx)\\
\left.\left(f(x^k)\right)^{(n)}\right|_{x=0}=\begin{cases}0,&amp;amp;k\nmid n\\ \dfrac{n!}{(n/k)!}f^{(n/k)}(0),&amp;amp;k\mid n\end{cases}
$$
最后一个可以直接展开级数证（很诡异），用于展开 $\arcsin x$ 之类的。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>关于微分的理解问题</title>
        <link>https://littlereuben.github.io/study/differential/</link>
        <pubDate>Tue, 26 Mar 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/differential/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;$\gdef\o{\mathrm{o}}\gdef\d{\mathrm{d}}\gdef\D{\Delta}$&lt;/p&gt;
&lt;h3 id=&#34;微分的定义&#34;&gt;微分的定义
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;对于一个在 $x_0$ 邻域内有定义的函数 $f$，如果：
$$
f(x_0+\D x)-f(x_0)=a\D x+\o(\D x)\quad(\D x\to 0)
$$
则称 $\d f(x_0)=a\D x=a\d x$。&lt;/p&gt;
&lt;p&gt;同理对于任意的 $x$，可以记 $\d y=\d f(x)=a(x)\D x=a(x)\d x$。根据导数与微分的关系，$a(x)=f^\prime(x)$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;问题的开端&#34;&gt;问题的开端
&lt;/h3&gt;&lt;p&gt;微分的最大好处在于它将求导这一求极限的动态过程转为了静态的，那么 $\d y/\d x$ 就可以视作除法了。那在证明复合函数和反函数的微分时，我们就会想：为什么不能直接进行分数操作呢？为什么高阶微分不具有形式不变性呢？&lt;/p&gt;
&lt;p&gt;对于式：
$$
\frac{\d y}{\d x}=\frac{\d y}{\d u}\frac{\d u}{\d x}
$$
如果要利用分数操作，大前提就是将 $\d y$ 和 $\d u$ 都写成关于 $\d x$ 的形式。而在实际求时，我们时直接求出 $y$ 关于 $u$ 的函数的导数，这两者是不同的。如果直接这样证明，会导致循环论证。&lt;/p&gt;
&lt;p&gt;那问题就来了——这里的 $\d y/\d u$ 就必须作为一个整体，那就违背微分拆成除法的思想了啊？&lt;/p&gt;
&lt;h3 id=&#34;扩展定义&#34;&gt;扩展定义
&lt;/h3&gt;&lt;p&gt;问题的核心出现在数学符号的模糊性上。注意到，在书中，微分是基于函数 $f$ 定义的，而函数只有唯一的自变量和因变量，因此 $\d f(x)$ 只能写成关于 $\d x$ 的表达式。但是当 $\d y=\d f(x)$ 后，我们就可以不知不觉地将 $y=f(x)=g(t)=\cdots$ 写出多种表达式了。这时 $\d y$ 就出现了歧义，因为按定义算它时，到底应该以那个函数关系为准呢？我们还没有说明微分各个函数是等价的，或者说，$y=f(x)=g(t)$ 并不能推出 $\d f(x)=\d g(t)$。&lt;/p&gt;
&lt;p&gt;为了处理这个问题，我进一步明确了一下定义。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;变量。$x,y,t$ 这些字母代表的就是变量，它们两两之间存在着唯一的关系，这些关系互不矛盾，可能可以用函数或隐函数描述，也可能需要用间接的变量描述或难以描述。如果一对变量 $u,v$ 之间不存在关系，那么强制认为 $\d u=0\d v,\d v=0\d u$；如果一个变量 $z$ 必须同时依赖于两个无关变量 $x,y$，那就是多元微分的事情了。总之，在一元函数微分这里，我们希望将所有涉及到的变量对应的高维坐标系画出来，所有符合关系的点应当形成若干曲线，即，可以将这些曲线拆成有限段，每一段曲线中，任何一维坐标的任何可能取值仅出现一次，或者至少要求所有变量能形成一个链式的关系，这样保证能归约到函数上的微分解决。&lt;/li&gt;
&lt;li&gt;函数。单独拿出一个函数，也是用例如 $f,g$ 的字母描述。它描述的是一种关系，可以与一个变量进行运算，得到另一个变量，例如 $y=f(x)$。注意 $y$ 和 $f$ 不能视作同一个东西，$\d f$ 是不合法的，$\d f(x)$ 才合法。&lt;br&gt;
函数代入任何变量，得到的结果形式都是相同的；而对一个变量写出关于不同变量的表达式，这些表达式形式是不同的。如果要对变量代入值，必须要写成例如 $y|_{x=1}$。&lt;br&gt;
定义函数的复合：$(f\circ g)(x)=f(g(x))$。优先级高于乘除。&lt;/li&gt;
&lt;li&gt;微分。非原始形式的微分必须是“什么变量关于什么变量的微分”，记 $y$ 关于 $x$ 的微分为 $\d_xy$，$y=f(x)$ 则 $\d_xy$ 就对应书中的 $\d f(x)$。其结果是一个变量乘上 $\D x$。这个 $\D x$ 是一个“形式”，可以理解成类似生成函数里的 $x$ 这样的一个东西，它就是标明微分类型的一个类似常数的东西。当然也可以从极小变化量角度理解，但是这里不管怎么小，都不能一阶近似，$\d_xy$ 才能一阶近似。微分与微分的商就是一个变量。&lt;br&gt;
$\D x$ 与 $x$ 无关，但 $\d_xx=\D x$，而 $\d_xy=a\D x=\D y+\o(\D x)\ne\D y=\d_yy$，也就是说 $\d_xy$ 和 $\d_yy$ 只差一个 $\o(\D x)$。这里的 $\D y$ 既可以理解为 $f(x+\D x)-f(x)$，也可以直接理解为 $y$ 的一个微小变化量。&lt;br&gt;
至于这里 $\D x$ 这类的东西是不需要考虑“什么关于什么”的，只需要所有的变量的 $\D *\to 0$ 即可，而这由可导性保证。&lt;br&gt;
为了避免歧义，规定 $\d_xuv=(\d_xu)v$，$\d_x\frac uv=\frac{\d_xu}v$，$\d_xu^2=(\d_xu)^2$。也就是说如果要写在里面必须加括号。&lt;/li&gt;
&lt;li&gt;导数。记 $y^\prime_x=\d_xy/\d_xx$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这样，上面那个式子会被写成：
$$
\frac{\d_xy}{\d_xx}=\frac{\d_uy}{\d_uu}\frac{\d_xu}{\d_xx}
$$
或 $y^\prime_x=y^\prime_uu^\prime_x$，从而无法约分。&lt;/p&gt;
&lt;h3 id=&#34;推导&#34;&gt;推导
&lt;/h3&gt;&lt;p&gt;现在关于微分只有两样东西可以使用：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过定义得到某个 $\d_x y$，以及将 $\d_xy$ 反写回定义；&lt;/li&gt;
&lt;li&gt;$u=v\Rightarrow\d_xu=\d_xv$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;根据这两样东西，可以推出：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$\d_x(u+v)=\d_xu+\d_xv$，$\d_x(cu)=c\d_xu$。证略。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\d_x(uv)=v\d_xu+u\d_xv$。证：
$$
\begin{align*}
\d_x(uv)&amp;amp;=\D(uv)+\o(\D x)\\
&amp;amp;=(u+\D u)(v+\D v)-uv+\o(\D x)\\
&amp;amp;=v\D u+u\D v+\D u\D v+\o(\D x)\\
&amp;amp;=v(\d_xu+\o(\D x))+u(\d_xv+\o(\D x))+(\d_xu+\o(\D x))(\d_xv+\o(\D x))+\o(\D x)\\
&amp;amp;=v\d_xu+u\d_xv+\o(\D x)
\end{align*}
$$
由于含 $\d$ 的部分都是常数倍 $\D x$，故这里的 $\o(\D x)$ 应该是 $0$。&lt;/p&gt;
&lt;p&gt;注意 $\d_x u\d_x v=\Theta(\D x^2)=\o(\D x)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\d_xu^{-1}=-\d_xu/u^2$。证：
$$
\begin{align*}
\d_x\left(\frac 1u\right)&amp;amp;=\frac 1{u+\D u}-\frac 1u+\o(\D x)\\
&amp;amp;=-\frac{\D u}{u(u+\D u)}+\o(\D x)\\
&amp;amp;=-\frac{\d_x u}{u(u+\D u)}+\o(\D x)\\
&amp;amp;=-\frac{\d_x u}{u^2}+\frac{\d_x u}{u^2}-\frac{\d_x u}{u(u+\D u)}+\o(\D x)\\
&amp;amp;=-\frac{\d_x u}{u^2}+\frac{\d_x u(\d_x u+\o(\D x))}{u^2(u+\D u)}+\o(\D x)\\
&amp;amp;=-\frac{\d_x u}{u^2}+\o(\D x)
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\d_xy=\d_uy/\d_uu\cdot\d_xu$。证：
$$
\begin{align*}
\d_xy&amp;amp;=\D y+\o(\D x)\\
&amp;amp;=\frac{\d_uy}{\d_uu}\D u+\o(\D u)+\o(\D x)\\
&amp;amp;=\frac{\d_uy}{\d_uu}(\d_xu+\o(\D x))+\o(\D x)\\
&amp;amp;=\frac{\d_uy}{\d_uu}\d_xu+\o(\D x)
\end{align*}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\d_yx/\d_yy=1/(\d_xy/\d_xx)$。证：只需令 4 中 $u=y$ 即可。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以上给出了微分形式的求导法则证明。注意到，3 的证明比直接 $\lim$ 麻烦。&lt;/p&gt;
&lt;p&gt;一阶微分形式的不变性，可以理解成（注意 $\d_xy\ne\d_uy$）：
$$
\forall u,\frac{\d_xy}{\d_xx}=\frac{\d_uy}{\d_ux}
$$
或是（注意 $y^\prime_u\ne y^\prime_x$）：
$$
\d_xy=y^\prime_u\d_xu=y^\prime_x\d_xx
$$
&lt;strong&gt;关于自变量微分时&lt;/strong&gt;，中间变量的微分形式和自变量的微分形式相同。这个性质一般会这样被使用：求 $\d_xy$ 时，先求出 $\d_uy$，然后把等式两侧的 $\d_u$ 替换为 $\d_x$ 再把 $\d_x u$ 展开。这在不标关于谁微分的时候是不容易被发觉的，书里的写法 $\d y=y^\prime_u\d u=y^\prime_x\d x$ 感觉像在说废话，其本质原因是它会被混淆成 $\d_uy=y^\prime_u\d_uu$，而这就是定义啊。&lt;/p&gt;
&lt;p&gt;至于为什么教材里不表明是对谁微分，主要因为一般微分都是关于分母，不然得到的东西类型就不对了。&lt;/p&gt;
&lt;p&gt;那么在答题时如何用教材中的形式呢？在没有使用链式法则或直接处理高阶微分时，默认是关于上文中&lt;strong&gt;唯一的自变量&lt;/strong&gt;微分；用链式法则处理一阶微分时，必须单独写出一步，并且在脑中，如果要替换“关于谁微分”，必须是&lt;strong&gt;成对替换&lt;/strong&gt;，这种成对可以是分子分母，也可以是等式两边。&lt;/p&gt;
&lt;h3 id=&#34;高阶微分&#34;&gt;高阶微分
&lt;/h3&gt;&lt;p&gt;如果硬要用类似一阶的定义方法定义高阶微分，可以这样类比定义：&lt;/p&gt;
&lt;p&gt;对于一个在 $x_0$ 邻域内有定义的函数 $f$，如果：
$$
\D^nf(x)=\sum_{i=0}^n(-1)^{n-i}\binom nif(x_0+i\D x)=a\D x^n+\o(\D x^n)\quad(\D x\to 0)
$$
则称 $\d^nf(x_0)=a\D x^n=a\d x^n$。&lt;/p&gt;
&lt;p&gt;但是这个似乎只能直接用导数的 $\lim$ 形式证，我没法通过反复利用一阶微分的定义证。&lt;/p&gt;
&lt;p&gt;回到正常的定义。高阶微分的写法也是好理解的：
$$
\d_x\left(\frac{\d_xy}{\d_xx}\right)=\frac{\d_x^2y\d_xx-\d_xy\d_x^2x}{\d_xx^2}=\frac{\d_x^2y}{\d_xx}
$$
核心是 $\d_x^2x=\d_x(\D x)=0$。&lt;/p&gt;
&lt;p&gt;二阶微分不具有形式不变性，可以如下试验：&lt;/p&gt;
&lt;p&gt;记 $u=g(x)$，$y=f(u)$。
$$
\begin{align*}
\d_u^2y&amp;amp;=\textcolor{teal}{f^{\prime\prime}(u)\d_uu^2}\\
&amp;amp;=(f^{\prime\prime}\circ g)(x)\d_uu^2\\
&amp;amp;=\textcolor{green}{(f^{\prime\prime}\circ g\cdot {g^\prime}^2)(x)\d_ux^2}\\
\d_x^2y&amp;amp;=(f\circ g)^{\prime\prime}(x)\d_xx^2\\
&amp;amp;=\textcolor{green}{(f^{\prime\prime}\circ g\cdot {g^\prime}^2+f^\prime\circ g\cdot g^{\prime\prime})(x)\d_xx^2}\\
&amp;amp;=\textcolor{teal}{f^{\prime\prime}(u)\d_xu^2+f^\prime(u)\d_x^2u}
\end{align*}
$$
也就是：
$$
\frac{\d_x^2y}{\d_xx^2}\ne\frac{\d_u^2y}{\d_ux^2}
$$
至于为什么不一样，可以大致理解为有一项高阶项不能忽略。由于水平有限，我无法指出到底源自于哪儿。&lt;/p&gt;
&lt;p&gt;从而我们也就能理解，为什么在书里，参数方程一阶导可以 $\d y/\d x=\d y/\d t\cdot\d t/\d x$，而二阶导必须拆成两次一阶导，而不能 $\d^2y/\d x^2=\d^2y/\d t^2\cdot (\d t/\d x)^2$。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>[题解] CF924F Minimal Subset Difference</title>
        <link>https://littlereuben.github.io/study/solution-cf924f/</link>
        <pubDate>Sun, 18 Feb 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/solution-cf924f/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;关于本题的一个注记。&lt;/p&gt;
&lt;p&gt;钦定背包上界为 $72$，这样搜得的状态数为 $12880$。对其进行 dfa 最小化，状态数优化到 $715$（注意到设上界较大时最小化 dfa 后大小仍为该值）。预处理 $f_{k,i,s,r}$ 表示限制差 $\le k$，$i$ 位待定，当前 dfa 上状态为 $s$，当前位至多取 $r$ 的答案，即可 $\mathrm{O}(\log r)$ 回答单组。&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/contest/924/submission/197247120&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;远古最优解代码&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;这题在徐哲安的 2021 年集训队论文《浅谈有限状态自动机及其应用》中作为例题出现，其证明了背包上界只需开到 $80$ 即可，但没证 $72$。以下是我口胡的证明。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;结论&lt;/strong&gt;：对于一个只包含 $\le w$ 的正整数的序列，给每个数安排正负号，使得和的绝对值最小。那么最大前缀和绝对值 $\le w(w-1)$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;引理&lt;/strong&gt;（&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/problemset/problem/618/F&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CF618F&lt;/a&gt;）：对于大小 $\ge n$ 的可重集合 $A$ 和任意大小（设为 $m$）的可重集合 $B$，它们的元素都是 $\le n$ 的正整数。如果 $n+\sum_{b\in B}b&amp;gt;\sum_{a\in A}a$，那么可选两者各自的一个非空子集，使得和相同。证略。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;证明&lt;/strong&gt;：首先最优答案一定 $\le w$，并且当且仅当序列为奇数个 $w$ 时最优答案为 $w$，这是易证的。接下来只考虑最优答案 $\le w-1$ 的情况。&lt;/p&gt;
&lt;p&gt;考虑某组最优解，找到其最靠前的前缀和绝对值 $&amp;gt;w(w-1)$ 的位置 $t$，不妨设该前缀和是正的。取出该前缀中最靠后的 $w$ 个取正号的数 $x_{1\cdots w}$，以及剩余后缀中所有共 $k$ 个取负号的数 $y_{1\cdots k}$。其中由鸽巢原理，$x_1,\cdots,x_w$ 一定是可以取出来的，而由于 $\sum_{i=1}^ky_i\ge w(w-2)+2$，故 $k\ge w-1$。&lt;/p&gt;
&lt;p&gt;接下来的目标是选择某些 $x$ 和某些 $y$，改变它们的符号，使全体和不变，且 $t$ 及之前不反而出现前缀和 $&amp;lt;-w(w-1)$ 的情况，且 $t$ 处的前缀和降低。这样就可以不断归纳了。&lt;/p&gt;
&lt;p&gt;如果 $\sum_{i=1}^wx_i\le w(w-1)$，则令 $A=\set{x_{1\cdots w}}$，$B=\set{y_{1\cdots k}}$，套用引理即可。&lt;/p&gt;
&lt;p&gt;否则随意套用引理可能会导致 $x_1$ 处前缀和 $&amp;lt;-w(w-1)$。这时，$x$ 中必然有 $w$。如果 $y$ 中也有 $w$，那么选这两个互换符号即可&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;否则，选择 $y$ 中最短的前缀 $y_{1\cdots k^\prime}$，使得和 $\ge w(w-2)+2$。由于 $y$ 中无 $w$，故 $k^\prime\ge n$。这时由于 $w(w-2)&amp;lt;\sum_{i=2}^wx_i\le w(w-1)$，$\sum_{i=1}^{k^\prime}y_i\le w(w-1)$，故可令 $A=\set{y_{1\cdots k^\prime}}$，$B=\set{x_{2\cdots w}}$，套用引理即可。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;这里其实有个特殊情况，就是 $x_1=w$，然后 $x_1$ 前的前缀和最小会达到 $-w+1$，这样一来 $x_1$ 处的前缀和会达到 $-2w+1$，在 $w=2$ 时会炸。但 $x_1$ 前的前缀和达到 $-w+1$ 时 $x$ 会全是 $w$，所以选后面的 $x$ 就行。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>[题解] lgP9603 [IOI2023] 山毛榉树</title>
        <link>https://littlereuben.github.io/study/solution-lgp9603/</link>
        <pubDate>Tue, 23 Jan 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/solution-lgp9603/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;提供一个自己做的思路。用到的性质比其他正解弱，但更容易想。&lt;/p&gt;
&lt;p&gt;考虑单棵树的判定。初步读题后会得到两个性质：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;一个点的儿子边权不能重复。&lt;/li&gt;
&lt;li&gt;设所有权为 $i$ 的边的较浅端点形成集合 $S_i$，则所有 $S_i$ 形成一个“连续包含链”的结构。或者也可以从一个点的所有儿子边权角度等价描述。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这些性质都是 beautiful subtree 的必要条件，并且对于想象力不够丰富的选手来说，难以加强至充要条件。既然必要角度不行，那考虑充分角度——同样是一个很常见的套路，我们希望找到一种排列的构造，使得对于 beautiful subtree，构造出来的排列必定是 beautiful permutation；如果不是 beautiful subtree，那就不用考虑了。于是剩余要做的就是验证一遍题意中的条件即可。&lt;/p&gt;
&lt;p&gt;归纳易证排列中越靠前的点子树 size 越大，因此先按 size 排序；如果两棵子树 size 相同，那么也归纳易证它们同构，因此它们的相对顺序只取决于它们各自父亲的相对顺序。因此可以在按 size 排序后再扫一遍，size 相同的按父亲在序列中的位置排序。这样可以做到 $\mathrm{O}(n\log n)$ 单次判定。这些归纳易证的部分也都很直觉的。&lt;/p&gt;
&lt;p&gt;对于原问题，一个有意思的猜想是，一棵 beautiful subtree 的子树也都是 beautiful 的。考试中当然可以直接 assert 然后交上去看看，不过这也是好证的。考虑 $T(u)$ 对应的某个 beautiful permutation $p$。对于 $v\in T(u)$，将 $p$ 中 ${}\in T(v)$ 的点对应的子序列 $p&amp;rsquo;$ 取出来，可以证明这就符合条件。因为对于某种权值的边，除去它的较深端点为 $v$ 的情况以外（$v$ 本身在 $p&amp;rsquo;$ 中不贡献给计数器，故也不用考虑），其余该权值的边的两端点要么同时在 $p&amp;rsquo;$ 中，要么同时不在 $p&amp;rsquo;$ 中。因此扔掉 $p&amp;rsquo;$ 以外的部分后，剩余的连边情况是保持不变的。&lt;/p&gt;
&lt;p&gt;剩下的就是思想类似 &lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/problem/P6541&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[WC2018] 即时战略&lt;/a&gt; 的二分了。取出重链，在上面二分，然后往轻儿子递归。硬二分是 $\mathrm{O}(n\log^3n)$ 的（&lt;a class=&#34;link&#34; href=&#34;https://qoj.ac/contest/1338/problem/7121&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;代码&lt;/a&gt;），如果按全局平衡二叉树的方式带权二分，则是 $\mathrm{O}(n\log^2 n)$ 的。这是因为考虑大小为 $n$ 的树的第一轮二分，假设得到的根最浅 beautiful subtree 大小为 $s$，那么分 $\ge 2s$ 和 $&amp;lt;2s$ 的子树判定讨论，这轮二分的复杂度为 $\mathrm{O}(n\log n+s\log^2 n)$。接下来，剩余若干大小 $\le n/2$，和为 $n-s$ 的子问题，这样分析下来就是 $\log^2$ 的。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>定长区间最小整周期问题的线性解法</title>
        <link>https://littlereuben.github.io/study/string-period/</link>
        <pubDate>Thu, 18 Jan 2024 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/string-period/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;本文非常地粗糙和民科，算法很可能是假的。如果您知道已有的其他解法或者找到了我的证明的问题，请告知我是小丑。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;最近做 &lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/problem/CF1909G&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CF1909G&lt;/a&gt; 的时候想复杂了，结果发现了一些奇怪的性质，感觉不大平凡？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;引理&lt;/strong&gt;：一个足够长的串 $s$，$s_1\ne s_{n+1}$。若 $s_{1\cdots n}$ 的最小整周期为 $p&amp;lt;n$，有某个 $1&amp;lt;i\le n$，$s_{i\cdots i+n-1}$ 的最小整周期为 $q&amp;lt;n$，那么 $i&amp;gt;n-p-q+\gcd(p,q)+1$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;证&lt;/strong&gt;：反证，假设 $i\le n-p-q+\gcd(p,q)+1$。&lt;/p&gt;
&lt;p&gt;$p\mid q$ 的情况下，$i\le n-q+1$，$s_{n+1}=s_{n-q+1}=s_{1}$，矛盾。&lt;/p&gt;
&lt;p&gt;$p\nmid q$ 的情况下，$s_{i\cdots n}$ 这一段长度至少为 $p+q-\gcd(p,q)$，且有 $p$ 和 $q$ 作为周期，由强周期引理，$p$ 不是 $s_{1\cdots n}$ 的最小整周期，矛盾。&lt;/p&gt;
&lt;p&gt;$i$ 取到 $n-p-q+\gcd(p,q)+2$ 的情况应该可以构造，不过我现在还没找到通用的形式。&lt;/p&gt;
&lt;p&gt;一个有趣的推论是 $i&amp;gt;n/3+1$，这可以通过讨论所有 $p,q&amp;gt;n/6$ 证明。取到 $i=n/3+2$ 的情况是这样的：
$$
\texttt{a}t\texttt{b}t\texttt{a}\textcolor{red}{t\texttt{a}t\texttt{b}t\texttt{a}t}+\textcolor{red}{\texttt{b}t\texttt{a}t\texttt{b}}
$$
$t$ 表示任意串。前面一个串 $p=n/2$，红色部分 $q=n/3$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;然后发现了一个求定长区间最小整周期的线性算法&lt;/strong&gt;（定长长为 $n$）：&lt;/p&gt;
&lt;p&gt;首先 $p=n/2$ 的情况要暴力判掉。&lt;/p&gt;
&lt;p&gt;从左往右移窗口。对于当前子串 $s_{l\cdots r=l+n-1}$，反过来跑 KMP。&lt;/p&gt;
&lt;p&gt;case 1. 如果找到了 $&amp;lt;n$ 的最小整周期（这里找到 $n/2$ 也无所谓），那就可以一步步移左右端点，看能否维持当前周期，如果不行，根据引理可以至少一次性往后跳 $(n-p)/2$。称这个为优化 A。&lt;/p&gt;
&lt;p&gt;case 2. 否则，如果下一个具有最小整周期 $p\le n/3$ 的区间与 $[l,r]$ 有交，那么交的部分一定也有 $p$ 的周期。并且，如果交的部分长 $\ge 2n/3$，那么 $p$ 一定是它的最小周期（否则可以用弱周期引理导出更小的 $p$）。现在，找到当前区间的最长后缀 $[t,r]$，满足这个后缀的最小周期是 $\le n/3$ 的 $n$ 的因数，把区间左端点移到 $\min(t,l+n/3)$。称这个为优化 B。注意优化 B 是不能兼容 $p=n/2$ 的，因为交里的循环节不足 $2$ 次，无法保证最小周期。比如当前子串为 $\texttt{aaaaaaaaaabaaaaa}$，那么后续必须逐一检查。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;性质&lt;/strong&gt;：连续进行两次优化 B，左端点移动超过 $n/3$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;证&lt;/strong&gt;：如果两次中有至少一次左端点移到的这个 $\min$ 式子取的后一项，那么已证毕。&lt;/p&gt;
&lt;p&gt;否则考虑反证，如果左端点移动 $\le n/3$，设两次分别移动到 $[l^\prime,r^\prime],[l^{\prime\prime},r^{\prime\prime}]$，$[l^\prime,r]$ 和 $[l^{\prime\prime},r^\prime]$ 的最小周期分别为 $p,q\le n/3$。由于 $r-l^{\prime\prime}+1\ge 2n/3$，故 $[l^{\prime\prime},r]$ 具有周期 $\gcd(p,q)$，故 $[l^\prime,r^\prime]$ 具有周期 $\gcd(p,q)$，不应有第二次优化 B，矛盾。&lt;/p&gt;
&lt;p&gt;综上，无论何种情况，都可以一次性跳过至少 $n/3$ 个位置，总时间复杂度为 $\mathrm{O}(n\cdot \lvert s\rvert/n)=\mathrm{O}(\lvert s\rvert)$。&lt;/p&gt;
&lt;p&gt;优化 A 应该是不必要的（可以直接从 $l+1$ 继续），因为如果 case 1 紧跟 case 2 的话，case 2 应当一定会跳 $\min$ 的后一项。这个我没仔细证。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>dp 题方法总汇</title>
        <link>https://littlereuben.github.io/study/dp-problems/</link>
        <pubDate>Sun, 31 Dec 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/dp-problems/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h2 id=&#34;声明&#34;&gt;声明
&lt;/h2&gt;&lt;p&gt;本文非严谨的算法理论研究，仅仅是个人对解题经验的归纳和实验性的系统总结，不保证理论上的完备性与纯粹性。仅对解题实践提供一个较为自洽的解释，作为参考。&lt;/p&gt;
&lt;p&gt;本文所有题都不会提供题意和完整包含细节的题解，也就是说您需要先做一遍或看其他题解，因为没有做题经验就无法感受解题思想。您也可以把本文理解成一个归类好的题单。&lt;/p&gt;
&lt;p&gt;如果一题包含多项技巧则会放在多处，但如果包含多项思想则只会在一处解说，其余处记入“其他”项并打+号。如果出现一题多解会记入多个类别并多次解说。有些不是非常典型或过难过易的题也会记入“其他”项。&lt;/p&gt;
&lt;p&gt;带括号的题是内部训练题或经典问题。&lt;/p&gt;
&lt;p&gt;如果您认为一些理论表述有偏颇，或找到文章无法解释的题目（反例），可以告诉我。&lt;/p&gt;
&lt;p&gt;本文会时常更新。&lt;/p&gt;
&lt;h2 id=&#34;引言&#34;&gt;引言
&lt;/h2&gt;&lt;p&gt;dp 在 OI 中应用之广，变化之多，难度之大，已使它不再仅限于原先 &amp;ldquo;dynamic programming&amp;rdquo; 的定义和特质。《算法导论》给了 dp 一个严谨的基本定义，但缺乏实操性和可扩展性。本文不会采用算导中的描述方法，而是用一个解题方法论的方式展开，但是也会牵涉到一些基本定义及术语。因此，&lt;strong&gt;在阅读本文前，您应当先掌握算导第 15 章（动态规划）的内容。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在 OI 中，狭义的 dp 基于的是一个类自动机结构（一般生成过程只有串联和并联两种，串联就是在自动机上走，并联可以理解成多维状态的降维，我不清楚这个东西有没有更形式化的描述）。考虑某种组合结构，所有满足某一条件的该结构作为元素（称为“解”）组成一个解集，题意要求求出这些解的某种权值经过某种运算后的结果。dp 就是使得自动机在这些解上运行。这种情况下的 dp 大致有三类：最优化、计数、判定。在所有合法解不漏的前提下，它们需要满足的关键条件是：最优子结构、不计重、无。&lt;/p&gt;
&lt;p&gt;广义上来说，习惯于将大部分用递推解决问题的方法都称作 dp。&lt;/p&gt;
&lt;p&gt;可以大致限定一下狭义 dp 的使用范围：如果可以找到一种生成方式，能恰好（逐步）刻画出所有满足条件的解，并且中途为了判定符合条件以及为了辅助求出权值所记录的信息是局部的或可能性较少的，那就有机会使用 dp。当然进一步地，如果有更好的结论能刻画模型，使得无需逐步生成解（解的可能性只有 $\mathrm{O}(1)$ 种或可以通过某类极简单的方式生成），那就是贪心、构造、直接计数或其他无算法题了。&lt;/p&gt;
&lt;p&gt;dp 题的核心就是对原问题模型的分析、转化、拆解和重构，通过钦定生成的顺序以及分析其变化的本质，将原先可能性极多的解“少量多次”地用变量来描述从而解决。&lt;/p&gt;
&lt;p&gt;下面我会从一些特殊类型的 dp 技巧和通用 dp 解题方法两方面，介绍如何思考 dp 题。由于 dp 的设计思想较细较杂，故有一些小的思想和套路不会单独写出来，而是会在例题讲解的最后一段，我会将它加粗。&lt;/p&gt;
&lt;p&gt;本文（将）是我的集训队论文的素材来源，预计论文对方法论的叙述方式可能与本文有出入，您可以结合着看。与论文有关的注释以 &amp;ldquo;remark.&amp;rdquo; 开头。&lt;/p&gt;
&lt;h2 id=&#34;基于特殊结构的技巧&#34;&gt;基于特殊结构的技巧
&lt;/h2&gt;&lt;p&gt;决策单调性优化与 ds 优化等的具体技术详见下一章。&lt;/p&gt;
&lt;h3 id=&#34;括号序列&#34;&gt;括号序列
&lt;/h3&gt;&lt;p&gt;括号序列的生成思路一般有以下几种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;直接按下标，记录当前多的 $\texttt{(}$ 数。&lt;/li&gt;
&lt;li&gt;按外层配对括号 $\texttt(\mathtt\cdots\texttt)\texttt(\mathtt\cdots\texttt)\mathtt\cdots\texttt(\mathtt\cdots\texttt)$ 拆开。&lt;/li&gt;
&lt;li&gt;拆第一对配对括号，剩下视作整体 $\texttt(\mathtt\cdots\texttt)\mathtt\cdots$。&lt;/li&gt;
&lt;li&gt;视作折线，进行容斥。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中 2、3 是直接对着定义 dp，3 可以理解成对括号树三度化再 dp，会方便一些，同时避免计重。2 在最优化问题下可以随便选一个断点拆。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1781F：称第 $i$ 轮加入的为第 $i$ 组括号。这题由于增加了时间维度，故又多出几种思路，但直接按时间维 dp 是不行的：正着信息量太大，倒着会把同一组括号拆到两部分。不按时间 dp 的话考虑概率不方便，先求出方案数。&lt;/p&gt;
&lt;p&gt;先分析一下题目条件的静态表述：把每个括号加入的时间写成序列，则不能出现 $[j,i,i,j],[i,j,i,j],[j,i,j,i]$（其中 $i&amp;lt;j$）的子序列。&lt;/p&gt;
&lt;p&gt;（解 1）考虑第一组括号，它们将序列切分成三部分，同一组括号在同一部分。这样只需在记一维“当前段前面多的 $\texttt{(}$ 数”即可。由于是三部分，故是 $\mathrm{O}(n^4)$。先对其中两个卷积即可做到 $\mathrm{O}(n^3)$。&lt;/p&gt;
&lt;p&gt;（解 2）尝试方式 3，问题在于这对匹配的括号可能不是同一组。那就改成找与开头括号同一组的括号，它将序列切成两部分，同一组括号在同一部分，第一部分都后于开头括号加入。dp 状态与第一种相同，直接三次方。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一些类括号序列的结构，主要依据递归定义来 dp（定义可能不唯一）。主要找形式相同的子问题。&lt;/p&gt;
&lt;h4 id=&#34;例&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF888F：断环为链，直觉上来说结构属于以下两种（红色的是边）：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/dp-problems/dp/o0rauqlf.png&#34;
	width=&#34;600&#34;
	height=&#34;300&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;200&#34;
		data-flex-basis=&#34;480px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;一种是在两种类型之间交替 dp，type 1 按方式 3 转移，type 2 找中间断点。另一种是只对 type 2 dp，即先逐步确定左侧的子结构，到达断点后再右侧（如果每次随意转移左右侧则会计重）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF913E：这题多了个优先级，dp 得记当前表达式的层级。我的具体思路是记能否被 T 或 F 识别（最外层是否没有 $\texttt{or}$），转移有几种：$\texttt{or}$ 连接、$\texttt{and}$ 连接、加 $\texttt{()}$、加 $\texttt{!()}$。由于后效性得多轮松弛。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另一个跟 01 序列相关的罕见技巧也放这（来源于 dmy WC2022 讲课的 PA2021R2T1(lgP9047)）：如果有一些 0 和一些 1，每个都有权值，要选一个子集 01 数量相同，最优化权值相关某个东西，可以把元素随机打乱再 dp，记录当前 0 比 1 多多少，这一维可以只开到 $\Theta(\sqrt n)$。&lt;/p&gt;
&lt;h3 id=&#34;排列&#34;&gt;排列
&lt;/h3&gt;&lt;p&gt;这一节侧重于排列未知的情况。&lt;/p&gt;
&lt;p&gt;排列的关键是找到一个生成顺序，使得已生成部分的数不需要逐个记录，而只需抽象成少量的几个量。最基本的排列生成顺序如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;预定（绝对）&lt;/th&gt;
&lt;th&gt;插入（相对）&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;按下标&lt;/td&gt;
&lt;td&gt;从左往右逐一确定值&lt;/td&gt;
&lt;td&gt;从左往右逐一确定当前值在前缀中排第几大&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;按值&lt;/td&gt;
&lt;td&gt;从小到大逐一确定位置&lt;/td&gt;
&lt;td&gt;从小到大逐一插入排列&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;还有几个典型的应用。一种是只对一个单调子序列 dp，剩余部分直接用组合数确定（属于按值、断点）；一种是基于笛卡尔树或类似笛卡尔树的分治结构，合并时确定相对大小，乘组合数（属于按值、预定、单步）。&lt;/p&gt;
&lt;h4 id=&#34;例-1&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1806D：（解 1）对答案有贡献的是所有 $p_i=\operatorname{mex}_{j&amp;lt;i}\set{p_j}$ 的 $i$，对它们 dp，其余部分可以用组合数插入。$f_i$ 表示到 $i$，$1\sim i-1$ 都在 $i$ 之前，且目前根为 $1$ 的方案数。$f_i=[a_i=0]\sum_{j&amp;lt;i}(i-2)^{\underline{i-j-1}}f_j$，可以换元做到线性，然后统计一下即可。这属于按值、插入、断点转移。&lt;/p&gt;
&lt;p&gt;（解 2）尝试按值、插入、单步转移。如果 $i$ 不插到末尾则无影响，否则当且仅当 $1\sim i-1$ 操作结束后根仍为 $1$ 且 $a_i=0$ 时有贡献。从另一个角度看，这个解法的处理是把每个点的贡献拆开，将原所求转化为容易转移的“前 $i$ 个点操作后根仍为 $1$ 的方案数”，属于拆分要素。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1437F：可以线性。对更新前缀 $\max$ 的值 dp。如果从大到小 dp，就是 $f_i$ 每次从 $2a_j\ge a_i$ 的 $f_j$ 转移，并在 $j$ 之后插入范围在 $(a_i/2,a_j/2]$ 的剩余 $a$，同样可以换元做到线性。这属于按值、插入、断点转移。&lt;/p&gt;
&lt;p&gt;如果从小到大 dp，就必须按值、预定、断点转移。当 $f_i$ 从 $f_j$ 转移时，$a_i$ 塞到第一个空位，后面的空位选填 $(a_j/2,a_i/2]$ 中的剩余 $a$。注意到这个问题中的两个两倍是有意义的，如果两个倍数不同，可能导致“剩余 $a$”数量无法确定。&lt;/p&gt;
&lt;p&gt;本题具体 dp 方程详见概率 &amp;amp; 期望一节。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;USACO21DECPlatinumT3：（解 1）同样，对猜的数 dp，处于转移之间的无用数直接用组合数算。官方解法是先对答案的期望 dp，这样可以避免 dp 同时要记方案数（这个技巧详见后）。前缀和优化即可。这也属于按值、断点转移。&lt;/p&gt;
&lt;p&gt;（解 2）尝试按下标、插入、单步转移，即每次在末尾加入一个数，不妨设是 $\le x$ 的，那么只需要分它会被猜和被忽略两种情况即可。这个同样可以期望化以省掉方案数 dp。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这三个例子本质上是形如“确定了主要元素（某个单调子序列），剩余元素必须出现在某个主要元素前或后”，为了使状态维数小，就对主要元素 dp。这时剩余元素的位置应当在对应的主要元素被 dp 到时用数学方法确定。如果限制方向与 dp 方向相同则用预定法，否则用插入法。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1363F：问题转化为找到一个排列 $p$，使 $s_i=t_{p_i}$ 且 $\sum_i[\max_{j&amp;lt;i}\set{p_j}&amp;lt;p_i]$ 最大。这个模型和前三个例子很像，但由于本题限制条件难以适应断点转移，故考虑单步转移。$f_{i,j}$ 表示到 $i$，目前最大值为 $j$。对于不更新最大值的转移，只需要判定同类字符在 $t$ 中位置 $\le j$ 的数量够用即可。更新最大值时有性质保证转移唯一，总的来说转移就是 0D 的。这属于按下标、预定、单步转移。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1799G：如果不容斥至少得 $\mathrm{O}(n^5)$。容斥的话麻烦的一点是，如果一组内有多个钦定不合法的投票，它们的方案数无法确定（类似一个有上限的整数拆分）。这里的一个技巧是，把投给同一个人的票也视作有先后顺序，这样投票方案就变成了一个排列，最后除以 $\prod c_i!$ 即可。这样直接枚举组内钦定数，然后用组合数即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1439D：正反 dp 要记的信息量都太大，考虑到多个占用位置极长连续段之间是无关的，因此可以分开 dp。对于一个连续段，考虑其最后一个人，拆成两段即可。段的合并或并列就乘组合数确定相对大小。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. +CF1784D、+CF856C、ABC134F&lt;/p&gt;
&lt;h3 id=&#34;背包&#34;&gt;背包
&lt;/h3&gt;&lt;p&gt;基础的背包技巧包括：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;多重背包的二进制拆分和同余转移。&lt;/li&gt;
&lt;li&gt;换维。价值较小时可以定义状态为得到 $i$ 的价值至少要多少重量。&lt;/li&gt;
&lt;li&gt;物品大小和有限制时只有根号种物品。&lt;/li&gt;
&lt;li&gt;无序整数拆分相关的两个：“全体 +1 &amp;amp; 新开一个”的转移方式，以及按下标 dp 总状态数为 $n^2\ln n$。&lt;/li&gt;
&lt;li&gt;从 GF 角度考虑。&lt;/li&gt;
&lt;li&gt;同余最短路。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;例-2&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;（经典问题）（无序整数拆分）：除了五边形数解法外，还有一种 $1.5$ 次的。对于 $\le\sqrt n$ 的数，直接完全背包，$&amp;gt;\sqrt n$ 的数少于 $\sqrt n$ 个，套用平方的做法，$f_{i,j}$ 表示 $i$ 个数和为 $j$，每次加入单个 $1$ 或全体加 $1$，最后全体加 $\sqrt n$，两类卷起来即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1425B：情况只会有两种：两人在某个环上卡住、两人分工将所有环走完（且最终至少有一人停在点 $1$）。后者简单。前者需要枚举卡住的环，这时相当于求 $\prod_{j\ne i}\left(x^{l_j}+1+x^{-l_j}\right)$ 某一区间的系数，可以预处理前后缀乘积拼合，也可以预处理所有的积然后 $\mathrm{O}(n)$ 除以当前的因式，都是 $\mathrm{O}(n^2)$ 的。只利用环大小只有 $\mathrm{O}(\sqrt n)$ 种也可以优化成 $\mathrm{O}(n^2)$，但上述两种技巧不能同时优化，变成 $\mathrm{O}(n\sqrt n)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1442D：容易用调整法证明只有一个数组选一部分，其余要么全选要么全不选。于是问题就变成了 $[x^k]\sum_iA_i(x)\cdot\prod_{j\ne i}\left(1+s_jx^{t_j}\right)$ 的 $(\max,+)$ 卷积版本。这不适用于例 1 的两种处理方法，因为前后缀拼合会由于 $A_i(x)$ 没有简单形式而必须把每一项算出来，就得 $\mathrm{O}(k^2)$，而本题没有可减性，不能作除法。这时可以利用分治方法做到 $\mathrm{O}(nk\log n)$。这个方法也可以用到上一题，做到 $\mathrm{O}(n^2\log n)$ 或 $\mathrm{O}(n^2)$（如果分治时控制多项式次数得当）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1740F：充要条件是前 $k$ 大的 $\text{size}$ 之和 $\le \sum\min(cnt_i,k)=s_k$。$f_{i,j,k}$ 表示前 $i$ 大，和为 $j$，目前 $k$，$ik\le j$，状态总数 $\mathrm{O}(n^2\log n)$，转移可以做到 $\mathrm{O}(1)$（新加一个数或 $k$ 减一）。用“全体 +1 &amp;amp; 新开一个”的转移思路也是可以的：$g_{i,j,k}$ 表示已确定 $i$ 个，和为 $j$，还能全体加至多 $k$ 次，其中 $k\le s_i/i$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[十二省联考 2019] 皮配：正常的暴力 dp 可以记录红阵营和 R 派系的选手数。用 GF 解释就是，一个城市会贡献 $\left(1+x^{\sum s_i}\right)\prod(1+y^{s_i})$，这意味着除了有偏好的城市以外，其余的可以分离阵营和派系两个要素。有偏好的城市贡献形如 $\prod_{i\notin T}(1+y^{s_i})\cdot \left(A(y)+B(y)x^{\sum s_i}\right)$（$T$ 为有偏好的学校）。一个大致的思路是把后面特殊的部分全部卷起来（记作 $E(x,y)$），这样需要 $\mathrm{O}(k^2s^2M)$。但由于 $A,B$ 都是若干单项和二项式的积，故分别可以逐一乘（求出 $E(x,y)A(y)$ 和 $E(x,y)B(y)$），然后最后再决定阵营，即 $E\cdot A+E\cdot B\cdot x^{\sum s_i}$。最终没必要把 $E$ 和 $x,y$ 剩余整齐部分卷起来，只需要枚举 $E$ 的每一项，然后乘上两段系数和的积即可。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题的几个技巧是：逐个乘项数小的多项式一般比先把这些小多项式乘起来再统一卷更优；求最终答案时可以视作求卷积的单点值，避免全体卷积；同时，对于这类最终不使用多项式算法的背包题，不能完全抛弃组合意义，要结合代数和原模型推导，否则可能会丢失方向或性质。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;然后有几个很牛的技巧（仅用于最优化）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;完全背包的倍增方法。当容量 $T$ 很大，最大重量 $W$ 较小时，通过将解按重量排序交替放，可证明一定能将解拆成两个总重量差 $\le W$ 的部分，于是求出 $[T-W,T+W]$ 的最优解可以 $\mathrm{O}(W^2)$ 递推到 $[2T-W,2T+W]$。如果额外对选的数量 $C$ 有限制，同样可以证明一定能将解拆成两个总重量差 $\le W$ 且数量差 $\le [2\nmid C]$ 的部分，从而有两种转移方式：一种是如果 $C$ 为奇数就转移单个，否则直接对半，这样做为了保证状态的封闭性就得求 $[T-2W,T+W]$ 的最优解；另一种是直接对于 $\lfloor C/2\rfloor$ 和 $\lceil C/2\rceil$ 的数量要求都 dp 即可。无论如何都会多一倍常数。&lt;/p&gt;
&lt;p&gt;只有完全背包能这么搞。$\mathrm{O}(nT)\rightarrow\mathrm{O}(W^2\log T)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;背包的贪心性质。考虑按性价比贪心选直到第一次遇到无法选的物品就停止，设选出的物品集合为 $G$，最优解为  $O$。有性质：存在 $O$ 使 $\lvert G\oplus O\rvert\le 2W$。&lt;/p&gt;
&lt;p&gt;证明：考虑 $G$ 加删元素（不重复加删一个元素）逐渐变成 $O$ 的过程，容易维持重量和 $\in[T-W,T+W)$。如果 $\lvert G\oplus O\rvert&amp;gt;2W$，那么由鸽巢原理，一定存在两个中间状态重量和相等。由于 $G$ 选的是性价比最高的一些，故把这两个重量和相等的中间的加删部分去掉，一定不劣。&lt;/p&gt;
&lt;p&gt;那么只需一个状态数为 $4W^2$ 的背包即可。$\mathrm{O}(nT)\rightarrow\mathrm{O}(nW^2)$。&lt;/p&gt;
&lt;p&gt;如果价格最大值 $V$ 很小，也有类似的性质（$\lvert G\oplus O\rvert\le 2V$），实现用换维技巧即可。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;例-3&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;（经典问题）（给定 $n$ 个数，选出一些使和 $\le T$ 且最大）：先随意贪心选，问题转化为有正数和负数的情况，且剩余容量 $&amp;lt;W$。这时存在一个容易 dp 的生成方式且可以保证时刻和 $\in (-W,+W)$：$f_{i,j,k}$ 表示考虑前 $i$ 个正的，前 $j$ 个负的，能否达到和 $k$。易做到 $\mathrm{O}(n^2W/w)$。考虑使用判定性转最优化技巧，$g_{j,k}$ 表示前 $j$ 个负的，和为 $k$，最小要考虑前几个正的可以达到。看似选正的转移需要再 1D，但实际上对于固定的 $k$，选第 $i$ 个正的只需要在最小的 $j$ 满足 $g_{j,k}&amp;lt;i$ 处转移即可。也可以理解为 $f$ 按 $k$ 切片，每片的 $1$ 都是右下一个阶梯形的部分，而转移只需使用阶梯的“边界”部分即可。$\mathrm{O}(nW)$。&lt;/li&gt;
&lt;li&gt;（物品）（有 $a_i$ 个数 $i$，$\lvert i\rvert\le W\le 300$，选出尽量多的数使和为 $T$）：如果只需和 $\le T$，那么选上所有负的再贪心选正的即可（也可以从性价比角度理解，但由于所有物品价值均为 $1$，故依次选直接就是最优解）。要求 $=T$ 时，仍然考虑使得和与 $T$ 尽量接近且与最优解相差较小，于是推广贪心：在不超过 $T$ 的前提下，把能选的正的选完后如果还不够 $T$，再贪心撤回负的（可以理解成也是符合性价比原则）。这时即可同理证明贪心解与最优解相差不超过 $2W$ 个元素，可以 $\mathrm{O}(W^3)$ 多重背包。&lt;/li&gt;
&lt;li&gt;[THUPC 2023 初赛] 背包：设 $(v_0,c_0)$ 为性价比最高的物品。有了之前的结论，显然最优解一定塞了一堆该物品，因此只需关心 $V\bmod v_0$，或者说，问题可以转化为，对于 $i\in[0,v_0)$，可以随意选物品，其中性价比最高的物品可以选负数个，最优的答案。看起来就是个同余最短路。枚举每种物品，图可以拆成若干个环，对于一个环，易证依次松弛松两圈就够了，那就是 $\mathrm{O}(nv_0)$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;状压&#34;&gt;状压
&lt;/h3&gt;&lt;p&gt;状压 dp 的难点主要在两块：刻画生成过程和优化。前者没有固定方法（详见通用解题方法），后者有几个经典技巧。&lt;/p&gt;
&lt;p&gt;第一个单独的技巧类似 meet-in-the-middle。如果转移时要考虑两个数之间的某个位运算，可以两者分别枚举一半。例子是 CSP-S 2020 初赛的最后一题。&lt;/p&gt;
&lt;p&gt;其余的技巧都和位运算卷积有关，这里有几个经典的转移形式（$\sqcup$ 表示不交并）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$g_i=\sum_{j\sqcup k=i}f_jg_k$：这个是经典的半在线子集卷积，写成集合幂级数就是 $(1-f)^{-1}$。可以直接套用普通子集卷积的变换，然后每一位的占位多项式进行半在线卷积。仍然是 $\mathrm{O}(n^22^n)$。&lt;/li&gt;
&lt;li&gt;$g_i=T_i\left(\sum_{j\sqcup k=i}f_jg_k\right)$：也就是 [WC2018] 州区划分。这时可以按照 $\lvert i\rvert$ 从小到大处理（同样 popcount 的内部的 $i$ 互不影响）。也就是逐一确定所有位的占位多项式的某一项的系数。每次要先 IFMT 再 FMT，仍然是 $\mathrm{O}(n^22^n)$。&lt;/li&gt;
&lt;li&gt;$g_i=\sum_{j\sqcup k=i,h(j)=h(i)}f_jg_k$：也就是 USACO22FEBGoldT1。这里 $h(j)=h(i)$ 意思是 $j$ 的最高位和 $i$ 的最高位要相同。可以理解成全集的无序划分，因此写成集合幂级数就是 $\mathrm{e}^f$，因此可以直接对每一位的占位多项式求 $\exp$。第二种是按 $h(i)$ 从小到大处理，每次是一个子集卷积，时间复杂度也是 $\mathrm{O}\left(\sum t^22^t\right)=\mathrm{O}(n^22^n)$。&lt;/li&gt;
&lt;li&gt;$g_i=T_i\left(\sum_{j\subset i}g_j\right)$：也就是 USACO23FEBPlatinumT2。一种直观的思路是按最高位 01 分治，同时维护子集和数组。求完左边后更新右边，求完右边后更新子集和。另一种更加本质的思路是，考虑如何外层从小到大循环下标，求出子集和。为了防止计重，对于下标 $i$，考虑贡献它的 $j$ 与它最高的不同的位。那所求的就是形如 $s_{i,k}$ 表示第 $k$ 位及以上与 $i$ 相同，低于 $k$ 位的部分是 $i$ 的子集的所有 $j$ 的 $g_j$。这两种都可以 $\mathrm{O}(n2^n)$，它们本质上是相同的（第一种将第二种的子集和数组压缩成一维了）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一个小技巧是多次位运算卷积可以把 DFT 过的数组放着，最后再 IDFT 回来，能省个 $n$。另外，$(\max,+)$ 位运算卷积应该只能做到 $\mathrm{O}(3^n)$，可以用 Karatsuba 的思路。&lt;/p&gt;
&lt;p&gt;进一步的扩展详见&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/your-alpha1022/qian-tan-ji-ge-mi-ji-shuo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;浅谈集合幂级数&lt;/a&gt;和 EI 的 21 年集训队论文。&lt;/p&gt;
&lt;p&gt;关于 DFT 和类 Karatsuba 算法的设计详见 LCA 的 18 年集训队论文、梁晏成的 18 年集训队论文、hehezhou 的 22 年集训队论文。&lt;/p&gt;
&lt;h4 id=&#34;例-4&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;[UCup2Stage4] I. Interval Addition：问题可以转化成将和为 $0$ 的数划分成尽量多的集合，使每个集合和均为 $0$。令 $t_i$ 表示集合 $i$ 内的和是否为 $0$，初步来看转移为 $f_i=\max_{j\sqcup k=i}\set{t_j(f_k+1)}$，是一个无法处理的半在线 $\max$ 子集卷积，但由于 $f_i$ 也只有在 $t_i=1$ 时有效，结合相关性质，可以直接化成 $f_i=\max_{j\subset i}\set{f_j}+t_i$，$\mathrm{O}(n2^n)$ 解决。&lt;/li&gt;
&lt;li&gt;[互测 2022] 整数：每一轮转移，相当于 dp 数组和允许选数的桶数组的一个复杂位运算卷积，且每一位的位运算不同，这取决于每个 $a_i$ 当前位的值。有两种运算，如果某个 $a_i$ 当前位为 $0$，那么桶数组这一位作后缀和即可转化为点积，否则相当于一个 and 卷积。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;概率--期望&#34;&gt;概率 &amp;amp; 期望
&lt;/h3&gt;&lt;p&gt;概率或期望 dp 有一个很经典的困惑是，为什么设计 dp 状态必须是“当前状态到达终止状态”的概率或期望，而不能是“从初始状态到当前状态”？&lt;/p&gt;
&lt;p&gt;这个问题的根源在于没有澄清 dp 的对象，而普通的计数 dp 是可以设计“从初始状态到当前状态”的 dp 含义的，这就导致初学者会习惯性地类推到概率或期望 dp，但这时转移是要乘概率的，这会导致转移意义与状态意义不符。&lt;/p&gt;
&lt;p&gt;首先，基于的模型仍然是 dfa，只不过转移边上带了个概率，dp 的本质还是统计所有路径。**先假定 dfa 无环。**概率 dp 如果设计“从初始状态到当前状态”其实是对的（设为 $f_i$），但是期望 dp 会有歧义：例如，设 $g_i$ 表示到达状态 $i$ 的期望步数，问题是初始状态可能不经过 $i$ 就到达终止状态。那 $g_i$ 到底表示的是一个条件期望（已知到达 $i$，这时期望的步数），还是前者乘上到达 $i$ 的概率（即所有初始状态到 $i$ 的路径的【长度乘概率积】的和）呢？&lt;/p&gt;
&lt;p&gt;设某个前驱状态为 $j$。如果 $g_i$ 是前者，那么 $j\to i$ 转移不应乘这条边的概率（记为 $p_{j,i}$），而应该乘”$j\to i$ 在所有转移到 $i$ 的情况中占的比例，即 $P(是j\to i\mid 到了i)$“，而这个玩意只能由 $\dfrac{f_jp_{j,i}}{f_i}=\dfrac{f_jp_{j,i}}{\sum_k f_kp_{k,i}}$ 得到。如果 $g_i$ 是后者，那么转移加的常数就不是 $1$，而是 $f_i$。也就是说，无论如何都要同时计算 $f$。&lt;/p&gt;
&lt;p&gt;dfa 有环时，尽管转移类似，但是由于可能会多次到达状态 $i$，故状态的原定义出现歧义，只能改成”所有以当前状态为终点的路径的概率积和或期望和“（路径可能有无限条，但只需和收敛即可），而这个东西没有好的组合意义（甚至在概率 dp 里这个概率和可能 $&amp;gt;1$），就更难思考了。&lt;/p&gt;
&lt;p&gt;总之，硬要这样设计也不是不行，但如果设计成“当前状态到达终止状态”就可以避免这些问题，从而比较简洁地直接转移。这主要是因为除了不合法情况外一定会到终止状态且立即终止&lt;del&gt;（废话）&lt;/del&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;关于概率或期望 dp 的技巧很少，有一个是某些计数问题题可以通过转成求概率或期望来简化转移公式，例如排列部分例 1~3。例 1&amp;amp;2 的换元形式的组合意义就是概率 dp，例 3 这类对于某些满足条件的结构的某个量计数的题，直接 dp 需要记方案数和总和，如果化成期望 dp，这个方案数就直接变成恒为 $1$ 的概率了，就只需记一个。另外一个好处是可以忽略结构中对状态没有影响的元素，直接找下一个有用的元素。&lt;/p&gt;
&lt;p&gt;期望 dp 的一个推广是&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/TinyWong/p/12887591.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;鞅的停时定理的应用&lt;/a&gt;，主要用于计算多结构集合和多终止状态的随机过程的期望步数。这里就不深入了。&lt;/p&gt;
&lt;h4 id=&#34;例-5&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1392H：（解 1）令一轮表示两次打乱间的所有操作。$f_{i,j}$ 表示剩余 $i$ 种牌没抽中过，当前轮还剩 $j$ 张牌，期望的剩余抽牌次数，转移很简单。题解区有些神仙直接通过这个利用待定系数法推出了正解。&lt;/p&gt;
&lt;p&gt;（解 2）$f_i$ 表示剩余 $i$ 种牌没抽中过（当前在轮与轮之间），期望的剩余抽牌次数。这个玩意相当于解 1 的断点转移形式，可以经过数小时的推导，利用组合恒等式和换元得到正确的线性公式。&lt;/p&gt;
&lt;p&gt;（解 3）涉及到处理期望的技巧：
$$
E[抽牌数]=\sum_{i}P(轮数\ge i)E[第i轮抽牌数\mid轮数\ge i]=E[轮数]E[单轮抽牌数]
$$&lt;/p&gt;
&lt;p&gt;注：这个东西不大符合直觉的原因是，如果恰好在第 $i$ 轮终止，那么这轮的期望抽牌数确实不是不带任何条件时的期望单轮抽牌数。但是这里是轮数 $\ge i$，也就是说只要进入了第 $i$ 轮就算进，也就是第 $i$ 轮的所有情况都是等概率的。或者也可以从树状图的角度理解。&lt;/p&gt;
&lt;p&gt;其中 $E[单轮抽牌数]=n\cdot P(某张牌在所有\text{joker}之前)+1=n/(m+1)+1$。$E[轮数]$ 的计算有两种简单的思路：一是 min-max 容斥：
$$
\begin{aligned}
E[轮数]&amp;amp;=E[\max_{i=1}^n\set{首抽i号牌的轮数}]\\
&amp;amp;=\sum_{i=1}^n(-1)^{i+1}\binom niE[首抽某i张牌中至少一张的轮数]\\
&amp;amp;=\sum_{i=1}^n(-1)^{i+1}\binom ni\frac{1}{P(某i张牌中至少一张在所有\text{joker}之前)}\\
&amp;amp;=\sum_{i=1}^n(-1)^{i+1}\binom ni\frac{m+i}{i}
\end{aligned}
$$
二是令 $f_i$ 表示剩余 $i$ 种牌没抽中过（当前在轮与轮之间），期望的剩余轮数。这里就可以用上忽略无关牌的技巧了，也就是当前抽牌只可能是未抽中的或 joker，并且抽中非 joker 后可以当场把它忽略，即 $f_i=\frac{i}{m+i}f_{i-1}+\frac{m}{m+i}(f_i+1)$，解得 $f_n=1+mH(n)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1823F：（解 1）$u\ne t$ 时 $f_u=[u=s]+\sum_{v\mid(u,v)\in E}[v\ne t]f_v/d_v$，于是以 $s$ 为根每个点的 $f_u$ 可表示为 $a\cdot f_{fa_u}+b$，然后再 dfs 一遍即可。不过这会有求 $0$ 的逆元之嫌。官方题解直接把 $f$ 的公式解出来了，我也是很被震撼。&lt;/p&gt;
&lt;p&gt;（解 2）（&lt;a class=&#34;link&#34; href=&#34;https://changna.blog.luogu.org/solution-cf1823f&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;来源&lt;/a&gt;）令 $f_e$ 表示经过有向边 $e$ 的期望次数（$e$ 的反向边记作 $\overline e$），对于 $s\rightsquigarrow t$ 上的正向边，$f_e=f_{\overline e}+1$，不在该路径上的边 $f_e=f_{\overline e}$，另外一个点的所有出边的 $f$ 相等，递推即可。这个做法洞察到了更有效的数量关系。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1437F：先排序。为了更好地理解计数转概率的优点，这里给出这题的四种 dp 方式。记 $#_I$ 表示大小在区间 $I$ 内的 $a_i$ 数量。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;$f_i$ 表示从后往前确定，当前在 $a_i$，$&amp;gt;a_i/2$ 的部分的方案数。这里使用插入法，枚举下一个峰值 $a_j$，将 $(a_i/2,a_j/2]$ 部分加入 $a_j$ 后面：
$$
f_i=\sum_{a_j\ge 2a_i}f_j\cdot(\#_{(a_i/2,+\infin)}-1)^{\underline{\#
_{(a_i/2,a_j/2]}-1}}
$$
令 $g_i=f_i/\#_{(a_i/2,+\infin)}$ 即可后缀和优化。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$g_i$ 表示剩余 $&amp;gt;a_i/2$ 部分待确定，当前结尾为 $a_i$，合法的概率。枚举在只考虑 $&amp;gt;a_i/2$ 部分时，$a_i$ 后面一个数 $a_j$，$(a_i/2,a_j/2]$ 必须在 $a_j$ 后面，相当于 $a_j$ 是剩余部分开头：
$$
g_i=\sum_{a_j\ge 2a_i}\frac{g_j}{\#_{(a_i/2,+\infin)}-1}
$$
这个 $g$ 就是 1 中的 $g$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$f_i$ 表示从前往后确定，当前在 $a_i$，$\le a_i/2$ 的部分的方案数。这里使用预定法，枚举上一个峰值 $a_j$，第一个空位放 $a_i$，后面加入 $(a_j/2,a_i/2]$ 部分：
$$
f_i=\sum_{2a_j\le a_i}f_j\cdot(\#_{(a_j/2,+\infin)}-2)^{\underline{\#_{(a_j/2,a_i/2]}-1}}
$$
令 $g_i=f_i\cdot\#_{(a_i/2,+\infin)}!$ 即可前缀和优化。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$g_i$ 表示剩余 $\le a_i/2$ 部分待确定，当前开头为 $a_i$，合法的概率。枚举上一个峰值 $a_j$，$(a_j/2,a_i/2]$ 必须在 $a_i$ 后面，相当于 $(a_i/2,+\infin)$ 已确定并以 $a_i$ 为开头，现在和未确定的 $(a_j/2,a_i/2]$ 部分混合，要求开头是 $a_j$，并且第二个是 $a_j$：
$$
g_i=\sum_{2a_j\le a_i}g_j\cdot\frac{\#_{(a_i/2,+\infin)}}{\#_{(a_j/2,+\infin)}^{\underline{2}}}
$$
这个 $g$ 就是 3 中的 $g$。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[THUPC 2023 初赛] 公平合作：这题很好地说明了，概率 dp 两种状态定义方式其实是通的。设先手倒入 $x$，后手倒入 $y$， $m=\max a_i$，那么 $x,y&amp;gt;L-m$，目的是求每种可能的 $x$，后手的最优胜率 $f_x$。&lt;/p&gt;
&lt;p&gt;（解 1）按一般的思路，$g_i$ 表示先手目前倒了 $i$ 时的最优胜率，则 $g_i=\max\left(1-f_i,\sum_jg_{i+a_j}/n\right)$。对于 $i\le L-m$，一定取后者，是一个线性递推。对于每个 $i$ 求 $f_i$，后手策略一定是 $y\le i$ 时继续随机，$y&amp;gt;i$ 时停止，因此仍然是个线性递推。这些递推（包括 $g$）的公式均相同，待求远处项位置也相近（至多差 $m$），只是初值不同，因此利用倍增求线性递推数列一项的技巧，可以 $m^2\log L$ 求得一个，然后 $m^2$ 推出其他。&lt;/p&gt;
&lt;p&gt;（解 2）计算某个 $f_i$ 是一个单起点多终点的 DAG 上游走问题，官解是令 $f^\prime _{i,j}$ 表示从 $x=i$ 时，后手从 $0$ 开始，最终停在 $j&amp;gt;i$ 的概率（必须是在 $&amp;gt;i$ 是最先到 $j$，否则会计重）。$f^\prime _{i}\to f^\prime _{i+1}$ 就转移一下 $f^\prime _{i,i+1}$ 即可，计算 $f^\prime _{L-m}$ 也可以线性递推。计算答案时也是考虑 $x$ 最终到几，$ans=\sum_{i&amp;gt;L-m}f^\prime_{L-m,i}g_i$。这个思路初看不大自然，但它其实就是正着定义状态的版本。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;数位&#34;&gt;数位
&lt;/h3&gt;&lt;p&gt;一般的数位 dp 无非就是在进位和压上界的处理上变个形，没什么可多说。&lt;/p&gt;
&lt;p&gt;关于全体 ${}+x$ 的最优化问题（例如 CF778E、ARC153D），考虑逐位 dp，记录进位的分界线。如果当前确定的是低 $i$ 位，那一定是所有数按低 $i$ 位排序后的一个后缀进位。转移时先基数排序，再枚举进位分解，得到下一位每种数占的区间，再枚举下一位。&lt;/p&gt;
&lt;p&gt;另一个值得注意的模型是，考虑函数 $f(S)=\set{\lfloor x/2\rfloor,\lceil x/2\rceil\mid x\in S}$，那么 $f^{(i)}(\set{x})$ 的大小至多为 $2$。这是因为 $\lfloor\lfloor x/a\rfloor/b\rfloor=\lfloor x/(ab)\rfloor$，故 $f^{(i)}(\set{x})=\set{\lfloor x/2^i\rfloor,\lceil x/2^i\rceil}$。如果考虑的是可重集合，那么 $f^{(i)}(\set{x})$ 中恰有 $2^i-x\bmod 2^i$ 个 $\lfloor x/2^i\rfloor$。这可以通过 $\lceil x/2\rceil=\lfloor (x+1)/2\rfloor$ 推得。&lt;/p&gt;
&lt;h4 id=&#34;例-6&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1815D：$m\ge 3$ 时显然可取到所有 $\le n$ 且与 $n$ 奇偶性相同的数。$m=2$ 时考虑逐位 dp。如果 $n$ 最低位为 $1$，那么只有一种转移，否则可能两个数最低位均取 $0/1$，且由于这两种情况下剩余部分 $n$ 的奇偶性不同，故可取得的异或值一定不交，因此转移形如 $f_n=f_{n/2}+f_{n/2-1}$。无论如何，有效状态至多 $2\log_2 n$ 个。可以用 map，也可以将状态理解成是否进位，开一维 $0/1$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AGC064C：暴力是把二进制表示倒过来建 trie 树，$f_u=f_{{ls}_u}\operatorname{nand}f_{{rs}_u}$。建树的过程是如果当前要插入 $[l,r]$，就往左子树插入 $[\lceil l/2\rceil,\lfloor r/2\rfloor]$，往右子树插入 $[\lceil(l-1)/2\rceil,\lfloor(r-1)/2\rfloor]$，这立即启发我考虑，同一层内的不同构的子树数量少。确实是这样的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/dp-problems/dp/zely9825.png&#34;
	width=&#34;1789&#34;
	height=&#34;541&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;330&#34;
		data-flex-basis=&#34;793px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;这是 $[11,21]$ 的 trie 树，发现每一层至多 $3$ 种子树。进一步地，对于第 $i$ 层（从 $0$ 开始）的 $x$ 号（编号定义为从根到它的路径的 01 序列反过来对应的二进制数）节点，$[l,r]$ 在它上面生成的子树为 $\left[\lceil(l-x)/2^i\rceil,\lfloor(r-x)/2^i\rfloor\right]$，也就是会将 $x$ 可以取的 $[0,2^i)$ 切成至多三段。那么 $n$ 个区间至多切 $2n+1$ 段。总体来说，逐层枚举，使用基数排序和指针扫描可以做到一个 $\log$。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;树形&#34;&gt;树形
&lt;/h3&gt;&lt;p&gt;树形 dp 的套路基本上已经出烂了，可参考任轩笛的 18 年集训队论文和张哲宇的 19 年集训队论文。&lt;/p&gt;
&lt;p&gt;设计思路上基本就是考虑加一条边和合并两个儿子，把状态和转移定出来。比较初级的技巧包括换根 dp、多儿子选择时的反悔技巧、树上背包。其中树上背包如果强制大小与 $k$ 取 $\min$ 的话时间是 $\mathrm{O}(nk)$ 的，证明见下。&lt;/p&gt;
&lt;p&gt;还有一种 dp 方式是在 dfs 序上跳。&lt;/p&gt;
&lt;h4 id=&#34;例-7&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;CF1097G：考虑 $\lvert E\rvert^k$ 等于选出虚树中边的有序可重 $k$ 元组数量，这就可以树上背包，合并用组合数。对于底部选出的边，子树里至少选一个；如果有一条最顶部的边，那外部至少选一个。稍加讨论即可。$\mathrm{O}(nk)$ 的证明可以考虑模仿一种树分块：子树 $siz\le k$ 的点称为小点，剩余称为大点。每个极大的小点子树都是 $\mathrm{O}(siz^2)$，由均值不等式至多 $\mathrm{O}(nk)$。小点顶部转移给大点是 $\mathrm{O}(siz\cdot k)$，共 $\mathrm{O}(nk)$。大点之间，两个大点合并为 $\mathrm{O}(k^2)$，合并共发生 $\mathrm{O}(n/k)$ 次，也是 $\mathrm{O}(nk)$。&lt;/li&gt;
&lt;li&gt;[APIO2021] 封闭道路=CF1119F：由于 $\sum_k\sum_u[deg_u\ge k]=\sum_udeg_u=n$，故可以暴力做。对于一个点，有一些 $deg\ge k$ 的儿子，还有一些其他边。使用反悔技巧，断儿子的代价为 $f_{v,1}-f_{v,0}$。这些其他边不能全部排序，必须只取最小的 $deg_u-k$ 个来归并，从大到小枚举 $k$，用链表维护即可。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. CF868E&lt;/p&gt;
&lt;h3 id=&#34;区间&#34;&gt;区间
&lt;/h3&gt;&lt;p&gt;这部分不是指区间 dp，而是某些给定若干区间然后选的问题。这类问题较罕见，我尚未总结出较好的技巧，几个初步的处理方式是按某个端点排序，以及处理掉一些区间使得左右端点同时递增或只有包含和相离情况，典型的例子（非 dp 题）分别是 CF1774G 和 CF319E。&lt;/p&gt;
&lt;h4 id=&#34;例-8&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1832F：对于一个人工区间，所有可能的自动区间与它配合导致的失守时间是一个斜率一次为 $1,0,-1$ 的分段函数，因此原问题是按 $(l_i+r_i)/2$ 排序后分段贡献，这就将二维化成一维，更好处理了。求一段共用一个自动区间的最优解是容易平方的，因为代价是凸的，离散化一下走指针即可。剩下的就是四边形不等式的形式 2，证一下四边形不等式即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1250D：称不高兴的科学家为全同区间，容易发现全同区间形成一些内部同色的不交段。考虑按右端点排序后 dp，那致命的问题是在一个区间后面的区间可能包含它，无法确定后者是否全同。按左端点排序则能避免这个问题，状态只能记目前最后一个全同区间（否则也会信息爆炸），我们将会看到这个状态的隐含条件（与当前区间相交的区间均与它同色）十分重要。记区间为 $I_{1\cdots n}$。若 $I_{i+1}\subseteq I_i$，则继续往后看，注意不能转移到 $i+1$，否则会丢隐含信息。若走到了一个不是包含但有交的 $I_j$，如果决策它也是全同，那就无虑地转移过去；如果不这样决策，就继续扫，直到不交，后面就任选一个开启新的全同段。这个是 2D/1D 的，我感觉可以再优化，但不会。&lt;/p&gt;
&lt;p&gt;像这种区间问题就感觉很奇怪，一个合理的状态能给出极好的无关性。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;数学方法&#34;&gt;数学方法
&lt;/h3&gt;&lt;p&gt;GF 相关详见&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/command-block/sheng-cheng-han-shuo-za-tan&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;这里讲些题外话。一些具体的数学处理方法详见下一章。&lt;/p&gt;
&lt;p&gt;我们无法找到一个通用的方法，判断解一道（计数）题设计 dp 和直接推式子孰优孰劣。推式子往往需要更透彻的对模型的分析（从而转化成能只用乘法原理描述的结构），但可以利用各种数学工具得到不依赖于组合意义的、更本质的解法，因此我们往往发现推式子后复杂度更优，例如 USACO21DECPlatinumT3，以及一些经典递推序列的通项等等。但情况也不全是这样，例如 [联合省选 2023] 染色数组 的第一问有一个 $\mathrm{O}(nm^2)$ 的 dp，但推式子（应该？）只能做到 $\mathrm{O}(n^3m)$。这两者的分界到底是什么？这是一个让我很困惑的问题。&lt;/p&gt;
&lt;p&gt;在 dp 题中，数学方法往往用于引导一些难以赋予组合意义的优化，例如 GF 等等。一些可以机械化的优化包括：矩乘相关（行列式、特征多项式、对角化等）、常系数线性递推、整式递推（详见 zzq 的 19 年集训队论文）。&lt;/p&gt;
&lt;p&gt;一维的递推数列已经基本上能解决了，但是二维的我目前找到&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/NaCly-Fish-blog/treasure-another-solution&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/664378069&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇&lt;/a&gt;，或许依次处理两个方向即可？&lt;del&gt;那&lt;a class=&#34;link&#34; href=&#34;https://qoj.ac/contest/1457/problem/7981&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;我的互测题&lt;/a&gt;能否代数推导保平安呢？能否线性呢？&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;另外一个方向是，常系数线性递推的快速幂+多项式取模方法意味着 $P(x)/Q(x)$ 的远处项可以快速求，于是可导出 $\ln P(x)$ 的远处项也可以快速求。整式递推的点值平移方法给出了一类生成函数的远处项的根号做法。那其他的特殊情况的远处项呢？例如 $\sqrt{P(x)}$ 和 $\mathrm{e}^{P(x)}$？&lt;del&gt;是不是扯得太远了……&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;如果您对这些方面有了解，请不吝赐教。&lt;/p&gt;
&lt;h2 id=&#34;通用的解题方法&#34;&gt;通用的解题方法
&lt;/h2&gt;&lt;p&gt;思考一道 dp 题的过程可以归纳为如下四步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;分析模型性质，简化模型，揭开模型“真面目”；&lt;/li&gt;
&lt;li&gt;处理模型，找到可以用 dp 解决的对象；&lt;/li&gt;
&lt;li&gt;明确转化后的问题，设计 dp 方式；&lt;/li&gt;
&lt;li&gt;优化 dp。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中相邻两步之间没有明确的分界。同时思考过程并不一定是依次做这四个步骤就行了，可能在第四步时会返回到前三步，重新分析组合意义，反复寻找更优的 dp 方式。&lt;/p&gt;
&lt;p&gt;接下来就逐个讲解。&lt;/p&gt;
&lt;h3 id=&#34;第一步-分析性质&#34;&gt;第一步 分析性质
&lt;/h3&gt;&lt;p&gt;与其说这是 dp 的第一步，不如说所有题第一步都要做类似的工作。这一步主要是在不主动改变或加强模型的情况下，分析模型的性质，从而转化模型，使其更容易被把握。&lt;/p&gt;
&lt;p&gt;第一、二步的核心都是减少总体（静态）的模型可能性，区别在于，第一步是基于题目条件作有充分性的推导，明确在题目条件下未知部分的哪些情况是可能的，如何用更简单的命题描述；而第二步的目的性更强，会为了使结构能被 dp，更加激进地主动转化模型，改变原有的模型结构和要素组织方式，寻找一个具体的刻画，组织所有可能的解。&lt;/p&gt;
&lt;p&gt;这一步和贪心或无算法题的分析过程较类似，具体技巧千变万化，这里就简单讲一下基本的方法。&lt;/p&gt;
&lt;p&gt;在这一步中，主要思考以下内容：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;寻找可以直接从题目条件导出，或与题目条件等价的条件；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;模拟（包括打表）小样例、特殊样例找到简化的方向和规律；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;想象某个最终解，利用（广义的）调整法排除可能性，即“具有这样特征的解一定包含最优解”。更具体的技巧可以参考&lt;a class=&#34;link&#34; href=&#34;http://cs.williams.edu/~shikha/teaching/spring20/cs256/handouts/Guide_to_Greedy_Algorithms.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;。这个思考主要用于最优化，但是其他类型的模型如果条件较复杂，交织在一起，也可以通过想象解，并调整或排除使之切合题目条件，得到对解的结构的&lt;strong&gt;直观&lt;/strong&gt;认知。画非具体样例式的模型图是很有用的。&lt;/p&gt;
&lt;p&gt;另外，如果解是一个过程，有时倒推一些必要的东西会比较容易。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;联想一些与题目条件相关或类似的模型，尝试套用。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体来说，主要会得到以下两类观察：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;条件或模型的等价但更适合处理的转述。有的题有着非常晦涩的条件，通过分析或换角度描述，可以使它更容易处理。&lt;/li&gt;
&lt;li&gt;结构、情况、过程的简化。这种简化不仅仅包含贪心性或排除性的简化，也包含对模型更深入的理解，将结构更明确、更简单地描述出来。&lt;del&gt;算了比较难描述，还是看一些具体例子吧……&lt;/del&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;例-9&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[联合省选 2023] 染色数组：这题显然要将“划分成增减序列至少有两种方案”转化成更直观的条件，然后再 dp 或推式子。转化的分析详见&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/problem/solution/P9171&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;题解区&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOI2016] 国王饮水记：如果任选子集，那完全无法处理。考虑挖掘性质：① $h_1$ 一定递增；每次选一定包含 $h_1$；除 $h_1$ 以外，其他的一定至多选一次；② 每次选的 $h$ 中 $\max$ 一定 $\le$ 下一次选的 $h$ 中 $\min$；③ 将 $h_{2\cdots n}$ 排序，每次一定选连续一段，且相邻两次选的之间一定无空隙，且最后一次一定选到末尾。这样分析完之后 dp 自然就出来了。后面进一步的除决策单调性以外的优化其实也是基于对原问题模型的分析（长度不为 $1$ 的区间很少）。&lt;/p&gt;
&lt;p&gt;注：① 得三个子性质一起归纳，每次调整最后一个不满足性质的，不然是无法严谨证明的；②③ 可以直接反证法+调整。参考官方题解。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1368H1：题目是以最大流的语言给出的，但如果只从最大流或最小割的角度来看是无法简化结构的，必须要考虑对偶图最短路——参考 [CSP-S 2021] 交通规划，模型等价于所有红蓝交替处作为端点，两两匹配（奇偶性必须不同）求最短路之和。本题中 $n,m$ 很大，但由于边权都是 $1$，故只需保证路径长等于曼哈顿距离即可。可以将矩形邻边上的匹配贴到边界上，对边上的匹配拉直（只会有一组对边上匹配），简化了结构。但这样的匹配还无法 dp，必须将该性质用最小割的语言描述——每行或每列颜色均相同，然后即可线性 dp。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题是非常典型的不断转化等价模型并观察，从而找到突破性质的题。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF906C：注意到选的点集导出子图一定是连通的（否则选的点之间会无边），同时易证选这个操作其实是无序的。这两个观察使模型清晰了很多。问题就转化成选一些连通的点使得它们的邻点并集包含所有未选点。按 bfs 的顺序状压 dp 即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1503E：考虑蓝色的区间从上到下的移动情况，如果相邻两行不交则称为“断”。发现至多断一次，即蓝色形成 $1/2$ 个连通块，否则一列中的黄色会被割裂。如果是两个连通块，则一定分别是单峰的，否则黄色部分一定是两个单峰的连通块。这题可以直接推式子算。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;USACO22DECGoldT1：想象最终选的朋友，发现 $B$ 一定花给这些朋友按 $X$ 排序后的前缀。于是按 $X$ 排序后背包，一定是先花 $B$ 再花 $A$，三维 dp 转成两个两维 dp。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;第二步-处理模型&#34;&gt;第二步 处理模型
&lt;/h3&gt;&lt;p&gt;（第一、二步往往是连续进行的，尤其是一些没有固定形式的转化和抽象过程，很难说清属于哪一步。）&lt;/p&gt;
&lt;p&gt;这一步中应当完成对静态模型的处理，将其彻底转化成可以 dp 的模型，并用更本质的语言去描述它，用更有效的角度去看待它，并在最后进行汇总。注意，这里的“静态”是与第三步的 dp 生成过程（局部）形成对照，并不是说模型本身必须是静态的，而是从一个整体的角度看待模型。&lt;/p&gt;
&lt;p&gt;您可能还不是很明白。可以类比推式子题来理解——当我拿到一个计数模型，一般不能直接写出式子，而是要考虑：要先转化等价模型吗？是否要套容斥或反演？该对模型的哪个部分计数，这些部分如何组织？枚举什么量，枚举顺序如何？等等。这些问题的答案共同构成了处理一个模型的具体思路，然后再写式子。&lt;/p&gt;
&lt;p&gt;要寻找处理模型的方法，固然对于某些有特定特征的题可以套用一些转化技巧，接下来也会讲；这里我先提出一个通用的思考方法：考虑模型的“要素”。要素，一般是模型结构的组成部分、相关量或维度。一个模型包含多个要素，要素之间的关系就是题目条件和描述，以及导出的性质。通过改变（增删、合并、拆分、等价转述）要素，调整这些要素的主次关系、自变量与因变量关系（包括无关、守恒等特殊关系）、组织顺序（例如有两个维度，先看哪个，或者时光倒流等）、枚举顺序等，得到一个新的看待模型的方式。在新的模型描述下，所有解应与原模型的所有解形成一个映射（双射）。至于如何判断转化是否有用，那就还是从信息量（不确定性）的角度考虑。&lt;/p&gt;
&lt;p&gt;一个最简单的例子就是上文中排列部分前两题，原模型是一个排列，但排列中各个元素的效果不同。现在只关心其贪心单调子序列这一部分要素，剩余部分通过组合数，也就是数学方法消除掉。&lt;/p&gt;
&lt;h4 id=&#34;例-10&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[CSP-J 2019] 纪念品：这题的关键在于拆分“纪念品的持有时间区间”这一要素，将它拆成相邻两天之间是否买进卖出，这样各天之间的决策就无关了，逐天背包即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1580D：这题难处理的是一堆区间 $\min$ 这个东西，考虑搬到笛卡尔树上，全局 $\min$ 的贡献就变成了左右选的数量之积，往下递归形式是一样的，dp 状态自然就出来了，树上背包即可。这题就是寻找一个更好的结构，转述要素（注意和第一步中的套用模型是不同的，这里考虑笛卡尔树不是为了进一步发掘性质，而是直接尝试 dp 了）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AGC056E：先固定没吃的老鼠。从时间维看该过程是没法多项式时间的。考虑一起看所有奶酪的轨迹（轨迹包含投掷初始位，多次尝试被吃和最终被吃三个部分），注意到如果有多块奶酪经过一只老鼠，它们后续的轨迹之间是可以交换的，也就是说只需保证同一块奶酪按顺序依次尝试被吃即可，多块奶酪之间的尝试是无序的，因此就可以从下标维来看轨迹，dp 记录当前已确定的奶酪数 $x$，每次以 $1-1/2^x$ 的概率吃。然后问题就在于它这个过程是无限的，但是只要所有奶酪确定了，就可以用数学方法算剩下的无限圈了。&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/174304/solution-at-agc056-e&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;题解区第一篇&lt;/a&gt;的考虑方法很有意思，再将问题转化回逐个奶酪移动，这样概率就变成了一个乘积式。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1842H：初始的题目模型无法处理，考虑将所有 $x_i$ 减 $0.5$ 后转化成一堆 $x_i\;\boxed{&amp;lt;/&amp;gt;}\;{-x_j}$ 形式的偏序关系。想象数轴上这些 $\pm x_i$ 的分布，$O$ 的两侧是对称的两半，直接 dp 一半发现得记已确定的变量和它的正负情况，那就得 $3^n$。但细看发现很多状态不合法，因为例如 $x_i+x_j&amp;lt;0$，那么 $x_i$ 与 $x_j$ 中绝对值大的一方必须 $&amp;lt;0$，因此只要按绝对值大小 dp，就只有那些最先（或最后）（相对于它所受约束的其他相关变量）确定的变量可能正负不定，但这些正负不定是无所谓的，而其他变量的正负都可以通过当前的已确定 bitmask 推得。从拓扑序角度也可以得到符合直觉的解释。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题不仅考察对模型的处理，还要求转化后不遗忘原模型的对称性质，再次回到第一步进行性质分析。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;补充一下，并不是所有对模型的处理都要进行转化，导致 dp 困难的往往是对模型的理解不够本质。所以不要急于改变要素，要先看清所有要素。&lt;/p&gt;
&lt;h4 id=&#34;例-11&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;USACO21DECPlatinumT2：显然配对端点同时递增。$T=1$ 利用扩大可行域技巧即可。$T=2$ 时，我当时执意考虑按从小到大扫一类牛的顺序 dp，这样直接做得记录当前对以及上一个（或两个）未配对牛以保证极大性，如果要避免第三维就得在出现不选时断点转移到下一个不必要考虑之前未配对牛的状态，但这样中间的讨论就炸飞了。我犯的错误是没有全局观，应当同时观察两类，这时不选的牛的品种随坐标增加在两种之间交替，且交替处间隔多余 $K$。因此得到了一个新的方案：记录当前两类待配对的下标，以及当前允许不选的品种。如果要更换品种就进行一段选满的断点转移，合法性可以预处理。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;其实可以发现，后面这种观察方式说的其实都是废话，也没有转化模型，但是若不这么考虑就是没法 dp。所以角度很重要。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1299D：首先要知道 dfs 树上所有返祖边对应环构成所有可能回路经过奇数次的边（若干不交简单环）的异或空间的一组基，相应地只考虑边权也是一样。因此可以把根伸出的各块每个视作一组异或空间。这里要将 $5$ 位异或空间及其合并运算一起视作一个交换半群（元素个数为 $374$，详见 &lt;a class=&#34;link&#34; href=&#34;https://oeis.org/A006116&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;A006116&lt;/a&gt;），再分讨根周围的块：要么与根连一条边，要么与根形成三元环，然后就做一个类似背包的东西即可。&lt;/p&gt;
&lt;p&gt;这题的关键在于把线性基合并抽象成代数运算。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;然后是一些特定的转化技巧。&lt;/p&gt;
&lt;h4 id=&#34;外套方法&#34;&gt;外套方法
&lt;/h4&gt;&lt;p&gt;这类方法直接作用于变量，主要包括枚举、二分（仅限最优化）和容斥（仅限计数）。二分主要包括二分答案和 WQS 二分（&lt;a class=&#34;link&#34; href=&#34;https://zhuanlan.zhihu.com/p/340514421&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;入门&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/yeah-potato/yan-jin-de-wqs-er-fen-fang-fa&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;进阶&lt;/a&gt;），容斥其实就是各类反演（&lt;a class=&#34;link&#34; href=&#34;https://vfleaking.blog.uoj.ac/blog/87&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;炫酷反演魔术&lt;/a&gt;，还可以参考周子衡的 23 年集训队论文），不过建议推导时不要丢掉组合意义，不然可能会漏性质或失去动机。枚举和二分答案的实质就是减少不确定性，WQS 二分和容斥的实质就是去除或弱化变量限制条件。&lt;/p&gt;
&lt;h5 id=&#34;例-12&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1784E：只考虑 $\Delta$ 表示 A 赢减 B 赢（经典套路）。这题大致的模型是，把循环节理解成一个黑盒，循环连接处只需提供少量信息即可确定整体的 $\Delta$。具体的接口抽象方式有两种：一种是考虑每个开头忽略 $0\sim 2$ 个后，结尾还需在下一次循环中取几个。这个必须要枚举开头两个字符。另一种是将比赛过程抽象成四个点的 dfa，考虑开头时的状态和结尾时的状态。&lt;/p&gt;
&lt;p&gt;这里就出问题了，将每种情况 $\Delta$ 记在状态里，势必会导致 $n$ 的较大次方（且事实上即使利用各情况的 $\Delta$ 间关系也不足以将次方缩得足够小）。而反复循环的接口处状态实际上构成基环树形态，结合题目所求，只需关注基环部分状态的 $\sum\Delta_s$。那就枚举基环所包含的状态集合，这样 dp 只用记状态之间的转移关系用于吻合枚举的情况，时间复杂度大常数 $\mathrm{O}(n^2)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[IOI2016] Aliens：可以将兴趣点转化成区间。对于不限制 $k$ 的情况，首先有一个 $\mathrm{O}(m^2)$ 的 dp，似乎不大能优化。考虑将 dp 对象转为区间（按右端点排序），或者发现只有右端点位置的 dp 值有用。列出 dp 方程发现可以四边形不等式优化或斜率优化。另有性质：答案关于 $k$ 下凸（用四边形不等式证），WQS 二分即可。细节详见&lt;a class=&#34;link&#34; href=&#34;https://ioinformatics.org/files/ioi2016solutions.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;官方题解&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1707D：直接 dp 得记每个时刻是否选真子集，爆炸了。令 $f_i$ 表示 $i$ 次内消得只剩根的，允许单次不变的方案数，$g_i$ 表示原答案，那么 $f_i=\sum_{j=1}^i\binom ijg_j\Rightarrow g_i=\sum_{j=1}^i(-1)^{i-j}\binom ijf_j$。$f$ 可以通过最自然地 dp 子树 $i$ 在 $j$ 步以内消光的方案数得到。转移时枚举根何时消去，消去后仍允许一个子树剩余。方程的主要部分形如 $f_{u,i}=\sum_{v}f_{v,i}\left(\sum_{j\le i}\prod_{w\ne v}f_{w,j}\right)$，可以前后缀积优化。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;（相互再归的鹅妈妈）：不容斥没法搞。容斥后的计数有两个思路，一个是无序（强制不降），一个是有序。无序得状压；有序可以只记压上界的数量，进一步考虑到一旦有不压上界的数就选出一个用于凑 $0$，从而用公式计算，应该可以做到 $\mathrm{O}(m)$，但是容斥起来麻烦些。一种思路是直接对于两两不相等的条件容斥，枚举钦定相等形成的等价类，设大小 $a_{1\cdots k}$，容斥系数为 $\prod f(a_i)$，$f(n)$ 表示所有 $n$ 点连通图的 $(-1)^{\lvert E\rvert}$ 之和，有 $[n=1]=\sum_{x_1+\cdots+x_m=n}n!/(m!\prod x_i!)\cdot\prod f(x_i)=[x^n/n!]\mathrm{e}^{\operatorname{EGF}(f)}$，从而 $f(n)=[x^n/n!]\ln(1+x)=(-1)^{n-1}(n-1)!$。这部分理论上可以做到 $\mathrm{O}(k\log k)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2023] Permutation Counting 2：欧拉数的和式推导可谓非常经典——钦定连续上升段，段间无法保证下降，就用二项式反演容斥：钦定 $i$ 个上升段的情况，会将恰好有 $j$ 个上升段的情况计入 $\binom{n-j}{i-j}$ 次。具体推导就不写了。那这道题这样容斥后就转化成，求 $q_{1\cdots n}$ 数量，满足 $1\le q_k\le i$，$1\sim i$ 中每个数至少出现一次，且 $q_k\le q_{k+1}$ 恰好有 $j$ 个。 “每个数都出现”这一条件可以套容斥，规定上升数可以再一次容斥，内层就变成了简单的非空不降序列。最内层的容斥可以推出一个线性的类似欧拉数的求和式，再依次进行剩余两层容斥就行，$\mathrm{O}(n^3)$。&lt;/p&gt;
&lt;p&gt;这里补充一下。个人感觉二项式反演很费脑，考试时建议把正向的式子写出来然后直接套结论（如果形式不对就换元），但平时还是尽量在脑中过一遍组合意义，还是很精妙的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. +CF663D、+CF1799G、判定型计数里的一些题、+[NOIP2018] 赛道修建、CF1322F、CF739E、CF1799F&lt;/p&gt;
&lt;h4 id=&#34;公式变形&#34;&gt;公式变形
&lt;/h4&gt;&lt;p&gt;这个就不必解释了。&lt;/p&gt;
&lt;h5 id=&#34;例-13&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF946F：（解 1）对于所有子序列，求出 $s$ 出现的次数，那实质上就是在 KMP 自动机上走，每遇到一个字符允许不走。矩乘描述即可。&lt;/p&gt;
&lt;p&gt;（解 2）考虑交换解 1 中的两个 $\sum$，对于 $F(x)$ 中所有的子序列 $s$，设开头在 $l$，结尾在 $r$，那贡献为 $2^{l-1+n-r}$。令 $f_{i,l,r}$ 表示 $s_{l\cdots r}$ 几次作为子序列出现在 $F(i)$ 中，特殊地，若 $l=1$ 或 $r=n$，就同时算上外部的 $2$ 的次幂。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF856C：数字 $x$ 可抽象为 $(x\bmod 11,\operatorname{len}(x)\bmod 2)$，方案中一个数的贡献取决于它所在数位的奇偶性，得考虑顺序，但无法直接 dp 排列。只能考虑先 dp 每个数所在位的奇偶性，然后再用数学方法算。$\operatorname{len}$ 为奇的恰好一半一半，偶的任意插空，先分开 dp，再合并。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;USACO23OPENPlatinumT1：将子序列匹配理解成自动机上走，可以得到一个矩乘表示，但是得记 $7\times 7$ 太大了。考虑抽象成一维的表示。线段树上每个节点记录：① 每种状态经过该区间后的状态；② 每种状态经过该区间且在该区间内终止的贡献；③ 每种状态经过该区间且尚未终止（走到右端点）的贡献；④ 在该区间内起始且尚未终止（走到右端点）的新增各状态数；⑤ 在该区间内起始且在该区间内终止的贡献；⑥ 在该区间内起始且尚未终止（走到右端点）的贡献。要把区间内终止和尚未终止（走到右端点）分开来记是因为往后延伸的话会贡献多次。&lt;/p&gt;
&lt;p&gt;以上是我考试时的做法，后来看题解发现可以只记四类信息：将 ② 和 ③ 合并成 $②+(n-r)\cdot ③$，⑤ 和 ⑥ 同理。为什么我写复杂了？因为我是按题意原样做的，而合并实质上是对于每一组（区间开头，一组匹配）分开看它们的贡献，出现一组匹配后后面结尾在哪是无关的，直接乘 $n-r$ 就行。&lt;strong&gt;所以说对初始模型理解的细微差别可能导致实现时复杂程度的大差距。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;USACO20OPENPlatinumT2：（解 1）考虑对于每一个 $p^k$ 计算有几个置换中包含至少一个长为 $p^k$ 倍数的环 $\bmod(M-1)$。令 $f_i$ 表示大小为 $i$ 时，有几个不包含。转移模仿第一类斯特林数：
$$
f_i=\sum_{p^k\nmid j}(i-1)^{\underline{j-1}}f_{i-j}
$$
由于模非质数故无法换元，但可以记前缀和每次乘 $(i-1)$。可以利用同余技巧，通过对 $i\bmod{p^k}$ 分组记和做到单次 $\mathrm{O}(n)$。&lt;/p&gt;
&lt;p&gt;（解 2）（&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/qwaszx/solution-p6276&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;来源&lt;/a&gt;）：钦定 $c$ 个长为 $p^k$ 倍数的环，是普通容斥，系数 $(-1)^{c-1}$。$f_i$ 表示钦定 $ip^k$ 个数（环数不记，直接压在一起）的和：
$$
f_i=-\sum_{j=1}^i\left(ip^k-1\right)^{\underline{jp^k-1}}f_{i-j}\\
ans\xleftarrow{\times}\operatorname{pow}\left(p,\sum_{i\ge 1}n^{\underline{n-ip^k}}f_i\right)
$$
总状态数是 $\mathrm{O}(n\log\log n)$ 的，可以用 ds 优化连乘。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[WC2021] 表达式求值：这类涉及大小关系的问题常考虑 $01$ 情况。数组逐位做，设当前 $a_{*,j}$ 排序成 $x_{1\cdots m}$，将其差分，答案转化成 $\sum_{i}(x_i-x_{i-1})[E([a_{1,j}\ge x_i],\cdots,[a_{m,j}\ge x_i])=1]$（这个套路也往往在算期望时用），这时所有叶子只有 $2^m$ 种分布情况，且 dp 可转移。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;判定型计数&#34;&gt;判定型计数
&lt;/h4&gt;&lt;p&gt;判定型计数问题主要指一类直接对着题目合法条件 dp 会导致同一个解被重复计入的问题（广义地说，所有计数都是判定型的，但显然这不是这里希望讨论的）。这类问题的通用处理方法有四类：转述条件（例 9&amp;amp;11）、钦定单射（例 1&amp;amp;4&amp;amp;5）、容斥（例 &lt;del&gt;4&lt;/del&gt;&amp;amp;7）、对判定过程 dp（例 2&amp;amp;3&amp;amp;6&amp;amp;8&amp;amp;10&amp;amp;12）。转述条件就是将判定条件能转化成对解本身更简单的限制，然后强制直接对解 dp。钦定单射主要指对于一个合法解的多个证书，通过规定偏序关系等方式，钦定唯一一个被计入的证书，来 dp。对判定过程 dp，如果判定过程是 dp，那就是常说的 dp 套 dp。也可能是贪心等其他算法，不一定要是 01 的判定过程。有些非判定型计数问题（不易计重，但也不易直接 dp）也会用这个技术，例子都放在这里。&lt;/p&gt;
&lt;p&gt;另外某些简单的问题可以记录一维 $0/1$ 表示是否存在至少一个达成的方案。&lt;/p&gt;
&lt;p&gt;remark. 钦定单射和容斥在论文中统称带权计数，注意两者的区别。例 4 不能理解成对计重容斥，因为并没有某组 $A/B$ 选择贡献了负数，用论文中的话来说就是没有 $w(y)&amp;lt;0$。这题的容斥只是为了保证有且仅有 $w(独立区间均选A的方案)=1$。而例 7 是实打实的容斥，这题不能把 $Y$ 看作 $1\sim n$，而必须看成 $1\sim n$ 的所有子集，不然“计同时能被多个下标满足的方案数”这个事就没法解释了。当然讲的这些在实操时没必要刻意区分。&lt;/p&gt;
&lt;h5 id=&#34;例-14&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1679F：这题虽然不是判定型的，但也易计重，用到了钦定单射的思想。考虑只对每个等价类的极小元素计数，极小元素定义为，每个数字 $d_i$ 向前看，都有一段相邻的可以交换的数（然后遇到头或一个不能交换的数），这些数都要 $\le d_i$。这个极小元素是存在且唯一的，可以借助字典序这一偏序结构证明。于是可以状压 dp，记录当前位可以取的数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1810G：这题也不是判定型，但是官解（解 2）用到了对判定过程 dp 的思想，故也放在这里。&lt;/p&gt;
&lt;p&gt;（解 1）我的思路是，考虑固定前缀和的 $\max$。$f_{i,j}$ 表示 $s_i$ 将前缀最大值刷新为 $j$ 的概率，这可以通过有限制折线的经典容斥来转移：$f_{i,j}=c_{i,j}-\sum_{k&amp;lt;i}c_{i-k,0}\cdot f_{k,j}$，其中 $c_{i,j}$ 表示 $i$ 个 $\pm 1$ 和为 $j$ 的概率。$ans_{i}=\sum_j(h_{j-1}-h_j)(1-\sum_{k\le i}f_{k,j})$，发现可以令 $g_i=\sum_j(h_{j-1}-h_j)f_{i,j}$ 将所有 $f_{i,*}$ 压缩成一个数同时仍能转移，从而变成 1D/1D。常数较大。&lt;/p&gt;
&lt;p&gt;这个方法的大致思想是，直接 dp 需要记当前的和与总的 $\max$（都会变），尝试省掉一方，那就固定 $\max$。最近又去看了一下题解区，发现&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/Ecrade/solution-cf1810g&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇题解&lt;/a&gt;虽然不是容斥，但是也同时用了“固定 $\max$”和“多个 dp 合并起来做”这两个思想，饶有趣味~~（如果您能给出对这类技巧更宏观的解释，请告诉我）~~。&lt;/p&gt;
&lt;p&gt;（解 2）考虑寻找一个不需要记三次方状态的求最大前缀和的方法，然后对该方法 dp。一个脑洞大开的想法是，从后往前扫，只维护求最大子段和时的 now 变量（含当前位置的最大和），当 $&amp;lt;0$ 时丢弃，置成 $0$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF924F：求划分最小差只能用背包，可以证明背包只需开到 $72$，这时状态数只有 $12880$ 个。通过合并等价状态可以达到 $715$ 个。然后就是一个数位 dp，预处理 $f_{k,i,s,r}$ 表示限制差 $\le k$，$i$ 位待定，当前 dfa 上状态为 $s$，当前位至多取 $r$ 的答案，即可 $\mathrm{O}(T\log r)$ 回答。&lt;/p&gt;
&lt;p&gt;这里用到了 dp 套 dp 中两个核心技巧：只 bfs 可能被达到的状态和合并等价状态。其中后者也是 SAM 的思想来源。两种朴素的合并方法是哈希（求出每个点向后 $C$ 层的状态，取一个合适的 $C$）和连锁合并（先合并出点编号完全相同的，再不断找新的可以合并的，缺点是有两个完全相同的环时无法缩）。&lt;/p&gt;
&lt;p&gt;关于 $72$ 的证明与最小 dfa 的求法（Hopcroft 方法）详见徐哲安的 21 年集训队论文以及我的题解。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AGC061C：这题涉及两个对象的关系：$A/B$ 之间的选择以及得到的排列，多个选择可能对应同一排列。考虑计重如何发生，直觉上来说形如一个区间内没有其他端点被选（称为独立区间），然后它分别选两个端点，并且容易想到对于每个独立区间，钦定它必选 $A$。但是为了保证这样，dp 时就要记上一次选 $B$ 的位置，至少平方。考虑容斥，钦定若干错误（独立区间选 $B$）选择，它们必然不交，且由输入性质，不存在与它们都有交的区间（否则就会两头均无法选），从而，只能选一端的区间数量为与每个钦定独立区间有交的区间数之和，只需要前缀和优化即可 1D/0D。可以把这个设计理解成先钦定单射（选择的字典序尽量小，只记）再容斥，&lt;del&gt;也可以理解成直接对计重容斥&lt;/del&gt;。&lt;/p&gt;
&lt;p&gt;这里的钦定单射还要严谨证明正确性：如果有两个选择方案，它们的独立区间全选了 $A$，却仍然生成了相同的排列，那么按排列中的顺序，找到第一个选择得不同的区间，这个区间不能是独立区间，那么它内部被选的其他端点必然会导致两个排列不同，矛盾。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AGC056B：这题是排列映射到 $\operatorname{argmax}$ 序列。考虑计重的特征，换句话说，考虑一个 $\operatorname{argmax}$ 序列对应的所有原排列的刻画。模拟样例发现，直觉上有多个“局部最大值”，它们互不影响，那么原排列任意换这些位置的相对大小，这时会计重。将直觉严谨化，如果所有包含位置 $i$ 的区间的 $\operatorname{argmax}$ 都取到 $i$，那么可以 $p_i=n$。钦定单射，若有多个 $i$ 就取最小的，这样易证不会计重。将这些区间去掉后可以得到形式基本相同的子问题，唯一的限制的是左侧不能再出现上述的 $i^\prime $，即规定左侧的最大值必须取在某个包含 $i$ 的区间内，即属于一个后缀。这可以做到 3D/0D。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;USACO22FEBPlatinumT3：考虑如何判定一个序列 $t$ 能被原序列 $s$ 生成。$f_{i}$ 表示 $t_{1\cdots i}$ 能否被 $s_{1\cdots i}$ 生成，除了 $s$ 中的元素，$f_i$ 还依赖于 $f_{i-1},f_{i-2},f_{i-3},f_{i-4},t_{i-1},t_{i-2},t_{i-3}$。dp 套 dp 的常数不得上天？考虑对记的状态剪枝：只有 $f_{i-4}=1$ 且 $\set{s_{i-3\cdots i}}$ 合法（为四种 $2\times 2$ 之一）且 $\set{t_{i-3\cdots i-1}}\subset\set{s_{i-3\cdots i}}$ 才有必要记 $t_{i-3}$，这时只有 $24$ 种可能；否则考虑 $\set{s_{i-2\cdots i+1}}$，$\set{t_{i-2\cdots i-1}}$ 有 $12$ 种；否则 $9$ 种。我的实现是不考虑 $f_{i-*}=0$ 的剪枝，这样共有 $15\times 45=675$ 种状态。应该可以进一步缩，可能也能套用 dfa 的通用缩状态技巧（加之删去只能到达非法状态的状态），但是转移边得同时定 $s_i$ 和 $t_i$，这不如直接剪枝（还可以利用 $s_{i+1}$）。像这种判定条件由输入给定的情况建议直接结合组合意义缩状态。&lt;/p&gt;
&lt;p&gt;remark. 这题也可以跑缩 DFA，结果也很优秀，详见论文，&lt;a class=&#34;link&#34; href=&#34;https://loj.ac/s/1976808&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;劲爆代码&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOI2021] 机器人游戏：这题求的是有几组 $(\set{X_i},\set{Y_i})$ 能被至少一个初始位置 $p$ 生成，那就容斥，枚举初始位置的集合，会得到每一个格子的方案数，暴搜或 dp 即可。后续分两类处理与 dp 无关，略。&lt;/p&gt;
&lt;p&gt;同样使用容斥处理计重的还有 [十二省联考 2019] 希望，利用树的连通子图点减边 $=1$ 的特性。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2023] 栞：考虑求 $f_k(p)$ 的方法，存在一个简单的贪心——容易证明 $f_{k}(p)\le f_{k+1}(p)$，因此每次对于所有可能的第一段，选择排序后的最小者（如果 $s$ 是 $t$ 的真前缀则 $s&amp;lt;t$），然后递归做。这个“第一段”的等价叙述是 $p_{1\cdots n-k}$ 中相对值域取到前缀的最小前缀。好，现在还是不能按照 dp 套 dp 的思路死板地逐位确定，而是考虑直接对贪心决策 dp，用数学方法求决策前缀部分的方案，用延后决策技巧处理决策以后的有限制的部分（即后面到 $p_{n-k}$ 为止都不能有小于前面的数）。&lt;/p&gt;
&lt;p&gt;但是延后决策毕竟要记一个下界，还是比较麻烦，考虑结合条件进一步分析。设 $q$ 的第一个上升段是 $q_{1\cdots l}$，那么 $p_l$ 处一定会分段。设进行以 $l$ 结尾的这一段的决策时，最右可选为 $p_{l^\prime }$，如果 $l^\prime =l$ 那就没事了。否则 $p_{l+1\cdots l^\prime }$ 都得大于 $q_l$，且下一段最右可选为 $p_{l^\prime +1}$，又由于 $q_{l}&amp;gt;q_{l+1}$，故 $p_{l^\prime +1}$ 必须 $=q_{l+1}$，且 $\set{p_{l+1\cdots l^\prime }}=\set{q_{l+2\cdots l^\prime +1}}$，这又表明 $q_{l+1\cdots l^\prime +1}$ 必须是上升段且除了 $q_{l+1}$ 外其余都大于 $q_l$。这一连串的推理表明除非在 $p_{1\cdots l}$ 就把 $k$ 用得只剩 $1$ 或 $p=\iota$，否则答案应当是 $f$ 中某一段卷上阶乘之和，这里 $f_i$ 表示 $l$ 排列中按照贪心分段恰好分 $i$ 段的数量，为 &lt;a class=&#34;link&#34; href=&#34;https://oeis.org/A003319&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;A003319&lt;/a&gt; 的 GF 的 $i$ 次方的 $x^l$ 次项。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1762F：考虑 $a_l&amp;lt;a_r$ 时 $(l,r)$ 好的条件。发现：① 子序列一定是递增的；② 贪心往大的取，到了 $r$ 时如果能到 $\ge a_r$ 的值那么 $(l,r)$ 就是好的。这就在多个子序列中找到了“极大”的一个，然后再将 $=a_r$ 转化成 $&amp;gt;a_r$。这时可以维护目前贪心可以到达每个值的 $l$ 数，问题转化为区间求和，区间清空，单点改。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PA2021R1T1(lgP8386)：判定型 dp 是 $f_i$ 表示前 $i$ 个能否消光，$f_i=\bigvee_{j&amp;lt;i}[a_j=a_i]f_{j-1}$。关键在于计数时不必记录每一个 $f_i$，而是考虑记录 $\lvert\set{a_{i+1}\mid f_i=1}\rvert$，那状态就是 2D 了。现在剩下一个问题：如果当前 $f_i=1$，那么更新这个 size 就得枚举 $a_{i+1}$，然后就得不停地连锁枚举了怎么办？可以多记一维 $0/1$ 表示上一位 $f_{i-1}$ 是否等于 $1$，枚举当前 $a_i$ 时再更新 size。可以理解为延后决策。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AGC064D：考虑如何判定。可以将最终从底向上写的序列理解成一棵树的 dfs 序对应的字符，这棵树编号满足大根堆性质，且儿子从小到大排序，且非叶子对应的字符均为 &lt;code&gt;B&lt;/code&gt;。考虑从大到小生成这棵树，每次加一个叶子。现在回到序列角度，相当于初始有个 &lt;code&gt;B&lt;/code&gt;，倒扫，每次将当前字符插到某个 &lt;code&gt;B&lt;/code&gt; 后面。可以将一个 &lt;code&gt;B&lt;/code&gt; 及其后面连续 &lt;code&gt;R&lt;/code&gt; 看作一个整体，用单个变量表示后面有几个 &lt;code&gt;R&lt;/code&gt;，那么对原序列的插入可以理解成对变量序列 $x$ 的操作：插入 &lt;code&gt;R&lt;/code&gt; 就是某个 $x_i\xleftarrow{+}1$，插入 &lt;code&gt;B&lt;/code&gt; 就是在非末尾插入一个 $0$。设 &lt;code&gt;B&lt;/code&gt; 有 $b$ 个，那么合法条件就是若干不等式：$x_b\ge$ 某个值，$x_b+{}$前 $b-1$ 个中最大值 $\ge$ 某个值，$x_b+{}$前 $b-1$ 个中最大值 $+$ 次大值 $\ge$ 某个值，等等。那这就和 CF1740F 很像了（只不过这题有序）。$f_{i,j,k}$ 表示前 $i$ 大，和 $j$，目前考虑值为 $k$。$x_b$ 单独决策，作为初值。转移得枚举为 $k$ 的数量，复杂度 $\sum_i\sum_j\sum_{k\le j/i}(n-j)/k=\sum_j\sum_k(n-j)/k\sum_{i\le j/k}=\sum_j(n-j)j\sum_k 1/k^2=\mathrm{O}(n^3)$。&lt;/p&gt;
&lt;p&gt;这题难点在从后往前考虑。我所考虑的 dfs 树其实就是帮我想到倒过来考虑的一个跳板而已。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[CTT2023] 黄焖鸡：判定方法是，扫描右端点，维护每个左端点的 $(f_0,f_1)$ 表示当前位不选/选，选减不选的最大值，新加一个数 $a$，$(f_0,f_1)\circ a=(\max(f_0,f_1)-a,f_0+a)$。如果 $\max(f_0,f_1)=0$ 就爆了。组合性质或归纳易证以下性质：$f_0+f_1\ge 0,\lvert f_0-f_1\rvert\le 2m$。考虑什么样的对没前途，即永远不会导致不合法。$f_0&amp;gt;0$ 肯定不用管；假设后面又接了一段序列，奇数项和为 $s$，偶数项和为 $t$，$\max(f_0+s-t,f_1+t-s)=0$ 必须有可能出现（不可能 $&amp;lt;0$），综合 $f_0+f_1\ge 0$，得到 $f_0+f_1=0$，这时只需后面加一个 $f_1$ 就爆了。因此只有 $(-1,1),\cdots,(-m,m)$ 有必要记，可以状压。转移形如：要求第 $i$ 位为 $0$，将低 $i-1$ 位 reverse，第 $i$ 位置 $1$，其余置 $0$，容易感知到一个 $2^m+2^{m-1}+\cdots$ 的去掉一个 $m$ 的突破口，用一个类高维前缀和优化填表法即可 $\mathrm{O}(n2^m)$。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. [NOI2022] 移除石子、[ZJOI2019] 麻将&lt;/p&gt;
&lt;h3 id=&#34;第三步-设计-dp&#34;&gt;第三步 设计 dp
&lt;/h3&gt;&lt;p&gt;这里首先要排除掉非生成类 dp 也就是一般的递推式的设计方法。这类问题难点单一，关键在于找到一个封闭（可以转移）的状态描述，然后填表即可。技巧性不强，因此后文不讲。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1778D：$f_i$ 表示有 $i$ 个 $1$ 的答案，$f_i=\frac{i}{n}f_{i-1}+\frac{n-i}{n}f_{i+1}+1$，有点难解。整理得 $i(f_i-f_{i-1})=(n-i)(f_{i+1}-f_i)+n$，换元 $g_i=f_i-f_{i-1},g_n=1$，然后递推即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1667E：（解 1）$u$ 为重心，一方面 $u$ 子树以外的点 $&amp;lt;n/2$ 个，另一方面 $u$ 的每个子树大小均 $&amp;lt;n/2$。重心又唯一，故考虑容斥。$siz_u&amp;gt;n/2$ 的方案数 $f_u$ 容易算，然后答案 $g_u=f_u-\sum_{v&amp;gt;u}g_v/u$。这个 ${}\div u$ 可以从概率的角度理解——$v$ 是否为重心与前 $u$ 个点树形无关，且可以将前 $u$ 个点视作不可区分的，故 $P(v为重心\mid v在u子树中)=1/u$。&lt;/p&gt;
&lt;p&gt;（解 2）一个不递推的推式子做法。考虑删去 $u$ 后有个连通块 $siz&amp;gt;n/2$ 的方案数，补集转化，分类 $u$ 子树和 $u$ 以外两种情况讨论，枚举 $siz$。最终会得到一个卷积形式。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. CF1534F2、+CF1770E、dmy stars&lt;/p&gt;
&lt;p&gt;对于生成结构类 dp，设计 dp 是解题的核心。在考虑具体的设计前，先思考一个问题：dp 到底计算的是什么？&lt;/p&gt;
&lt;p&gt;对于一个有待定信息的结构，每个 dp 状态以及值都表示确定待定信息中的某一部分，所有满足某些条件的解（即确定内容）它们的一个概括量。这些条件就是状态，概括量就是 dp 值。&lt;/p&gt;
&lt;p&gt;**因此考虑 dp 的前提是，先明确这个结构以及其待定部分是什么样的。**这里我想表达的是，建议在做完前两步后进行一个小结，明确 dp 的对象，以及其特征与性质。这样有助于后续思考清晰。不要认为这是废话，出现混淆状态含义等设计失误往往是因为没有明确 dp 对象造成的。&lt;/p&gt;
&lt;h4 id=&#34;几个原则&#34;&gt;几个原则
&lt;/h4&gt;&lt;p&gt;好，接下来我先列出 dp 设计的几个原则，再详述思考方式。&lt;/p&gt;
&lt;p&gt;众所周知，严谨地来说，一个 dp 的要素包括：最优子结构、重叠子问题和无后效性。但在实际设计时，一般会考虑这三点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每个希望被考虑（合法，或可能成为最优）的解均被恰当地（主要指计数题中次数正确）计入，不希望被考虑（不合法但会影响答案）的解均不被计入。这决定了无论在设计 dp 还是验证 dp 时，我们都会想象一个解，然后考虑它被计入的情况。“考虑一个解被计入的情况”，这是非常重要的思考习惯，因为当这样考虑时，可以跳出当前 dp 生成过程的语境，不被组合意义限制，去考虑本质上要记的东西，找到一些非常规的 dp 方式。&lt;/li&gt;
&lt;li&gt;状态数足够少。换句话说，可以将“确定待定信息中的某一部分”这个确定部分视作一个黑盒，其只有少量的信息会与剩余待定信息以及所求限制产生互动关系，一般体现为确定部分的某些数量特征或边缘（某个邻域）的确定情况，在题解中往往会以”我们只需记录某类信息/只需求某类子结构的答案“出现。&lt;/li&gt;
&lt;li&gt;状态是封闭的。这个更好理解，其实就是重叠子问题的意思。如果状态不封闭，那么从某个状态出发就会推出或依赖更多的状态，进而导致状态数爆炸，子问题的重叠情况就不够密集。这个可以类比分治类数据结构的信息封闭性来理解（例如推复杂线段树的记录信息与 tag）。同时这个要求会引出一类 dp 的设计方式，详见从转移推状态。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在设计 dp 前，应当有以下几个意识：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;优先考虑优化暴力 dp 和推广特殊情况 dp。相比凭空定 dp 状态，这两种方法显然更容易。不要急于一次性将高度优化或有复杂细节处理的最终 dp 想出来。&lt;/li&gt;
&lt;li&gt;优先考虑组合意义，优化时结合组合意义。用数学方法或形式化描述容易把自己搞晕，或丢失性质。&lt;/li&gt;
&lt;li&gt;优先寻找突破口，而不是一味地强制钦定某个顺序或规定状态定义再硬推转移。突破口可能是某个贪心性质、结构简单特征、信息量小或限制多的子结构、无关性或独立性等等。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;设计方法&#34;&gt;设计方法
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;注意，这里会讲得比较抽象和概括。dp 设计有非常多零碎的技巧，尤其是关于局部生成时序和状态选择相关，这些会在例子中提及。建议看理论的同时结合例子。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;好，现在是主要的两类 dp 设计方法。&lt;/p&gt;
&lt;p&gt;第一类是&lt;strong&gt;设计生成过程，再确定状态&lt;/strong&gt;。首先确定一个解大致的生成顺序，然后确定生成过程中的部分结构或时刻，用状态去表出这部分，用转移表出状态之间的部分。值得注意的是，状态相同时可能有不同的转移方程。&lt;/p&gt;
&lt;p&gt;该方法的核心以及难点就在于生成顺序的选取和子结构的选取。首先所谓的“生成顺序”绝不仅仅代表线性地扫一遍的顺序，因为难题的模型可能有多个维度（例如元素是区间，结构是带时间维的过程，带别的权值等等），有复杂的限制条件，或者结构本身就不是线性的。其次对于大致相同的顺序，子结构的选取就像在生成过程中寻找一些“checkpoint”，选取的不同会导致需要记录的信息量的差异。&lt;/p&gt;
&lt;p&gt;有些特定的结构有常用的生成方法，但诚然不存在通用的定法，有时只能靠枚举试错。但还是有些好的思考习惯。首先既然说是“想象法”，那就必须对静态和（以各种顺序）动态的模型有清晰的认知，在纸上画图，明晰模型在生成过程中呈现的特征，从而发现信息量小的部分（即突破口）。从否定的角度来说，可以尝试先排除不可能的方向，剩余少量可能。另外在设计状态时要尝试寻找不必要的状态（不可能、去除该状态也能对）以及不必要记的信息（可以合并、可以不管、可以多并一）等等。&lt;/p&gt;
&lt;p&gt;第二类是&lt;strong&gt;关注单步决策，推理出状态&lt;/strong&gt;。这种方法可以先确定大致的顺序或先后关系，也可以不确定。关键思想在于，先通过观察（顺序未知的）生成过程中某个静态的片刻或局部（只考虑某一步），发现无关性，作为定状态的突破口。思考过程一般是，首先寻找结构的单个决策（往往是最终结构，即考虑最后一步），然后分析该部分与剩余待决策部分的关系（可以想象该部分已确定或去除该部分之类的），得到剩余部分必要的限制条件或信息。如果出现多个无关部分就拆开来。反复进行上述操作，不断扩充状态使其关于转移封闭即可。这个有点像某些 ds 设计复杂 tag 的过程。&lt;/p&gt;
&lt;p&gt;这个思路更符合 dp 原本的定义，但是如果模型中与单步决策相关的信息太多，会导致状态不确定性太大，由于这个思路靠的是找必要性，故容易定不出状态，这时就得用第一类方法——先确定生成过程，本质上就是通过猜一部分状态相关的信息来减少不确定性。但是如果第一类方法猜不出来，例如下文中某些奇怪的树型 dp 和断点转移，以及上文的 CF1781F 和 CF1439D，就可以用这个方法，较容易地获得状态设计线索。但相对来说这种方法用得并不多，要不就出现在较难的题里。&lt;/p&gt;
&lt;p&gt;无论如何，这两类方法并不是泾渭分明的。例如第一类方法定出的状态数太大，再结合模型特点与转移微调状态；第二类方法也可以猜一部分的生成顺序。&lt;/p&gt;
&lt;p&gt;另外提及一下两类对立的 dp 特征：&lt;strong&gt;单步转移&lt;/strong&gt;和&lt;strong&gt;断点转移&lt;/strong&gt;。这个分类源于与 crn 的讨论（原话的第一种是“逐步转移”）。单步转移的 dp 每次只决策一个“最小单元”，而断点转移更像“跳跃”，一次性决策连续的待定部分（利用数学方法或其他性质）。在数据范围允许的情况下，一般建议单步转移，因为更易写转移方程，且不容易漏性质；断点转移往往在单步转移状态量太大（指数或多了若干维）时用于缩状态，但往往转移需要优化。一个经典的例子是在一个序列中选多个位置时，单步转移需要记两维，而断点转移可以规定当前末尾必选，然后用一些优化解决。&lt;/p&gt;
&lt;p&gt;注意单步和断点的对立是相对而言的，有时单步转移的也可能是较长的一个部分。可以结合例子理解。&lt;/p&gt;
&lt;p&gt;这里，再强调一下一个重要的性质——无关性，或者叫独立性，这是 dp 的重要信号。这种性质分为两个方面，一是当前步决策与先前步决策情况无关或关系较小（只需记少量变量），这在最优化 dp 中体现为最优子结构（只需规定少量限制，就可以保证候选解包含全局最优）；二是多个不交部分间的决策无关（也就是第二类方法利用的），而它们在某处汇聚。这两个特征共同导向的重叠子问题，也就导向了封闭且足够少的状态。&lt;/p&gt;
&lt;h4 id=&#34;转移方式&#34;&gt;转移方式
&lt;/h4&gt;&lt;p&gt;关于看待模型的方式对转移方程的影响，这里有两类情况。&lt;/p&gt;
&lt;p&gt;第一类是&lt;strong&gt;填表法&lt;/strong&gt;，指对于当前状态找出它可能的前驱状态来求得自己的答案；第二类是&lt;strong&gt;刷表法&lt;/strong&gt;，指对于当前状态找出它可能的后继状态去更新它们的答案。&lt;/p&gt;
&lt;p&gt;这两个名词我也不知道是从哪里来的，据说很多初学者就知道。这里主要想讲一下这两类转移的思路差别。&lt;/p&gt;
&lt;p&gt;在&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/yeah-potato/gou-zao-ti-fang-fa-zong-hui&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;构造题方法总汇&lt;/a&gt;中，我提到一类构造方法是 &lt;em&gt;k. 归约法和增量法&lt;/em&gt;。这两种方法的大思想相同，但具体思考方式有差别。dp 也是一样，考虑一个结构删去（可能先待定）或确定某个部分后，剩余部分如何归约，这就是填表法；考虑一个未完成结构上增加一些部分后信息的变化，这就是刷表法。&lt;/p&gt;
&lt;p&gt;在一些结构较简单的题中，这两种方法是相通的，一方面转移简单时可以直接转换，另一方面可以将 dp 确定部分和未确定取反（可以理解成“起点到它的方案数”与“它到终点的方案数”这两种），通过改变状态定义中的方向来转换。但情况复杂的时候只有一种是可行（或容易思考）的，所以要多换几种思考方式。&lt;/p&gt;
&lt;h4 id=&#34;例-15&#34;&gt;例
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF354D：将金字塔顺时针转 $45^\circ$，视作直角三角形。方案形如：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\dp\aye8wa5q.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;且每个小三角边长至多 $\sqrt{6k}$ 左右。（解 1）最直接的思路是对小三角 dp，断点转移。可以记当前的最右竖边（这条边对应的直线前面的全部考虑完），转移时枚举（上一个小三角竖边）和（当前边长）之一，另一方的选择可以优化掉。注意上一个不交时应当先单步（不选）转移到当前开头，强制相交。&lt;/p&gt;
&lt;p&gt;（解 2）类似扫描线，逐行或逐列扫描，记录当前最右或最上的被小三角覆盖的坐标。新开小三角形可以断点转移也可以单步转移，取决于怎样计入小三角的代价。&lt;/p&gt;
&lt;p&gt;这题的灵活性很强。其实大致的生成顺序都是一样的，就是局部的先后关系和计代价的拆分方式有些差异。解 1 的优点在于整体思考每个小三角形，状态较简洁，易推广；解 2 的优点在于转移容易想。这题是从状态推转移。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;（落月摇情满江树）（给定一棵儿子有序的有根树，所有相邻叶子额外连边，求能否将点划分成若干简单环）：（解 1）考虑一个子树的情况，如果有非完整环那么要记下，与外部产生关系。发现仅有四种：全完整、最左叶子到根路径、根到最右叶子路径、最左叶子到最右叶子路径。从所有儿子转移，做到线性需要一些处理。&lt;/p&gt;
&lt;p&gt;（解 2）考虑逐个儿子加入，方便讨论转移。此时状态除了原来的四类外还有（根未覆盖，其余完整）和（根未覆盖，最左叶子到最右叶子路径）这两种。对于六类情况分别讨论在最后一个子树和前面部分如何拼合可以得到即可。解 1 和解 2 的关系有点类似断点转移和单步转移的关系。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题非常形象地体现了“状态封闭性”要求。要求确定状态集合使得转移能够自洽&lt;/strong&gt;，这就像每个状态都是一个拼图，要能完美地吻合起来一样。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1784D：结构如图（ans 表示获得 Wooden Spoon 的人）：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\dp\wv8edyby.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;乍一看不容易 dp，先考虑静态模型。和上文中排列的部分题很像，都是有一些主要元素，其余元素与其中一个有偏序关系这么一个拓扑序计数。这一题中对主要元素有绝对大小的要求，故只能从右往左钦定。对于深度为 $i$ 的点（根深度为 $1$）其下面挂的子树 $\min$ 为 $j$，那么它贡献倍数为 $\binom{2^n-j-2^{n-i}}{2^{n-i}-1}$。而这只与 $i,j$ 有关。&lt;/p&gt;
&lt;p&gt;第一种思路是枚举获得 WS 的人，然后从右往左 dp，但这样至少带 $2^{2n}$。（解 1）从左往右 dp 时，由于目标限制出现在状态中（获得 WS 的是某个人），故可以。$\mathrm{O}(n2^n)$。&lt;/p&gt;
&lt;p&gt;（解 2）第三种思路是按值域从小到大填入。记录当前前缀中几个子树至少填了一个数，单步转移即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1765C：问题转化为对于 $l=1\sim k$，求任选 $l$ 张牌，最少的有 $c_0$ 张的概率。如果已知四种分别有 $c_{1\cdots 4}$ 张，那么概率为 $\binom{n}{c_1}\binom{n}{c_2}\binom{n}{c_3}\binom{n}{c_4}/\binom{4n}{l}$，（解 1）因此可以枚举 $c_0$ 后卷积，得 $\mathrm{O}(n^3)$。（解 2）$\mathrm{O}(n^2)$ 的做法是，按数量从大到小 dp。令 $f_{i,j,k}$ 表示当前上界是 $i$（接下来钦定的牌至多单种 $i$ 张），已定牌数为 $j$，已定了 $k$ 种牌，每次确定当前这个 $i$ 钦定给几种牌。（解 3）这题可以从小到大，只需将猜测成功率作为 dp 初值即可，相当于多个 dp 合并起来做，这是官解。&lt;/p&gt;
&lt;p&gt;这里有两个技巧，一是&lt;strong&gt;背包的单步转移&lt;/strong&gt;，实际上解 2 和解 3 的 dp 数组同时承担着两种定义（这个在背包专题例 4 中也提到）：当前最少的是 $i$ 张，和当前最少的 $\ge i$（$\le i$）张。根据是否允许转移给不变的 $k$，可以区分这两种定义（解 2 更新答案时 $k$ 必须变）。二是解 2 和例 3 相同的技巧：**通过改变 dp 顺序，使得目标限制和（终）状态吻合，减少一维枚举或状态。**这是想象顺序生成的重要技巧。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1060F：先枚举最后得到的节点 $r$，然后完全不会定状态。这时考虑以 $r$ 为根，所有儿子的子树是互相独立的，这就得到了 dp 的启发。每个儿子的子树要求的都是内部先合并若干次，然后 $r$ 在某一时刻合并上它了，之后再合并若干次，得到的仍为 $r$ 的概率。因此考虑 $f_{u,i}$ 表示点 $u$，内部剩余 $i$ 次合并时，$r$ 从上面下来和 $u$ 合并了，最终仍为 $r$ 的概率（这个概率只考虑合并时的 $1/2$，不考虑合并顺序，因为方便（考虑也行）。最后除以 $(n-1)!$ 即可）。分析转移发现这个状态是封闭的。具体来说，先考虑一个儿子 $v$，从 $f_{v,j}$ 转移。如果 $r$ 合并到 $u$ 在 $u$ 合并到 $v$ 之后，那么只从 $j=i$ 转移，因为从 $r$ 合并到 $u$ 开始计概率；否则，从 $j&amp;lt;i$ 转移，因为从 $u$ 合并到 $v$ 开始计概率。多个儿子时依据无关性，做树上背包即可。前缀和优化即可 $\mathrm{O}(n^3)$。&lt;/p&gt;
&lt;p&gt;你可能会有疑问：为什么要这样定状态？因为考虑一个子树内的边合并序列，根合并下来相当于在这个序列中某处插入一个分界。因此子树外面与内部产生关系的只与一个数量有关。为什么不令 $i$ 表示内部剩余含根的 $i$ 次合并呢？因为无法转移。另外，我当时在思考时又记了一维 $k$ 表示根恰好在子树中合并了几次（即，和“为什么”之后的这个含根合并的意思相同），然后最后让 $ans=\sum_kf_{r,n-1,k}/2^k$，这个得 $\mathrm{O}(n^5)$。&lt;strong&gt;正解对其的优化本质上就是将多个状态的值压成了一个，这也是很常见的技巧。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这题是典型的第二类方法。状态非常地怪，要真正理解可以从边合并序列的角度看，这启发我们要从多个角度同时看模型。同时还涉及了关于概率的处理，对于何时记概率，何时记方案数最后再除以总方案数的问题，答案是考虑转移时怎么方便怎么来。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF771E：（解 1）正解的核心思想是，**dp 只要使得任何合法解都能被生成即可，从而不必要记所有可能的状态。**想象一个解，容易考虑一个类似归并的生成过程：当前如果接下来两行都是单行矩形，那么选右端点小的那个。也相当于不允许出现第一行右端点为 $i$，第二行右端点为 $j$，且 $nxt_j&amp;lt;i$ 或对称的情况。但这样状态数还是很大。考虑对于一个 $i$，固定 $j\le i&amp;lt;nxt_j$，发现只需要记使 $f_{i,j}$ 取到最大值的最小 $j$ 即可。因为如果没取到最大值，由于 $nxt_j&amp;gt;i$，故该状态所有的导出状态都不优于取到最大值的状态的导出状态。因此只需 1D，记对称的两个情况，刷表法转移即可。一个类似利用这个思想的是&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/AlexWei/solution-cf771e&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇题解&lt;/a&gt;，但是我无法理解他是怎么想出这个“不必要”条件的。另外还有一种见鬼的记搜解法，如果您知道它的状态数证明请告诉我。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1608F：只能从左往右生成。问题出在 $\operatorname{mex}$ 被更新时的连锁增加，这就会要求记录已决策的数中 $&amp;gt;\operatorname{mex}$ 的 bitmask，那就完了。但是仔细一想：真有必要全部决策吗？是不是在连锁增加时有用才决策更好呢？因此考虑 $f_{i,j,k}$ 表示在 $i$，$\operatorname{mex}=j$，前面 $&amp;gt;j$ 的有 $k$ 个的方案数。当 $\operatorname{mex}$ 更新时，枚举连锁更新的量，用组合数分配即可。然而由于得枚举 $k^\prime $，故无法避免 $\Omega(n^3k)$。&lt;/p&gt;
&lt;p&gt;考虑将 $k$ 的定义改成“有 $k$ 种”，这样转移时只需要让 $j$ 单步即可。转移系数的下降幂妨碍单步，可以拆开来分给转移的起点和终点，也可以在定等价类时先决策大小关系。$\mathrm{O}(n^2k)$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题的延后决策技巧是局部生成时序的典型例子。从另一个角度理解，相当于 dp 已决策部分为下标—值域平面上的一个左下角矩形。这个矩形的上方既不能先决策，也不能完全不决策。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[联合省选 2021] 滚榜：初步思路是逐个确定，记当前的状压、末尾编号，末尾 $b$ 与 $\sum b$。优化，考虑记 $b$ 的目的是保证 $b$ 递增以及 $a+b$ 递增。而相邻的 $b_x\le b_y\Leftrightarrow b_y-b_x\ge 0$，$a_x+b_x\le a_y+b_y\Leftrightarrow a_x-a_y\le b_y-b_x$，可以考虑差分数组，$\Delta b$ 的下界是 $\max(a_x-a_y,0)$，同时这些下界可以确定一个 $\sum b$，只需要它 $\le m$ 即可。那就不必记末尾 $b$ 了，$\mathrm{O}(2^nn^2m)$。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题实质上决策的东西没有变，只不过换了一种方式刻画已决策部分的影响。可以通过画出 $b$ 的柱状图然后换一个方向看来得到突破口——原来记的和是左下角的三角形，现在记的是下方的一个梯形。这题也可以算是状态合并的例子。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[IOI2020] 装饼干：也是个判定型计数，考虑题目条件更好的描述。首先有个简化，如果 $a_i\ge x+2$，那么它可以合并一对。然后，合法的充要条件是，$y$ 的低 $i$ 位的 $x$ 倍必须 $\le \sum_{j=0}^{i-1}a_j2^j$，充分性的构造是，从高位到低位贪心使用下标大的，或从低到高随便用。如果从低到高，那就得记一个当前剩余可用和，不好优化；如果从高到低，考虑钦定了一个最高 $1$ 位 $i$，它往下贪心用掉，最后一个用掉的是下标为 $j$ 的，且其剩余 $a^\prime _j$。&lt;/p&gt;
&lt;p&gt;如果 $a^\prime_j=x$（不可能再大了），那么次高 $1$ 位至多是 $j+1$，并且如果次高 $1$ 位 $\le j$，那最高 $1$ 位实质上不产生影响，因此是一个无关的子问题；如果 $a_j^\prime &amp;lt;x$，那么次高 $1$ 位至多是 $j$，并且如果次高 $1$ 位 $&amp;lt;j$，那上面也不产生影响。因此，如果令 $f_i$ 表示只考虑低 $i$ 位且第 $i$ 位为 $1$ 的答案，$g_i=\sum_{j\le i}f_i$，那么 $f_i$ 的转移会形如 $g_{j-1}+f^\prime _j$，$f^\prime _j$ 是个特殊的东西。而这个特殊的因为只有一支，故可以直接迭代往下看。$\mathrm{O}(qk^2)$。如果不规范化使 $a_i\le x+1$，也是可以分析的，就是 $j$ 变成了最高的可以为 $1$ 的次高位。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这题是一个从转移推状态的例子。由于发现决策时只有一种情况会被影响，其他情况都可以归为形式相同的子问题，那就找到了 dp 突破口。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[ZJOI2022] 树：初步思路是逐一钦定每个点在哪棵树中是叶子，第一棵树要记录当前非叶子数与已有至少一个儿子（已满足）的非叶子数，第二棵树由于是倒过来，故生成模型变成了一个若干子树合并到当前点的形式，记录当前子树数，若是非叶子则枚举选几个作为儿子。这样一共是 4D/1D 的。分开来看每棵树，考虑以下思路转变：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;第二棵树记子树数必然导致一维卷积，得改。实际上其状态可以和第一棵树类似——记录当前尚待决策的点中有几个是非叶子以及满足的情况。这实质上是先前提到过的“将 dp 确定部分和未确定取反”的技巧，相当于第一棵树是不断生成，第二棵树是不断消去。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;为保证非叶子所记的另一维需要消去，可以用容斥——不保证非叶子有至少一个儿子，而钦定非叶子时新增一个强制它无儿子的 $\times (-1)$ 的转移。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;保证非叶子可以用另一种方法：在一个非叶子的最后一个儿子处将该非叶子的“接口”删掉，即，将非叶子数减一（第二棵树就是在第一个儿子处加一）。这个和 USAC23JANPlatinumT2 中只在钦定的最后一次访问某个点时才修改 bitmask 对应位置的思路异曲同工。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这样就 3D/0D 了。&lt;strong&gt;第一个优化本质上是决策时序的微调，将决策叶子同时决策儿子改成决策叶子同时决策父亲。第二、三个优化单纯就是改变当前刻画信息的方式。这题深刻地说明了几个事情：确定了大的生成顺序并不意味着局部决策顺序唯一，确定了精确的决策顺序并不意味着状态唯一，确定了状态并不意味着方程唯一。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[联合省选 2022] 最大权独立集问题：只考虑有两个儿子的情况，称先交换的儿子为左儿子。根的左儿子子问题为 ① “父亲点权为初始点权，$u$ 子树（含父亲边）完成交换，最后传给父亲的权为 $d_x$ 的最优解”，右儿子子问题为 ② “父亲点权为 $d_x$，$u$ 子树（含父亲边）完成交换的最优解”。继续往下看子问题 ②：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;父左右。子问题为 ③ “$u$ 点权为 $d_x$，$u$ 子树内（不含父亲边）完成交换的最优解”。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左父右。左儿子换给 $u$ 的点权会额外贡献一倍，需要记；换给右儿子的点权为 $d_x$。因此左儿子是一个子问题 ①，右儿子是个子问题 ②。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;左右父。$d_x$ 恰好贡献一倍，$u$ 在与父亲交换前的权值也额外贡献一倍。子问题为 ④ “$u$ 点权为初始点权，$u$ 子树（不含父亲边）完成交换，最后 $u$ 的权为 $d_x$ 的最优解”。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;子问题 ① 是对称的。然后看子问题 ③。这时必须枚举左儿子交换上来的点权，导致三次方。但是，这里的一个直觉是，这个左儿子交换上来的点权和 $u$ 当前的点权 $d_x$ 很大程度上是无关的，也就是不必嵌套而是可以分开枚举。这个直觉可以通过分析左儿子的交换情况得到（令 $u$ 的左右儿子分别为 $v,w$，下面的父、左、右指 $v$ 的父、左、右）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;父左右。$v$ 还是子问题 ③，$w$ 是 $x=v$ 的子问题 ①。&lt;/li&gt;
&lt;li&gt;左父右。$v$ 左儿子传上来的点权会交换给 $w$，$u$ 传下去的点权会给 $v$ 右儿子，因此这两个权值它们不会共同影响一个子问题，或者说它们的贡献是用加法连接，可以拆开的。因此，先把 $v$ 左儿子的这条路线的最优解算出来就行了。$v$ 左儿子是子问题 ②，$w$ 是子问题 ①，$v$ 右儿子是子问题 ①。&lt;/li&gt;
&lt;li&gt;左右父。这时 $d_x$ 恰好贡献一倍，与 $v$ 交换上来什么无关。因此可以不枚举 $x$ 但枚举 $v$ 交换上来的点权就算出答案，$v$ 为子问题 ④，$w$ 为子问题 ①。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如果从公式角度看，这个三次变两次的过程实际上就是通过再往下讨论一层，使转移 $f_{u,x}=\min_yF_u(x,y)$ 变成了 $f_{u,x}=\min_y\set{G_u(x)+H_u(y)}=G_u(x)+\min_y H_u(y)$。**所以说在解题过程中要对独立性非常敏感。**另外这题也是状态推转移的很好的例子。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;THUSC2023D1T2：尽量避免记燃料和能量，能量很傻，直接分段。现考虑不补充能量的一段的最优解，关键思路是将状态定在补给燃料的位置，这样只需记当前的区间与所在点。断点转移会五次方，考虑到转移范围是一个一维偏序，故只需用 ds 维护当前右端点的所有可能转移，到下一个游乐园理解成全体位移 $w$ 即可。同一个右端点内部预处理两两最短路即可。$\mathrm{O}(n^2m^2+n^2m\log{})$。&lt;/p&gt;
&lt;p&gt;这题的难点是选取合适的子结构。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOI2023] 桂花树：默认已知 $T^\prime $ 的结构刻画。对相对值域 dp 不可行。&lt;/p&gt;
&lt;p&gt;（解 1）条件 2 可以描述成“点 $u$ 的儿子中至多有一个，其子树 $\min&amp;lt;u-k$”。因此，考虑最大点，删去他和除了特别子树外的部分，然后把特别子树接给父亲，这样就归约成形式相同的问题了。$f_{u,s}$ 表示当前最大点为 $u$，$(u-k,u)$ 部分尚存的状态为 $s$ 的方案数。转移枚举子集，另外还要容斥掉子树全 $\ge u-k$ 的情况。可以用子集卷积优化到 $\mathrm{O}(mk^22^k)$。&lt;/p&gt;
&lt;p&gt;（解 2）考虑从小到大加入点，即考虑编号前缀点在 $T^\prime $ 中的虚树。可以在随意的位置加一个叶子，裂一条边，或有条件地加一个 $\operatorname{lca}$ 尚未加入的叶子，这个 $\operatorname{lca}$ 会有一个编号大小的限制，要记一个状压。也可以理解成一个部分延后决策。$\mathrm{O}(mk2^k)$。&lt;/p&gt;
&lt;p&gt;这两个做法，一个是从大到小填表，一个是从小到大刷表，而最终的解法本质上恰好是差不多的，是同一种生成思路的断点转移和单步转移形式。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOI2023] 深搜：还是判定型计数，两个思路：直接对边集计数（记录是否存在至少一个关键点满足），枚举点集容斥。都先考虑特殊性质。&lt;/p&gt;
&lt;p&gt;（解 1）直接对边集计数，性质 B：$f_{u,d,0/1}$ 表示一端在点 $u$ 子树内的非树边已定，选的非树边最浅达到多少的深度（与 $dep_u$ 取 $\min$），子树内是否有满足的关键点，这样的方案数。这个可以整体 dp：如果有多于一个儿子内有跨 $u$ 的非树边，那所有子树中的关键点都废了；如果恰有一个，那当前 $0/1$ 取决于该儿子的 $0/1$；否则直接乘起来。这些都可以线段树合并。正解：横叉边会限制关键点只能选在一或两棵子树内，这一或两棵子树内是独立的，因此有希望结合原 dp 解决。先解决只有一棵子树可以的，枚举该子树根，从它出发至少有一条横叉边，两端都在它外部的非树边可以换根 dp 解决。现在只需容斥掉有两棵子树均可以的情况：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\dp\s7xiccoj.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;以 dfs 的方式枚举 $u$，用 dfs 序上的线段树维护所有可能的 $v$ 的系数：对于一个 $v$，$\operatorname{lca}$ 是定的，因此这两者之间的返祖边方案数易求（必须两端均在链上或均在链上点某个非链上儿子子树内），同时两端分别在 $\operatorname{lca}{}-u$、$\operatorname{lca}{}-v$ 上的横叉边也在 $v$ 处维护，是形如区间乘 $2$ 的更新，然后再是 $v$ 子树的答案，这三者的乘积。对于一个 $u$，枚举选以它为一端的横叉边 $e$，现在要求其他以它为一端的横叉边的另一端都是 $e$ 的另一端的祖先。然后就是一个区间查询，再乘上与 $u$ 相关的系数和 $\operatorname{lca}$ 向上的部分。注意由于要强制 $v$ 有至少一条横叉边，故要对 $u$ 出发新的横叉边的另一端和另一端子树内其他点分开讨论一下。&lt;/p&gt;
&lt;p&gt;这个做法我只是口胡了一下，实际写起来会极度复杂。如果您发现这个做法有锅请指出。&lt;/p&gt;
&lt;p&gt;（解 2）（&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/AlexWei/solution-p9480&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;来源&lt;/a&gt;）还是看原题解比较好。大致思路就是容斥，边只能完全在钦定的关键点的虚树单边内或单边内点的其他邻点的子树内。然后这个东西在性质 B 时就要断点转移（解 1 是单步），但可以 ds 维护；优势在于有横叉边时只需枚举顶部，“稍加”讨论即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;（[原创] 禁止套娃）（求一个序列所有本质不同子序列的本质不同子序列个数之和，$n\le 5000$）：首先有个经典的算本质不同子序列数的线性 dp，也就是钦定单射，只对最左匹配计数，要求选的相邻两数之间不能有等于后者的。考虑仿照其思想：&lt;/p&gt;
&lt;p&gt;设选择的外层子序列下标为集合 $I$，内层为集合 $J\subseteq I$。为了方便表述，设占位下标 $0\in I,J$。同样只计贪心匹配的情况，限制如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$I$ 中相邻两个数 $i,i^\prime $，$a_{i+1\sim i^\prime -1}$ 中不存在 $=a_{i^\prime }$ 的值。&lt;/li&gt;
&lt;li&gt;$J$ 中相邻两个数 $j,j^\prime $，$a_{I\cap(j,j^\prime )}$ 中不存在 $=a_{j^\prime }$ 的值。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;考虑对 $J$ dp。$f_i$ 表示目前考虑到 $i$ 且内外层末尾均选 $i$ 的答案。如果要从 $f_j$ 转移过来，那么就要决定 $a_{j+1\sim i-1}$ 这部分如何选外层，设选择了集合 $K$，限制如下；&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$K$ 中相邻两个数 $k,k^\prime $，$a_{k+1\sim k^\prime -1}$ 中不存在 $=a_{k^\prime }$ 的值。&lt;/li&gt;
&lt;li&gt;$K$ 中最大值 $k_r$，$a_{k_r+1\sim i-1}$ 中不存在 $=a_i$ 的值。&lt;/li&gt;
&lt;li&gt;$K$ 中任意 $k$，$a_k\ne a_i$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一个简洁的处理方法是，对于每一个 $i$，dp 出 $&amp;gt;$ 每个 $j$ 的只需满足 1、3 条件的本质不同子序列个数 $g_{i,j}$，真正转移时 $f_i\xleftarrow{+}(g_{i,j}-g_{pre_i,j})\cdot f_j$ 即可。最后汇总答案可以弄一个必选的占位下标 $n+1$。&lt;/p&gt;
&lt;p&gt;这题其实不难，关键是把结构看清楚。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2021] Imbalance：（&lt;a class=&#34;link&#34; href=&#34;https://qoj.ac/download.php?type=solution&amp;amp;id=4893&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;参考&lt;/a&gt;）只讲 Subtask 3。描述计数限制：$s_i$ 表示前 $i$ 个中 $1$ 的个数，$s_i-s_{i-1}=0/1,s_i-s_{i-k}\ne k/2$。像题解中一样将 $s$ 排成矩阵，暴力状压实际上是先行后列的轮廓线 dp，而先列后行在 $k$ 大时状态数更少，这就像一些二维问题状压 dp 前 &lt;code&gt;if(n&amp;lt;m)swap(n,m);&lt;/code&gt;。又由于只需考虑所有 $s_i-s_{i-k}$ 全部 $&amp;lt;$ 或 全部 $&amp;gt;k/2$ 故可做到题解中的复杂度。这题也是&lt;strong&gt;观察与生成顺序很大程度上影响状态数&lt;/strong&gt;的有力说明。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2023] Tree Topological Order Counting：想象某个拓扑序，一个点 $u$ 的祖先都在 $u$ 前面，且他们各自的不包含 $u$ 的儿子子树在他们后面随意穿插。而这题又得固定 $u$ 的绝对位置，因此就和 CF1784D 相似，这题我用的单步转移思路。外部子树的后续占用情况不宜直接确定，因此考虑记 $f_{u,i}$ 表示 $u$ 在第 $i$ 位的方案数，这里的方案数包含外部子树内的拓扑序数量（形如 $n!/\prod siz_i$），以及他们在 $i$ 之前的部分的方案，但不含在 $i$ 后的（但数量已知且相对顺序已决策）。对于一个 $v$，先加入非 $v$ 儿子子树并穿插，再往后塞若干数，再塞 $v$。&lt;strong&gt;这题更能看出局部时序的技巧——往往要决策，但只决策一部分信息。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2023] 雷同：同样考虑合并树，同样书的深度随重量递减，同样想象最优的树的生成过程。这里我考虑的是自底向上合并：如果书的深度均确定，那么过程可以看作，从大到小扫深度 $d$，每次加入当前深度的，然后两两合并，点上记一下磨损度。易发现按磨损度排序后两两合并是最优的，调整法易证这是个“下界”。立即可以得到一个 $\mathrm{O}(n^3\log{})$ 的区间 dp。&lt;/p&gt;
&lt;p&gt;考虑直接对叶子形成的折线 dp，如果从浅到深 dp，必须记深度和剩余允许的同层叶子数，多了个 $\log$。如果从深到浅，则不必记深度，只需记：以目前已生成叶子的 $\operatorname{lca}$ 为根的子树，将其视作 01 trie，到当前叶子的路径状态。转移包括直接定一个叶子和上移一层，其中后者可能导致根变，要加一个重量的前缀和。时间平方。&lt;/p&gt;
&lt;p&gt;容易发现，后一种 dp 更优的根源在于，其计算代价的方式从逐叶子变成了逐层，这与 [联合省选 2021] 滚榜 的思想一致。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;待填坑. [UR #20] 跳蚤电话、[UNR #7] 璀璨宝石&lt;/p&gt;
&lt;h3 id=&#34;第四步-优化-dp&#34;&gt;第四步 优化 dp
&lt;/h3&gt;&lt;p&gt;首先要明确一点：最好的优化 dp 的方法，是做好前三步，或在较劣的 dp 基础上重做前三步。很多时候 dp 不够优，要么是漏性质，要么是观察角度或结构生成方法不对。对着复杂的转移方程做一堆细节很多的优化，不如先重新审视模型，改变 dp 思路。当然有的题优化也是必需的。&lt;/p&gt;
&lt;p&gt;优化 dp 的第一步是观察清楚现有的 dp。观察的角度包括：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;dp 的组合意义。清晰的组合意义不仅能使一般的优化变得容易，还能提供“dp 方程之外的东西”。例如表达状态更本质的方法、不必要的状态和转移、转化状态的可能性、dp 的决策单调性等等。&lt;/li&gt;
&lt;li&gt;dp 的转移方程。这里个人建议在草稿纸上写清关于 dp 的所有信息：状态定义、转移方程、转移顺序、初值、终值、时间复杂度。通过写清这些东西，可以找到一些通用优化方法适用的特征，或是直接对方程进行数学方法处理。同时对写代码也有帮助。&lt;/li&gt;
&lt;li&gt;dp 的转移图。主要包括基于原模型的 dp 转移示意图和基于 dp 转移的表格图。可以较直观地找到优化方向，处理一些细节。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;dp 的优化分为&lt;strong&gt;对状态的优化&lt;/strong&gt;和&lt;strong&gt;对转移的优化&lt;/strong&gt;。注意，下面列举的许多优化都可以且建议在第三步设计 dp 的同时完成，而不是写出一个暴力 dp 后在其基础上优化。先讲对状态的优化。&lt;/p&gt;
&lt;h4 id=&#34;状态数的自简化&#34;&gt;状态数的自简化
&lt;/h4&gt;&lt;p&gt;有时，真正可能 dp 到的状态远少于 dp 状态每一维最大值之积。可能使用记搜简化代码。&lt;/p&gt;
&lt;h5 id=&#34;例-16&#34;&gt;例
&lt;/h5&gt;&lt;p&gt;其他. CF1188C、+CF662E、+CF771E、+CF1740F&lt;/p&gt;
&lt;h4 id=&#34;下标换元&#34;&gt;下标换元
&lt;/h4&gt;&lt;p&gt;令 $g_i$ 表示 $f_{t(i)}$ 然后对 $g$ 做 dp，这样的一个换元优化不仅能方便一些转移优化，还常能暴露出一些不必记或不必分开记的状态，触发状态数的自简化或状态合并等，从而减少状态数。建议从组合意义角度入手优化（微调状态定义）。&lt;/p&gt;
&lt;h5 id=&#34;例-17&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;CF1801F：如果记 $f_{i,p}$ 表示当前 $b$ 之积为 $p$，那是过不了的。考虑到剩余的 $b$ 应当满足积 $\ge\lceil k/p\rceil$，因此可以只记 $f_{i,r}$ 表示当前 $\lceil k/p\rceil=r$。对于一个 $i$，状态就只有 $\mathrm{O}(\sqrt{k})$ 个，转移再套一个整除分块，共 $\mathrm{O}\left(\sum_{i\le\sqrt k}(\sqrt{i}+\sqrt{k/i})\right)=\mathrm{O}(k^{3/4})$。&lt;/li&gt;
&lt;li&gt;CF662E：如果有 $\ge 90$ 个负的则答案为 $1$，否则显然考虑枚举每题属于哪一档，会得到一个背包，总共是 $6^3\cdot{30}^3\cdot90$ 这样。如果状态改为“剩下几个不被 hack”而不是“hack 几个”，总状态数就变为 $(30/2+30/4+\cdots)^3$，那就是 ${30}^3\cdot90$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;状态合并&#34;&gt;状态合并
&lt;/h4&gt;&lt;p&gt;在初步设计 dp 时，可能会设计一些含义较好理解的，但实际上有些信息没有必要区分的 dp 状态，可以在进一步分析时合并。&lt;/p&gt;
&lt;h5 id=&#34;例-18&#34;&gt;例
&lt;/h5&gt;&lt;p&gt;其他. [CSP-S 2019] Emiya 家的饭、+CF1060F、+CF1810G（解 1）&lt;/p&gt;
&lt;h4 id=&#34;最优性去状态&#34;&gt;最优性去状态
&lt;/h4&gt;&lt;p&gt;对于最优化 dp，可以利用一些性质去除不必要记的状态，一般是这个状态不可能生成最优解，或有多条路线可以生成最优解，去掉其中的部分。思考方法一般是想象一个解，然后调整它。计数问题一般不用这个套路，因为要么可以归到自简化一类，要么优化前的 dp 会计重。&lt;/p&gt;
&lt;h5 id=&#34;例-19&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;[NOIP2023] 天天爱打卡：注意到使连续打卡段的起点是奖励区间的起点，终点同理，一定不劣。因此只需要在这些断点上 dp 即可。奖励部分是一个经典的扫描后前缀加，用线段树维护即可。dp 按归并顺序。&lt;/li&gt;
&lt;li&gt;[IOI2022] 鲶鱼塘：关键性质是：可以调整使每列的堤一定建在一条鱼的下方，或者空或满。但这样还不够，因为一条鱼可能被两个堤同时覆盖，从而计重，另一个性质是，不可能 $h_{i-1}\ge h_i\le h_{i+1}$，或者说结构一定形如若干空列分隔的单峰。这时转移的代价只需在一侧计即可。归并顺序+前/后缀 $\max$ 转移。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;最优性换维&#34;&gt;最优性换维
&lt;/h4&gt;&lt;p&gt;对于最优化 dp，这就是常说的定义域值域互换。有一类交换一维状态和所记值的优化，即，将求“某种情况下最优的……值”转为求“要达到最优值为……，某维的值至少/多要达到多少”。对于判定性 dp，如果 dp 值关于某一维具有二分性，或具有“只需关注最左/右的 1”这类性质，也可以将这一维压到 dp 值里。&lt;/p&gt;
&lt;p&gt;注意，要刻意证明最优子结构。或者说，只考虑与记的最优值有关的转移，必然能把全局最优解/合法性求出来。&lt;/p&gt;
&lt;h5 id=&#34;例-20&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[UCup2Stage4] J. Joining Cats：考虑最后一步，比如是从左往右，那必定只有第一只猫是合并过的。因此任何时刻被合并的一定是一段。于是得到一个 3D 的判定性 dp，有两个压的思路：对一个区间求最小并完时间，对一个左端点和一个时间求最大右端点。刷表，每次要求一个点向左/右最远可以合并到哪里，这个可以双指针替代二分。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF822E：暴力 dp 为 $f_{i,j}$ 表示  $s,t$ 分别匹配到 $i,j$，最少分几段。断点转移是一次决策一段，单步转移得再记维 $0/1$，表示当前段匹配是否完结。换维，如果保留 $j$ 则由于原 dp 存在一个 $f_{i,j}\rightarrow f_{i+1,j}$ 的转移，故转移难以 0D，因此考虑 $g_{i,k}$ 表示 $s$ 匹配到 $i$，分了 $k$ 段，最多匹配到 $t$ 的哪里。这时我就考虑也写成单步转移，结果错了。反例是 $s=\texttt{aaab},t=\texttt{aab}$，由于 $g_{2,1,1}=2$，故后面会断掉。这就是一个不具有最优子结构的例子，这题不能单步（您可能会问，如果对于每个 $j\le g_{当前}$ 都做呢？问题是并非每个 $j$ 都合法）。但断点转移是有最优子结构的（易调整法证明），得支持求两个后缀的 LCP，套 SA 或哈希+二分即可。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;经验是，如果 dp 值用于决定转移的条件或位置，那就要当心最优子结构。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1091H：转化略。打表发现 SG 值至多为 $l=54$，这里用一个神奇的优化：从小到大枚举 SG 值，求出哪些情况的 SG 值为它。用刷表法，每当确定了一个位置，它的所有可能的前一步情况的 SG 值就不可能是当前值。这可以 bitset 优化为 $\mathrm{O}(lm+m^2\log\log m/(w\log m))$。这个优化相当于逆着用判定性转最优化，常用于最优化 dp 值域 $l$ 较小的情况，可以将复杂度除掉 $w$（如果转移比较好处理）或乘以 $l/w$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF936D：位置必须要记，这样的话状态里就不能记别的东西了。注意到如果摧毁一个障碍，那么必须经过它，且经过前不换行。但也不能记摧毁了几个障碍和装弹时间。这里就考虑 dp 值记录当前最长预留装弹时间，可以 $&amp;gt;t$，每经过一个障碍减 $t$，换行时与 $t$ 取 $\min$。最后改成断点转移来减少状态：换行只会出现在一个障碍物后面一格，因为晚换行不如早换行。这里建议先分析清暴力 dp 的方程，再改成离散化过的状态，更易写方程。以归并的顺序 dp 即可。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. [NOI2022] 移除石子、dmy guess&lt;/p&gt;
&lt;h4 id=&#34;最优性去维&#34;&gt;最优性去维
&lt;/h4&gt;&lt;p&gt;对于最优化 dp，有时性质较强，可以将状态维度移入最优化目标，形成一个 pair 形 dp 值且不损失最优子结构性质。一般来说性质形如“如果值不够优，那么另一维再怎么样也没用；如果值最优了，那就尽量使另一维更优”。这个性质一般通过分析数量关系或通过找样例守恒规律得到。&lt;/p&gt;
&lt;p&gt;当最优性去维的性质强到一定程度，决策就变得单一，dp 就变成了贪心，如下面的例子。&lt;/p&gt;
&lt;h5 id=&#34;例-21&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1453E：走的是个 dfs 序，直接树形 dp 会涉及子树内答案和最后一个访问的叶子深度，不能做，因此可以二分后只记最优的最后一步深度。但这题有更强的性质：考虑一个非根点的所有儿子子树的最后一步深度 $h_i$ 都已确定，那么除了这个点最后一个走的儿子以外，其余的儿子的 $h$ 都要加一后取 $\max$ 给答案，而最后一个儿子的 $h$ 要加至少一，因为它要到子树外面去。故会选 $\min h$ 作为最后一个，归纳地，每个点子树最后一个必走最浅叶子。根特殊讨论。从而“最后一步深度”这维可以去掉，或者说变成一个待统计的定值。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[CSP-S 2019] 划分：（&lt;a class=&#34;link&#34; href=&#34;https://matthew99.blog.uoj.ac/blog/5299&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;参考&lt;/a&gt;）有一个显然的 2D 暴力，打表发现最后一段尽量短是最优的，因此不用记第二维。证明考虑归纳+调整。设最后一段最短，前面也最优的解为 $P$，另一个解为 $Q$，它一定形如这样：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;P: x|x|x x|x x|x x x|x x|x x x|x x x
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Q: x|x|x|x x|x x x|x x|x x x|x x x x
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;即 $O$ 的倒数第 $i$ 个切点都在 $P$ 的对应切点前面（如果不是则可以调整证 $P$ 不优）。现在尝试调整证 $Q$ 不优于 $P$，发现直接硬调整是困难的。考虑直接从数值上证，即不增序列 $p_{1\cdots k},q_{1\cdots k}$，$p_1&amp;lt;q_1$，$\forall\,i,\sum_{j=1}^ip_j\le \sum_{j=1}^iq_j$ 且 $\sum_{j=1}^kp_j=\sum_{j=1}^kq_j$，则 $\sum_{j=1}^kp_j^2&amp;lt;\sum_{j=1}^kq_j^2$。由于和相等，故必然有两位置 $j_1&amp;lt;j_2,\text{ s.t. }p_{j_1}&amp;lt;q_{j_1},p_{j_1+1}=q_{j_1+1},\cdots,p_{j_2-1}=q_{j_2-1},p_{j_2}&amp;gt;q_{j_2}$，这时将 $q_{j_1}\xleftarrow{-}1$，$q_{j_2}\xleftarrow{+}1$ 会更优。剩下就是每个位置求出以它结尾的最后一个切点 $f_{i}$，$f_i=\max\set{j\mid s_i-s_j\ge s_j-s_{f_j}}$，单调队列即可。&lt;/p&gt;
&lt;p&gt;这个调整法很有教育意义。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOIP2018 提高组] 赛道修建：二分。剩下的 dp 需考虑内部已有的路径数和当前传上来未完结的直链长度。一个符合直觉的结论是，一定优先让内部路径数最优，再使当前直链尽量长。因为当前直链至多贡献 $1$，如果内部路径数不是最优，直链再怎么长也不会优，这和 CF771E（解 1）类似。于是问题转化为，有一堆数，要尽可能两两匹配使和 $\ge mid$，再最大化未匹配的最大值。一个性质是，如果最小值可以匹配，那一定有最优解中它匹配了，这个可以调整证。显然找 lower_bound 配即可，于是就归约下去。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. +CF771E（解 1）、CF1795F&lt;/p&gt;
&lt;h4 id=&#34;扩大可行域&#34;&gt;扩大可行域
&lt;/h4&gt;&lt;p&gt;对于最优化 dp，可能为了保证解的合法，需要记录额外的维度；但有些不合法解它不可能成为最优，这时就可以默许它被考虑，从而减少要记的信息量。一个利用该思想的非 dp 问题是，定义一个序列合法条件，求一个序列的最长合法区间。区间会要求有一个一维偏序，但显然不考虑 $l\le r$ 也是可以的。&lt;/p&gt;
&lt;h5 id=&#34;例-22&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;USAC23JANPlatinumT2：每个点的收益取决于最后一次到的时刻，但 $q$ 较大，故不能与询问时间相关，因此只能考虑每个点的亏损，但如果有点从未到达那还是会出问题，因此考虑枚举到过的点集（dp 刚好也要用上这些中间状态），这时对于询问相当于查某个 $x$ 的最高直线，可以处理出凸壳再回答。第二步完成，现在的 dp 对象相当于是给每个固定终点的点集安排一条线路，直接 dp 需要记录当前已耗时，不行；这时可以模仿 [联合省选 2021] 滚榜 的思路，直接考虑走一条边对之前的最后一次到达的点的亏损增量。$f_{S,i}$ 表示当前在 $i$，先前已经强制钦定最后一次到达的点集为 $S$（$i\in S$）的最小亏损，枚举下一个点即可。&lt;/p&gt;
&lt;p&gt;这里有两个问题：① 既然每次决策一条路径，那么如果又经过了已钦定“最后一次到达”的点那怎么计算？② 如果一个方案总时间大于询问的 $s$ 那怎么办？回答是：如果一个解违反了这两个问题中的合法条件，那么它一定不会是最优解，但最优解总是会被 dp 到的，所以没事。如果偏要考虑这两个问题，那 dp 就不容易了。&lt;/p&gt;
&lt;p&gt;你可能会问：是怎么想到如此扩大可行域的？&lt;b&gt;答案是优先考虑生成过程的完备性（涵盖所有合法解），暂且忽略纯粹性（不含不合法解），然后到头来再简单证明一下。&lt;/b&gt;也就是说这个设计过程是有些冒险的，但对本题模型的直觉告诉我应该没什么问题。他有一个“偏序关系”在里面。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2022] 翻修道路：对最短路树 dp。$f_{i,j,s}$ 表示目前根为 $i$，子树内关键点集合为 $s$，至多改 $j$ 条边权。当 $j$ 和 $s$ 不变时，所有的 $i$ 之间跑最短路互相更新；两个子树合并时，注意到 $f_{i,*,s}$ 递减，故决策一定形如归并，可以做到 $\mathrm{O}(2^knm\log m+3^knm)$。&lt;/p&gt;
&lt;p&gt;这题的问题在于，dp 不能保证最短路树是真的最短，甚至不能保证是树，不能保证不会重复改同一条边的权！但是这些都是无所谓的，因为它们不会导致不合法的更优解。这题是一个经典的类型：要求 $\min_S\set{f(S)}$，然后 $f(S)$ 也是个 $\min$ 的形式，就直接用 dp 同时最优化这两个 $\min$。另外这题的生成思路和最小斯坦纳树相同。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;（就硬推销自己的博客）您看&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/yeah-potato/du-lun-wen-xi-lie-1-chuan-yu-dag-de-lcs&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这个问题&lt;/a&gt;的求解中第二步也用了这个技巧！&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;接下来是转移优化。&lt;/p&gt;
&lt;h4 id=&#34;前后缀&#34;&gt;前后缀
&lt;/h4&gt;&lt;p&gt;对于一类转移范围为一个前后缀（或能转化为前后缀，例如利用可减性，或记次优值等等）且方程中的项都只与转移和被转移的其中一方有关的 dp，可以（换元后）用前后缀或类似预处理方法优化。通常用填表法会比刷表法方便，有时也可以用刷表，就是会变成差分。&lt;/p&gt;
&lt;p&gt;前后缀处理优化实在是太入门了，这里就不给例子了。&lt;/p&gt;
&lt;h5 id=&#34;例-23&#34;&gt;例
&lt;/h5&gt;&lt;p&gt;其他. USACO21OPENPlatinumT3&lt;/p&gt;
&lt;h4 id=&#34;多步拆单步&#34;&gt;多步拆单步
&lt;/h4&gt;&lt;p&gt;这个优化范围比较广，也没有固定的模式。前后缀优化可以视作这个的子集。多步拆单步的核心思想就是构造中间状态去“合并”转移，在 dp 设计思路也提到过，在可以单步时，单步往往比断点优。这张图很直观地展现了其原理，很像某些建图优化。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\dp\3mvijowq.png&#34; style=&#34;zoom:25%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;除了对着公式优化外，直接从组合意义出发寻找新增的中间状态也是可以的。&lt;/p&gt;
&lt;h5 id=&#34;例-24&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1736E：称当前轮数取的 $a_i$ 位置为取值点。分析解的结构，某些数字会往前交换使其早贡献，然后在到达取值点后会往后交换跟着走。一定不会取值取到交换导致的 $0$，否则可以少往前交换使答案不劣。&lt;/p&gt;
&lt;p&gt;（解 1）$f_{i,j,k}$ 表示取值点在 $i$，取值 $a_j$，目前前面空余的交换轮数为 $k$。一种是 $a_j$ 跟着走，一种是换取值，$f_{i,j,k}\rightarrow f_{i+1,j^\prime ,k-j^\prime +i+2}(j^\prime &amp;gt;\max(i,j))$。从填表法角度看好优化，只需求出 $f$ 关于 $j$ 的前缀 $\max$ 即可。&lt;/p&gt;
&lt;p&gt;（解 2）考虑断点转移，$f$ 的状态类似解 1，$j$ 在取值点 $i$ 开始贡献，但转移直接枚举下一段贡献，$f_{i,j,k}\xrightarrow {(i^\prime -i)a_j}f_{i^\prime ,j^\prime ,k-j^\prime +i^\prime +1}(i^\prime &amp;gt;i,j^\prime &amp;gt;j,j^\prime \ge i^\prime )$。可以拆贡献后两次前缀 $\max$ 处理，我当时考虑的是令 $g_{i,j,k}$ 表示 $j$ 在取值点 $i$ 最后一次贡献，这样 $f\rightarrow g$ 是枚举 $i^\prime $，$g\rightarrow f$ 是枚举 $j^\prime $，我当时原地化了一下，显得很符合直觉。结果发现这个 $g$ 不就是辅助数组嘛！&lt;/p&gt;
&lt;p&gt;这两个解法它的辅助数组都是有组合意义的（解 1 的前缀 $\max$ 就是变选择但不决策，类似于前文里一些整数拆分背包），这就是为什么说直接从组合意义出发寻找新增的中间状态也是可以的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;倍增&#34;&gt;倍增
&lt;/h4&gt;&lt;p&gt;倍增优化适用于状态数量与转移轮数（较大）无关的情况，在具体题目中一般体现为“不需要记用了几次”这类。一些典型问题包括各种矩乘、完全背包、某些卷积（哎呀反正是个半群就行）等。也是很入门，不讲例子了。&lt;/p&gt;
&lt;p&gt;提几个延伸的东西：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;我感觉矩乘并算不上 dp 的优化，只是一类 dp 转移的通用刻画方法。真正和 ds 无关的技巧也不多，一个是乘向量优化，即，有多组询问时先预处理每个 $T^{2^i}$，然后二进制分解后逐一乘给向量。例子包括 [NOI2020] 美食节 和 [POI2015] Wycieczki。另一个是对于一些特殊矩乘，可能会抽象过度，实际可以记更少的信息。例如 USACO23OPENPlatinumT1 以及某些 ddp。&lt;/li&gt;
&lt;li&gt;这类倍增可以解决的 dp 在指数极大时往往能通过分析循环节等找到更优的做法，至少能避免倍增的大 $\log$。例如矩乘可以找特征多项式后线性递推，完全背包可以利用上面提到过的性质先贪心，图上定长最短路可以参考 [互测 2023] 【模板】矩阵快速幂。大的思想就是存在不依靠 dp 的更简单的规律。这些就不讨论了。&lt;/li&gt;
&lt;li&gt;有一类树上倍增维护 dp 支持多次询问的问题，例如 [NOIP2018 提高组] 保卫王国、[CSP-S 2022] 数据传输，它们实质上是纯 ds 问题，跟这里讲的“倍增”是不同的。一般有记录头尾状态和直接套矩乘两种思路，可以推广到 ddp。这篇文章里不会讲 ddp。可以详见猫锟的 ppt 和 17 年集训队论文，以及任轩笛的 18 年集训队论文。&lt;del&gt;反正大不了就套 top tree。&lt;/del&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&#34;例-25&#34;&gt;例
&lt;/h5&gt;&lt;p&gt;咕&lt;/p&gt;
&lt;h4 id=&#34;ds-维护-dp-数组&#34;&gt;ds 维护 dp 数组
&lt;/h4&gt;&lt;p&gt;对于一类状态过多，但转移有规律可循的 dp，可以使用 ds 维护 dp 数组，本质就是快速维护 dp 转移时的增量。这类优化有很多子类别：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;原地化（？）。谁说数组不是 ds 呢？众所周知背包问题可以原地转移而不必滚动数组，这实质上是在状态中隐去了一个维度，使同一位置在一些不相交的时段具有不同的含义（注意要与去维/合并状态区分开，它们是不必考虑某一维，而这里说的是不显式记某一维）。这类优化在状态多于转移时有很好的作用。&lt;/li&gt;
&lt;li&gt;各类线段树维护（注意与线段树优化 dp 区分）。除了基础的在序列上优化外，还有一类所谓整体 dp，也就是树上 dp 中每个节点上要记一个数组，合并儿子时是直接对应位合并然后加少量修改。这可以直接用线段树合并维护。注意这类线段树是可以打 tag 的，如果 tag 对未建出节点无影响，就判一下即可，否则可以 pushdown 时再新建并下放一层，merge 中出现有一方有点但无儿子时视作 base case 即可（我是从（nfls 7.19 秒速五厘米）的非官方解法学到的），这个 trick 又出现在了 [CTT2023] emerald 里。&lt;/li&gt;
&lt;li&gt;重剖（dsu on tree）与长剖。值得注意的是它们是支持换根 dp 的，只要保证轻儿子要用的子树外 dp 状态数只与该子树的 siz/dep 有关即可。详见 [十二省联考 2019] 希望，&lt;del&gt;由于太阴间这里就不讲了。&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;slope trick。用于 dp 值关于某一维有凸性的一些情况，详见&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/blog/entry/47821&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/blog/entry/77298&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇&lt;/a&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&#34;例-26&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;CF1770E：答案可以转化为求每条边贡献的期望，而每条边的贡献只会在它本身交换时变化，因此只需考虑每个时刻每个点为关键点的概率 $p_{u}$，发现转移相当于是将边两端的 $p$ 取平均。这个 dp 实际原地掉了时间维。&lt;/li&gt;
&lt;li&gt;CF1699E：不妨枚举 $\max$，最大化 $\min$。注意到最优拆分的变化次数为 $\sum\sigma(a_i)$，时间能接受，但空间不行。这时如果放弃该思路就无路可走了。考虑维护每个 $a_i$ 当前的最大 $\min$，搞不了，得求出 $f_{m,x}$ 表示最大值 $\le m$ 时数 $x$ 的最优解，如果 $m\mid x$ 则 $f_{m,x}=\max\left(f_{m-1,x},f_{m,x/m}\right)$，否则 $f_{m,x}=f_{m-1,x}$。这就给出了一个可以原地优化的转移数为 $\mathrm{O}(m\log m)$ 的 dp，从小到大扫 $m$，用桶+指针维护最优 $\min$ 即可。&lt;/li&gt;
&lt;li&gt;[IOI2018] 会议：从笛卡尔树角度来看，只需求每个节点的每个前后缀的答案。以前缀为例，左半直接继承，$f_{u,[l_u,u)}=f_{ls_u,[l_u,u)}$；对于 $i&amp;gt;u$，$f_{u,i}=\min(f_{ls_u,u-1}+(i-u+1)h_u,f_{rs_u,i}+(u-l_u+1)h_u)$，这是先继承 $f_{rs_u}$ 全体加，然后与一条直线取 $\min$。固然可以扩展李超树（区间加时不必沿途下方直线），但是考虑到 $f_{rs_u}$ 是递增且差分均 $\le h_u$（直接考虑意义即可），故可以二分取 $\min$ 切换点做到单 $\log$。在线段树上做，继承直接不动即可。&lt;/li&gt;
&lt;li&gt;[NOI2020] 命运：容斥不容斥最后 dp 形式类似，这里以容斥为例。如果强制钦定一条链全 $0$，那从树形 dp 角度相当于限制了当前点到根最深的 $1$ 的深度上界。把该限制对应的维度用线段树维护，在一条链的底部，选该链就相当于区间求和后减到 $dep_{top}$ 上；两树合并相当于 $\min$ 卷积，可以线段树合并时记一个后缀和。&lt;/li&gt;
&lt;li&gt;CF1534G：顺时针转 $45^\circ$，一个土豆一定在到达对应横坐标时种。dp 状态就记录当前坐标，每次跳到下一个有土豆的横坐标，这个转移相当于与长为 $\Delta x$ 的水平线段作闵可夫斯基和；加土豆相当于全体加上 $\lvert y-C\rvert$。归纳即可证凹。这题涉及斜率区间加和斜率交界点区间位移，线段树无法胜任，可以用平衡树。特殊地，由于只会延长壳的底部，故可以把谷两边的斜率交界点分开维护，用堆就行。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. CF671D&lt;/p&gt;
&lt;h4 id=&#34;ds-优化-dp-转移&#34;&gt;ds 优化 dp 转移
&lt;/h4&gt;&lt;p&gt;这类优化没有通用的方法，得结合具体 dp 方程来看。多步拆单步优化也算属于这个。&lt;/p&gt;
&lt;p&gt;注意复杂的 ds 优化 dp 题在填表和刷表时会有较大区别，都要试一下。&lt;/p&gt;
&lt;p&gt;ds 优化 dp 转移有一个重要的子集，是决策单调性优化，这里详细讲一下。&lt;/p&gt;
&lt;h5 id=&#34;决策单调性&#34;&gt;决策单调性
&lt;/h5&gt;&lt;p&gt;所谓决策单调性就是决策点有单调性的 dp。对于在线形式的 dp，如果仅有决策单调性，那应该是无法优化的，必须具有更强的性质（参见 4）。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;单调队列/单调栈优化。一般从“没前途”角度考虑。略。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;二分求决策点。只有在转移值严格单峰时才能用，较少见。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;斜率优化。斜率优化有两种等价形式，分别是将其中一方视作直线/点，另一方视作一个横坐标/去切的斜率。当转移方是静态或加入具有单调性时，可以直接用单调队列/单调栈维护凸壳，否则需要用平衡树或李超树维护。值得注意的是，并非只有 $f_i=\min/\max\set{k_ik_j+b_j}$ 形式可以优化，有些特殊形式的具有较强“没前途”性质的 dp 也可以，详见 [NOI2016] 国王饮水记。另外这类利用”没前途“性质排除转移的 dp 应该能推广到凸壳外的其他结构（例如曼哈顿距离下的凸壳等等），参考 [互测 2023] Grievous Lady。我不是很会。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;四边形不等式优化。有三个形式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$f_{i,j}=\min_{k=i}^{j-1}\set{f_{i,k}+f_{k+1,j}}+w_{i,j}$。若 $w$ 满足 QI，且 $\forall a\le b\le c\le d,w_{a,d}\le w_{b,c}$，则 $f$ 也满足 QI，且 $p_{i,j-1}\le p_{i,j}\le p_{i+1,j}$，可以按区间长度从小到大转移，三次方变两次方。&lt;/li&gt;
&lt;li&gt;$f_{i,j}=\min_{k=0}^{j-1}\set{f_{i-1,k}+w_{k,j}}$。若 $w$ 满足 QI，则 $f$ 也满足类 QI，且 $p_{i-1,j}\le p_{i,j}\le p_{i,j+1}$，可以类似形式 1 转移，也可以利用分治（对于一个 $i$，先求 $p_{i,n/2}$），都是减一次方。这里计算单点 $w$ 可以暴力移指针。&lt;/li&gt;
&lt;li&gt;$f_i=\min_{j=0}^{i-1}\set{f_j+w_{j,i}}$。若 $w$ 满足 QI，则 $p_i\le p_{i+1}$，且对于 $i&amp;lt;i^\prime ,j&amp;lt;j^\prime $，若在 $i$ 处 $j^\prime $ 更优，则在 $i^\prime $ 处 $j^\prime $ 必定更优。这就给出了一个单调队列上二分的方法。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中后两个情况的 $\log$ 是可以去掉的，详见冯哲的 17 年集训队论文。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;闵可夫斯基和以及其他与凸性相关的东西。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&#34;例-27&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1830F：（解 1）$f_i$ 表示最后一个选点 $i$，填表：记 $c_{i,j}$ 表示 $l\le j\le r&amp;lt;i$ 的区间数量，$f_i=\max_j\set{f_j+a_jc_{i,j}}$。相当于有一堆直线 $y_j=a_jx_j+f_j$，每次选一段 $x_j$ 加一，求全局 $\max$。只能 KTT。&lt;/p&gt;
&lt;p&gt;（解 2）状态同解 1，刷表：希望对于一个 $j$，一次性更新所有的 $i$，因此对于所有 $i$，维护解 1 中的 $c$，如果它不变，那相当于一个序列，每次与一条直线取 $\max$；但随着 $j$ 的移动，这些 $c$ 可能会区间加减，但原先更新的又不能变。相当于要维护一个取值点会变的李超树，由于 $c_{i,j}$ 关于 $i$ 递增，故可以用&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/blog/entry/86731&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;扩展李超树&lt;/a&gt;维护。&lt;/p&gt;
&lt;p&gt;（解 3）倒过来考虑，填表：记 $c_{i,j}$ 表示 $j&amp;lt;l\le i\le r$ 的区间数量，$f_i=\max_j\set{f_j+a_jc^\prime_{i,j}}$，这相当于维护一堆斜率会变（后缀加减）的直线，求某个横坐标对应的最大值。由于 $c_{i,j}$ 关于 $j$ 递减，故可以尝试用线段树套凸壳维护，合并时二分。如果一个节点上全体加减，那凸壳的结构是不变的。估计很难写。另外倒过来刷表涉及到一个奇怪的历史最值，不大能维护。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1720D2：一个 $i$ 从所有 $j&amp;lt;i$ 满足 $a_i\oplus j&amp;gt;a_j\oplus i$ 转移，无法直接 trie 树优化。如果是 $=$ 则可以变成 $a_i\oplus i=a_j\oplus j$。考虑硬套 trie 树，当 $a_i\oplus i$ 在上面走时，比如从一个点走到一个儿子，那在另一个儿子子树中的 $j$ 应当恰好有“一半”可以转移，这样的 $j$ 满足 $j$ 与 $a_i$ 的当前位相同。因此每个节点只需记两类值即可。这种同时与异或和偏序相关的问题可以魔改 trie 树，类似的套路出现在 [NOI Online 2021 提高组] 岛屿探险。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1603D：易证只需考虑 $k\le\log n$。$f_{i,j}$ 表示考虑到 $x_i=j$ 的答案。&lt;/p&gt;
&lt;p&gt;（解 1）注意到所有 $c(*,j-1)\rightarrow c(*,j)$ 是 $\sigma(j)$ 段区间加。因此用线段树维护所有 $f_{i-1,k}+c(k,j)$ 即可 $\log^3$。&lt;/p&gt;
&lt;p&gt;（解 2）$c(l,r)=\sum_{g=l}^rS(r/g)$，其中 $S(n)$ 为 $\varphi$ 的前缀和。注意到 $\forall\,l_1\le l_2\le r_1\le r_2,c(l_1,r_2)+c(l_2,r_1)-c(l_1,r_1)-c(l_2,r_2)=\sum_{g=l_1}^{l_2-1}(S(r_2/g)-S(r_1/g))\ge 0$，故可以套四边形不等式的分治做法。求 $c$ 的方法，注意到可以 $\mathrm{O}(1)$ 移动左端点，均摊 $\mathrm{O}(\log n)$ 移动右端点，而分治做法中左右端点移动在 $1\sim n$ 上求值次数是均匀的，故是 $\log^3$ 的。另一个常数较小的做法是先整除分块求出某个 $c(?,mid)$，再只移左端点。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOI2016] 国王饮水记：转移方程形如 $f^\prime_i=\max_{j&amp;lt;i}\set{(f_j+s_i-s_j)/(i-j+1)}$，发现似乎是求 $(j-1,s_j-f_j)-(i,s_i)$ 的最大斜率，因此可以维护一个下凸壳。同时，打表发现决策点有单调性，因此用队列维护即可 $\mathrm{O}(nkp)$，后面的优化与本节无关，略。&lt;/p&gt;
&lt;p&gt;决策单调性的证明似乎网上的题解都有问题。考虑 $j^\prime &amp;lt;j$ 且 $j^\prime $ 劣于 $j$，即 $(f_{j^\prime }+s_i-s_{j^\prime })/(i-j^\prime +1)\le(f_j+s_i-s_j)/(i-j+1)$。那么 $i+1$ 时：
$$
\begin{aligned}
&amp;amp;(f_j+s_{i+1}-s_j)(i-j^\prime +2)-(f_{j^\prime }+s_{i+1}-s_{j^\prime })(i-j+2)\\
={}&amp;amp;(f_j+s_i-s_j)(i-j^\prime +1)-(f_{j^\prime }+s_i-s_{j^\prime })(i-j+1)+h_{i+1}(j-j^\prime )+f_j-s_j-f_{j^\prime }+s_{j^\prime }\\
\ge{}&amp;amp;h_{i+1}(j-j^\prime )-(s_j-s_{j^\prime })\\
\ge{}&amp;amp;0
\end{aligned}
$$
不是只有四边形不等式才有这个性质的。注意，如果不求凸壳直接走指针是错的，数据专门卡了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[Tsinghua Bootcamp 2023 Qualification Round] L. Fence Decoration（给定 $x_{1\cdots n},c_{1\cdots n},d_{1\cdots m}$，$x$ 递增，选择 $x$ 的子序列下标 $p_{1\cdots k}(p_1=1,p_k=n)$，最大化 $\sum_i\sum_j\lvert x_{p_{i+1}}-x_{p_i}-d_j\rvert-\sum_ic_{p_i}$）：dp 是 $f_i=\max_{j&amp;lt;i}\set{f_j+g(x_i-x_j)}-c_i$，其中 $g(x)$ 是下凸的。直接维护所有可选项 $\max$ 起来的凸壳或用 KTT 的话需要求两个多段凸壳的交点，很困难。&lt;/p&gt;
&lt;p&gt;（解 1）注意到，两个可选项对应的凸壳只在至多一处相交（因为是全等的），这就可以用李超树维护。&lt;/p&gt;
&lt;p&gt;（解 2）由于琴生不等式，转移的代价有四边形不等式，但是这里是 $\max$，也就是对于 $i&amp;lt;i^\prime ,j&amp;lt;j^\prime $，如果 $i$ 处 $j$ 更优，则 $i^\prime $ 处 $j$ 也更优。因此这里可以用一个类似上文方法 3 的做法，用单调栈维护转移点的递减段。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其他. CF1067D&lt;/p&gt;
&lt;h4 id=&#34;有后效性-dp-的处理&#34;&gt;有后效性 dp 的处理
&lt;/h4&gt;&lt;p&gt;对于最优化问题，如果所有转移的起点只与一个 dp 值相关，那就是最短路，否则我也不会。计数问题要么魔改高斯消元，要么手玩方程。&lt;/p&gt;
&lt;p&gt;有些比较诡异的题。&lt;/p&gt;
&lt;h5 id=&#34;例-28&#34;&gt;例
&lt;/h5&gt;&lt;p&gt;其他. CF865C、[THUPC 2023 初赛] 最后的活动、+CF1778D、+CF1667E、（字符串）&lt;/p&gt;
&lt;h4 id=&#34;cdq-分治&#34;&gt;cdq 分治
&lt;/h4&gt;&lt;p&gt;这里指的是四边形不等式以外的 cdq 分治优化转移。对于复杂的断点转移问题，有时可以用 cdq 分治，求出转移和被转移双方与当前 mid 的关系，再借助 ds 优化转移。有些类似于多步拆单步的变形。&lt;/p&gt;
&lt;p&gt;这类题较罕见，我目前只遇到过两道。&lt;/p&gt;
&lt;h5 id=&#34;例-29&#34;&gt;例
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1175G：先写出暴力 dp：记 $mx_{l,r}=\max_{i=l}^r\set{a_i}$，则 $f_{i,j}=\min_{k&amp;lt;j}\set{f_{i-1,k}+(j-k)mx_{k+1,j}}$。不存在决策单调性。这里只考虑逐个 $i$，全体转移，因此接下来忽略 $i$。&lt;/p&gt;
&lt;p&gt;（解 1）填表。用栈维护 $mx$ 相同的段 $s$，每段的 $mx_s$ 会永远相同但会变，最优解形如 $opt_s=\min\set{f_k-k\cdot mx_s}$，维护其凸壳，支持合并，可以用李超树（也可以用单调队列之类的，启发式合并）。转移考虑每段，形如 $\max_s\set{opt_s+mx_s\cdot j}$，要维护一个大的凸壳，支持加直线和撤销上一次加入，可以用可持久化李超树。&lt;/p&gt;
&lt;p&gt;（解 2）利用笛卡尔树结构固定 $\max$。在点 $j$ 处求 $f_j$ 并将其挂到点 $j+1$ 上，这样所有的转移就形如：对于一个点 $u$，求出 $\min_{v\in\mathrm{lsub}_u\cup\set{u}}\set{f_{v-1}-(v-1)a_u}$，并将它更新给 $\mathrm{rsub}_u$，或者说，将该值记为 $g_u$，每次求 $\min_{v\in\mathrm{anc}_u}\set{g_v+a_v\cdot u}$。这个和解 1 本质上是相同的。&lt;/p&gt;
&lt;p&gt;（解 3）cdq 分治。直接扫 $[mid+1,r]$ 之间的每个位置转移还是不行的，这里关键要利用 $mid$。如果 $\max$ 选在左半段，那么被转移点只能从左半段的一个前缀转移，从右往左扫被转移点 $j$，维护可选前缀（只增不减）的凸壳，转移形如 $\min_{l\le k\le p}\set{f^\prime_k+mx_k\cdot j}$，由于 $mx$ 只减不增，故可以直接栈维护。如果 $\max$ 选在右半段，类似地从左往右扫被转移点 $j$，维护可选后缀的凸壳，转移形如 $\min_{mid\ge k\ge p}\set{f_k-k\cdot mx_j}$，还是可以用栈维护。注意这里不是用队列维护的原因是，加线和最优取值删线是同侧的。这个写起来比前两种简单很多。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF771E：（解 2）考虑断点转移，dp 状态只记录跨行矩形的尾。在 $i$ 时枚举 $j&amp;gt;i$，先贪心放一堆行内矩形到 $j$，再从 $j$ 往后放一个跨行矩形。直接转移会平方，考虑 cdq 分治优化，$i$ 在 $mid$ 之前，$j$ 在 $mid$ 之后。两边可以分别以 $mid$ 为边界贪心向右/向左跳，然后考虑跨 $mid$ 的行内矩形，共四种情况。有跨 $mid$ 的矩形就左边再贪心跳一次，这样就转化成一次全体更新，两次一维偏序，一次二维偏序。$\mathrm{O}(n\log^2n)$。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;参考文章&#34;&gt;参考文章
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;邓明扬，《杂题选讲》，WC2022 讲课。&lt;/li&gt;
&lt;li&gt;《一类动态规划选讲》。&lt;/li&gt;
&lt;li&gt;Alex_Wei，《DP 优化方法大杂烩》，&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/alex-wei/p/DP_Involution.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.cnblogs.com/alex-wei/p/DP_Involution.html&lt;/a&gt; &amp;amp; &lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/alex-wei/p/DP_optimization_method_II.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.cnblogs.com/alex-wei/p/DP_optimization_method_II.html&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;OI-Wiki，《四边形不等式优化》，&lt;a class=&#34;link&#34; href=&#34;https://oi-wiki.org/dp/opt/quadrangle/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://oi-wiki.org/dp/opt/quadrangle/&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;@&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/user/113570&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;changruinian2020&lt;/a&gt; 给予我的指示。&lt;/li&gt;
&lt;li&gt;@&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/user/273523&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;linrui&lt;/a&gt; 与我讨论的一些题目和思路。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一些例题参考了各处的题解，但是基本都是我先自己想出来的。如果是后来发现的一些他人独创的解法我都标出来了，如果您觉得漏标了可以提醒我。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>严谨的 WQS 二分方法</title>
        <link>https://littlereuben.github.io/study/wqs/</link>
        <pubDate>Tue, 31 Oct 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/wqs/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;下文中的 $\max/\min$ 可以为了严谨起见理解成 $\sup/\inf$。&lt;/p&gt;
&lt;p&gt;众所周知，WQS 二分优化的是这样一类问题：有一个函数 $f(x)$，给定 $a$，希望求得 $f(a)$，但是 $f$ 的单点值无法快速求。这时，如果有以下性质之一：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$f(x)$ 上凸，且能快速求 $\max_x\set{f(x)-kx}$。&lt;/li&gt;
&lt;li&gt;$f(x)$ 下凸，且能快速求 $\min_x\set{f(x)-kx}$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;那么就可以利用二分 $k$（也就是所谓的“多选扣分”）的方法“凑”出所需的 $f(a)$。&lt;/p&gt;
&lt;p&gt;接下来只以满足第 1 种性质的 $f$ 为例。&lt;/p&gt;
&lt;h2 id=&#34;常用的不严谨方法&#34;&gt;常用的不严谨方法
&lt;/h2&gt;&lt;p&gt;问题出在二分判定的时候。常用的写法要求 check 函数返回一个取到 $\max$ 的 $x_0$ 值，然后与 $a$ 比较大小。如果 $x_0$ 是任选的，那么如果二分的斜率恰好正确，而切线上有多于一个点（所谓“共线情况”），那么 $x_0$ 与 $a$ 的大小关系是任意的。而由于整数二分一定有一边会排斥掉 $mid$，故这个做法是错误的。&lt;/p&gt;
&lt;p&gt;相应的弥补方案有两种。一种是 check 返回最小或最大的 $x_0$。例如返回最小的 $x_0$，如果 $x_0\le a$，那么 $r\gets mid$，否则 $l\gets mid+1$。另一种是实数二分，其正确的原因在于总是不排除 $mid$，这样正确的斜率总是包含在 $[l,r]$ 中，而如果整数二分这样做，就会在区间为 $[l,l+1]$ 时卡住。以 $l=1$ 为例：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;wqs\wqs1.png&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;实数二分考虑了这条红切线（$k=l+0.5$），因此可以区分绿点是在哪一边。&lt;/p&gt;
&lt;p&gt;但是这两种处理方法面对着一个共同的问题，即高维的情况无法简易地处理：&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/problemset/problem/739/E&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CF739E&lt;/a&gt; 和 &lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/problemset/problem/1799/F&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CF1799F&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;以二维的情况为例，有函数 $f(x,y)$，要求 $f(a,b)$（其中 $f(x,b)$ 关于 $x$ 是上凸的，且 $\forall,k,\max_x\set{f(x,y)-kx}$ 关于 $y$ 是上凸的）。这时外层二分的判定条件应该是“使 $f(x,b)-kx$ 取到 $\max$ 的 $x$ 值”，然而这个值是难求的。&lt;/p&gt;
&lt;p&gt;你可能会说，内层二分的斜率 $k^\prime$ 已经求出来了，那拿它和 $k$ 一起跑一遍 check，尽量使 $x$ 最小或最大就行了呀。这里的问题在于，无法保证 $y$ 恰好取到 $b$，因为 $y$ 这一维同时也会出现共线情况，这时可能会取到错误的 $y$，从而取到不该取的 $x$。这个问题即使用实数二分也无法解决，例如这个&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/contest/1799/submission/195189992&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;提交记录&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&#34;一种解决方法&#34;&gt;一种解决方法
&lt;/h2&gt;&lt;p&gt;Neal Wu 在&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/blog/entry/49691?#comment-526153&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;提出了一种精细的处理方法。例如要求最小的取到 $\max$ 的 $x_0$，那么在 check 中求出必须要用几个 $x$，必须要用几个 $y$，和既可以用 $x$ 又可以用 $y$ 但不能都不用（必须都用的情况不算在内，应算作前两个各自加一）的数量，分别记作 $\alpha,\beta,\gamma$。外层二分如果 $\alpha\le a\land \alpha+\beta+\gamma\le a+b$，那么 $r\gets mid$。这个判断的正确性如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果这些条件不满足，那么显然不存在合法分配方案，斜率一定是太小了。&lt;/li&gt;
&lt;li&gt;如果这些条件满足，那么一定存在一个 $x\le a$，使得 $f(x,b)$ 被切线切到。构造方法是，$y$ 先取 $\beta$ 部分，显然 $\beta\le b$（不然内层二分就不会二分到这个斜率）。然后尽量用 $\gamma$ 的部分补满 $b$。如果补满了，那么由 $\alpha+\beta+\gamma\le a+b$，故 $x=\alpha+\gamma-(b-\beta)$ 一定可以。如果没补满，那么找另一些不影响 $x$ 用量的元素补满 $y$（一定能补满，不然内层二分就不会二分到这个斜率），这时由 $\alpha\le a$，故 $x=\alpha$ 一定可以。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/contest/1799/submission/195531907&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这里&lt;/a&gt;是另一题我写的类似的处理方法。&lt;/p&gt;
&lt;p&gt;但是这个方法缺乏通用性。首先，刚才这个解法中“用”的定义只在这两题里成立（即用两类精灵球和用两类操作），如果没有类似的组合意义就不行了，所求条件就再次变成了不可解决的，类似于原问题的“强制限定 $y=b$”。其次，维数再高就难以讨论了。&lt;/p&gt;
&lt;h2 id=&#34;通用的解决方法&#34;&gt;通用的解决方法
&lt;/h2&gt;&lt;p&gt;核心性质：对于上凸的 $f(x)$，令 $g(k)=\max_x\set{f(x)-kx}+ka$，$g(k)$ 是下凸的，且最小值恰为 $f(a)$。（在力学中这个称为 Legendre 变换）&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这张动图中红色轨迹即为 $g(k)$。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;center&gt;&lt;img src=&#34;wqs\wqs2.gif&#34; style=&#34;zoom:100%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;证 1：若 $f(k)$ 处处可导，令 $h(k)=\min\set{x\mid f^\prime(x)=k}$，则 $g(k)=f(h(k))-k(h(k)-a)$。
$$
\begin{aligned}
g^\prime(k)&amp;amp;=f^\prime(h(k))h^\prime(k)-kh^\prime(k)-(h(k)-a)\\
&amp;amp;=kh^\prime(k)-kh^\prime(k)-h(k)+a\\
&amp;amp;=-h(k)+a
\end{aligned}
$$
而 $h(k)$ 是递减的，故 $g^\prime(k)$ 递增。&lt;/p&gt;
&lt;p&gt;证 2：用更加普遍的定义来证。同样令 $h(k)$ 为使 $g(k)$ 取到 $\max$ 的某个 $x$。$\forall,k_1,k_2$，对于 $\lambda\in (0,1)$，令 $k_m=\lambda k_1+(1-\lambda)k_2$：
$$
\begin{aligned}
&amp;amp;\lambda g(k_1)+(1-\lambda)g(k_2)\\
={}&amp;amp;\lambda\max_x\set{f(x)-k_1x}+(1-\lambda)\max_x\set{f(x)-k_2x}+k_ma\\
\ge{}&amp;amp;\lambda(f(h(k_m))-k_1h(k_m))+(1-\lambda)(f(h(k_m))-k_2h(k_m))+k_ma\\
={}&amp;amp;f(h(k_m))-k_mh(k_m)+k_ma\\
={}&amp;amp;g(k_m)
\end{aligned}
$$
同时，显然 $\forall,k,g(k)\ge f(a)$，又由于 $f$ 的凸性，一定存在一个 $k$ 使得 $g(k)=f(a)$，故得证。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;另外我们会惊奇地发现：除了最后一步外，证 2 甚至没用 $f$ 的凸性！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;于是就可以直接二分了，判定时只需比较 $mid$ 和 $mid+1$（或 $mid+\varepsilon$）的 check 结果。&lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/contest/1799/submission/197720360&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CF1799 的代码&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;这样做唯一的缺点在于会有 $2^d$ 倍常数（$d$ 为维数）。可以用优选法（按黄金比划分的三分）优化到 ${1.44}^d$ 倍。&lt;/p&gt;
&lt;h2 id=&#34;一个小细节&#34;&gt;一个小细节
&lt;/h2&gt;&lt;p&gt;考虑实数二分的精度问题，设当前二分区间为 $[l,r]$，取 $f(h(l))-lh(l)+la$ 来估算答案，它与 $f(a)$ 的差距为：
$$
\begin{aligned}
\lvert f(h(l))-lh(l)+la-f(a)\rvert&amp;amp;=\left\lvert l(a-h(l))-\int_{h(l)}^af^\prime(x)\mathrm{d}x\right\rvert\\
&amp;amp;=\left\lvert\int_{h(l)}^a(l-f^\prime(x))\mathrm{d}x\right\rvert\\
&amp;amp;\le\lvert a-h(l)\rvert\cdot(r-l)\\
&amp;amp;\le\lvert I\rvert\cdot(r-l)
\end{aligned}
$$
其中 $I$ 为 $f$ 的定义域。因此二分一般得在 $r-l$ 小于允许的绝对误差除以 $n$ 时才结束。$f(x)=C$ 时可以取到最差情况下的误差。&lt;/p&gt;
&lt;h2 id=&#34;参考资料--总结&#34;&gt;参考资料 &amp;amp; 总结
&lt;/h2&gt;&lt;p&gt;本文基本上就是 &lt;a class=&#34;link&#34; href=&#34;https://codeforces.com/blog/entry/98334&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Theoretical grounds of lambda optimization&lt;/a&gt; 的提要版本。&lt;/p&gt;
&lt;p&gt;目前，WQS 二分在应用中仍难以解决的问题主要是凸性的证明。大量题目直觉上目标函数具有凸性，但无法严格证明。归约费用流可能是一种有前途的方案，但目前这几道题例仍未找到证明。adamant 的这篇文章关于 CF739E 的证明应该是错的，我在下面的评论区也有提问，如果您有想法可以与我交流。&lt;/p&gt;
&lt;p&gt;目前已知的证明方法：&lt;/p&gt;
&lt;p&gt;[IOI2016] Aliens：四边形不等式是要的，然后有两个证明方法，分别于 Kubic 23 年的论文、我 24 年的论文。&lt;/p&gt;
&lt;p&gt;CF739E 和 CF1799F：用题解区&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/problem/solution/CF739E&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇&lt;/a&gt;的方法建图，然后把一种精灵球选的代价改为 $+\infty$，这样就可以证 $f(x,b)$ 或 $f(a,x)$ 的凸性；内层的凸性更容易，可以用流或 dp 证。&lt;strong&gt;这题外层不能用 dp 归纳证，分讨会有一种情况去世。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;P1792 种树：这类题如果是奇环我是不会证的，并且我目前没看到对的证明。偶环、链、树这类二分图的情况可以看 Kubic 的论文。对于链的情况，可以将限制扩展到“任意两个选的距离必须 $\ge k$”，这样就只能用四边形不等式（一个区间的代价为除去开头 $k$ 个，剩余的 $\max$，这样就有四边形不等式了）或者 dp 归纳证。&lt;/p&gt;
&lt;p&gt;[八省联考 2018] 林克卡特树：&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/blog/zyc2003/p4383-lin-ke-ka-te-shu-post&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇题解&lt;/a&gt;似乎有证明，我没仔细看，不知道是否严谨。反正 dp 归纳是不行的。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>构造题方法总汇</title>
        <link>https://littlereuben.github.io/study/constructive-problems/</link>
        <pubDate>Sun, 08 Oct 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/constructive-problems/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;h2 id=&#34;声明&#34;&gt;声明
&lt;/h2&gt;&lt;p&gt;本文非严谨的算法理论研究，仅仅是个人对解题经验的归纳和实验性的系统总结，不保证理论上的完备性与纯粹性。仅对解题实践提供一个较为自洽的解释，作为参考。&lt;/p&gt;
&lt;p&gt;本文所有题都不会提供题意和完整包含细节的题解，也就是说您需要先做一遍或看其他题解，因为没有做题经验就无法感受解题思想。您也可以把本文理解成一个归类好的题单。&lt;/p&gt;
&lt;p&gt;如果一题包含多项技巧则会放在多处，但如果包含多项思想则只会在一处解说。如果出现一题多解会记入多个类别并多次解说。&lt;/p&gt;
&lt;p&gt;带括号的题是内部训练题。&lt;/p&gt;
&lt;p&gt;如果您认为一些理论表述有偏颇，或找到文章无法解释的题目（反例），可以告诉我。&lt;/p&gt;
&lt;p&gt;本文会时常更新。&lt;/p&gt;
&lt;h2 id=&#34;引言&#34;&gt;引言
&lt;/h2&gt;&lt;p&gt;在 OI 中，“构造题”的定义是什么？我也没法给出一个精准的答案。似乎这类题确实有某些明确的特征，但这一概念的边界却是模糊的。广义地来说，所有算法都是构造——dp 构造状态和转移，ds 构造维护的结构……但我们常说的构造更多的是一种无算法的构造，或者说，不是将问题模型转化成一种特定的算法所能解决的问题，再去间接求解，而是直接去构造所求组合结构。&lt;/p&gt;
&lt;p&gt;最关键的是这类题的思维方式很特殊，这使曾经的我面对构造题不知如何下手。其余类型的题都主要侧重于分析，通过分析问题模型的性质，刻画其结构，从而将它转化成更容易解决的模型。而构造题则往往给人一种“凭空”出现了答案的感觉，例如，考虑一个方式/过程/结构，它刚好就是对的，然后就解完了。另外，其他类型的求解型问题往往是以最优化为目标，某些不要求最优化的题可能还得硬转成最优化（例如一些流问题），而构造题则倾向于消去最优化目标。当然也不能否定，构造和其他算法是密切相关的。&lt;/p&gt;
&lt;p&gt;不存在简单地区分构造和非构造题的方法。解题后期如果感觉解的可能性很复杂，无法用简单的方式统一描述，那就需要考虑 dp、网络流等方法，否则可以尝试直接构造。&lt;del&gt;这其实是废话。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;接下来，我会介绍解构造题的技巧和方法。所有归约 dp、差分约束、2-SAT、流、线性规划的题，以及交互、部分数学求解方面的构造这些非构造组合结构而是构造求解方法的题均不会讨论，我也会尽量避免无法证明概率的随机化构造题。&lt;/p&gt;
&lt;h2 id=&#34;分类&#34;&gt;分类
&lt;/h2&gt;&lt;p&gt;这部分其实对解题没啥帮助……&lt;/p&gt;
&lt;p&gt;构造题的所求一般来说有以下几类：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;凭空构造一个结构或补充结构；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;安排（排列、划分、组合、选一部分）给出元素；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;构造一系列操作以达到目标。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另外可以关注以下几个特征：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;输入是否是 $\mathrm{O}(1)$ 的；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;是否有可能无解；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;是否要求最优化。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;基于特性的技巧&#34;&gt;基于特性的技巧
&lt;/h2&gt;&lt;p&gt;以下题例可能不完全是构造题，但如果某个技巧没法出到构造题里就不会收录。&lt;/p&gt;
&lt;h3 id=&#34;括号序列相关&#34;&gt;括号序列相关
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;技巧&lt;/th&gt;
&lt;th&gt;题例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;前缀和化。将左右括号分别视作 $\pm 1$ 并作前缀和，画出折线图。能给 flip 和 reverse 提供一个直观的几何解释，还能处理 $\min/\max$ 相关，以及利用类介值定理证明存在性。&lt;/td&gt;
&lt;td&gt;CF1458D、CF1685C&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;路径化。将左右括号分别视作向右和向下，画出折线图。与上一种类似。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;匹配括号连弧线。&lt;/td&gt;
&lt;td&gt;CF1503F&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;括号树。根据定义，合法括号序列一般有两种观察方式：多个括号序列拼接并在外面套一对括号：(ABC&amp;hellip;)，以及找到开头括号匹配的右括号将序列分成两块：(A)B。这两种分别对应着正常括号树与三度化后的括号树。&lt;/td&gt;
&lt;td&gt;[WC2022] 序列变换&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;排列相关&#34;&gt;排列相关
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;技巧&lt;/th&gt;
&lt;th&gt;题例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;画点。在平面直角坐标系中画出 $(i,p_i)$ 是一种直观反映偏序关系的方法。&lt;/td&gt;
&lt;td&gt;[APIO2022] 排列&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;按值域构造。一种是以某种顺序扫描值域，另一种是只维护相对大小关系，每次插入再在值域中空出一个位置给新元素。这样可以减少构造受限性，可以用增量思想构造。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;置换环。涉及置换、交换使排序这类的题都可以把 $i\rightarrow p_i$ 画出来。还有类似的排列转有向图的处理方法。&lt;/td&gt;
&lt;td&gt;CF1491G、CF1656G、CF1787F、[THUPC2024 初赛] 排序大师&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;考虑逆置换。&lt;/td&gt;
&lt;td&gt;CFgym102154C&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拓扑序。用 DAG 的拓扑序来理解所求的排列。&lt;/td&gt;
&lt;td&gt;CF1477D、CF798E&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;逆序对数。常用于分析无解。&lt;/td&gt;
&lt;td&gt;CF804E、（樱花抄）、[互测 2022] 魔术师&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;贪心。要求排列字典序最小时，逐位贪心判断可行性即可。&lt;/td&gt;
&lt;td&gt;CF1530E、CF1844F1、（roast）&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;二维相关&#34;&gt;二维相关
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;技巧&lt;/th&gt;
&lt;th&gt;题例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;拆成一维。&lt;/td&gt;
&lt;td&gt;CF417E、（巧克力）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;转 $45^\circ$。&lt;/td&gt;
&lt;td&gt;[IOI2021] 喷泉公园、[IOI2019] 视觉程序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拼图法。找到构造中的小单元去试探。&lt;/td&gt;
&lt;td&gt;CF1628C、CF1034B&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;棋盘染色。即按 $(x+y)\bmod k$ 将格子分类，保证长为 $k$ 的段必然包含每类各一个，用于加强命题方便构造，或判断无解。&lt;/td&gt;
&lt;td&gt;CF1450C2、CF763B、CF1268B、CF1485D&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拓扑学方法。主要包括转向度数和、穿过次数奇偶性、欧拉定理、皮克定理。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;行列和。作为守恒量用于判断无解。&lt;/td&gt;
&lt;td&gt;CF1672G&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;数论相关&#34;&gt;数论相关
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;技巧&lt;/th&gt;
&lt;th&gt;题例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;互质对构造。$(n,n+1)$、$(n,2^k-1)$（n 奇）、$(p,n)$（p 质）。&lt;/td&gt;
&lt;td&gt;CFgym102055C、LOJ3392、CF922F、[互测 2022] 大冬天题&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拆二进制以及辗转相除法。&lt;/td&gt;
&lt;td&gt;CF341E&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;原根。乘转加。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;互质/整除图。可以更加直观。&lt;/td&gt;
&lt;td&gt;CF1148G&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;预处理常数。如果只允许使用特定材料构造出某个数，那么可以考虑先用方程把相关要用的常数解出来，然后用二进制拆分等构造。&lt;/td&gt;
&lt;td&gt;CF1060H、CF1427E&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;模意义下考虑。如果条件是不等式，那么模意义就是加强条件；如果是等式，那就需要倍增。&lt;/td&gt;
&lt;td&gt;CF1218G、CF1844G&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;生成树相关&#34;&gt;生成树相关
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;技巧&lt;/th&gt;
&lt;th&gt;题例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;归约最小/大生成树。&lt;/td&gt;
&lt;td&gt;CF1054G&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;叶子调整法。叶子是树中最灵活的部分，就像质数在数论构造中的作用。可用于保证某个相关数值“能够调整至任意一个 $[l,r]$ 内的值”。&lt;/td&gt;
&lt;td&gt;CF1311E、CF1098C&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;边权为标号差绝对值的最大生成树。前一半连 $n$，后一半连 $1$。&lt;/td&gt;
&lt;td&gt;CF1474E、CF1656F&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;图论相关&#34;&gt;图论相关
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;技巧&lt;/th&gt;
&lt;th&gt;题例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;考虑反图。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;利用 $\sum deg=2m$ 来均摊。在处理实现细节，确定枚举方式时可以提供依据。&lt;/td&gt;
&lt;td&gt;CF1444C&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;找 dfs 树。往往可以简化构造。&lt;/td&gt;
&lt;td&gt;CF1680F、[IOI2019] 景点划分、CF1515F&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;缩点。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;考虑二分图。&lt;/td&gt;
&lt;td&gt;CF1515F、CF1218G、[湖北省选模拟 2023] 棋圣&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;进行 bfs。主要是从邻边和距离视角观察。&lt;/td&gt;
&lt;td&gt;CF1470D、CF1368E、CF1019C、CF794D&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;竞赛图性质。存在哈密顿路、可分层、度数最小的点到其他点距离均 $\le 2$。&lt;/td&gt;
&lt;td&gt;CF1779E&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;图相关序列判定定理。包括 Erdős–Gallai 定理、Landau 定理等。&lt;/td&gt;
&lt;td&gt;USACO14MARGoldT3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;邻接矩阵。&lt;/td&gt;
&lt;td&gt;AGC061B&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;赋点权来决定边权。&lt;/td&gt;
&lt;td&gt;CF42D&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;互斥条件。有一类题目是要求在图中找两种结构之一。先尝试找一种，假设找不到再试另一种。&lt;/td&gt;
&lt;td&gt;CF1364D、CF1148G、CF1439B、（ schrodingersjerry 和图染色）&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;格雷码&#34;&gt;格雷码
&lt;/h3&gt;&lt;p&gt;格雷码的本质是利用二进制表示的唯一性，来保证每种数恰好出现一次。&lt;/p&gt;
&lt;p&gt;题例：CF1673F、ARC138D=P7949、CF1163E&lt;/p&gt;
&lt;h3 id=&#34;欧拉回路路径&#34;&gt;欧拉回路/路径
&lt;/h3&gt;&lt;p&gt;遇到类似与“相关和为 $0$” 的守恒条件时可以考虑用欧拉回路/路径构造。&lt;/p&gt;
&lt;p&gt;题例：CF1634E、CF1610F、CF1458D&lt;/p&gt;
&lt;h3 id=&#34;鸽巢原理&#34;&gt;鸽巢原理
&lt;/h3&gt;&lt;p&gt;鸽巢原理一般用于有多个备选项，它们从总体来看有某个数量关系，可以导出存在一个个体满足特定条件。偶尔也反过来用证明无解。在实际应用中，备选项可能是给定模型的局部，也可能需要自己构造，后者会比较难，关键在于找到可能性足够少的“鸽巢”。&lt;/p&gt;
&lt;p&gt;例：CF1450C2、CFgym102900B、CF1515F、CF1090C、CF618F、CF1835C、[NOI2021] 量子通信、[NOI2020] 制作菜品&lt;/p&gt;
&lt;h3 id=&#34;绝对众数&#34;&gt;绝对众数
&lt;/h3&gt;&lt;p&gt;涉及到绝对众数最简单的模型就是：排列一些数使得相邻数不同。这类问题要抓住主要矛盾，其他次要矛盾都会自动消解，就可以专注于构造一个内容。另外这类题常使用逐步构造。&lt;/p&gt;
&lt;p&gt;另外，对于树上问题，通过找重心作为根可以避免出现大小为绝对众数的子树，这也是一个简化讨论的技巧。&lt;/p&gt;
&lt;p&gt;例：CF1242E、CF1762G、CF1329D、[IOI2019] 景点划分、ARC156C&lt;/p&gt;
&lt;p&gt;题外话：用爬山或退火构造时也常常会先满足最紧的限制，体现形式也往往是类似绝对众数的东西。&lt;a class=&#34;link&#34; href=&#34;https://peehs-moorhsum.blog.uoj.ac/blog/8042&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;详见此处&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&#34;dilworth-定理&#34;&gt;Dilworth 定理
&lt;/h3&gt;&lt;p&gt;往往给人一种“双向限制”的感觉。&lt;/p&gt;
&lt;p&gt;例：CF1097E、CF1738G、CF1630F&lt;/p&gt;
&lt;p&gt;简单写一下相关的证明：&lt;/p&gt;
&lt;p&gt;最长链 = 最小反链覆盖：≤ 显然，≥ 每次剥掉一层入/出度为 $0$ 的点。&lt;/p&gt;
&lt;p&gt;最长反链 = 最小链覆盖：≤ 显然，≥ 删掉一个出度为 $0$ 的点 $u$ 归纳，取出覆盖方案的每条链中最后的能出现在最长反链里的点，如果没有一个与 $u$ 有偏序关系则最长反链 $+1$，否则最长反链不变，且有一个点 $\le u$，取出它所在的链中所有能出现在最长反链里的点与 $u$ 共同作为一条链，剩余的点最小链覆盖也 $-1$，总体不变。&lt;/p&gt;
&lt;p&gt;求最长反链法 1：取二分图最大独立集中两部均在内的点。记最小链覆盖为 $s$，则最大匹配为 $n-s$，最大独立集为 $n+s$，两部均在内的点至少 $s$ 个。&lt;/p&gt;
&lt;p&gt;求最长反链法 2：求出所有可能在最长反链中的点，每次任选一个，删除与它有偏序关系的点，归纳。&lt;/p&gt;
&lt;h2 id=&#34;常用的解题思想&#34;&gt;常用的解题思想
&lt;/h2&gt;&lt;p&gt;所有解题思想之间大多没有明确的分界，往往结合使用。&lt;/p&gt;
&lt;h3 id=&#34;a-等价表述条件和观察模型&#34;&gt;a. 等价表述条件和观察模型
&lt;/h3&gt;&lt;p&gt;使用不同的方式和图形去表示问题模型，可能会突出问题的某一部分特征，从而带来新的启发。有一个经典的例子可以说明换一种方式描述会产生多大的区别（一道 dp）：CF1368H1。原问题（最大流模型）和最小割模型都看似无法解决，但如果转变到平面图最短路的角度去分析出路径的简化性质（每行或每列均相同），再回到最小割模型，就可以 dp 了。因此，不要认为等价模型没有意义，否则会错失动机。&lt;/p&gt;
&lt;p&gt;在转述过程中要注意可能会不小心加强模型或丢性质，反而导致无解，这个后面会提到。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CF1680F：奇环上会出现两端均选的边。因此原题意可以转述为“删除一条边使得图变成二分图”，dfs 树讨论即可。&lt;/li&gt;
&lt;li&gt;CF1110E：经典套路，这种就两类，$(a_{i-1},a_i,a_{i+1})\rightarrow(a_{i-1},a_{i-1}+a_{i+1}-a_i,a_{i+1})$ 作差分解决，$(a_{i-1},a_i,a_{i+1})\rightarrow(a_{i-1}+a_i,-a_i,a_{i+1}+a_i)$ 作前缀和解决。&lt;/li&gt;
&lt;li&gt;CF1458D：将 01 序列转化为前缀和序列化成折线，从而将奇怪操作翻译成区间翻转。容易用调整法证明任意符合守恒条件的序列均可达到。因此可用欧拉路径的方式去描述合法折线，从而贪心。&lt;/li&gt;
&lt;li&gt;CF1054G：“集合内所有点形成一个连通块”等价于“集合内所有点之间边共有 $size-1$ 条”，加之边不可能多于 $size-1$ 条，故原条件可以转述成“所有集合的点之间边数量之和取到理论上界”，这就可以用 MST 了。边权用 bitset 加速计算。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;b-将无解和最优化条件转成已知条件&#34;&gt;b. 将无解和最优化条件转成已知条件
&lt;/h3&gt;&lt;p&gt;首先是经验：CF 中如果 Output 里说无解输出 $-1$ 但 Example 里没有 $-1$，那么就不会有无解的情况。&lt;/p&gt;
&lt;p&gt;部分构造题有一个很大的特点，就是在解题开头就确定无解条件或最优解公式，也就是先确定充要条件的一边，去构造另一边，或是先给出不等式的一边，再构造取等。可以说这是一种“先猜后证”，也为构造增加了提示。当然这种猜测要足够谨慎，尽量思考通过题目条件能推导出的必然性，以及从数学角度去分析模型（找到模型的某个示性数，或守恒量）。&lt;/p&gt;
&lt;p&gt;不是所有构造题都可以使用这个技巧，同时要避免将非构造题误判成构造（例如，有时无解和最优化情况必须通过 dp 求出）。关键是通过分析条件来感知题目模型的解是可以用一种特定的规律描述，还是要根据输入数据，去遍历所有可能的解才能确定。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CF1543E：对于第二问，首先分析图的点与边的数量关系。每个点恰有一个颜色 $x$ 的邻居，一个颜色为 $x$ 的点会作为 $n$ 个点的邻居，因此一共有 $2^n/n$ 个颜色为 $x$ 的点，所以原问题在 $n\ne 2^k$ 时无解。这个无解条件反过来启发我们使用递归构造和拆分二进制的思路去构造 $n=2^k$ 的情况。可参考 &lt;a class=&#34;link&#34; href=&#34;https://www.bilibili.com/video/BV1UD4y1U7or/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;3b1b 的视频&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;[CTSC2016] 单调上升序列：套用题面中给出的证明，可得到最优解 $\ge n-1$。并且达到 $n-1$ 时限制是很紧的，遂考虑每一轮安排边权使得所有“探险家”均走一步，也就是将完全图的边划分为 $n-1$ 组完美匹配。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;c-从特殊情况获取提示&#34;&gt;c. 从特殊情况获取提示
&lt;/h3&gt;&lt;p&gt;特殊情况包括特殊输入和特殊解，这一条侧重于特殊输入。这样思考的帮助是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过特殊情况的解获取一般构造的线索；&lt;/li&gt;
&lt;li&gt;通过将所有情况用某些手段归约到特殊情况，从而只需解决特殊情况；&lt;/li&gt;
&lt;li&gt;通过构造极端输入确认无解性/答案上下界，或排除不可能的构造方法。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;但是不是所有题的特殊情况都能给出有效的提示，有时候反而会起到误导作用。要很警惕的一点是一些不成熟的思路可能会被构造的极端情况排除掉，但是实际上改一改就对了。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CF1311E：先考虑完全二叉树和链的特殊情况，然后寻找能符合题意的，处于两种特殊情况之间的“连续的”变化，调整法。&lt;/li&gt;
&lt;li&gt;CF1515F：结合 &lt;em&gt;b&lt;/em&gt;，有足够的理由猜测 $\sum a_i\ge (n-1)x$ 即有界，于是任意图就可以归约到树这一特殊情况。然后根据 &lt;em&gt;b&lt;/em&gt; 的数学上分析（核心分析：如果有一条边不能并那么一定存在一个点 $a_u&amp;gt;x$），结合鸽巢原理，构造出一个合并方法。&lt;/li&gt;
&lt;li&gt;CF618F：考虑 $B={n\,个\,n}$ 的情况，容易想到将 $A$ 作前缀和后对模 $n$ 余数鸽巢，这样就把正解的提示都集齐了：鸽巢、前缀和、$A$ 的前缀和减 $B$ 的前缀和。&lt;/li&gt;
&lt;li&gt;CF1019C：一种思路是，考虑 DAG，可以做到任何不选的点都能被选的点走 $1$ 步到达；稍稍加强，考虑对原图 dfs 后只有树边、前向边和返祖边，树边和前向边就相当于 DAG，返祖边导致的矛盾可以通过取消选择祖先那个点，同时保证至多走 $2$ 步可达。推广到一般情况，将原图拆成两张 DAG（根据边的起终点的编号大小关系分），套用原来的方法即可。&lt;br&gt;
作为一个反例：我在解这道题时考虑了竞赛图这一特例，这没有帮助，反而把方向带歪到关注节点度数上去了。因此要多考虑几种特殊情况，并结合分析筛选。&lt;/li&gt;
&lt;li&gt;AGC064B：如果不考虑特殊情况，容易考虑使用 &lt;em&gt;j&lt;/em&gt;，每次找一个点，周围只有一条可行（加入不成环）同色边，选择这条边。这样思路就走歪了。正确的思路是先考虑一些无解情况，发现点边颜色均交替的偶环无解，进一步分析发现如果要形成一棵树，就必须有一条边，两端的颜色都与它相同（记为一类边）。进一步地，发现如果存在一个点，它不断走这样的边 $u\xrightarrow{e}v$（$u$ 和 $e$ 同色，与 $v$ 异色，记作二类边），最后走不到任何一类边，那就无解了。因此先尽量选所有一类边，然后再从这些边的端点向外扩展二类边（一个点只能被扩展到一次）。如果所有点都被扩展到了，再用剩下的边尽量连接这些森林即可保证有解。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;d-分析数量关系&#34;&gt;d. 分析数量关系
&lt;/h3&gt;&lt;p&gt;模型的数量关系可能不仅仅能用于 &lt;em&gt;b&lt;/em&gt;，而且能指导构造的过程。往往结合待定系数法，列出方程或不等式来分析。&lt;em&gt;c&lt;/em&gt; 例 2 就是一个典型的例子。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1667C：设答案为 $k$，则有 $(n-k)\times(n-k)$ 的部分只能用对角线覆盖，故 $2(n-k)-1\le k\Rightarrow k\ge \lfloor(2n+1)/3\rfloor$。固定右下这样一个空矩形，剩余部分试探构造即可。换句话说，下界分析直接给出了构造思路。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1158B：经过一些尝试，直觉上串必须要有循环节，长设为 $l$。长 $&amp;lt;k$ 出现过的至少出现两次，也就是 $\forall\,i,i-l\ge 1\lor i+l+k-2\le n$，长 $=k$ 的有恰好出现一次的，也就是 $\exists\,i,\lnot(i-l\ge 1\lor i+l+k-1\le n)$，综上解得 $l=(n-k)/2+1$。立即得出构造为 $(n-k)/2$ 个 $0$ 加上一个 $1$ 不断循环直到长为 $n$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;（樱花抄）：不妨设输入是排列。先考虑对每个位置操作对逆序对奇偶性的影响：$n\equiv 0\pmod 4$ 是 $1111\cdots 1$，$n\equiv 1\pmod 4$ 是 $0101\cdots 0$，$n\equiv 2\pmod 4$ 是 $0000\cdots 0$，$n\equiv 3\pmod 4$ 是 $1010\cdots 1$。因此 $n\equiv 2$（以下省略 $\bmod 4$）时可能无解。构造可以考虑 &lt;em&gt;k&lt;/em&gt;，发现每次将一个数移到开头或结尾是容易的，因此考虑在维护一段后缀为 $1\sim i-1$。现在要加入 $i$，设位置为 $p$，若 $p\ne 1$，则可以操作 $p$ 后操作 $p-1$；否则一定无法 $\le 3$ 步搞定，就必须要操作 $1$、操作 $i+2$、操作 $1$、操作 $n-i$，共 $4$ 步。特殊地，$i=n-1$ 时如果出现后一种情况就完了，因为搜索小情况可发现还要大量步骤。因此在一开始就要把逆序对数调整为偶，又由于每一轮都不会改变其奇偶性，故最终一定形如 $[n-1,n,1,2,\cdots,n-2]$，操作 $1$ 再操作 $n$ 即可。为避免大量出现四步情况，可以先随机操作 $C$ 次打乱排列，这样总次数为 $C+2n+\mathrm{O}(\log n)$。&lt;/p&gt;
&lt;p&gt;为什么要先分析逆序对的奇偶性呢？因为只有奇偶性可能成为这类排序题的“守恒量”，逆序对是定义在&lt;strong&gt;每一对&lt;/strong&gt;数上的。另外真正的解题过程中其实是先尝试构造，发现最后出现 $[n,n-1,1,2,\cdots,n-2]$ 这种无法处理情况时，再去研究逆序对奇偶性的。最后再对操作进行微调，保证不会改变奇偶性。也就是说，手动构造和对数量关系的分析是交织着进行的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[THUPC2022 复赛] 拯救还是毁灭：这题与 [THUPC2024 初赛] 排序大师 的难点都在于，抓住“势能”刻画剩余步数。&lt;/p&gt;
&lt;p&gt;我的思路：① 仿照一维时的最差情况，考虑构造行列均循环移一位，这时有 $2n(n-1)$ 步的方案，且直觉上无法做到更优。猜测这就是 $M(n)$，尝试构造即证。② 直接构造实在太复杂了，考虑加强——分阶段，逐行归位。由于最后一行只需 $n-1$ 步，故前面每行只需在暴力（每个数行列依次归位）的基础上省去一步即可，模样例发现应该一定可以。现在抓住推论：如果一个数要移两步，那第二步必须归位，同时不能所有数都移两步，要利用一维情况的性质省掉一步。看起来复杂情况下，这两个要求是互斥的，因为一旦开始“移两步”，就有可能每个数都要这样做。考虑到 $1\sim n$一一分布在每列的情况，这时就要先全部放到第一行再做。这就启发我考虑最终将问题归为这一类情况。如果有空列，那可以把对应数归位；否则没有空列，由鸽巢，必然是上面所说的情况。那么这个解法的后半部分构造，就是不断尝试、调整，找到一个自洽的分讨，这个并没有一个通法，不过一般只要抓住特殊、极端情况的提示，做好假设和推理，就不会太难。&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.luogu.com.cn/article/zph2avbo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;这篇题解&lt;/a&gt;给出了严格的图论角度分析。对这类问题，图论思路的核心就是，复原一个环的步数是环长减一，因为最后一步可以两个同时归位。我没想清楚的，一个是两维分别开环，来证上界，这个实际上是普通置换环的重边推广版本，值得学习；另一个就是再同行归位时，搞不出那个“减一”，最后只能硬凑，这个题解说的则是，当该行元素到处分布时，尽管列重叠会导致无法构造完整的置换环，但总能找出一个环，这就够了。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;e-寻找诈骗条件&#34;&gt;e. 寻找诈骗条件
&lt;/h3&gt;&lt;p&gt;主要是要有这个意识。有些题目的条件或性质可以极大程度地减小可能性，不要忽视。往往可以通过思考极端情况获得启发。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CF425B：“所有连通块均为矩形”这一条件可被简化为“$a_{i,j}=r_i\oplus c_j$”，将 $nm$ 个未知量减少为 $n+m$ 个。于是只需暴力枚举 $r_{1\cdots n}$ 即可。&lt;/li&gt;
&lt;li&gt;CF1689E：默认 $a_i&amp;gt;0$，发现存在一个策略只需两步，因此问题变为判断答案是否为 $0$ 或 $1$，可以暴力。&lt;/li&gt;
&lt;li&gt;CF1685C：打表发现 $ans\le 2$，结合括号序列技巧画图可得，以前缀和最大值为界左右各翻转一次，一定可以完成，因此只需讨论答案是否为 $1$。&lt;/li&gt;
&lt;li&gt;CF1781G：尝试构造达到理论下界的解，可以使用归约构造，逐步删掉儿子均为叶子的点的子树，base case 分讨即可。同样 $ans\le 2$。&lt;/li&gt;
&lt;li&gt;CF1852E：刻画完结构后发现未知元素的可能性太多了，但是可以找到性质，只有至多一种未出现过的数被填入，并且它一定是某个出现过的数 ${}-1$，且可以较简单地确定它填的情况，暴力枚举这种数即可。&lt;/li&gt;
&lt;li&gt;CF1375F：不必多说。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;f-加强构造条件&#34;&gt;f. 加强构造条件
&lt;/h3&gt;&lt;p&gt;这个方法很像数竞不等式放缩的过程。有时构造的限制太松了，反而不知道如何下手。通过加强构造条件减少可能性是构造题非常常用的手段，它可以体现为通解、逆向、归约、调整、分治等复杂的技巧，在后面会提到。这一节以较为初级的增强限制和减少变量为主。&lt;/p&gt;
&lt;p&gt;在构造的过程中自然地加强和通过模型特征提示试探加强是加强构造条件的两个主要方法，加强过程中要保证有解性或最优性不变（否则就像不等式放缩过头）。考虑特殊情况下“必须得怎么构造”也能给加强条件指明方向（例 5&amp;amp;6）。&lt;/p&gt;
&lt;p&gt;在条件分析不下去的时候，也可以跳出复杂的关系限制，冒无解的风险去尝试一些特定的构造策略，有可能它刚好就符合了所有要求，或者有少量不符合可以微调改对。例如 yhx 在 WC2022 上讲的 [IOI2021] 喷泉公园 的贪心构造做法，就是通过试探得到的。&lt;/p&gt;
&lt;p&gt;总的来说就是不要因为题目给的条件无从下手就懵了，要主动尝试一些可能性。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CF1599A=ISIJ2021CupT3：题目条件给人一种“可以任意改变左右和大小关系”的感觉，考虑一种大小关系的必然性（加强）：左右砝码可以配对，所有对要么都是左边大，要么都是右边大。容易想到排序 $a_{1\cdots n}$ 后连续段交替取，可以保证有解，就解完了。&lt;/li&gt;
&lt;li&gt;CF1270G：考虑将 $a_i$ 换元使得所有变量的限制条件都相同，否则感觉不好处理。令 $b_i=i-a_i$，则 $b_i\in[1,n]$，目标条件转化成 $\sum_{i\in S}b_i=\sum_{i\in S}i$。考虑加强，试图使得每个 $b_i$ 都等于一个 $i&amp;rsquo;$，类似回路的结构可以满足该条件。建 $n$ 点图连边 $i\rightarrow b_i$，找个基环即可。&lt;/li&gt;
&lt;li&gt;CF1835C：作前缀和，目标转化为找到 $0\le a&amp;lt;b\le c&amp;lt;d\le n,\text{ s.t. }s_a\oplus s_b\oplus s_c\oplus s_d=0$。可以鸽巢证明一定有解，但是 $4^k$ 这个大小太大了，考虑加强，通过强制使得低 $k$ 位相同，只对高 $k$ 位做鸽巢。按低 $k$ 位分组后发现恰可以取出 $2^k+1$ 对数，低 $k$ 位相同，分别求出它们高 $k$ 位的异或后即可找到所求。&lt;/li&gt;
&lt;li&gt;CF1391E：pairing 的条件极为诡异，无法处理。考虑 dfs 树，好处在于额外的边只可能出现在祖先后代之间。结合菊花等特殊情况或者用排除法，容易考虑选的点对不形成祖先后代关系，而这恰好吻合 pairing 的条件。最粗暴的方法是同深度的点两两配对，如果最长直链长 $\ge\lceil n/2\rceil$ 那么就 path，否则因为同层奇数个而扔掉的点数至多 $\lfloor n/2\rfloor$。&lt;/li&gt;
&lt;li&gt;ARC153C：其实也可以归到调整一节里。先随便安排 $x$。我当时的思路是，如果 $\sum A_i\ne 0$，那么可以全体 $\pm$，否则如果 $A$ 形如括号序列那么无解，否则可以找到两个位置（$n$ 和后缀中第一个 $j$ 满足 $A_j\ne A_n$ 且 $\sum_{i=j+1}^nA_i=0$）作为“调整工具”。题解区大部分是利用前后缀统一 $\pm$ 来调整，异曲同工之处就是将 $n$ 个变量加强成只有 $\le 2$ 个变量可以调整，反而方便构造。&lt;/li&gt;
&lt;li&gt;CF1218G：先加强成要求三部的点邻边和 $\bmod 3$ 必须分别为 $0,1,2$。考虑只取出一棵树（最“紧”的情况，也算加强），其余边全部赋 $3$。可以调整 $n-1$ 条边，因此只有根可能不满足，试图微调。如果是一个基环树，那么环长为奇时可以解方程，全体满足；否则原图为二分图，仅要求要求一部 $\bmod 3=1$，另一部可以为 $0$ 或 $2$，这样只需调成两部的目标和 $\bmod 3$ 同余即可。&lt;/li&gt;
&lt;li&gt;USACO22OPENGoldT3：考虑答案下界，是有祖先后代关系的点的区间距离与无祖先后代关系的点的区间距离的一半的 $\max$。只考虑 $s_1$，发现 $s_1$ 取合适的值，其他 $s_i$ 尽量向 $s_1$ 靠拢，就可以直接达到下界，其他点之间复杂的关系不形成瓶颈，自动消解掉了。&lt;/li&gt;
&lt;li&gt;[互测 2023] 天空度假山庄：可以置换使得必然依次捡 $1,2,\cdots,n$ 的草莓（不算加强）。然后想象如何证明正解构造一定不会两次经过同一条边，如果构造过于混乱那肯定没法证，所以要先缩小可能性。希望证明形如：对于一条边 $(u,v)$，它只会出现在从 $f(u,v)$ 走 $k$ 步到 $f(u,v)+1$ 的路径上。初步思路是按编号差分类，如果 $i\rightsquigarrow i+1$ 上面只放 $v-u\equiv i$ 的边，不行。又立即考虑到所有路径上同一步放编号差相同的（例如 $k=2$ 是 $[2,-1]$），问题转化为构造一个长为 $k$ 的序列，和 $\equiv 1\pmod n$，且 $\forall\,i\le n/2$，序列中 $i$ 和 $n-i$ 出现的总次数 $\le 1$。这个可以先构造 $[\lfloor n/2\rfloor,\lfloor n/2\rfloor-1,\cdots,\lfloor n/2\rfloor-k+1]$，再随便调整一下。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;g-构造不依赖于输入的通解&#34;&gt;g. 构造不依赖于输入的通解
&lt;/h3&gt;&lt;p&gt;对于输入非 $\mathrm{O}(1)$ 的情况，如果对构造的限制较小，可能性较大，但难以基于题目要求条件进行讨论，可以尝试直接构造一个解，无论输入如何都满足条件。这其实也是一种加强，一种寻找模型当中的“必然性”的思维。有的时候只考虑根据输入推导出解也是一种错误的思维惯性。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;AGC052A。构造 $0^n1^n0$ 一定对，因为第 $n$ 个 $0$ 和第 $2n$ 个 $0$ 之间是一个完整的串，一定有 $n$ 个 $1$。&lt;/li&gt;
&lt;li&gt;CF1495C。每三行填满一行，这样任何输入的 &lt;code&gt;X&lt;/code&gt; 都能被“粘进来”。然后用一个竖线串起来一定可以，竖线稍微讨论一下。&lt;/li&gt;
&lt;li&gt;CF1485D。$a_{i,j}$ 很小，如果 $b_{i,j}=\operatorname{lcm}(2,\cdots,16)$ 就非常地安全。部分加强，棋盘染色后黑格子置 $720720$，只剩下白格子的条件，取 $b_{i,j}=720720-a_{i,j}^4$ 即可。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;h-研究操作能实现的功能&#34;&gt;h. 研究操作能实现的功能
&lt;/h3&gt;&lt;p&gt;在符合要求的情况下寻找（正推或逆推）某些具有特定功能的小结构或组合操作，再以这些“小单元”为跳板，去构造整个问题的解。另外一种情况是只有效利用题目允许的操作的一部分功能，这个思想也常在交互题中用到，例如 CF1299E 中第一步找 $1$ 和 $n$ 的过程。也是整题的突破口。&lt;/p&gt;
&lt;p&gt;核心思想是加强，以及分多步思考。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF715D：这类构造某结构使某方案数等于给定值的问题一般都可以二进制拆分（倍增）。但这题 $T$ 太大了，得六（$C_4^2$）进制拆分才行。建立 $6^k$ 的“源泉”，然后在旁边附着一个“管道”，收集需要的每一位数。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/constructive-problems/5zn46ypf.png&#34;
	width=&#34;654&#34;
	height=&#34;260&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;251&#34;
		data-flex-basis=&#34;603px&#34;
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1773J：这题必要的无解条件并不明确，先考虑仅部分利用这个复杂的操作，生成树联想到消圈法，发现如果 $e_1,e_2$ 同属于一个简单环，则可用两步操作将 $e_1\xleftarrow{+}x,e_2\xleftarrow{-}x$，其余边不变，因此有且仅有同一点双内的边是“连通”的（点双内的每对边都同处于某个简单环内）。并且一个点双选的边数固定，故有解当且仅当存在一个 $S$，操作一次 $+S$ 后每个点双内边和等于目标和。微调操作可做到 $m$ 步。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1748F：发现可以在 $4\cdot (j-i)$ 次内远程异或，将 $a_j\xleftarrow{\oplus}a_i$。利用 &lt;code&gt;y^=x^=y^=x&lt;/code&gt; 等价于 &lt;code&gt;swap(x,y)&lt;/code&gt; 直接构造需要 $3n^2$，但可以去除多个远程操作之间的重复部分做到 $1.5n^2$，利用环的另一个方向可以做到 $1.25n^2$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1060H：倒推。在只能作幂的情况下，$xy$ 仅能通过 $(x+y)^2-x^2-y^2$ 得到。考虑通过 $x^d,(x+1)^d,\cdots,(x+d)^d$ 的线性组合得到 $x^2$，由于方程的系数是范德蒙德矩阵，故一定有解。现在只需支持乘常数即可，用二进制拆分。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1120E：首先明确的一点是 $an$ 一定被大量的 $0$ 占据，但并不能直接找到。考虑 $an=10^kh+l$，然后在此基础上对个别位调整，改变 $w(n)=S(n)-S(an)\cdot a$。然而容许调整的范围太小，转而考虑多个 $10^kh+l$ 拼接在一起。对 $w(n)$ 做背包或按 $w(n)$ 值域建点跑最短路即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UOJ #75：不必多说。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;i-逆操作与中继状态&#34;&gt;i. 逆操作与中继状态
&lt;/h3&gt;&lt;p&gt;对于构造操作序列类题来说，这也是一种转换视角的方式。&lt;/p&gt;
&lt;p&gt;逆操作不要求给定操作可逆，只需要把操作本身逆过来看就行了，可能有更多性质。&lt;/p&gt;
&lt;p&gt;还有一类起始状态与终止状态均给定的情况，不容易直接构造，就可以考虑分别将两个状态先操作到某个固定的中继状态，再把后一半逆过来。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;[WC2022] 序列变换：思考这题需要一定的冒险，因为正解的线索不多。第一部分构造是将 $s_1$ 变成 $\texttt{(())()()…()}$，然后删掉开头里面的那个括号。每次考虑末尾最后一段非 $\texttt{()}$ 的子合法段，可以用 $1,2,3$ 操作之一将一部分脱离出来，构造得当可以做到 $\le 2n-4$ 次（需要均摊分析）。第二部分是将 $\texttt{()()…()}$ 变成 $s_2$。设 $s_2=\texttt{((A)…(Z))}$，那么可以先递归得到 $\texttt{(A)…(Z)()()}$，然后不断 $4$ 操作将倒数第二个括号扩到完整包含前面。注意最后一个括号是 $5$ 操作额外加的，不然 $4$ 操作无法进行。这一部分 $\le n$ 次，总共 $\le 3n$ 次。&lt;/li&gt;
&lt;li&gt;CF778D：操作两次等于不操作，考虑将任意状态归到骨牌全部水平。正解思路是依次扫描，遇到竖直的硬调整；实际上每一轮扫描全体，奇数轮尽量把竖变横，偶数轮尽量把横变竖，进行足够多轮也能过。&lt;/li&gt;
&lt;li&gt;[第五届图灵杯高级组 T2] 基础循环结构练习题：倒过来考虑，操作变成：① 全体减（不能有负）；② 选一个 $&amp;gt;\max$ 的数 $v$，每个数加若干倍 $v$。其中第二个操作灵活性就很大。在递增的情况下，可以逐个把最小的数减成 $0$ 后变为最大的数；在非递增的情况下可以先 $b_i\xleftarrow{+}iv$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;j-外围排除法&#34;&gt;j. 外围排除法
&lt;/h3&gt;&lt;p&gt;对于安排给出元素类题，常常会出现限制过于紧或复杂，无法直接构造的情况。这时可以尝试先基于题目条件，进行一些大规模的，充分的推理，或许可以有效地简化甚至解决原问题。&lt;/p&gt;
&lt;p&gt;这种排除法的要点有：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;找到排除的突破口。往往是题目条件的一个&lt;strong&gt;定量&lt;/strong&gt;形式的&lt;strong&gt;推论&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;解决无法继续排除时的问题。&lt;/li&gt;
&lt;li&gt;确定排除的顺序和实现方法。可以将排除过程类比为不断消除一个有向图入度为 $0$ 的点。使用外围排除法的题目常常会要求优化时间复杂度。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这种方法的本质恰好是与 &lt;em&gt;f&lt;/em&gt; 相反的，这里是只利用条件的一部分（弱化），然后就能构造成功。可以类比为数独中的排除法和假设法。&lt;/p&gt;
&lt;p&gt;用这种方法的题可能无法在一开始就确定无解条件，一般这样考虑：如果有解，那么推理就能一直进行下去；因此逆否命题就是，如果推理进行不下去，就无解了（例 2）；或者是无法推理了就是合法解，空了则无解（例 4&amp;amp;5）。&lt;/p&gt;
&lt;p&gt;例 6&amp;amp;7 讲的是一类变形，一般基于图。它的排除条件不一定是基于必要性的推理，而可能也是加强。这种反倒类似于 &lt;em&gt;k&lt;/em&gt;，其关键在于保证每一步操作前后有解/最优性不变。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1546E：排除线索是，若某一列一种数恰好只有一个那就可以确定对应排列一定在拉丁方里，同时可以排除与它有冲突的一些排列。这样，每时每刻剩余的排列一定是 $x$ 个拉丁方内的，$y$ 个拉丁方外的，并且每个外部的一定对应 $x$ 个内部的中的一个（$y\le x$）。如果无法排除，则每列都有 $\ge x$ 种数，且每种数 $\ge 2$ 个，由鸽巢原理，$y=x$，同时如果找到了一组拉丁方的剩余 $x$ 行，那它的补集也是合法的剩余 $x$ 行。因此可以随便选一个排列固定选它，答案 $\times 2$，继续递归处理。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1054G：叶子是一个值得考虑的突破口。如果某集合只有单个元素则可以忽略。设点 $x$ 所在的集合编号集合为 $A_x$，如果 $A_u\subseteq A_v$，那么 $u$ 可以作为 $v$ 的儿子叶子。因为如果原问题有解，$u$ 不是 $v$ 的儿子叶子，则可以调整成 $v$ 的儿子叶子并保持合法。并且每个叶子 $A$ 一定存在一个超集，因此找不到包含关系就无解。具体实现用 bitset，维护包含关系的二维数组，每次删点只会更新一小部分。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1439B：也是一个图找子集二选一问题，但是不能直接构造。显然度 $&amp;lt;k-1$ 的点可以忽略，度 $=k-1$ 的点只可能参与唯一的团，如果所有点度都 $\ge k$ 那么就完事了。由于是一个归纳的过程故已删去的点不考虑也没问题。判团可以用哈希表或离线每个点依次判定。由于一个团花费 $k^2$ 时间，边数减了 $k$，而 $k=\omega(\sqrt m)$  时无解，故至多 $\mathrm{O}(m\sqrt m)$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1656H：突破口是，（对称地来说）如果对于某个质数 $p$，$\exists\,i,\forall\,j,v_p(a_i)&amp;gt;v_p(b_j)\quad\cdots(*)$，那么 $a_i$ 可以扔掉。如果没得扔，剩余部分就一定符合条件。发现无法分解质因数，但 $(*)$ 等价于 $\gcd_j(a_i/\gcd(a_i,b_j))=1$，可以用 $2n$ 棵线段树维护这些值。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[IOI2022] 千岛：通过小样例模拟可以感知到环的作用，大致需要两个环且需要有特定的位置关系，但难以简单地描述和寻找。考虑如果有点没有出度则可以删去，如果起点出度为 $1$ 可以直接向后走，若这两个情况都排除完毕，则可以除起点外其余点任取一条出边，这样起点可以到达两个或重合或不交的环，即可构造方案。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1503F：将每张卡视作一个节点，如果一面的数是正的就像对应负的卡连边，这样入度+出度=2。尝试大量样例，发现有解性与只有出度的点和只有入度的点之间的路径距离奇偶性有关，但具体构造仍无法处理。发现如果出现一条三个点的链，那么这三个点可以紧邻着构造，也就是可以合并，于是用队列不断合并即可，最终出现环则无解。我在解这题时并没有对最终的合并法给出严谨的证明，题解区应该有。&lt;/p&gt;
&lt;p&gt;与这题类似的是 [WC2021] 括号路径（非构造题）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1610F：上界是邻边中权为 $1$ 的有奇数个的点数。这样的点的其他邻边都可以一入一出，两两匹配，这就启发进行合并或欧拉回路。事实上这两种方向都可以解。第一种方向就直接合并，用链表维护边序列即可。最终会剩下一堆 $1/2$ 交错链和环，直接安排。&lt;/p&gt;
&lt;p&gt;与这题类似的是 CF1499G。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;k-归约法和增量法&#34;&gt;k. 归约法和增量法
&lt;/h3&gt;&lt;p&gt;这两种方法的最大特征在于递归，类似于数学归纳法在数学中的地位。它们与  &lt;em&gt;j&lt;/em&gt; 的共同点在于，都无法直接解决整个问题，而是着眼于每一个“单步构造”，多个“单步”自动构成整个解。&lt;/p&gt;
&lt;p&gt;归约法的思想是考虑找到结构的某个子部分先构造掉并删去，缩小到一个形式相同，规模较小的子问题。&lt;/p&gt;
&lt;p&gt;增量法的思想是假设目前结构有一个现成的构造方法，如何将它扩展到更大的情况。&lt;/p&gt;
&lt;p&gt;归约法的思考往往比增量法容易，因为增量法是自依赖的，而归约法可以假定子问题必定可以解决。增量法的增量结构有时较复杂，难以确定，可能需要先递归地思考，再用增量法回溯。无论如何，要根据具体题目模型的条件限制关系来决定使用哪种思考顺序。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CFgym101221A：经过多次尝试，发现最优解开头与结尾有规律，可以通过四步将开头的四个 A 与结尾的四个 B 归位，中间部分递归构造。最优性分析可通过“相邻相同数”作为势能来分析。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/constructive-problems/0v4h3srt.png&#34;
	width=&#34;942&#34;
	height=&#34;198&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;475&#34;
		data-flex-basis=&#34;1141px&#34;
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1470D：归约法的思路是，（加强）每次任选一个点，将它与相邻点删去，实质上连出一个”菊花“。为了保证删去部分时刻连通，任选的点应当有至少一个邻点已被删去。增量法的思路是，每次加入一个与当前点集至少连有一条边的点，决定其是否要选。两者实质相同。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1019C：直接归约是不行的，因为不能在不考虑剩余结构的情况下贸然钦定一个点选。如果用增量法，加入一个点时若其出点选了则会出问题，入点则不会。于是考虑原图，每次删去任一点及其出点，然后倒过来加入。若其入点已选则没问题，否则选本身。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[CCO2020] 旅行商问题：下界为 $n-1$，考虑增量法，维护先全红后全蓝的链，设红蓝交界点为 $m$。加入一个点时如果能直接连接到 $m$ 之后则直接连，否则它与 $m$ 的边一定是蓝色，这时可以夹到 $m$ 和 $m$ 的前驱之间。这个构造和竞赛图哈密顿路径的构造有异曲同工之处。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1267H：一定有一种颜色很多，并且考虑到这种颜色参与使得原条件满足的一个必要条件是永不出现两个都是该颜色的相邻。这是一个弱化的条件，但是如果要求只考虑其他颜色仍然满足原条件，那就是充分的了。于是就有一个归约方法。将出现过相邻的位置之间连边，容易贪心选出一个大小至少为 $\lceil n/3\rceil$ 的独立集，剩下的归约即可。这题关键在于一开始对题意正确的诠释与转化。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF1744D：第一反应应该是给边定向，使得拓扑序变化量尽量大。首先满度点可以忽略，其次尝试达到上界。发现如果两点 $u,v$ 之间无边则可以互换 $p_u+1=q_v+1=p_v=q_u$，因而考虑反图。由于不能保证完美匹配故考虑加强只取反图的生成森林，然后将互换法推广成菊花，然后菊花剖分。菊花剖分用归约，根处特殊讨论类似 &lt;em&gt;e&lt;/em&gt; 例 4。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;l-调整法&#34;&gt;l. 调整法
&lt;/h3&gt;&lt;p&gt;注意构造题的调整法与 exchange argument 无关。&lt;/p&gt;
&lt;p&gt;调整的本质是基于已构造的结构进行二次构造，也是一种加强。一般用于两种情况：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;基本上已构造完毕，完善局部在最极端情况下会错的构造（初步构造→发现矛盾→解决矛盾）。&lt;/li&gt;
&lt;li&gt;从极端构造出发，多步调整直到符合条件（往往用于构造某个结构使得某个相关值为 $K$ 这类）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;调整法往往与 &lt;em&gt;c&lt;/em&gt;、&lt;em&gt;h&lt;/em&gt;、&lt;em&gt;k&lt;/em&gt; 等共同使用。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;CF1098C：首先可以二分出答案 $d$，然后考虑从完全 $d$ 叉树开始调整（类似 CF1311E），需要保证 $s$ 时刻属于当前未确定点的可调整范围内——如果再在当前层放点，就算剩余点连成直链也不够 $s$，就要直接跳到下一层。这样一定不会出现上一层未放满父亲数还不够的情况，否则上一层应该再多点。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CF922F：确定最优解后，考虑从全选调整到 $f$ 恰好为 $k$。$&amp;gt;m/2$ 的数调整不会导致贡献的连锁改变，可控性较强。$m$ 足够大时 $\sigma_0(m)\le (m/2,m)$ 中的质数数量，$m$ 较小时可以直接贪心，打表验证。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[IOI2020] 网络站点：先考虑直接用 dfs 序，发现最后一个儿子的子树与本身子树外后 dfs 到的节点无法区分，因此考虑调整为所有儿子记出栈时间，以此类推，按层数奇偶性决定记入栈还是出栈时间戳。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[NOIP2022] 喵了个喵：思考 subtask 1，每个栈维护两个牌，分别记为“底”和“顶”。留一个空栈用于消底。在 $k=2n-1$ 时仅有所有种类牌均存在 $1$ 张时会出问题。出现这种情况时不应贸然将最后一种牌（记为 $x$）放到仅有的空栈里——如果下一步消的是一个底，那么 $x$ 直接放到这个底对应的顶上。推而广之，这启发我考虑后面第一个消底的步骤，在这之前消的都是顶，好处理。如果这个底对应的顶在期间出现了偶数次，那么也可以将 $x$ 放在这个顶上，否则 $x$ 可以放在空栈里。这样的话当消第一个底后至少留有一个空栈。如果后面第一个消底之前先消了 $x$，则可以直接把 $x$ 放在空栈里。&lt;/p&gt;
&lt;p&gt;这题实际上最恶心的是实现。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;m-做法拼合&#34;&gt;m. 做法拼合
&lt;/h3&gt;&lt;p&gt;用这类方法的题较少见，其主要难点在于找到一个分界条件，使得两种做法恰好能完美覆盖所有情况。一个重要的点是不要因为一个构造方法不能解决整个问题就把它舍弃掉。&lt;/p&gt;
&lt;p&gt;常用于找图的一部分，满足两个条件中的一个这类问题。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CF1097E：发现上界至少是 $f(n)=\max{k\mid k(k+1)/2\le n}$，可由 $[1,3,2,6,5,4,10,9,8,7,\cdots]$ 取到。一个基本的归约思路是每次取 LIS 和 LDS 中较长的删去，但通过随机大数据筛选发现这个长度可能 $&amp;lt;f(n)$，这可能导致多划分了一个但上界不变。正确的方法是如果 $\text{|LIS|}\ge f(n)$ 则选 LIS，否则由 Dilworth 定理，最小 DS 覆盖必 $&amp;lt;f(n)$，直接覆盖即可。&lt;/li&gt;
&lt;li&gt;CF1364D：dfs 树。如果所有返祖边跨度都 $&amp;gt;k$，那么任选一个环，隔一个选一个即可得到独立集。&lt;/li&gt;
&lt;li&gt;CF1148G：将互质的数之间连边构成一张图，直觉上来说连通块数量较大就可以选独立集，否则可以选每个点至少有一条边。后者只对连通块保留生成树即可。加强，考虑对于每一个数求出前面任意一个与它互质的数连父亲，这样如果根数 $\ge k$ 就有独立集了，否则由鸽巢原理必存在一个大小至少为 $3$ 的树（不选它，用于后面调整用），现在可以随意贪心选树，如果出现剩余只需选一个点的情况就不行了，这时上一步应当与开始找到的大小至少为 $3$ 的树之间调整一下使得每棵树里都至少选两个点。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;n-分组与分治&#34;&gt;n. 分组与分治
&lt;/h3&gt;&lt;p&gt;例：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[NOIP2020] 移球游戏：如果每次只分离一种颜色那太浪费了。考虑如果只有两种颜色但每种颜色不止一根柱子怎么做。一种思路是每次合并两根杂色柱子。先将一根柱子的颜色分出，多的一种颜色放在该柱子上，少的一种放在一根临时柱上。再将另一根柱子的该颜色归过去，剩余部分归入临时柱，这样就变出一根纯色柱子。 以下是一个例子：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;initial
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱一: 122112112
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱二: 212221122
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;临时: ?????????
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;空柱: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;stage 1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱一: 122112112
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱二: 212221122
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;临时: ?????
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;空柱: ????
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;stage 2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱一: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱二: 212221122
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;临时: ?????2222
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;空柱: ????11111
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;stage 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱一: 2222
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱二: 212221122
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;临时: ?????
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;空柱: ????11111
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;stage 4
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱一: 222222222
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;柱二: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;临时: ?????1112
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;空柱: ????11111
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;设较多的一种颜色在柱一中出现了 $a$ 次，那么四个阶段分别的移动次数为：$\min(a,m-a),m,a,m$，因此至多 $3m$ 次，套上值域分治即可。只剩余两根杂色柱子时要特殊规划一下，也可以做到 $3m$。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[互测 2021] 聚会/Steiner 三元系：首先用 b 证明仅有 $n\equiv 1/3\pmod 6$ 时有解，其次构造无法直接递归或增量构造。考虑分组。$n=6k+3$ 时考虑将点平分成三组，连这样的结构：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/constructive-problems/tu7s7npb.png&#34;
	width=&#34;1000&#34;
	height=&#34;292&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;342&#34;
		data-flex-basis=&#34;821px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;这相当于构造一个 $2k+1$ 阶对称拉丁方 $A$（下标从 $0$ 始），且 $a_{i,i}=i$。可取 $a_{i,j}=\frac{i+j}{2}\bmod (2k+1)$。&lt;/p&gt;
&lt;p&gt;$n=6k+1$ 时考虑拿出一个点 $o$，剩余平分三组。将组内边消光后应当还剩余组间的 $6k$ 条边及与 $o$ 的 $6k$ 条边。取 $a_{i,j}\equiv\begin{cases}\frac{(i+j)\bmod 2k}{2},&amp;amp;2\mid(i+j)\\ \frac{(i+j)\bmod 2k+2k-1}{2},&amp;amp;2\nmid(i+j)\end{cases}$，这样相邻层间只剩 $(i,i)$ 和 $(n+i,i)$（$0\le i&amp;lt;n$），可以处理掉。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;通用的思考方法&#34;&gt;通用的思考方法
&lt;/h2&gt;&lt;p&gt;以上的技巧与解题思想都只是构造题的冰山一角，还存在着大量的技巧变式和无技巧构造，我们不能对于每道题都枚举所有套路逐一试错，而需要具体情况具体分析。对于任意给出的一道构造题，我们该如何入手思考？&lt;/p&gt;
&lt;p&gt;首先要明确的一点是，OI 中的构造题一定有一个很突出的突破口，一般来说是一个具体的思考方向（观察角度、加强方式、构造顺序或初步构造结构形式等）。这与其他题目是有很大不同的。当没有想到这个突破口时，一切分析都看似杂乱无章，没有作用；但从突破口向下推导，构造的正确性就会自然浮出水面。&lt;/p&gt;
&lt;p&gt;突破口不应当完全依靠猜或试找出来，而是主要通过线索推断出来。这样的线索可能是特殊的题目条件（包括数据范围）、某种特殊情况、导出的性质、对模型某个量的数学分析、对必然性的分析、对模型的观察转化，甚至是打表的结果或者对部分分解法或错误解法的进一步调整和研究。&lt;/p&gt;
&lt;p&gt;从而我提出解构造题的一个思考过程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;读题，获取模型特征，结构类型，条件限制的类型和可能性多少。&lt;/li&gt;
&lt;li&gt;分析条件，转化条件，试图导出初步结论，例如确定无解和最优化条件。&lt;/li&gt;
&lt;li&gt;模拟样例，对模型有初步的感知，并尝试对模型的观察角度及呈现形式进行转变，重复做该步骤。&lt;/li&gt;
&lt;li&gt;小结，总结目前已知的性质和转化方式，剩余的问题的特征，并指出可能的方向与角度。&lt;/li&gt;
&lt;li&gt;进一步深入尝试，循环往复。&lt;/li&gt;
&lt;li&gt;找到一个正确的方法后，尝试换角度描述或找性质以进一步简化、优化实现。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当解构造题长时间卡住时，我的经验是自己一直在一个不可能解决的范围内打转，而真正漏的方向或错误排除的方向是在其他的地方。因此要回到原题目模型，再次分析特征，寻找可能的方向，同时也要回顾自己先前想到的方向，写清楚问题模型和错误解法模型，尝试调整错误，可能会柳暗花明又一村。如果没有陈述清楚问题，也会妨碍构造，遗漏正确思路。&lt;/p&gt;
&lt;h2 id=&#34;参考文章&#34;&gt;参考文章
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;蒋凌宇，《信息学竞赛中构造题的常用解题方法》，IOI 2021 集训队论文集&lt;/li&gt;
&lt;li&gt;虞皓翔，《构造题选讲》，WC 2022 讲课&lt;/li&gt;
&lt;li&gt;William Cherowitzo，《Steiner Triple System》，&lt;a class=&#34;link&#34; href=&#34;http://www-math.ucdenver.edu/~wcherowi/courses/m6406/sts.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://www-math.ucdenver.edu/~wcherowi/courses/m6406/sts.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>读论文系列 #2——两个偏理论的静态数据结构问题</title>
        <link>https://littlereuben.github.io/study/paper2/</link>
        <pubDate>Sun, 27 Aug 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/paper2/</guid>
        <description>&lt;div style=&#34;background-color: #FFE1B9; color: #794500; padding-left: 1em; border-left: 4px solid #DE9B41; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;摘抄笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;本文基本上就是 &lt;a class=&#34;link&#34; href=&#34;https://citeseerx.ist.psu.edu/doc/10.1.1.79.1554&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Optimal Preprocessing for Answering On-line Product Queries&lt;/a&gt; 和 &lt;a class=&#34;link&#34; href=&#34;https://cs.uwaterloo.ca/~imunro/cs840/ProjectPapers/SODA10_014_yuanh.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Data Structures for Range Minimum Queries in Multidimensional Arrays&lt;/a&gt; 的非形式化翻译，掺杂了自己的理解和思路，略去了一些细节。&lt;/p&gt;
&lt;p&gt;主要讲一下比较基础的静态数组、高维数组的区间查询问题。两篇论文其实关系不大，只是后一篇用了前一篇的部分成果。&lt;/p&gt;
&lt;p&gt;理论性比较强，尤其是后一篇，基本上出不成题。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;静态序列区间半群查询问题&#34;&gt;静态序列区间半群查询问题
&lt;/h2&gt;&lt;p&gt;问题：给定半群元素序列 $a_{1\cdots n}$，在只能使用半群运算 $\circ$ 的情况下，多次询问区间 $[l,r]$，回答 $\circ_{i=l}^r a_i$。&lt;/p&gt;
&lt;p&gt;解决思路无非就是预处理一些区间的积，查询时拼起来就行。联想到正常的动态区间查询问题，动态情况下下界就是 $\Omega(\log n)$ 的。静态情况下允许的预处理量大大增加，因此分析下去会不一样，但思路还是可以借鉴的。总体来说，核心的思想就是两点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;预处理与查询的平衡。&lt;/li&gt;
&lt;li&gt;分块与分治。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;记 $k$ 表示回答查询时允许的半群运算次数 ${}+1$。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;最初的思考从 $k=2$ 开始（$k=1$ 只能预处理所有平方个区间），我们要给每个区间 $[l,r]$ 选定一个切分点，然后进行所需的预处理。为了使公共预处理区间尽量多，考虑每次选择一个点，将所有尚未确定切分点，且能以该点为切分点的区间的切分点选定为该点。这个就是猫树，下面说点题外话。&lt;/p&gt;
&lt;p&gt;记猫树的预处理量为 $p(n)$。每次选取中点作为切分点的&lt;em&gt;最优性&lt;/em&gt;是由 $p(n)$ 的凸性保证的。我们可以通过解递归式得到：
$$
p(n)=n\lfloor\log_2(n-1)\rfloor+2n-2^{\lfloor\log_2(n-1)\rfloor+1}
$$
为了方便 $\Omicron(1)$ LCA，猫树有少量冗余。理论上递归可以只进行 &lt;code&gt;build(l,mid-1)&lt;/code&gt; 和 &lt;code&gt;build(mid+2,r)&lt;/code&gt;，并且在 $r-l\le 1$ 时结束，记猫树&lt;em&gt;最优的&lt;/em&gt;预处理量为 $p^\prime(n)$：
$$
p^\prime(n)=(n+2)\lfloor\log_2(n+1)\rfloor-n+2-2^{\lfloor\log_2(n+1)\rfloor+1}
$$
猜想：对于长为 $n$ 的序列，$k=2$ 情况下符合条件的预处理区间集合 $\mathcal{P}$，除去 $n$ 个单元素区间，${\lvert\mathcal{P}\rvert}_{\min}=p^\prime(n)$。&lt;/p&gt;
&lt;p&gt;注意这里的最优性和上文的最优性是不一样的，上文是“每次选择一个切分点，然后两边递归”这个思路前提的基础上的最优性。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;纠结于系数意义不大，我们关注 $k=2$ 情况的结构带来的启发。“预处理前/后缀和”是非常有效的线性手段。&lt;/p&gt;
&lt;p&gt;但是如何推理 $k&amp;gt;2$ 呢？众所周知，动态情况下的线段树是从分块嵌套演化过来的，因此考虑类比逆推多个切分点的情况（只预处理每一块内的前后缀和）：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/paper2/fga2gv7u.png&#34;
	width=&#34;1070&#34;
	height=&#34;400&#34;
	
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;267&#34;
		data-flex-basis=&#34;642px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;对于一个询问，如果它在块内部，则递归 $T_2$ 处理，否则两头散块可以用前后缀和算出，然后考虑 $T_1$ 用于维护每块的和形成的较短序列，处理块间部分。&lt;/p&gt;
&lt;p&gt;记块大小为 $B(n)$，预处理复杂度为 $p(n)$，回答询问使用的运算次数最多为 $q(n)-1$。下文中可能出现多个 $f(n)$，作用域仅在单自然段内。&lt;/p&gt;
&lt;p&gt;利用分治的思想，考虑三种可能（记 $q(n)=k$ 的数据结构为 $S_k$，$S_2=$ 猫树）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$T_1=T,T_2=T$。&lt;br&gt;
$p(n)=p(n/B(n))+n/B(n)\cdot p(B(n))+\Theta(n),q(n)=\max\set{q(n/B(n))+2,q(B(n))}$，上下均自递归的结构其实很像 vEB 树，因此考虑取 $B(n)=\sqrt n$，将 $p(n)$ 展开后使用初中处理因式的技巧，就可以得到 $p(n)=\Theta(n\log\log n)$，同时 $q(n)=\Theta(\log\log n)$。我猜测无法更优了。&lt;/li&gt;
&lt;li&gt;$T_1=T,T_2=S_2$。&lt;br&gt;
$p(n)=p(n/B(n))+\Theta(n\log B(n)),q(n)=q(n/B(n))+2$，可以对输入的固定的 $n$ 取 $\forall i,B(i)=2^{\sqrt{\log n}}$，这样可以平衡成 $p(n)=\Theta\left(n\sqrt{\log n}\right),q(n)=\Theta\left(\sqrt{\log n}\right)$。这个方向没有前途的直觉解释是：分块后问题分成了 $T_1$——&lt;strong&gt;单个规模较小&lt;/strong&gt;、$T_2$——&lt;strong&gt;若干规模很小，但总和不变&lt;/strong&gt; 这两个子问题，直觉上后者是比前者难的，拿已有的结构作为 $T_2$ 基本没法优化。&lt;/li&gt;
&lt;li&gt;$T_1=S_2,T_2=T$。&lt;br&gt;
$p(n)=\Theta(n/B(n)\cdot\log(n/B(n)))+n/B\cdot p(B(n))+\Theta(n),q(n)=4$，很明显可取 $B(n)=\log n$，从而做到 $p(n)=\Omicron(n\log^*n)$，这个就是 $S_4$。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;第三种可能实际上提供了一个以 $q(n)$ 增加 $2$ 为代价，将 $p(n)=\Omicron(n\cdot f(n))$ 变为 $\Omicron(n\cdot f^*(n))$ 的通法（得满足 $f(n)=\Omicron(\log n)$，取 $B(n)=f(n)$ 即可），其中 $f^*(n)=\min\set{i\mid f^{(i)}(n)\le 1}$。 因此我们可以做到：
$$
\forall 2\mid k\ge 4,p(n)=\Omicron(n\log^{\begin{matrix}k/2-1\\ \overbrace{**\cdots*}\end{matrix}}n),q(n)=k
$$
……吗？&lt;/p&gt;
&lt;p&gt;这里有一个很容易犯的错误，就是如果不用主定理解递归式，那么解的过程中严谨地来说必须避免渐进记号。但 OI 实践中往往不拆也不会出问题，这里实际上套上了一个归纳，并且把 $k$ 作为变量塞进渐进记号里了，就得谨慎地算一下了。$k=4$ 时：
$$
\begin{aligned}
p(n)&amp;amp;=n/\log n\cdot \log(n/\log n)+n/\log n\cdot p(\log n)+2n-2\log n\\
&amp;amp;&amp;lt;3n+n/\log n\cdot p(\log n)\\
&amp;amp;=3n\log^*n
\end{aligned}
$$
同理，可以算得 $k=6$ 时 $p(n)&amp;lt;5n\log^*n$ 等等。因此：
$$
\forall 2\mid k\ge 4,p(n)=\Omicron(n\textcolor{red}{k}\log^{\begin{matrix}k/2-1\\ \overbrace{**\cdots*}\end{matrix}}n),q(n)=k
$$
另外，为了完整，我们把 $2\nmid k$ 也补上。$k=3$ 套上 $T_1=S_1$，（特例）取 $B(n)=\sqrt n$，可以得到 $p(n)=\Theta(n\log\log n)$ 的 $S_3$，$k\ge 5$ 就跟 $k-1$ 情况一样了。&lt;/p&gt;
&lt;p&gt;为了平衡 $p(n)/n$ 和 $q(n)$，考虑取 $k=2\alpha(n)+2$，其中：
$$
\alpha(n)=\min\set{i\mid\log^{\begin{matrix}i\\ \overbrace{**\cdots*}\end{matrix}}n\le 3}
$$
这里 $\le 3$ 时因为 $n\ge 5$ 时不管有几个星，结果都至少是 $3$。您可能在其他地方见过 $\alpha(n)$ 的不同定义方式，不同的定义应该都只差一个常数。&lt;/p&gt;
&lt;p&gt;这时 $p(n)=\Omicron(n\alpha(n)),q(n)=\Theta(\alpha(n))$。注意这里的 $\alpha(n)$ 是无法变成 $\alpha^*(n)$ 的，但是有另一个看起来不大优美的优化方式：&lt;/p&gt;
&lt;p&gt;仍然考虑上文的分块模型，$T_1=S_{2\alpha(n)+2},T_2=T_{?}$，设 $T_{?}$ 的预处理时间为 $p_{?}(n)=\Omicron(n\cdot f(n))$。那么总的 $p(n)=\Omicron(n/B(n)\cdot\alpha(n)+n\cdot f(B(n)))$，如果要使得 $p(n)=\Theta(n)$，唯一的方法是取 $B(n)=\alpha(n),f(n)=\Omicron(1)$，那么 $T_{?}$ 可以选择普通线段树。好在这部分的询问运算次数不是瓶颈，因此总的 $q(n)$ 只会加 $2$（最外层两端的散块）。这里主要是通过类似于待定系数法的方式解释一下论文里为什么会突然冒出普通线段树。&lt;/p&gt;
&lt;p&gt;这个优化的思想是，用“单个规模较小”优化预处理“常数”（红色的 $k$），“若干规模很小，但总和不变”尽管无法有效减小预处理复杂度，但是可以保证查询次数足够少。二者互补。&lt;/p&gt;
&lt;p&gt;我尝试类推优化掉任意 $k$ 的“常数”（红色的 $k$）（这个原论文里没讲），但 $q(n)$ 会加 $2$。这个是可以避免的：&lt;/p&gt;
&lt;p&gt;希望 $q(n)=k\ge 3$，最外层是 $T_1=S^\prime_k,T_2=普通线段树,B(n)=k$。$S^\prime_k$ 是修改过的结构，基本与 $S_k$ 相同，即 $T_1=S_{k-2},T_2=S^\prime_k,B(n)=f(n)$，这里 $f(n)$ 指的是设 $S_{k-2}$ 的预处理复杂度为 $\Omicron(n(k-2)f(n))$。不同的点在于 $S^\prime_k$ 处理的块内前后缀和是细分到原序列的，而不是严格遵循最外层分块结构把每 $k$ 个一组的和视为整体。这样就避免了最外层跨块时额外查一对前后缀和。$S^\prime_k$ 的预处理复杂度仍然是 $p(n)=\Omicron(nk/B(n)\cdot f(n))+n/B(n)\cdot p(B(n))+\Theta(nk)=\Omicron(nk\cdot f^*(n))$，其他部分也都没有问题，总体来说就把 $p(n)$ 的 $k$ 除掉了，$q(n)$ 不变。最终我们得到了：
$$
p(n)=\begin{cases}\Omicron(n^2)&amp;amp;q(n)=1\\ \Omicron(n\log n)&amp;amp;q(n)=2\\ \Omicron(n\log\log n)&amp;amp;q(n)=3\\ \Omicron(n\log^{\begin{matrix}\lfloor k/2\rfloor-1\\ \overbrace{**\cdots *}\end{matrix}}n)&amp;amp;q(n)=k\ge 4\end{cases}
$$
但如果具体实现真想做到查询时间复杂度 $=\Theta(q(n))$，那就得处理一个“变进制数 LCP 问题”，而且 $q(n)\ge 4$ 后基本没法体现区别，所以只能套一个交互限制运算次数或者像 &lt;a class=&#34;link&#34; href=&#34;https://uoj.ac/problem/709&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;【北大集训2021】末日魔法少女计划&lt;/a&gt; 这样。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;下界的证明思路是对着这个分块结构硬证。对于 $k=2$，选择序列中点 $m$，将只包含于中点左侧（不含中点）和只包含于中点右侧（不含中点）的预处理作为一类，跨左右的预处理作为一类。考虑询问 $[m-i,m+i]$，要用两个预处理拼成该询问，就必须有一个跨左右的预处理。因此 $p(n)\ge p(\lfloor n/2\rfloor)+p(\lceil n/2\rceil-1)+\lceil n/2\rceil-1$，解得 $p(n)=\Omega(n\log n)$。对于 $k\ge 3$，按 $S_k$ 的块大小分块，但块间空出一位。也是先忽略块内的预处理，剩余跨块的预处理。对于一个位置，如果它不是任何跨块预处理的端点，则标记它。如果含有被标记位置的块不足一半，那么跨块预处理至少 $\Omega(n)$；超过一半，那么考虑所有以标记位置为两端的询问，组成询问区间的最左右预处理一定是块内的，去掉这两部分后剩余问题一定不弱于 $k^\prime=k-2,n^\prime=n/B(n)$ 情况的问题，跨块预处理也是至少 $\Omega(n)$，归纳即可，这里注意不会带有因子 $k$。论文里提到这个证明可以直接推广成“预处理可以是任意子集且不要求不交并”情况。&lt;/p&gt;
&lt;p&gt;因此，上述解法的半群运算次数是渐进最优的。论文标题上加了个 on-line，不知离线是否会有更好的结果。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;高维-rmq-问题&#34;&gt;高维 RMQ 问题
&lt;/h2&gt;&lt;p&gt;问题：给定高维数组 $a_{1\cdots n_1,\cdots,1\cdots n_d}$，在只能使用比较运算的情况下，多次询问高维区间 $[l_1,r_1],\cdots,[l_d,r_d]$，回答 $\min_{i_1\in[l_1,r_1]}\cdots\min_{i_d\in[l_d,r_d]}\set{a_{i_1,\cdots,i_d}}$。记 $N=\prod n_i$。&lt;/p&gt;
&lt;p&gt;以下视 $d$ 为定值，但还是会尽量写一下关于 $d$ 的常数。以下假设 $a$ 中数互不同。&lt;/p&gt;
&lt;p&gt;先尝试把上文的静态区间半群查询问题的 $S_k$ 扩展到 $d$ 维结构 $S_k^d$：非常简单，处理块内前后缀和时，不再是存储单个元素，而是一个 $d-1$ 维数组，就需要嵌套下去，那就归约 $S_k^{d-1}$ 了。时间复杂度的变化是预处理的 $\log$ 以及查询会带上 $d$ 次方。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;目前可以做到的是预处理 $\Omicron(N\log^{d-1}N)$，查询 $\Omicron(2^d)$，也就是把最内层一维套个四毛子。&lt;/p&gt;
&lt;p&gt;但是我们的目标是预处理 $\Theta(N)$，查询 $\Omicron(1)$。可以推理得到以下几点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;得用四毛子。&lt;/li&gt;
&lt;li&gt;直接用 $S_2^d$ 之类的结构肯定不行。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;那如果是 $S_3^d$ 的最内层套四毛子，是不是就可以做到 $\Omicron\left(N\frac{(\log\log N)^d}{\log N}\right)=\omicron(N)$ 了呢？答案是否定的，因为次内层的结构是带一个前后缀 $\min$ 的，也就是要得到最内层建树所基于的序列，就先得乘 $\Theta(n_d)$，而其他外层又无法直接套四毛子，所以如果用这种思路，就必定是 $\Omega(N(\log\log N)^{d-1})$ 的。因此一维的四毛子不行。&lt;/p&gt;
&lt;p&gt;四毛子的关键是找到一个信息量足够小的贴近本质的刻画，那如何找到一个高维数组的所有可能的区间 $\min$ 的刻画呢？不幸的是，论文中提到，二维的 $n\times n$ 方阵不存在类笛卡尔树的刻画，因为在矩形 $\min$ 查询意义下本质不同的方阵个数为 $\Omega(((n/4)!)^{n/4})$，取对数发现光是靠比较来区分所有的情况都无法做到 $\Omicron(n^2)$。&lt;/p&gt;
&lt;p&gt;一种新的刻画一维序列的方式如下：考虑猫树，树的每个节点预处理所有前后缀 $\min$。尽管建树复杂度无法做到 $\Theta(n)$，但比较次数是可以的：考虑一个节点的前缀 $\min$，前一半从左儿子继承，后一半从右儿子继承的同时，要与左儿子 $\min$ 再取个 $\min$，而这个取 $\min$ 的决策情况显然可以二分分界点，因此一个节点的比较次数可以做到长度的对数，总体来说就是至多 $2\sum_{i\ge1}i\cdot\frac{n}{2^i}=4n$ 次。&lt;/p&gt;
&lt;p&gt;猫树可以扩展到高维 $S_2^d$，但为了保证比较次数，处理方法要稍作调整：对于某个节点，设其对应的区间长度为 $2^{i_1}\times\cdots\times 2^{i_d}$，由于不能多维同时二分，故选择最长的一维，将这一维切成两半后对应的节点信息作为继承 $\min$ 值的来源，其他维暴力扫描，这一维二分。比较次数为（这里的 $2^d$ 是每一维都要前后缀）：
$$
\begin{aligned}
&amp;amp;\sum_{i_1,\cdots,i_d}\max_j\set{i_j}\cdot\frac{\prod_j2^{i_j}}{\max_j\set{2^{i_j}}}\cdot 2^d\cdot\frac{N}{\prod_j2^{i_j}}\\
={}&amp;amp;2^dN\sum_{i_1,\cdots,i_d}\frac{\max_j\set{i_j}}{2^{\max_j\set{i_j}}}\\
={}&amp;amp;2^dN\sum_i\frac{i}{2^i}\left[(i+1)^d-i^d\right]\\
&amp;lt;{}&amp;amp;2^dN\sum_i\frac{i^{d+1}}{2^{i-1}}\\
={}&amp;amp;2^{d+2}N\cdot \tilde{b}(d+1)\\
\approx{}&amp;amp;\frac{2^{d+1}(d+1)!}{(\ln 2)^{d+2}}N\\
={}&amp;amp;\Theta(N)
\end{aligned}
$$
其中 $\tilde{b}(n)$ 是 &lt;a class=&#34;link&#34; href=&#34;https://oeis.org/A000670&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;A000670&lt;/a&gt;。注意如果不选最长的一维切就不能线性了。&lt;/p&gt;
&lt;p&gt;由于这个结构并非确定唯一的最小值位置，而是给出 $\Omicron(2^d)$ 个候选最小值，故它的线性复杂度并不与上文所说的“无法刻画”矛盾。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;好，现在选取边长为 $B=c\log^{1/d}N$ 的 $d$ 维超立方体作为小块，使用四毛子（为了快速识别输入的每一小块的类型，避免带上 $\log^d$，可以选取足够小的常数 $c$，$\Omicron(N)$ 地预处理出判断块类型的决策树）。这种分块方式不是严格意义上的高维嵌套分块，需要重新考虑如何回答询问。&lt;/p&gt;
&lt;p&gt;注意到，只要询问有一个维度的区间是跨块，那么整块部分就可以直接利用除以 $\log^{1/d} N$ 这个因子，套上 $S_3^d$ 从而达到 $\Theta\left(\max\Set{N,N\frac{(\log\log N)^d}{\log^{1/d}N}}\right)$ 也就是 $\Theta(N)$（因为 $d$ 是定值）；查询的每一维都是块内的情况不必多说。&lt;/p&gt;
&lt;p&gt;现在就剩下跨块时去掉中间整块后，散块即两端块内前后缀部分的处理。&lt;/p&gt;
&lt;p&gt;论文中给出的方法是：对跨块的这一维的所有块内前后缀 $\min$（指的是多个内层 $d-1$ 维数组对应位置分别取 $\min$），递归建 $d-1$ 维时的原问题结构。总体来说，需要预处理以下三部分：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每个小块的类型；&lt;/li&gt;
&lt;li&gt;每一维求出每个块的 $\min$（$B$ 个内层 $d-1$ 维数组对应位置分别取 $\min$），然后建 $S_3^d$。&lt;/li&gt;
&lt;li&gt;每一维求出每个块内前后缀的 $\min$，然后递归建 $d-1$ 维的结构。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;询问时，如果所有维度都是块内，则直接回答，否则任选一个跨块维度，拆成三个部分处理。&lt;/p&gt;
&lt;p&gt;预处理复杂度 $p(n)=\Theta(2^d\tilde{b}(d+1)N)$，具体算一下会发现递归减一维的部分并不是瓶颈，识别小块类型才是。查询 $q(n)=\Omicron(3^d)$。&lt;/p&gt;
&lt;p&gt;我想到的一个更简单的方法是：只预处理上文中 1 和 2 结构，$p(n)$ 不变。查询时利用 RMQ 可以重复考虑同一个数的性质，分别考虑每一个跨块的维度，忽略其散块部分（其他维保留原询问区间），在 2 结构中查询，这个是 $\Omicron(d3^d)$；剩余未考虑的就是每一维都是散块的部分，一共有 $\Omicron(2^d)$ 个（左右段各一个）块，每个小块 $\Omicron(2^d)$，乍一看是 $\Omicron(4^d)$，但实际上如果一个维度跨块了，它会给查询数量贡献 $\times 2$，但在高维猫树中由于这维查的是前后缀，所以对候选最小值数量就不贡献 $\times 2$ 了，因此还是 $\Omicron(2^d)$。最终 $q(n)=\Omicron(d3^d)$。&lt;/p&gt;
&lt;hr&gt;
</description>
        </item>
        <item>
        <title>读论文系列 #1——串与 DAG 的 LCS</title>
        <link>https://littlereuben.github.io/study/paper1/</link>
        <pubDate>Tue, 22 Aug 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/paper1/</guid>
        <description>&lt;div style=&#34;background-color: #FFE1B9; color: #794500; padding-left: 1em; border-left: 4px solid #DE9B41; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;摘抄笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;前天 @changruinian2020 发了我一篇论文，让我帮他读读。以前基本上没有在毫无相关理论准备的情况下读论文，这里记录一下，挺有帮助的。&lt;a class=&#34;link&#34; href=&#34;https://arxiv.org/pdf/2302.01748.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;链接&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;首先这篇论文在 OI 范围内没啥意义，纯粹就是练阅读能力，相对一些其他论文来说比较友好。如果您也想练习，推荐先去看原文，再对照一下下面提供的我的理解（不保证正确）。&lt;/p&gt;
&lt;p&gt;问题：给定一张 DAG $G$，点上带有字符串 $\ell(v)$，给定串 $Q$，求 $Q$ 与 $G$（的所有路径中）的 LCS，一条路径对应的串就是点的串顺次拼起来。&lt;/p&gt;
&lt;p&gt;结构：求得每个单点 $v$ 与 $Q$ 的所有极长公共子串 MEM（说是可以关于 MEM 个数线性地求出，在另一篇论文里。记为 $N$ 个），记作 $(Q[x\cdots x+\kappa-1],\ell(v)[i\cdots j])$，然后选出一个 MEM 序列，要求 $x\le x&amp;rsquo;,v\rightsquigarrow v&amp;rsquo;$，允许 $v=v&amp;rsquo;$，如果这样有额外的条件 $i\le i&amp;rsquo;$（这里加一撇表示序列中的下一项）。这个时候把这个序列在 $Q$ 和所有涉及到的 $\ell(v)$ 中都划出对应匹配的子串，如果相邻两个 MEM 在 $Q$ 中或者某个 $\ell(v)$ 中划的线有重合，就把前面的一个区间缩一下（$Q$ 和 $\ell(v)$ 同时缩）。这样子得出的公共子序列一定能考虑到最优解。例子可以参见 Figure 1。&lt;/p&gt;
&lt;p&gt;求解：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;先考虑每个点只能选一个 MEM 的情况，那么只能在 $Q$ 中出现划线重合。这个问题相当于：$G$ 中每个点都挂了一些区间，要选一条路径，路径上的每个点选挂在上面的 $0$ 或 $1$ 个区间，得到 $[l_1,r_1],\cdots,[l_t,r_t]$，其中要求 $l_i\le l_{i+1}$。现在最大化 $\sum(\min(r_i+1,l_{i+1})-l_i)$。由于可能是在 DAG 上跳着走，所以有点难搞。给所有挂着的区间一起编个号，记 $dp[i]$ 表示 $i$ 号区间作为最后一个区间的答案。通过另一个神秘算法找到图的最小（可相交）路径覆盖（记为 $k$ 条），每一条路径统一更新其他所有点（对于每个希望被更新的点，&lt;em&gt;找到路径上最后一个可达它的点&lt;/em&gt;，在那个点处理完时更新，这样就避免了后效性），然后就剩下路径内部转移了。具体统一更新的方法就是讨论 $\sum$ 里的 $\min$ 取哪一项，就变成了一个单点更新，求区间 $\max$ 的问题了，每条路径维护两棵线段树/平衡树即可。这样就是 $\mathrm{O}(kN\log N)$ 的。&lt;br&gt;
补充一句，斜体部分在原文中说若要做到与 $\lvert E\rvert$ 无关得用 transitive reduction，这个东西看起来有些前途，NOI2021D1T3 用到了这个思想。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后要考虑点内部选多个 MEM 的情况。先考虑两个串之间的问题，仍然是已知两者的所有 MEM。这里我认为论文有笔误，显然 &lt;code&gt;M.sort()&lt;/code&gt; 应该按照 $i$ 而不是 $x$ 排序。转移就按照 coverage 公式讨论：a. 两者都不重合；b. $T$ 中不重合 $Q$ 中重合（与第一步中类似）；c. $T$ 中重合且比 $Q$ 中重合得多（允许 $Q$ 不重合）；d. $T$ 中重合且比 $Q$ 中重合得少。值得思考的是：① 为什么不能将 bd 合并成 $T$ 中重合得且比 $Q$ 中重合的少（允许 $T$ 不重合）？因为这时要保证 $Q$ 中有重合，那就有两维限制，无法维护。② 为什么 d 无需考虑 $x$ 递增条件不满足的情况？因为这个在后续转移中一定不会成为最优解。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;综合起来，2 中的 ab 情况和 1 的点间更新是兼容的，不用额外转移了。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这里最感到奇怪的就是这个 MEM 的引入以及链覆盖的做法。现在理论界确实有很多 parameterized 的解法（&lt;del&gt;主要理论下界都被研究完了&lt;/del&gt;），即关于输入的某个示性数较优的解法。OI 中这类情况就较少。&lt;/p&gt;
&lt;p&gt;然后是一些闲话。&lt;/p&gt;
&lt;p&gt;形式化是一把双刃剑，保证了严谨性的同时给没有相关基础的读者竖起了一面妨碍理解的高墙。vuq 也讨论过“知识的诅咒”这一问题。当你会了一个模型时，你可以任意地把它形式化地表述出来，但是读者初步看了之后，不懂的还是不懂，&lt;strong&gt;因为他们看不到你的文字背后的思考过程（而且实际表述顺序很可能相对于思考顺序是颠倒的），你的 motivation 和 intuition，在理论体系上是怎样的存在（本质、意义、等价表述），当然也包括 vuq 里提到的联想知识&lt;/strong&gt;；甚至单纯就是被一堆定义绕晕了，就放弃了。我以前看算法导论和部分集训队论文就是这种感觉，就像看别人的代码一样。&lt;/p&gt;
&lt;p&gt;但是论文都得保证严谨性。友善的作者可能会加入例子和非形式化解释，但不多。那我硬啃的过程就是把它变成自己的理解，我觉得关键就是在明确定义的前提下尽量带入自己的思路，尝试还原作者的想法。如果硬着头皮逐字逐句地去看文章，被动地理解，会很痛苦（很多情况下就是莫名其妙提出来一个 theorem 然后证明），而且无法收获思维上的营养。读的过程中要经常停下来，想象目前模型的图形化解释、例子以及如果我面对这个模型，我会怎么考虑。主动地去思考，会比较好。当然前提是核心 definition 和问题模型得先搞清楚，如果发现定义不自洽可以检查一下是不是有些专业表述望文生义了。一些无关紧要的延伸的定义也没必要抠得很明白。当然也没法 100% 搞清背后的动机，毕竟都是基于先前已有的论文成果往上堆。&lt;/p&gt;
&lt;p&gt;欢迎讨论。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>[题解] lgP9171 [省选联考 2023] 染色数组</title>
        <link>https://littlereuben.github.io/study/solution-lgp9171/</link>
        <pubDate>Thu, 17 Aug 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/solution-lgp9171/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;  提供一个 $\mathrm{O}(Tn^3m)$ 的做法，目前在各 oj 上是 rank 1，运行时间为第二名的 $\frac{1}{6}$ 以内。&lt;/p&gt;
&lt;p&gt;  类似于本题解的方法不建议在考试中使用，非常耗时间。&lt;del&gt;并且公式很丑。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;  坐稳了！！&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;step-1&#34;&gt;Step 1
&lt;/h2&gt;&lt;p&gt;  @Alex_Wei 已经把严谨的结构刻画讲清楚了，这里再写一下自己的理解（本质上是等价的），看起来不大优美，但比较直观。&lt;/p&gt;
&lt;p&gt;  对于一个完整的序列 $a_{1\cdots n}$，找出其最长的前缀 $a_{1\cdots r}$，满足：前缀中 $\le a_r$ 的数严格递增，$\ge a_r$ 的数严格递减，类似于形成一个尖角。接下来暂时默认 $r&amp;lt;n$。&lt;/p&gt;
&lt;p&gt;  如果 $a_{r+1}=a_r$，那么要求 $a_{r+1\cdots n}$ 中，$\le a_r$ 的数严格递减，$\ge a_r$ 的数严格递增。这种情况恰好有 $2$ 种染色方案且得分相同。&lt;/p&gt;
&lt;p&gt;  否则，记 $a_{1\cdots r}$ 中最大的 $&amp;lt;a_r$ 的数为 $D$（不存在则为 $0$），最小的 $&amp;gt;a_r$ 的数为 $U$（不存在则为 $m+1$），&lt;strong&gt;不妨设&lt;/strong&gt; $a_{r+1}\le D$（与之对称的一种情况是 $\ge U$）。现在找到以 $a_{r+1}$ 开头的最长严格递减&lt;strong&gt;子段&lt;/strong&gt;，如果子段末尾还有下一项，则记为 $a_s$，否则肯定是完美的。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;结论&lt;/strong&gt;：此时完美数组的充要条件是，在 $a_{r+1\cdots n}$ 中，$\le a_{r+1}$ 的数严格递减，不存在 $(a_{r+1},a_r]$ 以内的数，且 $\ge a_s$ 的数严格递增。&lt;/p&gt;
&lt;p&gt;  如图，这是一个完美数组的例子（横坐标为下标，纵坐标为值）：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\kn1ls8is.png&#34; alt=&#34;例1.1&#34; style=&#34;zoom:40%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;  它共有 $4$ 种染色方案，分别对应着下图中全不选/选一个黄色点染成绿色，其他黄色点染成红色：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\whyomgtn.png&#34; alt=&#34;例1.2&#34; style=&#34;zoom:40%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;  如果 $a_s\in (D,a_r]$，那么只有 $1$ 种染色方案，以下是一例；如果 $a_s\in (a_{r+1},D]$ 则无染色方案。&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\uww5i8ud.png&#34; alt=&#34;例1.3&#34; style=&#34;zoom:40%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;  同时，通过观察例子，可以发现多种染色方案一定是形如：一段前后缀颜色固定，中间剩下的区间，它有一个染色方案是全染红/绿，其余方案仅通过选其中某一个反转颜色得到。若 $a_{r+1}\le D$，则允许变颜色的点是以 $(a_U^{-1},U)$ 为左上角，$(r+1, a_{r+1})$ 为右下角的矩形&lt;strong&gt;以内&lt;/strong&gt;的点。这部分实际上是递增的，且相对值域是连续的。$a_{r+1}\ge U$ 类似。&lt;/p&gt;
&lt;p&gt;  以上的证明都是容易的，需要一些分类讨论。&lt;/p&gt;
&lt;p&gt;  考虑哪种染色方案得分最大，容易发现最后一个可以变的点变色一定比其他点变色更优。因此最优染色一定是：$a_{1\cdots r-1}$ 中 $&amp;lt;a_r$ 的和 $a_{r+1\cdots n}$ 中 $&amp;gt;a_r$ 的染红色，$a_{1\cdots r-1}$ 中 $&amp;gt;a_r$ 的和 $a_{r+1\cdots n}$ 中 $&amp;lt;a_r$ 的染绿色，$a_r$ 两种均有可能。&lt;/p&gt;
&lt;h2 id=&#34;step-2&#34;&gt;Step 2
&lt;/h2&gt;&lt;p&gt;  &lt;strong&gt;下文中 $r,U,D$ 的含义不变。称出现了满足 $a_{r+1}=a_r$ 或 $\le D$ 或 $\ge U$ 的情况为“交叉”，$a_r$ 为“交叉点”。称 $a_{1\cdots t}$ 为“前面”，$a_{t+1\cdots n}$ 为“后面”。组合数里只要有负数结果就是 $0$，除了 $\binom{-1}{-1}=1$。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;  回到原问题。先来道开胃菜：前面已经交叉了。这时可以由 $a_{1\cdots t}$ 确定后面染绿部分必须要小于某个值 $L$，染红部分必须要大于某个值 $R$。&lt;/p&gt;
&lt;p&gt;  枚举后面有 $i$ 个染绿的。方案数为：
$$
\binom{L-1}{i}\binom{m-R}{n-t-i}\binom{n-t}{i}
$$
  得分贡献为：
$$
\begin{aligned}
&amp;amp;\left[\sum_{j&amp;lt;L}\sum_{k\le t}[a_k&amp;lt;j]j\right]\binom{L-2}{i-1}\binom{m-R}{n-t-i}\binom{n-t}{i}\\
+{}&amp;amp;\left[\sum_{j&amp;gt;R}\sum_{k\le t}[a_k&amp;gt;j](m-j+1)\right]\binom{L-1}{i}\binom{m-R-1}{n-t-i-1}\binom{n-t}{i}
\end{aligned}
$$
  可以共 $\mathrm{O}(n+m)$ 计算。另外需要求前面的贡献，可以用树状数组。&lt;/p&gt;
&lt;h2 id=&#34;step-3&#34;&gt;Step 3
&lt;/h2&gt;&lt;p&gt;  前面尚未交叉时，为了简化起见，分 $a_r;\fbox{&amp;lt;/=/&amp;gt;};a_t$ 讨论。$a_r=a_t$ 也就是 $r=t$，这时暴力枚举 $a_{r+1}$ 后套用 Step 2 方法，时复只有两次方。&lt;/p&gt;
&lt;p&gt;  $a_r&amp;gt;a_t$ 与 $a_r&amp;lt;a_t$ 的算法完全相同。下记 $L$ 为前面最大的 $&amp;lt;a_t$ 的数（不存在则为 $0$），$R=a_r$，$X$ 为前面 $\le L$ 的数的个数，$Y=t-X$。&lt;/p&gt;
&lt;p&gt;  求方案数可以用 dp。交叉之前，想象“识别尖角”的过程，每次新加入的 $a$ 允许处于两个区间中：&lt;/p&gt;
&lt;center&gt;&lt;img src=&#34;.\yjke872q.png&#34; alt=&#34;例2&#34; style=&#34;zoom:40%;&#34; /&gt;&lt;/center&gt;
&lt;p&gt;  实际计数时，只需要钦定一个区间就行了，一般不会计重。于是 $f_{i,j,k}$ 表示，交叉之前，$a_i=j$，区间另一个端点为 $k$ 的方案数。一种转移是枚举 $a_{i+1}$，然后转移到 $f_{i,a,j/k}$。&lt;/p&gt;
&lt;p&gt;  $g_{i,j,k}$ 表示交叉之后，上一个染绿的为 $j$ ，上一个染红的为 $k$ 的方案数，转移略。$f$ 在 $i$ 作为 $r$ 时要转移给 $g$，为了避免信息不够无法转移以及计重的情况，$j&amp;gt;k$ 的 $f_{i,j,k}$ 只枚举 $a_{i+1}\le k$ 以及 $a_{i+1}=a_i$ 的情况进行贡献，$j&amp;lt;k$ 的只枚举 $a_{i+1}\ge k$ 的情况进行贡献。&lt;/p&gt;
&lt;p&gt;  以上 dp 均可以用前缀和优化做到 $\mathrm{O}(nm^2)$，但是这个 dp 无法类推求出得分和，我们放弃 dp，尝试直接推式子。&lt;strong&gt;同样地，还是只考虑 $a_{r+1}\le D$、 $a_{r+1}=a_r$ 以及 $r=n$ 的情况&lt;/strong&gt;，$a_{r+1}\ge U$ 情况可以将 $a_i\mapsto m-a_i+1$ 后套用 $a_{r+1}\le D$ 的算法。&lt;/p&gt;
&lt;p&gt;  首先，后面的结构大致包含这些要素：交叉前 $&amp;lt;a_r$ 的数个数、交叉前 $&amp;gt;a_r$ 的数个数、$r$、$a_r$、$a_{r+1}$、交叉后 $&amp;lt;a_r$ 的数个数、交叉后 $&amp;gt;a_r$ 的数个数。考虑枚举其中一些。&lt;/p&gt;
&lt;p&gt;  对于 $a_{r+1}\le D$，枚举交叉前 $&amp;lt;a_r$ 的数个数 $i$，交叉前 $&amp;gt;a_r$ 的数个数 $j$，交叉后 $&amp;lt;a_r$ 的数个数 $k$，方案数为：
$$
\begin{aligned}
&amp;amp;\sum_{a_r}\sum_{D&amp;lt;a_r}\textcolor{red}{\binom{D-L-1}{i-1}\binom{m-a_r}{n-t-i-j-k-1}}\textcolor{green}{\binom{D}{k}\binom{R-a_r-1}{j}}\textcolor{blue}{\binom{i+j}{i}\binom{n-t-i-j-2}{k-1}}\\
={}&amp;amp;\binom{i+j}{i}\binom{n-t-i-j-2}{k-1}\sum_{a_r}\left[\sum_{D&amp;lt;a_r}\binom{D-L-1}{i-1}\binom{D}{k}\right]\binom{R-a_r-1}{j}\binom{m-a_r}{n-t-i-j-k-1}\\
={}&amp;amp;\binom{i+j}{i}\binom{n-t-i-j-2}{k-1}\sum_{a_r}C_D(i,k,a_r)\cdot C_U(j,n-t-i-j-k-1,a_r)
\end{aligned}
$$
  红色表示染红部分的方案数，绿色表示染绿部分的方案数，蓝色表示“交织”的方案数。枚举 $D$ 会比枚举 $a_{r+1}$ 稍微方便一点。&lt;strong&gt;$C_D$ 和 $C_U$ 主要是为了突出有关变量仅有三个（预处理即可）。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;  对于 $a_{r+1}=a_r$，枚举 $l=r-t-1$ 以及 $a_r$，方案数为：
$$
\begin{aligned}
&amp;amp;\sum_i\sum_k\textcolor{red}{\binom{a_r-L-1}{i}\binom{m-a_r}{n-t-l-k-2}}\textcolor{green}{\binom{R-a_r-1}{l-i}\binom{a_r-1}{k}}\textcolor{blue}{\binom{l}{i}\binom{n-t-l-2}{k}}\\
={}&amp;amp;\left[\sum_i\binom{a_r-L-1}{i}\binom{R-a_r-1}{l-i}\binom{l}{i}\right]\left[\sum_k\binom{a_r-1}{k}\binom{m-a_r}{n-t-l-k-2}\binom{n-t-l-2}{k}\right]\\
={}&amp;amp;C_L(l,a_r)\cdot C_R(n-t-l-2,a_r)
\end{aligned}
$$
  这里明确一下组合意义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$C_D(i,j,a)$ 表示 $a_r=a$，要安排 $&amp;lt;a_r$ 的数，交叉前个数为 $i$，交叉后个数为 $j$ 的方案数。&lt;/li&gt;
&lt;li&gt;$C_U(i,j,a)$ 表示 $a_r=a$，要安排 $&amp;gt;a_r$ 的数，交叉前个数为 $i$，交叉后个数为 $j$ 的方案数。&lt;/li&gt;
&lt;li&gt;$C_L(i,a)$ 表示 $a_r=a$，要安排 $r$ 之前的数共 $i$ 个的方案数（不考虑交叉条件）。&lt;/li&gt;
&lt;li&gt;$C_R(i,a)$ 表示 $a_r=a$，要安排 $r$ 之后的数共 $i$ 个的方案数（不考虑交叉条件）。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;  $r=n$ 的情况可以顺便计入。总体来说，计算方案数为 $\mathrm{O}(n^3m)$，实际表现比 dp 还快。下面是计算得分和，思路与求方案数类似。&lt;/p&gt;
&lt;h2 id=&#34;step-4&#34;&gt;Step 4
&lt;/h2&gt;&lt;p&gt;  以下 $a_r=a_{r+1}$ 情况部分时间复杂度都是 $\mathrm{O}(n^2m)$，一般情况部分则是 $\mathrm{O}(n^3m)$。代码中的顺序和分析的顺序是一样的。&lt;/p&gt;
&lt;h4 id=&#34;交叉前下部&#34;&gt;交叉前下部
&lt;/h4&gt;&lt;p&gt;  首先，不考虑交叉后部分与交叉前上部数值的安排，它们充其量就是外面乘一个系数。枚举交叉前 $&amp;lt;a_r$ 的数个数 $i$，交叉前 $&amp;gt;a_r$ 的数个数 $j$，以及 $D$，该部分得分为：
$$
\begin{aligned}
&amp;amp;\sum_{p=1}^i\left[\sum_{q=0}^j\binom{p-1+q}{p-1}\binom{i-p+j-q}{i-p}(q+Y)\right]\left[\sum_{a=L+1}^D\binom{a-L-1}{p-1}\binom{D-a-1}{i-p-1}(m-a+1)\right]\\
={}&amp;amp;\sum_{p=1}^i\left[\binom{i+j}{i+1}p+\binom{i+j}{i}Y\right]\left[\binom{D-L-1}{i-1}(m-L+1)-\binom{D-L}{i}p\right]\\
={}&amp;amp;\binom{i+j}{i}\binom{D-L-1}{i-1}\left[\frac{ij(m-L+1)}{2}-\frac{(2i+1)j(D-L)}{6}+iY(m-L+1)-\frac{(i+1)Y(D-L)}{2}\right]
\end{aligned}
$$
  其中 $p$ 枚举交叉前下部的第几个数（称为“它”），$q$ 枚举有交叉前上部有几个数在它前面，$a$ 枚举它的值。第一个等号是利用 Vandermonde 恒等式，第二个等号就是正整数次方求和。记该式为 $(*)$。&lt;/p&gt;
&lt;p&gt;  接下来再把剩余未确定的部分确定，枚举交叉后 $&amp;lt;a_r$ 的数个数 $k$，最终得分为：
$$
\begin{aligned}
&amp;amp;\sum_{a_r&amp;gt;D}(*)\binom{R-a_r-1}{j}\binom{D}{k}\binom{m-a_r}{n-t-i-j-k-1}\binom{n-t-i-j-2}{k-1}\\
={}&amp;amp;(*)\binom{D}{k}\binom{n-t-i-j-2}{k-1}\sum_{a_r&amp;gt;D}C_U(j,n-t-i-j-k-1,a_r)\\
={}&amp;amp;(*)\binom{D}{k}\binom{n-t-i-j-2}{k-1}C^\prime_U(j,n-t-i-j-k-1,D)
\end{aligned}
$$
  预处理 $C_U(i,j,*)$ 的后缀和就不用枚举 $a_r$ 了。&lt;/p&gt;
&lt;h4 id=&#34;交叉前上部&#34;&gt;交叉前上部
&lt;/h4&gt;&lt;p&gt;  思路是差不多的。先枚举交叉前 $&amp;lt;a_r$ 的数个数 $i$，交叉前 $&amp;gt;a_r$ 的数个数 $j$，以及 $a_r$，该部分得分为：
$$
\begin{aligned}
&amp;amp;\sum_{p=1}^j\left[\sum_{q=0}^i\binom{p-1+q}{p-1}\binom{j-p+i-q}{j-p}(q+X)\right]\left[\sum_{a=a_r+1}^{R-1}\binom{R-a-1}{p-1}\binom{a-a_r-1}{j-p}a\right]\\
={}&amp;amp;\sum_{p=1}^j\left[\binom{i+j}{j+1}p+\binom{i+j}{j}X\right]\left[\binom{R-a_r-1}{j}R-\binom{R-a_r}{j+1}p\right]\\
={}&amp;amp;\binom{i+j}{j}j\left[\binom{R-a_r-1}{j}\left(\frac{i}{2}+X\right)R-\binom{R-a}{j+1}\left(\frac{i(2j+1)}{6}+\frac{(j+1)X}{2}\right)\right]
\end{aligned}
$$
  抱歉让强迫症难受了，没法化得对称，否则分母上就会有未知数，得乘逆元了 /lb。&lt;/p&gt;
&lt;p&gt;  剩余未确定的部分的方案数同理，枚举一下 $k$，就不写了，要乘 $C_D$ 等。&lt;/p&gt;
&lt;p&gt;  另外 $a_{r+1}=a_r$ 和 $r=n$ 的情况的交叉前也可以方便地在这里算掉（反正都枚举 $a_r$ 了）。交叉前下部里就不用算了，会在 $a_i\mapsto m-a_i+1$ 时当成上部算掉。&lt;/p&gt;
&lt;p&gt;  另一种思路是不推上部，直接推 $a_{r+1}&amp;gt;a_r$ 情况的下部，我没试过，应该也是可以的。&lt;/p&gt;
&lt;h4 id=&#34;交叉点&#34;&gt;交叉点
&lt;/h4&gt;&lt;p&gt;  枚举交叉前 $&amp;lt;a_r$ 的数个数 $i$，交叉前 $&amp;gt;a_r$ 的数个数 $j$，交叉后 $&amp;lt;a_r$ 的数个数 $k$，最终得分为：
$$
\sum_{a_r}C_D(i,k,a_r)\cdot C_U(j,n-t-i-j-k-1,a_r)\cdot\max((Y+j)(m-a_r+1),(X+i)a_r)
$$
  $a_{r+1}=a_r$ 的部分可能要特殊考虑一下，代码里处理的思路是和交叉前放在一起算，直接乘 $C_R$，就不用枚举 $k$ 了。&lt;/p&gt;
&lt;h4 id=&#34;交叉后下部&#34;&gt;交叉后下部
&lt;/h4&gt;&lt;p&gt;  交叉后就无需考虑 $r=n$ 了。先不考虑上部与“交织”的安排。枚举交叉前 $&amp;lt;a_r$ 的数个数 $i$，交叉后 $&amp;lt;a_r$ 的数个数 $k$，以及 $D$，该部分得分为：&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
&amp;amp;\sum_{i\le t,a_i\le L}\sum_{p=a_i+1}^D\binom{D-L-1}{i-1}\binom{D-1}{k-1}p+\sum_{a=L+1}^D\sum_{p=a+1}^D\binom{D-L-2}{i-2}\binom{D-1}{k-1}p\\
=&amp;amp;\binom{D-1}{k-1}\left[\binom{D-L-1}{i-1}\underline{\sum_{i\le t,a_i\le L}\frac{(a_i+1+D)(D-a_i)}{2}}_{f_0(D)}+\binom{D-L-2}{i-2}\underline{\sum_{a=L+1}^D\frac{(a+1+D)(D-a)}{2}}_{f(D)}\right]
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;  其中 $p$ 枚举的是交叉后下部的某个数值。记该式为 $(*)$。划线部分可以预处理。&lt;/p&gt;
&lt;p&gt;  考虑剩余部分，枚举交叉前 $&amp;gt;a_r$ 的数个数 $j$，最终得分为：
$$
(*)\binom{i+j}{i}\binom{n-t-i-j-2}{k-1}C^\prime_U(j,n-t-i-j-k-1,D)
$$&lt;/p&gt;
&lt;h4 id=&#34;交叉后上部&#34;&gt;交叉后上部
&lt;/h4&gt;&lt;p&gt;$$
{\underline{a}&lt;em&gt;{f}}{\underline{b}&lt;/em&gt;{f}}
$$&lt;/p&gt;
&lt;p&gt;  先枚举交叉前 $&amp;gt;a_r$ 的数个数 $j$，交叉后 $&amp;gt;a_r$ 的数个数 $k$，以及 $a_r$，该部分得分为：
$$
\binom{m-a_r-1}{k-1}\underline{\left[\binom{R-a_r-1}{j}\sum_{i\le t,a_i\ge R}\frac{(2m-a_i-a_r+2)(a_i-a_r-1)}{2}+\binom{R-a_r-2}{j-1}\sum_{a=a_r+1}^{R-1}\frac{(2m-a-a_r+2)(a-a_r-1)}{2}\right]}_{F(j,a_r)}
$$
  最终得分同理也是要乘 $C_D$ 等，略。&lt;/p&gt;
&lt;p&gt;  同样要处理一下 $a_{r+1}=a_r$，要做到三次方还得分离一下变量：
$$
\begin{align}
&amp;amp;\sum_{i,j,k,a_r}\binom{a_r-L-1}{i}\binom{m-a_r-1}{k-1}F(j,a_r)\binom{a_r-1}{n-t-i-j-k-2}\binom{i+j}{j}\binom{n-t-i-j-2}{k}\\
=&amp;amp;\sum_{a_r}\sum_l\left[\sum_i\binom{a_r-L-1}{i}F(l-i,a_r)\binom{l}{i}\right]\left[\sum_k\binom{a_r-1}{n-t-l-k-2}\binom{m-a_r-1}{k-1}\binom{n-t-l-2}{k}\right]
\end{align}
$$
  $l$ 就是 $i+j$ 换元，跟 Step 3 里的 $l$ 是一样的。注意第二个中括号里的不是 $C_R$。&lt;/p&gt;
&lt;h2 id=&#34;step-5&#34;&gt;Step 5
&lt;/h2&gt;&lt;p&gt;  说一下优化：我们希望瓶颈部分（四次方的最内层循环）运算次数尽量少，所以可以把只涉及到一部分变量的乘法先预处理掉，把能用分配律的乘法提到外层。&lt;/p&gt;
&lt;p&gt;  然后就是 $18$ 次一取模优化。&lt;/p&gt;
&lt;h2 id=&#34;code&#34;&gt;Code
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#define ansc ans. first
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#define anss ans. second
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calcP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;getsum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;getsum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calcX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pre&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sumd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sumu&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pre&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sumd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sumu&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sumd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sumu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pre&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calcI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CU&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CUS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;CU&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;CUS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CUS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CU&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;CR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;ull&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;ADD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CU&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;ull&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;ADD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CUS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;ull&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;						&lt;span class=&#34;n&#34;&gt;ADD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;ull&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CU&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;ull&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;ADD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CUS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CL&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;_F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;ull&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;ADD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;res1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;res2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;res2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;res2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calcF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calcN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;pii&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;cin&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;cin&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;scanf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;					&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calcN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nl&#34;&gt;O&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%d %d&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ansc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;anss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>[题解] lgP9159 [GLR-R4] 大暑</title>
        <link>https://littlereuben.github.io/study/solution-lgp9159/</link>
        <pubDate>Wed, 24 May 2023 00:00:00 +0000</pubDate>
        
        <guid>https://littlereuben.github.io/study/solution-lgp9159/</guid>
        <description>&lt;div style=&#34;background-color: #FFF9B9; color: #796E00; padding-left: 1em; border-left: 4px solid #DED041; height: 25pt; line-height: 25pt;&#34;&gt;这是一篇&lt;b&gt;学习笔记&lt;/b&gt;。&lt;/div&gt;
&lt;p&gt;  同学打月赛后告诉我有道很离谱的题，遂做，确实挺离谱的，这里讲一下自己做的思路。&lt;/p&gt;
&lt;h2 id=&#34;题意&#34;&gt;题意
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;给定 $n$，平面直角坐标系上有点 $(0,0)\sim(0,n-1),(1,0)\sim(1,n-1)$。对于一个 $n$ 排列 $p$，对每个 $i$ 连线段 $(0,i)-(1,p_i)$。&lt;/li&gt;
&lt;li&gt;考虑从每个横坐标为 $0$ 的点出发，依附于这些线段各走一条折线（或线段）到达一个横坐标为 $1$ 的点，这些折线（或线段）仅能在原先 $n$ 条线段的交点上重合。&lt;/li&gt;
&lt;li&gt;求所有 $p$ 的方案数之&lt;strong&gt;积&lt;/strong&gt;${}\bmod{335544323}$。&lt;/li&gt;
&lt;li&gt;$n\le 10^6$。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;step-1&#34;&gt;Step 1
&lt;/h2&gt;&lt;p&gt;  &lt;strong&gt;方便起见称原题中完美匹配（简称匹配）的连线为 “线段”，染色的折线（或线段）为 “路径”。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;  模拟一些例子，发现三点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;路径不会 “往回折” 且线段没有任何部分不被经过。&lt;/li&gt;
&lt;li&gt;选择一条路径在（最后）一个交点的走向，剩余的东西并没有本质不同，感性地说像是有一个乘法原理。&lt;/li&gt;
&lt;li&gt;三线段交于同一点和三线段交于三个点的方案数是不同的，也就是说这个几何背景是有用的。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;  可以证明第一点：考虑任一横坐标 $x_0$ 满足原先 $n$ 条线段的交点均不在 $x=x_0$ 上，这时原图有 $n$ 个点在 $x=x_0$ 上，而每一条路径至少穿过一次 $x=x_0$。如果有一条路径往回折，那就穿过某个 $x=x_0$ 大于一次，这就不可能存在 $n$ 条两两交长度 $=0$ 的路径了。&lt;/p&gt;
&lt;p&gt;  进一步分析，发现一个 “$k$ 线共点” 的情况会对答案贡献 $k!$。因为这个局部相当于一个 $k$ 阶匹配以决定每条路径的走向，且每种方案显然都是合法的。因此最有可能的思路大概就是对于每个可能的交点，求出每种匹配情况下有几条线段经过它，然后阶乘乘起来贡献给答案。当然不能像这样直接算。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;显然贡献值只取决于该交点最多被几条线段经过&lt;/strong&gt;（显然这些线段的端点均不同，所以相当于是一个选择问题），故可以求出 &lt;strong&gt;$w_k$ 表示将所有可能的 $n^2$ 条线段画出后 $k$ 线共点的情况数，$p_k$ 表示一个至多作为 $k$ 条线段交点的点在所有匹配情况下对答案的总贡献&lt;/strong&gt;。就有：&lt;/p&gt;
&lt;p&gt;$$
ans=\prod_{k=2}^n p_k^{w_k}
$$&lt;/p&gt;
&lt;h2 id=&#34;step-2&#34;&gt;Step 2
&lt;/h2&gt;&lt;p&gt;  求 $w_k$。考虑刻画线段交于一点的情况。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://littlereuben.github.io/study/solution-lgp9159/xd7iksq2.png&#34;
	width=&#34;847&#34;
	height=&#34;164&#34;
	
	loading=&#34;lazy&#34;
	
		alt=&#34;例&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;516&#34;
		data-flex-basis=&#34;1239px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;  （为了美观横过来了）由图中相似关系可见，两边选的相邻点距离要对应成比例。&lt;/p&gt;
&lt;p&gt;  第一反应是直接硬着对&lt;strong&gt;极大共点选择（一些线段交于同一点，且不能再多选一条经过该交点的线段&lt;/strong&gt;。显然这些线段的端点均不同）计数，官方解法有更方便的容斥做法，这里就算给一个备选方案了。极大共点选择的条件为：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;两边选的点纵坐标分别成等差数列；&lt;/li&gt;
&lt;li&gt;不能再往左右扩展；&lt;/li&gt;
&lt;li&gt;公差互质。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;  首先发现互质条件无法直接处理，因此莫反，枚举公差的公因数 $g$，贡献乘 $\mu(g)$ 即可。如果考虑左右部分别长为 $x$ 和 $y$ 的极长等差数列，那么画图可得它们能构成的极大共点选择包括：$2$ 个 $2$ 线共点，$2$ 个 $3$ 线共点，……，$2$ 个 $\min(x,y)-1$ 线共点，$\lvert x-y\rvert+1$ 个 $\min(x,y)$ 线共点。&lt;/p&gt;
&lt;p&gt;  那么只需对于每个 $g$，把每种为 $g$ 倍数的公差所能形成的极长等差数列长度及其数量求出来，统计并扫描处理即可。由于一个公差 $d$ 至多只能产生 $\lfloor (n-1)/d\rfloor+1$ 与 $\lfloor (n-1)/d\rfloor$ 两种长度，而扫描可以优化到线性（枚举长较小者，部分细节略去），故这部分可以做到 $\mathrm{O}(n\log n)$。&lt;/p&gt;
&lt;h2 id=&#34;step-3&#34;&gt;Step 3
&lt;/h2&gt;&lt;p&gt;  直接求 $p_k$ 的思路为：对于每个 $i=1,\cdots,k$，求出&lt;strong&gt;有多少种匹配恰好出现 $i$ 条线段经过该点，记为 $f_i$&lt;/strong&gt;，则：&lt;/p&gt;
&lt;p&gt;$$
p_k=\prod_{i=1}^k (i!)^{f_i}
$$&lt;/p&gt;
&lt;p&gt;  $f_i$ 无法直接计算，记 &lt;strong&gt;$g_i$ 表示钦定 $i$ 条线段经过该点，其他随便匹配的方案数&lt;/strong&gt;（可能会算重）。则：&lt;/p&gt;
&lt;p&gt;$$
\binom ki(n-i)!=g_i=\sum_{j=i}^k\binom jif_i
$$&lt;/p&gt;
&lt;p&gt;  二项式反演得：&lt;/p&gt;
&lt;p&gt;$$
f_i=\sum_{j=i}^k(-1)^{j-i}\binom ji\binom kj(n-j)!
$$&lt;/p&gt;
&lt;p&gt;  然后就会发现没法快速求出 $p_i$&lt;del&gt;（如果有大佬会的能教一下吗/kel&lt;/del&gt;&lt;/p&gt;
&lt;h2 id=&#34;step-4&#34;&gt;Step 4
&lt;/h2&gt;&lt;p&gt;  既然没法快速求 $p_i$，那么考虑利用最终只需求一个积这个性质，把所有 $k$ 放在一起求。记：&lt;/p&gt;
&lt;p&gt;$$
c_i=\sum_{k=i}^nw_k\sum_{j=i}^k(-1)^{j-i}\binom ji\binom kj(n-j)!
$$&lt;/p&gt;
&lt;p&gt;  则：&lt;/p&gt;
&lt;p&gt;$$
ans=\prod_{i=2}^n(i!)^{c_i}
$$&lt;/p&gt;
&lt;p&gt;  而 $c_i$ 是可以快速求的：&lt;/p&gt;
&lt;p&gt;$$
c_i=\sum_{j=i}^n(-1)^{j-i}\binom ji(n-j)!\left(\sum_{k=j}^n w_k\binom kj\right)
$$&lt;/p&gt;
&lt;p&gt;  两次差卷积即可。细节略去。&lt;/p&gt;
&lt;h2 id=&#34;step-5&#34;&gt;Step 5
&lt;/h2&gt;&lt;p&gt;  最后一个问题是 $c_i$ 是在指数上的。注意到原模数为质数 $335544323=2^{26}\times 5+3$，因此如果能求出 $c_i$ 模 NTT 质数 $2^{25}\times 5+1$ 与 $c_i$ 的奇偶性即可用 CRT 的思路还原 $c_i\bmod (2^{26}\times 5+2)$。&lt;/p&gt;
&lt;p&gt;  一个性质是 $w_i\equiv[i=n]\pmod 2$（显然 $w_n=1$）。这是因为除了两部公差均为 $1$ 的情况，其余所有极大共点选择可以对应其两部交换后的另一个极大共点选择。那么：&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}c_i&amp;amp;\equiv\sum_{j=i}^n\binom ji\binom nj(n-j)!\\ &amp;amp;\equiv n\binom{n-1}i+\binom ni\\ &amp;amp;\equiv(n-i+1)[i\subseteq n]\pmod 2\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;  最终时间复杂度为 $\mathrm{O}(n\log n)$。&lt;/p&gt;
&lt;h2 id=&#34;代码&#34;&gt;代码
&lt;/h2&gt;&lt;p&gt;  一个优化：两次卷积分别要求类似于 $\text{DFT}(\mathrm{e}^x)$ 以及 $\text{DFT}(\mathrm{e}^{-x})$ 形式的东西，可以省掉一次。共 $5$ 次 DFT。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NTT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;reverse&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;I&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;cin&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;				&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;sl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;qpow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;I&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;qpow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;qpow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;NTT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;NTT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;NTT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;P&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;NTT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;NTT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1ll&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;qpow_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        
    </channel>
</rss>
